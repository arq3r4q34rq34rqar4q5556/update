// ==UserScript==
// @name         blobio 2026 newest api
// @namespace    bro
// @version      2025-01-13
// @description  ya
// @author       yo?
// @match        *://blobgame.io/*
// @match        *://test.blobgame.io/*
// @match        *://custom.client.blobgame.io/*
// @resource     IMPORTED_CSS3 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/gamecss
// @resource     IMPORTED_CSS1 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/loginpage2
// @resource     IMPORTED_CSS2 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/BROloading
// @resource     IMPORTED_CSS5 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/tooltipandnottester
// @resource     IMPORTED_CSS4 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/sigmachattooltip
// @resource     IMPORTED_CSS17 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/tooltiptestbigger
// @resource     IMPORTED_CSS7 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/sigmacss
// @resource     IMPORTED_CSS8 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/okaynamingthisNAVBARbecauseiforgotlastone
// @resource     IMPORTED_CSS9 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/help
// @resource     IMPORTED_CSS10 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/supercooltoast
// @resource     IMPORTED_CSS11 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/butterup
// @resource     IMPORTED_CSS12 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/oopstextarea
// @resource     IMPORTED_CSS13 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/partypagecss
// @resource     IMPORTED_CSS14 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/partygradient
// @resource     IMPORTED_CSS15 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/jussttesting
// @resource     IMPORTED_CSS16 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/homepageupdatenotes
// @resource     IMPORTED_CSS18 https://cdn.jsdelivr.net/gh/ColonelParrot/feedbackplus@master/src/feedbackplus.min.css
// @resource     IMPORTED_CSS19 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/reportfeedbackformcss
// @resource     IMPORTED_CSS22 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/feedbackbruhfixed
// @resource     IMPORTED_CSS23 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/hompagestuff
// @resource     IMPORTED_CSS24 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/asdfdfasdfsg
// @resource     IMPORTED_CSS25 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/customskintestcss
// @resource     IMPORTED_CSS26 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/onlinestatus2
// @require      https://code.jquery.com/jquery-3.7.1.min.js
// @require      https://cdn.jsdelivr.net/gh/ColonelParrot/feedbackplus@master/src/feedbackplus.min.js
// @require      https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/butterup.min
// @require      https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/customskintestJS
// @require      https://raw.githubusercontent.com/Prinzhorn/skrollr/refs/heads/master/dist/skrollr.min.js
// @require      https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js
// @require      https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js
// @require      https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js
// @require      https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js
// @require      https://cdn.jsdelivr.net/npm/party-js@latest/bundle/party.min.js
// @include      https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/shadertest
// @icon         https://cdn.discordapp.com/avatars/1218403826181210166/6007be8754f9689f89181b9b784f45da.webp?size=240
// @grant        GM_getResourceText
// @grant        GM_xmlhttpRequest
// @grant        GM_addStyle
// @grant        GM_setValue
// @grant        GM_getValue
// @grant        GM_webRequest
// @grant        unsafeWindow
// ==/UserScript==
// @require      https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/requiredscripts

// @resource     IMPORTED_CSS4 https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/tooltip
(function () {
    'use strict';
    var homepage = !!location.href.match('https://blobgame.io/');
    var testaccountpage = !!location.href.match('https://test.blobgame.io/');
    var gameActivity = !!location.href.includes('http://custom.client.blobgame.io/?ip=');
    var loginActivity = !!location.href.match('http://custom.client.blobgame.io/assets/');
    var loginSuccessful = !!location.href.match('http://custom.client.blobgame.io/html/loginsuccess');
    var loginUnsuccessful = !!location.href.match('http://custom.client.blobgame.io/privatelist.js');
    var transferTester = !!location.href.match('https://blobgame.io/ffffffffffff2ff2f2f288f8a9ajdkdlasdkjfa9s0dajsdfa');
    var logoutHOMEPAGE = !!location.href.match('https://blobgame.io/nagosdngaosdngaosdnao12ad9fa0sj9gsjd0ga');
    var invisUpdatNO = !!location.href.match('http://custom.client.blobgame.io/updateHAHAHA-no');
    var invisUpdatYES = !!location.href.match('http://custom.client.blobgame.io/updateHAHAHA-yes');
    var testAccUpdatNO = !!location.href.match('https://blobgame.io/assets/updateHAHAHAtestAcc-no');
    var testaccIDKidk = !!location.href.match('https://blobgame.io/awoenvpnavepnoipv');
    var robloxLoginSuccess = !!location.href.includes('https://blobgame.io/loginrobloxsuccess?code=');
    var purchaseCustomSkin = !!location.href.includes('https://blobgame.io/FA293-C9Ã–A-VA87D-A8780-MCM0-0ZV98');
    var twomXPurchaseSuccess = !!location.href.includes('https://blobgame.io/G9DA4-IASD-V9S03-VS0A9-IAV9-S9D0A');



    if (purchaseCustomSkin) {

        console.log("purchase successful");
        localStorage.setItem("3u90fewjio", "0sa9dvhia90sdjfpo");

    }

    const convertcode = new URLSearchParams(window.location.hash.slice(1));
    const [code] = [convertcode.get('code')];

    /* not in use */
    var partyPage = !!location.href.match('http://custom.client.blobgame.io/.well-known/assetlinks.json')
    if (!localStorage.getItem('access-token')) {
        //console.log("asdfasdfs");

    } else {
        var blobioTokenID = JSON.parse(atob(localStorage.getItem("access-token").split(".")[1]))["userId"];
        //console.log("34r234t234fwa");
    }
    var token3 = localStorage.getItem('access-token')
    if (robloxLoginSuccess) {
        const loadingst = document.createElement('style');
        loadingst.innerHTML = `

body {
	 -webkit-font-smoothing: antialiased;
	 text-rendering: optimizeLegibility;
	 font-family: "proxima-nova-soft", sans-serif;
	 -webkit-user-select: none;
	 overflow: hidden;
}
 body .vertical-centered-box {
	 position: absolute;
	 width: 100%;
	 height: 100%;
	 text-align: center;
}
 body .vertical-centered-box:after {
	 content: '';
	 display: inline-block;
	 height: 100%;
	 vertical-align: middle;
	 margin-right: -0.25em;
}
 body .vertical-centered-box .content {
	 box-sizing: border-box;
	 display: inline-block;
	 vertical-align: middle;
	 text-align: left;
	 font-size: 0;
}
 * {
	 transition: all .3s;
}
 body {
	 background: #2c2d44;
}
 .loader-circle {
	 position: absolute;
	 left: 50%;
	 top: 50%;
	 width: 120px;
	 height: 120px;
	 border-radius: 50%;
	 box-shadow: inset 0 0 0 1px rgba(255,255,255,0.1);
	 margin-left: -60px;
	 margin-top: -60px;
}
 .loader-line-mask {
	 position: absolute;
	 left: 50%;
	 top: 50%;
	 width: 60px;
	 height: 120px;
	 margin-left: -60px;
	 margin-top: -60px;
	 overflow: hidden;
	 transform-origin: 60px 60px;
	 -webkit-mask-image: -webkit-linear-gradient(top,#000000,rgba(0,0,0,0));
	 animation: rotate 1.2s infinite linear;
}
 .loader-line-mask .loader-line {
	 width: 120px;
	 height: 120px;
	 border-radius: 50%;
	 box-shadow: inset 0 0 0 1px rgba(255,255,255,0.5);
}
 #particles-background, #particles-foreground {
	 left: -51%;
	 top: -51%;
	 width: 202%;
	 height: 202%;
	 transform: scale3d(.5,.5,1);
}
 #particles-background {
	 background: #2c2d44;
	 background-image: -moz-linear-gradient(45deg,#3f3251 2%,#002025 100%);
	 background-image: -webkit-linear-gradient(45deg,#3f3251 2%,#002025 100%);
	 background-image: linear-gradient(45deg,#3f3251 2%,#002025 100%);
}
 @keyframes rotate {
	 0% {
		 transform: rotate(0deg);
	}
	 100% {
		 transform: rotate(360deg);
	}
}
 @keyframes fade {
	 0% {
		 opacity: 1;
	}
	 50% {
		 opacity: 0.25;
	}
}
 @keyframes fade-in {
	 0% {
		 opacity: 0;
	}
	 100% {
		 opacity: 1;
	}
}


        `
      document.body.appendChild(loadingst);

       document.querySelector("body").innerHTML += `

<div id="particles-background" class="vertical-centered-box"></div>
<div id="particles-foreground" class="vertical-centered-box"></div>

<div class="vertical-centered-box">
  <div class="content">
    <div class="loader-circle"></div>
    <div class="loader-line-mask">
      <div class="loader-line"></div>
    </div>
    <svg width="36px" height="24px" viewBox="0 0 36 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
      <path d="M8.98885921,23.8523026 C8.8942483,23.9435442 8.76801031,24 8.62933774,24 L2.03198365,24 C1.73814918,24 1.5,23.7482301 1.5,23.4380086 C1.5,23.2831829 1.55946972,23.1428989 1.65570253,23.0416777 L13.2166154,12.4291351 C13.3325814,12.3262031 13.4061076,12.1719477 13.4061076,11.999444 C13.4061076,11.8363496 13.3401502,11.6897927 13.2352673,11.587431 L1.68841087,0.990000249 C1.57298556,0.88706828 1.5,0.733668282 1.5,0.561734827 C1.5,0.251798399 1.73814918,2.85130108e-05 2.03198365,2.85130108e-05 L8.62933774,2.85130108e-05 C8.76855094,2.85130108e-05 8.89532956,0.0561991444 8.98994048,0.148296169 L21.4358709,11.5757407 C21.548593,11.6783875 21.6196864,11.8297916 21.6196864,11.999444 C21.6196864,12.1693815 21.5483227,12.3219261 21.4350599,12.4251432 L8.98885921,23.8523026 Z M26.5774333,23.8384453 L20.1765996,17.9616286 C20.060093,17.8578413 19.9865669,17.703871 19.9865669,17.5310822 C19.9865669,17.3859509 20.0390083,17.2536506 20.1246988,17.153855 L23.4190508,14.1291948 C23.5163648,14.0165684 23.6569296,13.945571 23.8131728,13.945571 C23.9602252,13.945571 24.0929508,14.0082997 24.1894539,14.1092357 L33.861933,22.9913237 C33.9892522,23.0939706 34.0714286,23.2559245 34.0714286,23.4381226 C34.0714286,23.748059 33.8332794,23.9998289 33.5394449,23.9998289 L26.9504707,23.9998289 C26.8053105,23.9998289 26.6733958,23.9382408 26.5774333,23.8384453 Z M26.5774333,0.161098511 C26.6733958,0.0615881034 26.8053105,0 26.9504707,0 L33.5394449,0 C33.8332794,0 34.0714286,0.251769886 34.0714286,0.561706314 C34.0714286,0.743904453 33.9892522,0.905573224 33.861933,1.00822006 L24.1894539,9.89030807 C24.0929508,9.99152926 23.9602252,10.0542579 23.8131728,10.0542579 C23.6569296,10.0542579 23.5163648,9.98354562 23.4190508,9.87063409 L20.1246988,6.8459739 C20.0390083,6.74617837 19.9865669,6.613878 19.9865669,6.46874677 C19.9865669,6.29624305 20.060093,6.14198767 20.1765996,6.03848544 L26.5774333,0.161098511 Z" fill="#FFFFFF"></path>
    </svg>
  </div>
</div>

`;

       fetch(`https://apis.roblox.com/oauth/v1/token`, {
           method: 'POST',
           headers: {
               "Content-Type": "application/x-www-form-urlencoded"
           },
           body: new URLSearchParams({
               grant_type: 'authorization_code',
               client_id: 2811426297878574107,
               client_secret: 'RBX-npMbEBZi5UqtsD0VMDp4TaDb_8Nk_QP5uc-FXuNT-RiIApFFugl2FpOF2tu-XNHD',
               code: window.location.href.slice(44)

           })
       })
           .then(result => result.json())
           .then(response => {
           //handle response
           console.log("success")
           const {
               access_token
           } = response;

           console.log(access_token)

           /*  if (roles == 1310056596558188576) {
               localStorage.setItem('tester', 'ya');
               console.log("tester confirmed");

               //localStorage.setItem('loggedin', 'true');
test();

            } else {
               alert("you're not a tester on the discord");
               redirecthomepage();

               return false;
            }*/

       })
           .catch(console.error);

   }
    if (testaccountpage) {

        $(document.querySelector("body > app-root > app-main > div.wrapper")).append(`


<button id="backtonormalbtn" style="width:80px;">BACK TO NORMAL</button>


`);
       document.getElementById('backtonormalbtn').addEventListener('click', function () {

           location.href = 'https://blobgame.io/assets/updateHAHAHAtestAcc-no';

       });
   }

    if (testAccUpdatNO) {

        const loadingsta = document.createElement('style');
        loadingsta.innerHTML = `

body {
	 -webkit-font-smoothing: antialiased;
	 text-rendering: optimizeLegibility;
	 font-family: "proxima-nova-soft", sans-serif;
	 -webkit-user-select: none;
	 overflow: hidden;
}
 body .vertical-centered-box {
	 position: absolute;
	 width: 100%;
	 height: 100%;
	 text-align: center;
}
 body .vertical-centered-box:after {
	 content: '';
	 display: inline-block;
	 height: 100%;
	 vertical-align: middle;
	 margin-right: -0.25em;
}
 body .vertical-centered-box .content {
	 box-sizing: border-box;
	 display: inline-block;
	 vertical-align: middle;
	 text-align: left;
	 font-size: 0;
}
 * {
	 transition: all .3s;
}
 body {
	 background: #2c2d44;
}
 .loader-circle {
	 position: absolute;
	 left: 50%;
	 top: 50%;
	 width: 120px;
	 height: 120px;
	 border-radius: 50%;
	 box-shadow: inset 0 0 0 1px rgba(255,255,255,0.1);
	 margin-left: -60px;
	 margin-top: -60px;
}
 .loader-line-mask {
	 position: absolute;
	 left: 50%;
	 top: 50%;
	 width: 60px;
	 height: 120px;
	 margin-left: -60px;
	 margin-top: -60px;
	 overflow: hidden;
	 transform-origin: 60px 60px;
	 -webkit-mask-image: -webkit-linear-gradient(top,#000000,rgba(0,0,0,0));
	 animation: rotate 1.2s infinite linear;
}
 .loader-line-mask .loader-line {
	 width: 120px;
	 height: 120px;
	 border-radius: 50%;
	 box-shadow: inset 0 0 0 1px rgba(255,255,255,0.5);
}
 #particles-background, #particles-foreground {
	 left: -51%;
	 top: -51%;
	 width: 202%;
	 height: 202%;
	 transform: scale3d(.5,.5,1);
}
 #particles-background {
	 background: #2c2d44;
	 background-image: -moz-linear-gradient(45deg,#3f3251 2%,#002025 100%);
	 background-image: -webkit-linear-gradient(45deg,#3f3251 2%,#002025 100%);
	 background-image: linear-gradient(45deg,#3f3251 2%,#002025 100%);
}
 @keyframes rotate {
	 0% {
		 transform: rotate(0deg);
	}
	 100% {
		 transform: rotate(360deg);
	}
}
 @keyframes fade {
	 0% {
		 opacity: 1;
	}
	 50% {
		 opacity: 0.25;
	}
}
 @keyframes fade-in {
	 0% {
		 opacity: 0;
	}
	 100% {
		 opacity: 1;
	}
}


        `
      document.body.appendChild(loadingsta);
       document.querySelector("body").innerHTML += `
<div id="particles-background" class="vertical-centered-box"></div>
<div id="particles-foreground" class="vertical-centered-box"></div>

<div class="vertical-centered-box">
  <div class="content">
    <div class="loader-circle"></div>
    <div class="loader-line-mask">
      <div class="loader-line"></div>
    </div>
    <svg width="36px" height="24px" viewBox="0 0 36 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
      <path d="M8.98885921,23.8523026 C8.8942483,23.9435442 8.76801031,24 8.62933774,24 L2.03198365,24 C1.73814918,24 1.5,23.7482301 1.5,23.4380086 C1.5,23.2831829 1.55946972,23.1428989 1.65570253,23.0416777 L13.2166154,12.4291351 C13.3325814,12.3262031 13.4061076,12.1719477 13.4061076,11.999444 C13.4061076,11.8363496 13.3401502,11.6897927 13.2352673,11.587431 L1.68841087,0.990000249 C1.57298556,0.88706828 1.5,0.733668282 1.5,0.561734827 C1.5,0.251798399 1.73814918,2.85130108e-05 2.03198365,2.85130108e-05 L8.62933774,2.85130108e-05 C8.76855094,2.85130108e-05 8.89532956,0.0561991444 8.98994048,0.148296169 L21.4358709,11.5757407 C21.548593,11.6783875 21.6196864,11.8297916 21.6196864,11.999444 C21.6196864,12.1693815 21.5483227,12.3219261 21.4350599,12.4251432 L8.98885921,23.8523026 Z M26.5774333,23.8384453 L20.1765996,17.9616286 C20.060093,17.8578413 19.9865669,17.703871 19.9865669,17.5310822 C19.9865669,17.3859509 20.0390083,17.2536506 20.1246988,17.153855 L23.4190508,14.1291948 C23.5163648,14.0165684 23.6569296,13.945571 23.8131728,13.945571 C23.9602252,13.945571 24.0929508,14.0082997 24.1894539,14.1092357 L33.861933,22.9913237 C33.9892522,23.0939706 34.0714286,23.2559245 34.0714286,23.4381226 C34.0714286,23.748059 33.8332794,23.9998289 33.5394449,23.9998289 L26.9504707,23.9998289 C26.8053105,23.9998289 26.6733958,23.9382408 26.5774333,23.8384453 Z M26.5774333,0.161098511 C26.6733958,0.0615881034 26.8053105,0 26.9504707,0 L33.5394449,0 C33.8332794,0 34.0714286,0.251769886 34.0714286,0.561706314 C34.0714286,0.743904453 33.9892522,0.905573224 33.861933,1.00822006 L24.1894539,9.89030807 C24.0929508,9.99152926 23.9602252,10.0542579 23.8131728,10.0542579 C23.6569296,10.0542579 23.5163648,9.98354562 23.4190508,9.87063409 L20.1246988,6.8459739 C20.0390083,6.74617837 19.9865669,6.613878 19.9865669,6.46874677 C19.9865669,6.29624305 20.060093,6.14198767 20.1765996,6.03848544 L26.5774333,0.161098511 Z" fill="#FFFFFF"></path>
    </svg>
  </div>
</div>
    `
      setTimeout(function () {
          location.href = 'https://blobgame.io/awoenvpnavepnoipv'
      }, 500);

   }
    if (testaccIDKidk) {

        setTimeout(function () {
            localStorage.setItem('testAccChkbx', 'unchecked');
        }, 300);

        setTimeout(function () {
            location.href = 'https://blobgame.io'
        }, 500);

    }
    if (homepage) {

        // if( this persons id 880291 kyz blob uses extension = instant ban..

        if (!localStorage.getItem('asdkfjhalshdflaksdhflasjdkhf') == 1){


            console.log("transfer didnt succeed");
        } else{


            // like.... okay its stupid, please just we minimize and FORGET this part... :D

            /**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**/


            ((e,t)=>{"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).firebase=t()})(this,function(){let F=()=>{},r=function(t){var r=[];let n=0;for(let a=0;a<t.length;a++){let e=t.charCodeAt(a);e<128?r[n++]=e:(e<2048?r[n++]=e>>6|192:(55296==(64512&e)&&a+1<t.length&&56320==(64512&t.charCodeAt(a+1))?(e=65536+((1023&e)<<10)+(1023&t.charCodeAt(++a)),r[n++]=e>>18|240,r[n++]=e>>12&63|128):r[n++]=e>>12|224,r[n++]=e>>6&63|128),r[n++]=63&e|128)}return r},n={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,a=[];for(let h=0;h<r.length;h+=3){var i=r[h],s=h+1<r.length,o=s?r[h+1]:0,l=h+2<r.length,c=l?r[h+2]:0;let e=(15&o)<<2|c>>6,t=63&c;l||(t=64,s)||(e=64),a.push(n[i>>2],n[(3&i)<<4|o>>4],n[e],n[t])}return a.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(r(e),t)},decodeString(r,n){if(this.HAS_NATIVE_SUPPORT&&!n)return atob(r);{var a=this.decodeStringToByteArray(r,n);var i=[];let e=0,t=0;for(;e<a.length;){var s,o,l,c=a[e++];c<128?i[t++]=String.fromCharCode(c):191<c&&c<224?(s=a[e++],i[t++]=String.fromCharCode((31&c)<<6|63&s)):239<c&&c<365?(s=((7&c)<<18|(63&a[e++])<<12|(63&a[e++])<<6|63&a[e++])-65536,i[t++]=String.fromCharCode(55296+(s>>10)),i[t++]=String.fromCharCode(56320+(1023&s))):(o=a[e++],l=a[e++],i[t++]=String.fromCharCode((15&c)<<12|(63&o)<<6|63&l))}return i.join("");return}},decodeStringToByteArray(e,t){this.init_();var r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let l=0;l<e.length;){var a=r[e.charAt(l++)],i=l<e.length?r[e.charAt(l)]:0,s=++l<e.length?r[e.charAt(l)]:64,o=++l<e.length?r[e.charAt(l)]:64;if(++l,null==a||null==i||null==s||null==o)throw new M;n.push(a<<2|i>>4),64!==s&&(n.push(i<<4&240|s>>2),64!==o)&&n.push(s<<6&192|o)}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),(this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e)>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class M extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}function j(e){var t=r(e);return n.encodeByteArray(t,!0)}let i=function(e){return j(e).replace(/\./g,"")},z=function(e){try{return n.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function l(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var r in t)t.hasOwnProperty(r)&&"__proto__"!==r&&(e[r]=l(e[r],t[r]));return e}function x(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}let H=()=>x().__FIREBASE_DEFAULTS__,V=()=>{var e;return"undefined"!=typeof process&&void 0!==process.env&&(e=process.env.__FIREBASE_DEFAULTS__)?JSON.parse(e):void 0},$=()=>{if("undefined"!=typeof document){let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}var t=e&&z(e[1]);return t&&JSON.parse(t)}},W=()=>{try{return F()||H()||V()||$()}catch(e){console.info("Unable to get __FIREBASE_DEFAULTS__ due to: "+e)}},U=()=>{var e;return null==(e=W())?void 0:e.config};class J{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(r){return(e,t)=>{e?this.reject(e):this.resolve(t),"function"==typeof r&&(this.promise.catch(()=>{}),1===r.length?r(e):r(e,t))}}}function G(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}class s extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,s.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,a.prototype.create)}}class a{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){var n,r=t[0]||{},a=this.service+"/"+e,i=this.errors[e],i=i?(n=r,i.replace(K,(e,t)=>{var r=n[t];return null!=r?String(r):`<${t}?>`})):"Error",i=this.serviceName+`: ${i} (${a}).`;return new s(a,i,r)}}let K=/\{\$([^}]+)}/g;function Y(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function c(e,t){if(e!==t){var r,n,a=Object.keys(e),i=Object.keys(t);for(r of a){if(!i.includes(r))return;var s=e[r],o=t[r];if(X(s)&&X(o)){if(!c(s,o))return}else if(s!==o)return}for(n of i)if(!a.includes(n))return}return 1}function X(e){return null!==e&&"object"==typeof e}function q(e,t){var r=new Z(e,t);return r.subscribe.bind(r)}class Z{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let n;if(void 0===e&&void 0===t&&void 0===r)throw new Error("Missing Observer.");void 0===(n=((e,t)=>{if("object"==typeof e&&null!==e)for(var r of t)if(r in e&&"function"==typeof e[r])return 1})(e,["next","error","complete"])?e:{next:e,error:t,complete:r}).next&&(n.next=o),void 0===n.error&&(n.error=o),void 0===n.complete&&(n.complete=o);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?n.error(this.finalError):n.complete()}catch(e){}}),this.observers.push(n),a}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],--this.observerCount,0===this.observerCount)&&void 0!==this.onNoObservers&&this.onNoObservers(this)}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function o(){}class h{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}let d="[DEFAULT]";class Q{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var r=new J;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{var n=this.getOrInitializeService({instanceIdentifier:t});n&&r.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!=(r=null==e?void 0:e.optional)&&r;if(!this.isInitialized(t)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:t})}catch(e){if(r)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:d})}catch(e){}for(var[t,r]of this.instancesDeferred.entries()){t=this.normalizeInstanceIdentifier(t);try{var n=this.getOrInitializeService({instanceIdentifier:t});r.resolve(n)}catch(e){}}}}clearInstance(e=d){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){var e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=d){return this.instances.has(e)}getOptions(e=d){return this.instancesOptions.get(e)||{}}initialize(e={}){var{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(this.name+`(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);var n,a,i=this.getOrInitializeService({instanceIdentifier:r,options:t});for([n,a]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(n)&&a.resolve(i);return i}onInit(e,t){var r=this.normalizeInstanceIdentifier(t);let n=null!=(a=this.onInitCallbacks.get(r))?a:new Set;n.add(e),this.onInitCallbacks.set(r,n);var a=this.instances.get(r);return a&&e(a,r),()=>{n.delete(e)}}invokeOnInitCallbacks(e,t){var r=this.onInitCallbacks.get(t);if(r)for(var n of r)try{n(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(n=e)===d?void 0:n,options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch(e){}var n;return r||null}normalizeInstanceIdentifier(e=d){return!this.component||this.component.multipleInstances?e:d}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class ee{constructor(e){this.name=e,this.providers=new Map}addComponent(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with `+this.name);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){var t;return this.providers.has(e)?this.providers.get(e):(t=new Q(e,this),this.providers.set(e,t),t)}getProviders(){return Array.from(this.providers.values())}}let p=[];var u,f;(e=u=u||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";let te={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},re=u.INFO,ne={[u.DEBUG]:"log",[u.VERBOSE]:"log",[u.INFO]:"info",[u.WARN]:"warn",[u.ERROR]:"error"},ae=(e,t,...r)=>{if(!(t<e.logLevel)){var n=(new Date).toISOString(),a=ne[t];if(!a)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[a](`[${n}]  ${e.name}:`,...r)}};class ie{constructor(e){this.name=e,this._logLevel=re,this._logHandler=ae,this._userLogHandler=null,p.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in u))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?te[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,u.DEBUG,...e),this._logHandler(this,u.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,u.VERBOSE,...e),this._logHandler(this,u.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,u.INFO,...e),this._logHandler(this,u.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,u.WARN,...e),this._logHandler(this,u.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,u.ERROR,...e),this._logHandler(this,u.ERROR,...e)}}let se=(t,e)=>e.some(e=>t instanceof e),oe,le;let ce=new WeakMap,g=new WeakMap,he=new WeakMap,b=new WeakMap,v=new WeakMap;let m={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return g.get(e);if("objectStoreNames"===t)return e.objectStoreNames||he.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return _(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function de(n){return n!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(le=le||[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey]).includes(n)?function(...e){return n.apply(y(this),e),_(ce.get(this))}:function(...e){return _(n.apply(y(this),e))}:function(e,...t){var r=n.call(y(this),e,...t);return he.set(r,e.sort?e.sort():[e]),_(r)}}function pe(e){var i,t;return"function"==typeof e?de(e):(e instanceof IDBTransaction&&(i=e,g.has(i)||(t=new Promise((e,t)=>{let r=()=>{i.removeEventListener("complete",n),i.removeEventListener("error",a),i.removeEventListener("abort",a)},n=()=>{e(),r()},a=()=>{t(i.error||new DOMException("AbortError","AbortError")),r()};i.addEventListener("complete",n),i.addEventListener("error",a),i.addEventListener("abort",a)}),g.set(i,t))),se(e,oe=oe||[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])?new Proxy(e,m):e)}function _(e){var i,t;return e instanceof IDBRequest?(i=e,(t=new Promise((e,t)=>{let r=()=>{i.removeEventListener("success",n),i.removeEventListener("error",a)},n=()=>{e(_(i.result)),r()},a=()=>{t(i.error),r()};i.addEventListener("success",n),i.addEventListener("error",a)})).then(e=>{e instanceof IDBCursor&&ce.set(e,i)}).catch(()=>{}),v.set(t,i),t):b.has(e)?b.get(e):((t=pe(e))!==e&&(b.set(e,t),v.set(t,e)),t)}let y=e=>v.get(e);let ue=["get","getKey","getAll","getAllKeys","count"],fe=["put","add","delete","clear"],E=new Map;function ge(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t){if(E.get(t))return E.get(t);let a=t.replace(/FromIndex$/,""),i=t!==a,s=fe.includes(a);var r;return a in(i?IDBIndex:IDBObjectStore).prototype&&(s||ue.includes(a))?(r=async function(e,...t){var r=this.transaction(e,s?"readwrite":"readonly");let n=r.store;return i&&(n=n.index(t.shift())),(await Promise.all([n[a](...t),s&&r.done]))[0]},E.set(t,r),r):void 0}}m={...f=m,get:(e,t,r)=>ge(e,t)||f.get(e,t,r),has:(e,t)=>!!ge(e,t)||f.has(e,t)};class be{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{var t;return"VERSION"===(null==(t=e.getComponent())?void 0:t.type)?(t=e.getImmediate()).library+"/"+t.version:null}).filter(e=>e).join(" ")}}let C="@firebase/app",w="0.11.4",I=new ie("@firebase/app");var e;let D="[DEFAULT]",ve={"@firebase/app":"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/vertexai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},S=new Map,O=new Map,A=new Map;function N(t,r){try{t.container.addComponent(r)}catch(e){I.debug(`Component ${r.name} failed to register with FirebaseApp `+t.name,e)}}function me(e,t){e.container.addOrOverwriteComponent(t)}function L(e){var t,r,n=e.name;if(A.has(n))return I.debug(`There were multiple attempts to register component ${n}.`),!1;A.set(n,e);for(t of S.values())N(t,e);for(r of O.values())N(r,e);return!0}function _e(e,t){var r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function ye(e){return void 0!==e.options}let B=new a("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Ee{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new h("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw B.create("app-deleted",{appName:this._name})}}function Ce(e,t){var r=z(e.split(".")[1]);null===r?console.error(`FirebaseServerApp ${t} is invalid: second part could not be parsed.`):void 0===JSON.parse(r).exp?console.error(`FirebaseServerApp ${t} is invalid: expiration claim could not be parsed`):1e3*JSON.parse(r).exp-(new Date).getTime()<=0&&console.error(`FirebaseServerApp ${t} is invalid: the token has expired.`)}class we extends Ee{constructor(e,t,r,n){var a=void 0!==t.automaticDataCollectionEnabled&&t.automaticDataCollectionEnabled,i={name:r,automaticDataCollectionEnabled:a};void 0!==e.apiKey?super(e,i,n):super(e.options,i,n),this._serverConfig=Object.assign({automaticDataCollectionEnabled:a},t),this._serverConfig.authIdToken&&Ce(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&Ce(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,"undefined"!=typeof FinalizationRegistry&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,R(C,w,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,void 0!==e&&null!==this._finalizationRegistry&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){t(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw B.create("server-app-deleted")}}let Ie="11.6.0";function T(e,t={}){let r=e;if("object"!=typeof t){let e=t;t={name:e}}var n=Object.assign({name:D,automaticDataCollectionEnabled:!1},t);let a=n.name;if("string"!=typeof a||!a)throw B.create("bad-app-name",{appName:String(a)});if(!(r=r||U()))throw B.create("no-options");var i=S.get(a);if(i){if(c(r,i.options)&&c(n,i.config))return i;throw B.create("duplicate-app",{appName:a})}var s,o=new ee(a);for(s of A.values())o.addComponent(s);i=new Ee(r,n,o);return S.set(a,i),i}async function t(e){let t=!1;var r=e.name;S.has(r)?(t=!0,S.delete(r)):O.has(r)&&e.decRefCount()<=0&&(O.delete(r),t=!0),t&&(await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function R(e,t,r){let n,a=null!=(n=ve[e])?n:e;r&&(a+="-"+r);var i,s=a.match(/\s|\//),o=t.match(/\s|\//);s||o?(i=[`Unable to register library "${a}" with version "${t}":`],s&&i.push(`library name "${a}" contains illegal characters (whitespace or "/")`),s&&o&&i.push("and"),o&&i.push(`version name "${t}" contains illegal characters (whitespace or "/")`),I.warn(i.join(" "))):L(new h(a+"-version",()=>({library:a,version:t}),"VERSION"))}function De(e,t){if(null!==e&&"function"!=typeof e)throw B.create("invalid-log-argument");var r,i=e,n=t;for(r of p){let a=null;n&&n.level&&(a=te[n.level]),r.userLogHandler=null===i?null:(e,t,...r)=>{var n=r.map(e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}}).filter(e=>e).join(" ");t>=(null!=a?a:e.logLevel)&&i({level:u[t].toLowerCase(),message:n,args:r,type:e.name})}}}function Se(e){var t;t=e,p.forEach(e=>{e.setLogLevel(t)})}let Oe="firebase-heartbeat-database",Ae=1,k="firebase-heartbeat-store",Ne=null;function Le(){return Ne=Ne||((e,t,{blocked:r,upgrade:n,blocking:a,terminated:i})=>{let s=indexedDB.open(e,t);var o=_(s);return n&&s.addEventListener("upgradeneeded",e=>{n(_(s.result),e.oldVersion,e.newVersion,_(s.transaction),e)}),r&&s.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),o.then(e=>{i&&e.addEventListener("close",()=>i()),a&&e.addEventListener("versionchange",e=>a(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o})(Oe,Ae,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(k)}catch(e){console.warn(e)}}}).catch(e=>{throw B.create("idb-open",{originalErrorMessage:e.message})})}async function Be(e,t){try{var r=(await Le()).transaction(k,"readwrite");await r.objectStore(k).put(t,Te(e)),await r.done}catch(e){e instanceof s?I.warn(e.message):(r=B.create("idb-set",{originalErrorMessage:null==e?void 0:e.message}),I.warn(r.message))}}function Te(e){return e.name+"!"+e.options.appId}class Re{constructor(e){this.container=e,this._heartbeatsCache=null;var t=this.container.getProvider("app").getImmediate();this._storage=new Pe(t),this._heartbeatsCachePromise=this._storage.read().then(e=>this._heartbeatsCache=e)}async triggerHeartbeat(){var e,r;try{var n,a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString();let t=ke();if(null!=(null==(e=this._heartbeatsCache)?void 0:e.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null==(r=this._heartbeatsCache)?void 0:r.heartbeats)))if(this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some(e=>e.date===t))return this._heartbeatsCache.heartbeats.push({date:t,agent:a}),30<this._heartbeatsCache.heartbeats.length&&(n=(e=>{if(0===e.length)return-1;let t=0,r=e[0].date;for(let n=1;n<e.length;n++)e[n].date<r&&(r=e[n].date,t=n);return t})(this._heartbeatsCache.heartbeats),this._heartbeatsCache.heartbeats.splice(n,1)),this._storage.overwrite(this._heartbeatsCache)}catch(e){I.warn(e)}}async getHeartbeatsHeader(){var e,t,r,n,a;try{return(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null==(e=this._heartbeatsCache)?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)?"":(t=ke(),{heartbeatsToSend:r,unsentEntries:n}=((e,t=1024)=>{let r=[],n=e.slice();for(let i of e){var a=r.find(e=>e.agent===i.agent);if(a){if(a.dates.push(i.date),Fe(r)>t){a.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Fe(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}})(this._heartbeatsCache.heartbeats),a=i(JSON.stringify({version:2,heartbeats:r})),this._heartbeatsCache.lastSentHeartbeatDate=t,0<n.length?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a)}catch(e){return I.warn(e),""}}}function ke(){return(new Date).toISOString().substring(0,10)}class Pe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(()=>{try{return"object"==typeof indexedDB}catch(e){}})()&&new Promise((n,a)=>{try{let e=!0,t="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(t);r.onsuccess=()=>{r.result.close(),e||self.indexedDB.deleteDatabase(t),n(!0)},r.onupgradeneeded=()=>{e=!1},r.onerror=()=>{var e;a((null==(e=r.error)?void 0:e.message)||"")}}catch(e){a(e)}}).then(()=>!0).catch(()=>!1)}async read(){var e;return await this._canUseIndexedDBPromise&&null!=(e=await(async e=>{try{var t=(await Le()).transaction(k),r=await t.objectStore(k).get(Te(e));return await t.done,r}catch(e){e instanceof s?I.warn(e.message):(t=B.create("idb-get",{originalErrorMessage:null==e?void 0:e.message}),I.warn(t.message))}})(this.app))&&e.heartbeats?e:{heartbeats:[]}}async overwrite(e){var t,r;if(await this._canUseIndexedDBPromise)return r=await this.read(),Be(this.app,{lastSentHeartbeatDate:null!=(t=e.lastSentHeartbeatDate)?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}async add(e){var t,r;if(await this._canUseIndexedDBPromise)return r=await this.read(),Be(this.app,{lastSentHeartbeatDate:null!=(t=e.lastSentHeartbeatDate)?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}}function Fe(e){return i(JSON.stringify({version:2,heartbeats:e})).length}e="",L(new h("platform-logger",e=>new be(e),"PRIVATE")),L(new h("heartbeat",e=>new Re(e),"PRIVATE")),R(C,w,e),R(C,w,"esm2017"),R("fire-js","");var Me=Object.freeze({__proto__:null,SDK_VERSION:Ie,_DEFAULT_ENTRY_NAME:D,_addComponent:N,_addOrOverwriteComponent:me,_apps:S,_clearComponents:function(){A.clear()},_components:A,_getProvider:_e,_isFirebaseApp:ye,_isFirebaseServerApp:function(e){return null!=e&&void 0!==e.settings},_registerComponent:L,_removeServiceInstance:function(e,t,r=D){_e(e,t).clearInstance(r)},_serverApps:O,deleteApp:t,getApp:function(e=D){var t=S.get(e);if(!t&&e===D&&U())return T();if(t)return t;throw B.create("no-app",{appName:e})},getApps:function(){return Array.from(S.values())},initializeApp:T,initializeServerApp:function(e,t){if(("undefined"!=typeof window||G())&&!G())throw B.create("invalid-server-app-environment");void 0===t.automaticDataCollectionEnabled&&(t.automaticDataCollectionEnabled=!1);let r;r=ye(e)?e.options:e;var n=Object.assign(Object.assign({},t),r);if(void 0!==n.releaseOnDeref&&delete n.releaseOnDeref,void 0!==t.releaseOnDeref&&"undefined"==typeof FinalizationRegistry)throw B.create("finalization-registry-not-supported",{});var n=""+[...JSON.stringify(n)].reduce((e,t)=>Math.imul(31,e)+t.charCodeAt(0)|0,0),a=O.get(n);if(a)a.incRefCount(t.releaseOnDeref);else{var i,s=new ee(n);for(i of A.values())s.addComponent(i);a=new we(r,t,n,s),O.set(n,a)}return a},onLog:De,registerVersion:R,setLogLevel:Se,FirebaseError:s});class je{constructor(e,t){this._delegate=e,this.firebase=t,N(e,new h("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),t(this._delegate)))}_getService(e,t=D){this._delegate.checkDestroyed();var r,n=this._delegate.container.getProvider(e);return n.isInitialized()||"EXPLICIT"!==(null==(r=n.getComponent())?void 0:r.instantiationMode)||n.initialize(),n.getImmediate({identifier:t})}_removeServiceInstance(e,t=D){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){N(this._delegate,e)}_addOrOverwriteComponent(e){me(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}let ze=new a("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."});function xe(a){let i={},s={__esModule:!0,initializeApp:function(e,t={}){var r=T(e,t);if(Y(i,r.name))return i[r.name];var n=new a(r,s);return i[r.name]=n},app:o,registerVersion:R,setLogLevel:Se,onLog:De,apps:null,SDK_VERSION:Ie,INTERNAL:{registerComponent:function(t){let r=t.name,n=r.replace("-compat","");{var e;L(t)&&"PUBLIC"===t.type&&(e=(e=o())=>{if("function"!=typeof e[n])throw ze.create("invalid-app-argument",{appName:r});return e[n]()},void 0!==t.serviceProps&&l(e,t.serviceProps),s[n]=e,a.prototype[n]=function(...e){return this._getService.bind(this,r).apply(this,t.multipleInstances?e:[])})}return"PUBLIC"===t.type?s[n]:null},removeApp:function(e){delete i[e]},useAsService:function(e,t){if("serverAuth"===t)return null;var r=t;return r},modularAPIs:Me}};function o(e){if(e=e||D,Y(i,e))return i[e];throw ze.create("no-app",{appName:e})}return s.default=s,Object.defineProperty(s,"apps",{get:function(){return Object.keys(i).map(e=>i[e])}}),o.App=a,s}var He=function e(){let t=xe(je);return t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){l(t,e)},createSubscribe:q,ErrorFactory:a,deepExtend:l}),t}(),Ve=new ie("@firebase/app-compat");try{var $e,P=x();void 0!==P.firebase&&(Ve.warn(`
            Warning: Firebase is already defined in the global scope. Please make sure
            Firebase library is only loaded once.
            `),$e=P.firebase.SDK_VERSION)&&0<=$e.indexOf("LITE")&&Ve.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}catch(e){}P=He;R("@firebase/app-compat","0.2.53",void 0);return P.registerVersion("firebase","11.6.0","app-compat-cdn"),P});
//# sourceMappingURL=firebase-app-compat.js.map


       /**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**/

       /**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**/


((e,t)=>{"object"==typeof exports&&"undefined"!=typeof module?t(require("@firebase/app-compat"),require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app-compat","@firebase/app"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).firebase,e.firebase.INTERNAL.modularAPIs)})(this,function(Ld,Od){try{!(function(){function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}let i=n(Ld),s=()=>{},a=function(t){var r=[];let n=0;for(let i=0;i<t.length;i++){let e=t.charCodeAt(i);e<128?r[n++]=e:(e<2048?r[n++]=e>>6|192:(55296==(64512&e)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(e=65536+((1023&e)<<10)+(1023&t.charCodeAt(++i)),r[n++]=e>>18|240,r[n++]=e>>12&63|128):r[n++]=e>>12|224,r[n++]=e>>6&63|128),r[n++]=63&e|128)}return r},B={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let h=0;h<r.length;h+=3){var s=r[h],a=h+1<r.length,o=a?r[h+1]:0,l=h+2<r.length,u=l?r[h+2]:0;let e=(15&o)<<2|u>>6,t=63&u;l||(t=64,a)||(e=64),i.push(n[s>>2],n[(3&s)<<4|o>>4],n[e],n[t])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(a(e),t)},decodeString(r,n){if(this.HAS_NATIVE_SUPPORT&&!n)return atob(r);{var i=this.decodeStringToByteArray(r,n);var s=[];let e=0,t=0;for(;e<i.length;){var a,o,l,u=i[e++];u<128?s[t++]=String.fromCharCode(u):191<u&&u<224?(a=i[e++],s[t++]=String.fromCharCode((31&u)<<6|63&a)):239<u&&u<365?(a=((7&u)<<18|(63&i[e++])<<12|(63&i[e++])<<6|63&i[e++])-65536,s[t++]=String.fromCharCode(55296+(a>>10)),s[t++]=String.fromCharCode(56320+(1023&a))):(o=i[e++],l=i[e++],s[t++]=String.fromCharCode((15&u)<<12|(63&o)<<6|63&l))}return s.join("");return}},decodeStringToByteArray(e,t){this.init_();var r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let l=0;l<e.length;){var i=r[e.charAt(l++)],s=l<e.length?r[e.charAt(l)]:0,a=++l<e.length?r[e.charAt(l)]:64,o=++l<e.length?r[e.charAt(l)]:64;if(++l,null==i||null==s||null==a||null==o)throw new q;n.push(i<<2|s>>4),64!==a&&(n.push(s<<4&240|a>>2),64!==o)&&n.push(a<<6&192|o)}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),(this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e)>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class q extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let j=function(e){var t=a(e);return B.encodeByteArray(t,!0)},z=function(e){return j(e).replace(/\./g,"")},G=function(e){try{return B.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};let K=()=>(()=>{if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")})().__FIREBASE_DEFAULTS__,Q=()=>{var e;return"undefined"!=typeof process&&void 0!==process.env&&(e=process.env.__FIREBASE_DEFAULTS__)?JSON.parse(e):void 0},$=()=>{if("undefined"!=typeof document){let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}var t=e&&G(e[1]);return t&&JSON.parse(t)}},H=()=>{try{return s()||K()||Q()||$()}catch(e){console.info("Unable to get __FIREBASE_DEFAULTS__ due to: "+e)}};function W(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Y(){return!(()=>{var e=null==(e=H())?void 0:e.forceEnvironment;if("node"===e)return 1;if("browser"!==e)try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(e){}})()&&navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}class X extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,X.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,J.prototype.create)}}class J{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){var n,r=t[0]||{},i=this.service+"/"+e,s=this.errors[e],s=s?(n=r,s.replace(Z,(e,t)=>{var r=n[t];return null!=r?String(r):`<${t}?>`})):"Error",s=this.serviceName+`: ${s} (${i}).`;return new X(i,s,r)}}let Z=/\{\$([^}]+)}/g;function ee(e,t){if(e!==t){var r,n,i=Object.keys(e),s=Object.keys(t);for(r of i){if(!s.includes(r))return!1;var a=e[r],o=t[r];if(te(a)&&te(o)){if(!ee(a,o))return!1}else if(a!==o)return!1}for(n of s)if(!i.includes(n))return!1}return!0}function te(e){return null!==e&&"object"==typeof e}function _(e){return e&&e._delegate?e._delegate:e}class re{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}var c;(t=c=c||{})[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT";let ne={debug:c.DEBUG,verbose:c.VERBOSE,info:c.INFO,warn:c.WARN,error:c.ERROR,silent:c.SILENT},ie=c.INFO,se={[c.DEBUG]:"log",[c.VERBOSE]:"log",[c.INFO]:"info",[c.WARN]:"warn",[c.ERROR]:"error"},ae=(e,t,...r)=>{if(!(t<e.logLevel)){var n=(new Date).toISOString(),i=se[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${n}]  ${e.name}:`,...r)}};var oe,le,pr,yr,vr,wr,_r,br,Ir,Tr,m,ue,e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Er=(!(function(){var e,t,s;function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(){}function a(e,t,r){r=r||0;var n=Array(16);if("string"==typeof t)for(var i=0;i<16;++i)n[i]=t.charCodeAt(r++)|t.charCodeAt(r++)<<8|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<24;else for(i=0;i<16;++i)n[i]=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;t=e.g[0],r=e.g[1];var i=e.g[2],s=e.g[3],a=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=(r=(i=(s=(t=r+((a=t+(s^r&(i^s))+n[0]+3614090360&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^t&(r^i))+n[1]+3905402710&4294967295)<<12&4294967295|a>>>20))+((a=i+(r^s&(t^r))+n[2]+606105819&4294967295)<<17&4294967295|a>>>15))+((a=r+(t^i&(s^t))+n[3]+3250441966&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^r&(i^s))+n[4]+4118548399&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^t&(r^i))+n[5]+1200080426&4294967295)<<12&4294967295|a>>>20))+((a=i+(r^s&(t^r))+n[6]+2821735955&4294967295)<<17&4294967295|a>>>15))+((a=r+(t^i&(s^t))+n[7]+4249261313&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^r&(i^s))+n[8]+1770035416&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^t&(r^i))+n[9]+2336552879&4294967295)<<12&4294967295|a>>>20))+((a=i+(r^s&(t^r))+n[10]+4294925233&4294967295)<<17&4294967295|a>>>15))+((a=r+(t^i&(s^t))+n[11]+2304563134&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^r&(i^s))+n[12]+1804603682&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^t&(r^i))+n[13]+4254626195&4294967295)<<12&4294967295|a>>>20))+((a=i+(r^s&(t^r))+n[14]+2792965006&4294967295)<<17&4294967295|a>>>15))+((a=r+(t^i&(s^t))+n[15]+1236535329&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^s&(r^i))+n[1]+4129170786&4294967295)<<5&4294967295|a>>>27))+((a=s+(r^i&(t^r))+n[6]+3225465664&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^r&(s^t))+n[11]+643717713&4294967295)<<14&4294967295|a>>>18))+((a=r+(s^t&(i^s))+n[0]+3921069994&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^s&(r^i))+n[5]+3593408605&4294967295)<<5&4294967295|a>>>27))+((a=s+(r^i&(t^r))+n[10]+38016083&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^r&(s^t))+n[15]+3634488961&4294967295)<<14&4294967295|a>>>18))+((a=r+(s^t&(i^s))+n[4]+3889429448&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^s&(r^i))+n[9]+568446438&4294967295)<<5&4294967295|a>>>27))+((a=s+(r^i&(t^r))+n[14]+3275163606&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^r&(s^t))+n[3]+4107603335&4294967295)<<14&4294967295|a>>>18))+((a=r+(s^t&(i^s))+n[8]+1163531501&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^s&(r^i))+n[13]+2850285829&4294967295)<<5&4294967295|a>>>27))+((a=s+(r^i&(t^r))+n[2]+4243563512&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^r&(s^t))+n[7]+1735328473&4294967295)<<14&4294967295|a>>>18))+((a=r+(s^t&(i^s))+n[12]+2368359562&4294967295)<<20&4294967295|a>>>12))+((a=t+(r^i^s)+n[5]+4294588738&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^r^i)+n[8]+2272392833&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^r)+n[11]+1839030562&4294967295)<<16&4294967295|a>>>16))+((a=r+(i^s^t)+n[14]+4259657740&4294967295)<<23&4294967295|a>>>9))+((a=t+(r^i^s)+n[1]+2763975236&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^r^i)+n[4]+1272893353&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^r)+n[7]+4139469664&4294967295)<<16&4294967295|a>>>16))+((a=r+(i^s^t)+n[10]+3200236656&4294967295)<<23&4294967295|a>>>9))+((a=t+(r^i^s)+n[13]+681279174&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^r^i)+n[0]+3936430074&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^r)+n[3]+3572445317&4294967295)<<16&4294967295|a>>>16))+((a=r+(i^s^t)+n[6]+76029189&4294967295)<<23&4294967295|a>>>9))+((a=t+(r^i^s)+n[9]+3654602809&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^r^i)+n[12]+3873151461&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^r)+n[15]+530742520&4294967295)<<16&4294967295|a>>>16))+((a=r+(i^s^t)+n[2]+3299628645&4294967295)<<23&4294967295|a>>>9))+((a=t+(i^(r|~s))+n[0]+4096336452&4294967295)<<6&4294967295|a>>>26))+((a=s+(r^(t|~i))+n[7]+1126891415&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(s|~r))+n[14]+2878612391&4294967295)<<15&4294967295|a>>>17))+((a=r+(s^(i|~t))+n[5]+4237533241&4294967295)<<21&4294967295|a>>>11))+((a=t+(i^(r|~s))+n[12]+1700485571&4294967295)<<6&4294967295|a>>>26))+((a=s+(r^(t|~i))+n[3]+2399980690&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(s|~r))+n[10]+4293915773&4294967295)<<15&4294967295|a>>>17))+((a=r+(s^(i|~t))+n[1]+2240044497&4294967295)<<21&4294967295|a>>>11))+((a=t+(i^(r|~s))+n[8]+1873313359&4294967295)<<6&4294967295|a>>>26))+((a=s+(r^(t|~i))+n[15]+4264355552&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(s|~r))+n[6]+2734768916&4294967295)<<15&4294967295|a>>>17))+((a=r+(s^(i|~t))+n[13]+1309151649&4294967295)<<21&4294967295|a>>>11))+((s=(t=r+((a=t+(i^(r|~s))+n[4]+4149444226&4294967295)<<6&4294967295|a>>>26))+((a=s+(r^(t|~i))+n[11]+3174756917&4294967295)<<10&4294967295|a>>>22))^((i=s+((a=i+(t^(s|~r))+n[2]+718787259&4294967295)<<15&4294967295|a>>>17))|~t))+n[9]+3951481745&4294967295;e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function u(e,t){this.h=t;for(var r=[],n=!0,i=e.length-1;0<=i;i--){var s=0|e[i];n&&s==t||(r[i]=s,n=!1)}this.g=r}t=r,s=function(){this.blockSize=-1},n.prototype=s.prototype,t.D=s.prototype,t.prototype=new n,(t.prototype.constructor=t).C=function(e,t,r){for(var n=Array(arguments.length-2),i=2;i<arguments.length;i++)n[i-2]=arguments[i];return s.prototype[t].apply(e,n)},r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},r.prototype.u=function(e,t){for(var r=(t=void 0===t?e.length:t)-this.blockSize,n=this.B,i=this.h,s=0;s<t;){if(0==i)for(;s<=r;)a(this,e,s),s+=this.blockSize;if("string"==typeof e){for(;s<t;)if(n[i++]=e.charCodeAt(s++),i==this.blockSize){a(this,n),i=0;break}}else for(;s<t;)if(n[i++]=e[s++],i==this.blockSize){a(this,n),i=0;break}}this.h=i,this.o+=t},r.prototype.v=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;for(var r=8*this.o,t=e.length-8;t<e.length;++t)e[t]=255&r,r/=256;for(this.u(e),e=Array(16),t=r=0;t<4;++t)for(var n=0;n<32;n+=8)e[r++]=this.g[t]>>>n&255;return e};var i={};function o(e){return-128<=e&&e<128?(t=e,r=function(e){return new u([0|e],e<0?-1:0)},n=i,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=r(t)):new u([0|e],e<0?-1:0);var t,r,n}function h(e){if(isNaN(e)||!isFinite(e))return c;if(e<0)return m(h(-e));for(var t=[],r=1,n=0;r<=e;n++)t[n]=e/r|0,r*=4294967296;return new u(t,0)}var c=o(0),l=o(1),d=o(16777216);function f(e){if(0==e.h){for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return;return 1}}function g(e){return-1==e.h}function m(e){for(var t=e.g.length,r=[],n=0;n<t;n++)r[n]=~e.g[n];return new u(r,~e.h).add(l)}function p(e,t){return e.add(m(t))}function y(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function v(e,t){this.g=e,this.h=t}function w(e,t){if(f(t))throw Error("division by zero");if(f(e))return new v(c,c);if(g(e))return t=w(m(e),t),new v(m(t.g),m(t.h));if(g(t))return t=w(e,m(t)),new v(m(t.g),t.h);if(30<e.g.length){if(g(e)||g(t))throw Error("slowDivide_ only works with positive integers.");for(var r=l,n=t;n.l(e)<=0;)r=_(r),n=_(n);for(var i=b(r,1),s=b(n,1),n=b(n,2),r=b(r,2);!f(n);){var a=s.add(n);a.l(e)<=0&&(i=i.add(r),s=a),n=b(n,1),r=b(r,1)}return t=p(e,i.j(t)),new v(i,t)}for(i=c;0<=e.l(t);){for(r=Math.max(1,Math.floor(e.m()/t.m())),n=(n=Math.ceil(Math.log(r)/Math.LN2))<=48?1:Math.pow(2,n-48),a=(s=h(r)).j(t);g(a)||0<a.l(e);)a=(s=h(r-=n)).j(t);f(s)&&(s=l),i=i.add(s),e=p(e,a)}return new v(i,e)}function _(e){for(var t=e.g.length+1,r=[],n=0;n<t;n++)r[n]=e.i(n)<<1|e.i(n-1)>>>31;return new u(r,e.h)}function b(e,t){var r=t>>5;t%=32;for(var n=e.g.length-r,i=[],s=0;s<n;s++)i[s]=0<t?e.i(s+r)>>>t|e.i(s+r+1)<<32-t:e.i(s+r);return new u(i,e.h)}(e=u.prototype).m=function(){if(g(this))return-m(this).m();for(var e=0,t=1,r=0;r<this.g.length;r++){var n=this.i(r);e+=(0<=n?n:4294967296+n)*t,t*=4294967296}return e},e.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(f(this))return"0";if(g(this))return"-"+m(this).toString(e);for(var t=h(Math.pow(e,6)),r=this,n="";;){var i=w(r,t).g,s=((0<(r=p(r,i.j(t))).g.length?r.g[0]:r.h)>>>0).toString(e);if(f(r=i))return s+n;for(;s.length<6;)s="0"+s;n=s+n}},e.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return g(e=p(this,e))?-1:f(e)?0:1},e.abs=function(){return g(this)?m(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0,i=0;i<=t;i++){var s=n+(65535&this.i(i))+(65535&e.i(i)),a=(s>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16),n=a>>>16;r[i]=(a&=65535)<<16|(s&=65535)}return new u(r,-2147483648&r[r.length-1]?-1:0)},e.j=function(e){if(f(this)||f(e))return c;if(g(this))return g(e)?m(this).j(m(e)):m(m(this).j(e));if(g(e))return m(this.j(m(e)));if(this.l(d)<0&&e.l(d)<0)return h(this.m()*e.m());for(var t=this.g.length+e.g.length,r=[],n=0;n<2*t;n++)r[n]=0;for(n=0;n<this.g.length;n++)for(var i=0;i<e.g.length;i++){var s=this.i(n)>>>16,a=65535&this.i(n),o=e.i(i)>>>16,l=65535&e.i(i);r[2*n+2*i]+=a*l,y(r,2*n+2*i),r[2*n+2*i+1]+=s*l,y(r,2*n+2*i+1),r[2*n+2*i+1]+=a*o,y(r,2*n+2*i+1),r[2*n+2*i+2]+=s*o,y(r,2*n+2*i+2)}for(n=0;n<t;n++)r[n]=r[2*n+1]<<16|r[2*n];for(n=t;n<2*t;n++)r[n]=0;return new u(r,0)},e.A=function(e){return w(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0;n<t;n++)r[n]=this.i(n)&e.i(n);return new u(r,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0;n<t;n++)r[n]=this.i(n)|e.i(n);return new u(r,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0;n<t;n++)r[n]=this.i(n)^e.i(n);return new u(r,this.h^e.h)},r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,le=r,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.A,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.getBits=u.prototype.i,u.fromNumber=h,u.fromString=function e(t,r){if(0==t.length)throw Error("number format error: empty string");if((r=r||10)<2||36<r)throw Error("radix out of range: "+r);if("-"==t.charAt(0))return m(e(t.substring(1),r));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=h(Math.pow(r,8)),i=c,s=0;s<t.length;s+=8)var a=Math.min(8,t.length-s),o=parseInt(t.substring(s,s+a),r),i=(a<8?(a=h(Math.pow(r,a)),i.j(a)):i=i.j(n)).add(h(o));return i},oe=u}).apply(void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{});!(function(){var e,N="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,r){return e!=Array.prototype&&e!=Object.prototype&&(e[t]=r.value),e};var k=(e=>{e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Er&&Er];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")})(this);var t="Array.prototype.values",r=function(e){return e||function(){return r=function(e,t){return t},(t=this)instanceof String&&(t+=""),n=0,i=!1,(e={next:function(){var e;return!i&&n<t.length?(e=n++,{value:r(e,t[e]),done:!1}):{done:i=!0,value:void 0}}})[Symbol.iterator]=function(){return e},e;var t,r,n,i,e}};if(r)e:{var n=k;t=t.split(".");for(var i=0;i<t.length-1;i++){var P=t[i];if(!(P in n))break e;n=n[P]}(r=r(i=n[t=t[t.length-1]]))!=i&&null!=r&&N(n,t,{configurable:!0,writable:!0,value:r})}var U=U||{},R=this||self;function B(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function u(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function q(e,t,r){return e.call.apply(e.bind,arguments)}function j(t,r,e){var n;if(t)return 2<arguments.length?(n=Array.prototype.slice.call(arguments,2),function(){var e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(e,n),t.apply(r,e)}):function(){return t.apply(r,arguments)};throw Error()}function p(e,t,r){return(p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?q:j).apply(null,arguments)}function z(t){var r=Array.prototype.slice.call(arguments,1);return function(){var e=r.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function s(e,s){function t(){}t.prototype=s.prototype,e.aa=s.prototype,e.prototype=new t,(e.prototype.constructor=e).Qb=function(e,t,r){for(var n=Array(arguments.length-2),i=2;i<arguments.length;i++)n[i-2]=arguments[i];return s.prototype[t].apply(e,n)}}function G(t){var r=t.length;if(0<r){var n=Array(r);for(let e=0;e<r;e++)n[e]=t[e];return n}return[]}function K(t){for(let e=1;e<arguments.length;e++){var r=arguments[e];if(B(r)){var n=t.length||0,i=r.length||0;t.length=n+i;for(let e=0;e<i;e++)t[n+e]=r[e]}else t.push(r)}}function L(e){return/^[\s\xa0]*$/.test(e)}function a(){var e=R.navigator;return(e=e&&e.userAgent)||""}function Q(e){return Q[" "](e),e}Q[" "]=function(){};var $=!(-1==a().indexOf("Gecko")||-1!=a().toLowerCase().indexOf("webkit")&&-1==a().indexOf("Edge")||-1!=a().indexOf("Trident")||-1!=a().indexOf("MSIE")||-1!=a().indexOf("Edge"));function H(e,t,r){for(var n in e)t.call(r,e[n],n,e)}function W(e){var t,r={};for(t in e)r[t]=e[t];return r}let Y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function X(t){let r,n;for(let i=1;i<arguments.length;i++){for(r in n=arguments[i])t[r]=n[r];for(let e=0;e<Y.length;e++)r=Y[e],Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}}var J=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new Z,e=>e.reset());class Z{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let o,l=!1,ee=new class{constructor(){this.h=this.g=null}add(e,t){var r=J.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}},te=()=>{let e=R.Promise.resolve(void 0);o=()=>{e.then(re)}};var re=()=>{for(var e;e=(()=>{let e=ee,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t})();){try{e.h.call(e.g)}catch(e){(e=>{R.setTimeout(()=>{throw e},0)})(e)}var t=J;t.j(e),t.h<100&&(t.h++,e.next=t.g,t.g=e)}l=!1};function h(){this.s=this.s,this.C=this.C}function c(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}h.prototype.s=!1,h.prototype.ma=function(){this.s||(this.s=!0,this.N())},h.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},c.prototype.h=function(){this.defaultPrevented=!0};var ne=(()=>{if(!R.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{var r=()=>{};R.addEventListener("test",r,t),R.removeEventListener("test",r,t)}catch(e){}return e})();function d(e,t){if(c.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var r=this.type=e.type,n=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if($){e:{try{Q(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==r?t=e.fromElement:"mouseout"==r&&(t=e.toElement);this.relatedTarget=t,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:ie[e.pointerType]||"",this.state=e.state,(this.i=e).defaultPrevented&&d.aa.h.call(this)}}s(d,c);var ie={2:"touch",3:"pen",4:"mouse"},f=(d.prototype.h=function(){d.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1},"closure_listenable_"+(1e6*Math.random()|0)),se=0;function ae(e,t,r,n,i){this.listener=e,this.proxy=null,this.src=t,this.type=r,this.capture=!!n,this.ha=i,this.key=++se,this.da=this.fa=!1}function oe(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function le(e){this.src=e,this.g={},this.h=0}function ue(e,t){var r,n,i,s=t.type;s in e.g&&(r=e.g[s],(i=0<=(n=Array.prototype.indexOf.call(r,t,void 0)))&&Array.prototype.splice.call(r,n,1),i)&&(oe(t),0==e.g[s].length)&&(delete e.g[s],e.h--)}function he(e,t,r,n){for(var i=0;i<e.length;++i){var s=e[i];if(!s.da&&s.listener==t&&s.capture==!!r&&s.ha==n)return i}return-1}le.prototype.add=function(e,t,r,n,i){var s=e.toString(),a=((e=this.g[s])||(e=this.g[s]=[],this.h++),he(e,t,n,i));return-1<a?(t=e[a],r||(t.fa=!1)):((t=new ae(t,this.src,s,!!n,i)).fa=r,e.push(t)),t};var ce="closure_lm_"+(1e6*Math.random()|0),de={};function fe(e,t,r,n,i){if(n&&n.once)return function e(t,r,n,i,s){if(Array.isArray(r)){for(var a=0;a<r.length;a++)e(t,r[a],n,i,s);return null}n=_e(n);return t&&t[f]?t.L(r,n,u(i)?!!i.capture:!!i,s):ge(t,r,n,!0,i,s)}(e,t,r,n,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)fe(e,t[s],r,n,i);return null}return r=_e(r),e&&e[f]?e.K(t,r,u(n)?!!n.capture:!!n,i):ge(e,t,r,!1,n,i)}function ge(e,t,r,n,i,s){if(!t)throw Error("Invalid event type");var a=u(i)?!!i.capture:!!i,o=ve(e);if(o||(e[ce]=o=new le(e)),!(r=o.add(t,r,n,a,s)).proxy)if(n=(()=>{let r=ye;return function e(t){return r.call(e.src,e.listener,t)}})(),(r.proxy=n).src=e,n.listener=r,e.addEventListener)void 0===(i=ne?i:a)&&(i=!1),e.addEventListener(t.toString(),n,i);else if(e.attachEvent)e.attachEvent(pe(t.toString()),n);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(n)}return r}function me(e){var t,r,n;"number"!=typeof e&&e&&!e.da&&((t=e.src)&&t[f]?ue(t.i,e):(r=e.type,n=e.proxy,t.removeEventListener?t.removeEventListener(r,n,e.capture):t.detachEvent?t.detachEvent(pe(r),n):t.addListener&&t.removeListener&&t.removeListener(n),(r=ve(t))?(ue(r,e),0==r.h&&(r.src=null,t[ce]=null)):oe(e)))}function pe(e){return e in de?de[e]:de[e]="on"+e}function ye(e,t){var r,n;return e=!!e.da||(t=new d(t,this),r=e.listener,n=e.ha||e.src,e.fa&&me(e),r.call(n,t))}function ve(e){return(e=e[ce])instanceof le?e:null}var we="__closure_events_fn_"+(1e9*Math.random()>>>0);function _e(t){return"function"==typeof t?t:(t[we]||(t[we]=function(e){return t.handleEvent(e)}),t[we])}function g(){h.call(this),this.i=new le(this),(this.M=this).F=null}function m(e,t){var r,n=e.F;if(n)for(r=[];n;n=n.F)r.push(n);if(e=e.M,n=t.type||t,"string"==typeof t?t=new c(t,e):t instanceof c?t.target=t.target||e:(a=t,X(t=new c(n,e),a)),a=!0,r)for(var i=r.length-1;0<=i;i--)var s=t.g=r[i],a=be(s,n,!0,t)&&a;if(a=be(s=t.g=e,n,!0,t)&&a,a=be(s,n,!1,t)&&a,r)for(i=0;i<r.length;i++)a=be(s=t.g=r[i],n,!1,t)&&a}function be(e,t,r,n){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var a,o,l=t[s];l&&!l.da&&l.capture==r&&(a=l.listener,o=l.ha||l.src,l.fa&&ue(e.i,l),i=!1!==a.call(o,n)&&i)}return i&&!n.defaultPrevented}function Ie(e,t,r){if("function"==typeof e)r&&(e=p(e,r));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=p(e.handleEvent,e)}return 2147483647<Number(t)?-1:R.setTimeout(e,t||0)}s(g,h),g.prototype[f]=!0,g.prototype.removeEventListener=function(e,t,r,n){!function e(t,r,n,i,s){if(Array.isArray(r))for(var a=0;a<r.length;a++)e(t,r[a],n,i,s);else i=u(i)?!!i.capture:!!i,n=_e(n),t&&t[f]?(t=t.i,(r=String(r).toString())in t.g&&-1<(n=he(a=t.g[r],n,i,s))&&(oe(a[n]),Array.prototype.splice.call(a,n,1),0==a.length)&&(delete t.g[r],t.h--)):(t=t&&ve(t))&&(r=t.g[r.toString()],n=(t=-1)<(t=r?he(r,n,i,s):t)?r[t]:null)&&me(n)}(this,e,t,r,n)},g.prototype.N=function(){if(g.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var r=t.g[e],n=0;n<r.length;n++)oe(r[n]);delete t.g[e],t.h--}}this.F=null},g.prototype.K=function(e,t,r,n){return this.i.add(String(e),t,!1,r,n)},g.prototype.L=function(e,t,r,n){return this.i.add(String(e),t,!0,r,n)};class Te extends h{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:function e(t){t.g=Ie(()=>{t.g=null,t.i&&(t.i=!1,e(t))},t.l);var r=t.h;t.h=null,t.m.apply(null,r)}(this)}N(){super.N(),this.g&&(R.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function y(e){h.call(this),this.h=e,this.g={}}s(y,h);var Ee=[];function Se(e){H(e.g,function(e,t){this.g.hasOwnProperty(t)&&me(e)},e),e.g={}}y.prototype.N=function(){y.aa.N.call(this),Se(this)},y.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var xe=R.JSON.stringify,Ae=R.JSON.parse,Ce=class{stringify(e){return R.JSON.stringify(e,void 0)}parse(e){return R.JSON.parse(e,void 0)}};function De(){}function Ne(e){return e.h||(e.h=e.i())}function ke(){}De.prototype.h=null;var Re={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Le(){c.call(this,"d")}function Oe(){c.call(this,"c")}s(Le,c),s(Oe,c);var v={},Me=null;function Ve(){return Me=Me||new g}function Fe(e){c.call(this,v.La,e)}function Pe(){var e=Ve();m(e,new Fe(e))}function Ue(e,t){c.call(this,v.STAT_EVENT,e),this.stat=t}function O(e){var t=Ve();m(t,new Ue(t,e))}function Be(e,t){c.call(this,v.Ma,e),this.size=t}function qe(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return R.setTimeout(function(){e()},t)}function je(){this.g=!0}function M(e,t,r,n){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+((e,t)=>{if(!e.g)return t;if(!t)return null;try{var r=JSON.parse(t);if(r)for(e=0;e<r.length;e++)if(Array.isArray(r[e])){var n=r[e];if(!(n.length<2)){var i=n[1];if(Array.isArray(i)&&!(i.length<1)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var a=1;a<i.length;a++)i[a]=""}}}return xe(r)}catch(e){return t}})(e,r)+(n?" "+n:"")})}v.La="serverreachability",s(Fe,c),v.STAT_EVENT="statevent",s(Ue,c),v.Ma="timingevent",s(Be,c),je.prototype.xa=function(){this.g=!1},je.prototype.info=function(){};var ze={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ge={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Ke(){}function w(e,t,r,n){this.j=e,this.i=t,this.l=r,this.R=n||1,this.U=new y(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Qe}function Qe(){this.i=null,this.g="",this.h=!1}s(Ke,De),Ke.prototype.g=function(){return new XMLHttpRequest},Ke.prototype.i=function(){return{}};var $e=new Ke,He={},We={};function Ye(e,t,r){e.L=1,e.v=yt(b(t)),e.m=r,e.P=!0,Xe(e,null)}function Xe(e,t){e.F=Date.now(),Ze(e),e.A=b(e.v);var r=e.A,n=e.R,i=(Array.isArray(n)||(n=[String(n)]),Nt(r.i,"t",n),e.C=0,r=e.j.J,e.h=new Qe,e.g=cr(e.j,r?t:null,!e.m),0<e.O&&(e.M=new Te(p(e.Y,e,e.g),e.O)),t=e.U,r=e.g,n=e.ca,"readystatechange");Array.isArray(i)||(i&&(Ee[0]=i.toString()),i=Ee);for(var a,o,l,u,h,c,s=0;s<i.length;s++){var d=fe(r,i[s],n||t.handleEvent,!1,t.h||t);if(!d)break;t.g[d.key]=d}t=e.H?W(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Pe(),a=e.i,o=e.u,l=e.A,u=e.l,h=e.R,c=e.m,a.info(function(){if(a.g)if(c)for(var e="",t=c.split("&"),r=0;r<t.length;r++){var n,i,s=t[r].split("=");1<s.length&&(n=s[0],s=s[1],e=2<=(i=n.split("_")).length&&"type"==i[1]?e+(n+"=")+s+"&":e+(n+"=redacted&"))}else e=null;else e=c;return"XMLHTTP REQ ("+u+") [attempt "+h+"]: "+o+"\n"+l+"\n"+e})}function Je(e){return e.g&&"GET"==e.u&&2!=e.L&&e.j.Ca}function Ze(e){e.S=Date.now()+e.I,et(e,e.I)}function et(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=qe(p(e.ba,e),t)}function tt(e){e.B&&(R.clearTimeout(e.B),e.B=null)}function rt(e){0==e.j.G||e.J||or(e.j,e)}function V(e){tt(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,Se(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function nt(e,t){try{var r=e.j;if(0!=r.G&&(r.g==e||lt(r.h,e)))if(!e.K&&lt(r.h,e)&&3==r.G){try{var n=r.Da.g.parse(t)}catch(e){n=null}if(Array.isArray(n)&&3==n.length){var i=n;if(0==i[0]){e:if(!r.u){if(r.g){if(!(r.g.F+3e3<e.F))break e;ar(r),Yt(r)}nr(r),O(18)}}else r.za=i[1],0<r.za-r.T&&i[2]<37500&&r.F&&0==r.v&&!r.C&&(r.C=qe(p(r.Za,r),6e3));if(ot(r.h)<=1&&r.ca){try{r.ca()}catch(e){}r.ca=void 0}}else A(r,11)}else if(!e.K&&r.g!=e||ar(r),!L(t))for(i=r.Da.g.parse(t),t=0;t<i.length;t++){var s,a,o,l,u,h,c,d,f,g,m=i[t];r.T=m[0],m=m[1],2==r.G?"c"==m[0]?(r.K=m[1],r.ia=m[2],null!=(s=m[3])&&(r.la=s,r.j.info("VER="+r.la)),null!=(a=m[4])&&(r.Aa=a,r.j.info("SVER="+r.Aa)),null!=(o=m[5])&&"number"==typeof o&&0<o&&(n=1.5*o,r.L=n,r.j.info("backChannelRequestTimeoutMs_="+n)),n=r,(l=e.g)&&(!(u=l.g?l.g.getResponseHeader("X-Client-Wire-Protocol"):null)||(h=n.h).g||-1==u.indexOf("spdy")&&-1==u.indexOf("quic")&&-1==u.indexOf("h2")||(h.j=h.l,h.g=new Set,h.h&&(ut(h,h.h),h.h=null)),n.D)&&(c=l.g?l.g.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.ya=c,I(n.I,n.D,c)),r.G=3,r.l&&r.l.ua(),r.ba&&(r.R=Date.now()-e.F,r.j.info("Handshake RTT: "+r.R+"ms")),d=e,(n=r).qa=hr(n,n.J?n.ia:null,n.W),d.K?(ht(n.h,d),f=d,(g=n.L)&&(f.I=g),f.B&&(tt(f),Ze(f)),n.g=d):rr(n),0<r.i.length&&Jt(r)):"stop"!=m[0]&&"close"!=m[0]||A(r,7):3==r.G&&("stop"==m[0]||"close"==m[0]?"stop"==m[0]?A(r,7):Wt(r):"noop"!=m[0]&&r.l&&r.l.ta(m),r.v=0)}Pe()}catch(e){}}w.prototype.ca=function(e){e=e.target;var t=this.M;t&&3==F(e)?t.j():this.Y(e)},w.prototype.Y=function(e){try{if(e==this.g)e:{var t=F(this.g),r=this.g.Ba();this.g.Z();if(!(t<3)&&(3!=t||this.g&&(this.h.h||this.g.oa()||Qt(this.g)))){this.J||4!=t||7==r||Pe(),tt(this);var n=this.g.Z();this.X=n;t:if(Je(this)){var i=Qt(this.g),s=(e="",i.length),a=4==F(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){V(this),rt(this);var o="";break t}this.h.i=new R.TextDecoder}for(r=0;r<s;r++)this.h.h=!0,e+=this.h.i.decode(i[r],{stream:!(a&&r==s-1)});i.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==n,S=this.i,x=this.u,A=this.A,C=this.l,D=this.R,N=t,k=n,S.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+D+"]: "+x+"\n"+A+"\n"+N+" "+k}),this.o){if(this.T&&!this.K){t:{if(this.g){var l,u=this.g;if((l=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(l)){var h=l;break t}}h=null}if(!(n=h)){this.o=!1,this.s=3,O(12),V(this),rt(this);break e}M(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,nt(this,n)}if(this.P){for(var c,d,n=!0;!this.J&&this.C<o.length;){if(I=o,E=T=void 0,T=(b=this).C,(c=-1==(E=I.indexOf("\n",T))?We:(T=Number(I.substring(T,E)),isNaN(T)?He:(E+=1)+T>I.length?We:(I=I.slice(E,E+T),b.C=E+T,I)))==We){4==t&&(this.s=4,O(14),n=!1),M(this.i,this.l,null,"[Incomplete Response]");break}if(c==He){this.s=4,O(15),M(this.i,this.l,o,"[Invalid Chunk]"),n=!1;break}M(this.i,this.l,c,null),nt(this,c)}Je(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=t||0!=o.length||this.h.h||(this.s=1,O(16),n=!1),this.o=this.o&&n,n?0<o.length&&!this.W&&(this.W=!0,(d=this.j).g==this)&&d.ba&&!d.M&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),ir(d),d.M=!0,O(11)):(M(this.i,this.l,o,"[Invalid Chunked Response]"),V(this),rt(this))}else M(this.i,this.l,o,null),nt(this,o);4==t&&V(this),this.o&&!this.J&&(4==t?or(this.j,this):(this.o=!1,Ze(this)))}else{{var f=this.g;var g,m,p,y={};f=(f.g&&2<=F(f)&&f.g.getAllResponseHeaders()||"").split("\r\n");for(let e=0;e<f.length;e++)L(f[e])||(g=(e=>{for(var t=1,r=(e=e.split(":"),[]);0<t&&e.length;)r.push(e.shift()),t--;return e.length&&r.push(e.join(":")),r})(f[e]),m=g[0],"string"==typeof(g=g[1])&&(g=g.trim(),p=y[m]||[],(y[m]=p).push(g)));var v,w=y,_=function(e){return e.join(", ")};for(v in w)_.call(void 0,w[v],v,w)}400==n&&0<o.indexOf("Unknown SID")?(this.s=3,O(12)):(this.s=0,O(13)),V(this),rt(this)}}}}catch(e){}var b,I,T,E,S,x,A,C,D,N,k},w.prototype.cancel=function(){this.J=!0,V(this)},w.prototype.ba=function(){this.B=null;var e,t,r=Date.now();0<=r-this.S?(e=this.i,t=this.A,e.info(function(){return"TIMEOUT: "+t}),2!=this.L&&(Pe(),O(17)),V(this),this.s=2,rt(this)):et(this,this.S-r)};var it=class{constructor(e,t){this.g=e,this.map=t}};function st(e){this.l=e||10,e=R.PerformanceNavigationTiming?0<(e=R.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(R.chrome&&R.chrome.loadTimes&&R.chrome.loadTimes()&&R.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function at(e){return e.h||e.g&&e.g.size>=e.j}function ot(e){return e.h?1:e.g?e.g.size:0}function lt(e,t){return e.h?e.h==t:e.g&&e.g.has(t)}function ut(e,t){e.g?e.g.add(t):e.h=t}function ht(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function ct(t){if(null!=t.h)return t.i.concat(t.h.D);if(null==t.g||0===t.g.size)return G(t.i);{let e=t.i;for(var r of t.g.values())e=e.concat(r.D);return e}}function dt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(B(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var r=(e=>{if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(B(e)||"string"==typeof e){var t=[];e=e.length;for(var r=0;r<e;r++)t.push(r)}else for(var n in t=[],r=0,e)t[r++]=n;return t}}})(e),n=(e=>{if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(B(e))for(var t=[],r=e.length,n=0;n<r;n++)t.push(e[n]);else for(n in t=[],r=0,e)t[r++]=e[n];return t})(e),i=n.length,s=0;s<i;s++)t.call(void 0,n[s],r&&r[s],e)}st.prototype.cancel=function(){if(this.i=ct(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(var e of this.g.values())e.cancel();this.g.clear()}};var ft=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function _(e){var t,r;this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof _?(this.h=e.h,gt(this,e.j),this.o=e.o,this.g=e.g,mt(this,e.s),this.l=e.l,t=e.i,(r=new At).i=t.i,t.g&&(r.g=new Map(t.g),r.h=t.h),pt(this,r),this.m=e.m):e&&(t=String(e).match(ft))?(this.h=!1,gt(this,t[1]||"",!0),this.o=vt(t[2]||""),this.g=vt(t[3]||"",!0),mt(this,t[4]),this.l=vt(t[5]||"",!0),pt(this,t[6]||"",!0),this.m=vt(t[7]||"")):(this.h=!1,this.i=new At(null,this.h))}function b(e){return new _(e)}function gt(e,t,r){e.j=r?vt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function mt(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.s=t}else e.s=null}function pt(e,t,r){var n,i;t instanceof At?(e.i=t,n=e.i,(i=e.h)&&!n.j&&(T(n),n.i=null,n.g.forEach(function(e,t){var r=t.toLowerCase();t!=r&&(Ct(this,t),Nt(this,r,e))},n)),n.j=i):(r||(t=wt(t,St)),e.i=new At(t,e.h))}function I(e,t,r){e.i.set(t,r)}function yt(e){return I(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function vt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function wt(e,t,r){return"string"==typeof e?(e=encodeURI(e).replace(t,_t),e=r?e.replace(/%25([0-9a-fA-F]{2})/g,"%$1"):e):null}function _t(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}_.prototype.toString=function(){var e=[],t=this.j,r=(t&&e.push(wt(t,It,!0),":"),this.g);return!r&&"file"!=t||(e.push("//"),(t=this.o)&&e.push(wt(t,It,!0),"@"),e.push(encodeURIComponent(String(r)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null==(r=this.s))||e.push(":",String(r)),(r=this.l)&&(this.g&&"/"!=r.charAt(0)&&e.push("/"),e.push(wt(r,"/"==r.charAt(0)?Et:Tt,!0))),(r=this.i.toString())&&e.push("?",r),(r=this.m)&&e.push("#",wt(r,xt)),e.join("")};var bt,It=/[#\/\?@]/g,Tt=/[#\?:]/g,Et=/[#\?]/g,St=/[#\?@]/g,xt=/#/g;function At(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function T(r){if(!r.g&&(r.g=new Map,r.h=0,r.i)){var e=r.i,t=function(e,t){r.add(decodeURIComponent(e.replace(/\+/g," ")),t)};if(e){e=e.split("&");for(var n=0;n<e.length;n++){var i,s=e[n].indexOf("="),a=null;0<=s?(i=e[n].substring(0,s),a=e[n].substring(s+1)):i=e[n],t(i,a?decodeURIComponent(a.replace(/\+/g," ")):"")}}}}function Ct(e,t){T(e),t=E(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Dt(e,t){return T(e),t=E(e,t),e.g.has(t)}function Nt(e,t,r){Ct(e,t),0<r.length&&(e.i=null,e.g.set(E(e,t),G(r)),e.h+=r.length)}function E(e,t){return t=String(t),t=e.j?t.toLowerCase():t}function S(e,t,r,n,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),n(r)}catch(e){}}function kt(){this.g=new Ce}function Rt(e){this.l=e.Ub||null,this.j=e.eb||!1}function Lt(e,t){g.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Ot(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Mt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Vt(e)}function Vt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Ft(e){let r="";return H(e,function(e,t){r=(r=r+t+":")+e+"\r\n"}),r}function Pt(e,t,r){e:{for(n in r){var n=!1;break e}n=!0}n||(r=Ft(r),"string"==typeof e?null!=r&&encodeURIComponent(String(r)):I(e,t,r))}function x(e){g.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=At.prototype).add=function(e,t){T(this),this.i=null,e=E(this,e);var r=this.g.get(e);return r||this.g.set(e,r=[]),r.push(t),this.h+=1,this},e.forEach=function(r,n){T(this),this.g.forEach(function(e,t){e.forEach(function(e){r.call(n,e,t,this)},this)},this)},e.na=function(){T(this);var t=Array.from(this.g.values()),r=Array.from(this.g.keys()),n=[];for(let s=0;s<r.length;s++){var i=t[s];for(let e=0;e<i.length;e++)n.push(r[s])}return n},e.V=function(t){T(this);let r=[];if("string"==typeof t)Dt(this,t)&&(r=r.concat(this.g.get(E(this,t))));else{t=Array.from(this.g.values());for(let e=0;e<t.length;e++)r=r.concat(t[e])}return r},e.set=function(e,t){return T(this),this.i=null,Dt(this,e=E(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=Array.from(this.g.keys()),r=0;r<t.length;r++)for(var n=t[r],i=encodeURIComponent(String(n)),s=this.V(n),n=0;n<s.length;n++){var a=i;""!==s[n]&&(a+="="+encodeURIComponent(String(s[n]))),e.push(a)}return this.i=e.join("&")},s(Rt,De),Rt.prototype.g=function(){return new Lt(this.l,this.j)},Rt.prototype.i=(bt={},function(){return bt}),s(Lt,g),(e=Lt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Vt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||R).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Mt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Vt(this)),this.g)&&(this.readyState=3,Vt(this),this.g))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(void 0!==R.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ot(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){var t;this.g&&(this.o&&e.value?this.response.push(e.value):!this.o&&(t=e.value||new Uint8Array(0),t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t),(e.done?Mt:Vt)(this),3==this.readyState)&&Ot(this)},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Mt(this))},e.Qa=function(e){this.g&&(this.response=e,Mt(this))},e.ga=function(){this.g&&Mt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),r=t.next();!r.done;)r=r.value,e.push(r[0]+": "+r[1]),r=t.next();return e.join("\r\n")},Object.defineProperty(Lt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),s(x,g);var Ut=/^https?$/i,Bt=["POST","PUT"];function qt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,jt(e),Gt(e)}function jt(e){e.A||(e.A=!0,m(e,"complete"),m(e,"error"))}function zt(e){if(e.h&&void 0!==U&&(!e.v[1]||4!=F(e)||2!=e.Z()))if(e.u&&4==F(e))Ie(e.Ea,0,e);else if(m(e,"readystatechange"),4==F(e)){e.h=!1;try{var t,r,n,i=e.Z();switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break;default:s=!1}if((t=s)||((r=0===i)&&(!(n=String(e.D).match(ft)[1]||null)&&R.self&&R.self.location&&(n=R.self.location.protocol.slice(0,-1)),r=!Ut.test(n?n.toLowerCase():"")),t=r),t)m(e,"complete"),m(e,"success");else{e.m=6;try{var a=2<F(e)?e.g.statusText:""}catch(e){a=""}e.l=a+" ["+e.Z()+"]",jt(e)}}finally{Gt(e)}}}function Gt(e,t){if(e.g){Kt(e);var r=e.g,n=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||m(e,"ready");try{r.onreadystatechange=n}catch(e){}}}function Kt(e){e.I&&(R.clearTimeout(e.I),e.I=null)}function F(e){return e.g?e.g.readyState:0}function Qt(e){try{if(e.g){if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}}return null}catch(e){return null}}function $t(e,t,r){return r&&r.internalChannelParams&&r.internalChannelParams[e]||t}function Ht(e){this.Aa=0,this.i=[],this.j=new je,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=$t("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=$t("baseRetryDelayMs",5e3,e),this.cb=$t("retryDelaySeedMs",1e4,e),this.Wa=$t("forwardChannelMaxRetries",2,e),this.wa=$t("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new st(e&&e.concurrentRequestLimit),this.Da=new kt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Wt(e){if(Xt(e),3==e.G){var t=e.U++,r=b(e.I);if(I(r,"SID",e.K),I(r,"RID",t),I(r,"TYPE","terminate"),er(e,r),(t=new w(e,e.j,t)).L=2,t.v=yt(b(r)),r=!1,R.navigator&&R.navigator.sendBeacon)try{r=R.navigator.sendBeacon(t.v.toString(),"")}catch(e){}!r&&R.Image&&((new Image).src=t.v,r=!0),r||(t.g=cr(t.j,null),t.g.ea(t.v)),t.F=Date.now(),Ze(t)}ur(e)}function Yt(e){e.g&&(ir(e),e.g.cancel(),e.g=null)}function Xt(e){Yt(e),e.u&&(R.clearTimeout(e.u),e.u=null),ar(e),e.h.cancel(),e.s&&("number"==typeof e.s&&R.clearTimeout(e.s),e.s=null)}function Jt(e){var t;at(e.h)||e.s||(e.s=!0,t=e.Ga,o||te(),l||(o(),l=!0),ee.add(t,e),e.B=0)}function Zt(e,t){var r=t?t.l:e.U++,n=b(e.I);I(n,"SID",e.K),I(n,"RID",r),I(n,"AID",e.T),er(e,n),e.m&&e.o&&Pt(n,e.m,e.o),r=new w(e,e.j,r,e.B+1),null===e.m&&(r.H=e.o),t&&(e.i=t.D.concat(e.i)),t=tr(e,r,1e3),r.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),ut(e.h,r),Ye(r,n,t)}function er(e,r){e.H&&H(e.H,function(e,t){I(r,t,e)}),e.l&&dt({},function(e,t){I(r,t,e)})}function tr(e,t,i){i=Math.min(e.i.length,i);var s=e.l?p(e.l.Na,e.l,e):null;e:{let r=e.i,n=-1;for(;;){var a=["count="+i];-1==n?0<i?(n=r[0].g,a.push("ofs="+n)):n=0:a.push("ofs="+n);let e=!0;for(let t=0;t<i;t++){var o=r[t].g,l=r[t].map;if((o-=n)<0)n=Math.max(0,r[t].g-100),e=!1;else try{((e,n,t)=>{let i=t||"";try{dt(e,function(e,t){let r=e;u(e)&&(r=xe(e)),n.push(i+t+"="+encodeURIComponent(r))})}catch(e){throw n.push(i+"type="+encodeURIComponent("_badmap")),e}})(l,a,"req"+o+"_")}catch(e){s&&s(l)}}if(e){s=a.join("&");break e}}}return e=e.i.splice(0,i),t.D=e,s}function rr(e){var t;e.g||e.u||(e.Y=1,t=e.Fa,o||te(),l||(o(),l=!0),ee.add(t,e),e.v=0)}function nr(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=qe(p(e.Fa,e),lr(e,e.v)),e.v++,1)}function ir(e){null!=e.A&&(R.clearTimeout(e.A),e.A=null)}function sr(e){e.g=new w(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=b(e.qa),r=(I(t,"RID","rpc"),I(t,"SID",e.K),I(t,"AID",e.T),I(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&I(t,"TO",e.ja),I(t,"TYPE","xmlhttp"),er(e,t),e.m&&e.o&&Pt(t,e.m,e.o),e.L&&(e.g.I=e.L),e.g);e=e.ia,r.L=1,r.v=yt(b(t)),r.m=null,r.P=!0,Xe(r,e)}function ar(e){null!=e.C&&(R.clearTimeout(e.C),e.C=null)}function or(e,t){var r,n,i,s=null;if(e.g==t){ar(e),ir(e),e.g=null;var a=2}else{if(!lt(e.h,t))return;s=t.D,ht(e.h,t),a=1}if(0!=e.G)if(t.o)(1==a?(s=t.m?t.m.length:0,t=Date.now()-t.F,r=e.B,m(a=Ve(),new Be(a,s)),Jt):rr)(e);else if(3==(r=t.s)||0==r&&0<t.X||(1!=a||(i=t,ot((n=e).h)>=n.h.j-(n.s?1:0))||(n.s?(n.i=i.D.concat(n.i),0):1==n.G||2==n.G||n.B>=(n.Va?0:n.Wa)||(n.s=qe(p(n.Ga,n,i),lr(n,n.B)),n.B++,0)))&&(2!=a||!nr(e)))switch(s&&0<s.length&&(t=e.h,t.i=t.i.concat(s)),r){case 1:A(e,5);break;case 4:A(e,10);break;case 3:A(e,6);break;default:A(e,2)}}function lr(e,t){let r=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(r*=2),r*t}function A(e,t){var r,n,i;e.j.info("Error code "+t),2==t?(r=p(e.fb,e),n=!(i=e.Xa),i=new _(i||"//www.google.com/images/cleardot.gif"),R.location&&"http"==R.location.protocol||gt(i,"https"),yt(i),(n?(t,r)=>{var n=new je;if(R.Image){let e=new Image;e.onload=z(S,n,"TestLoadImage: loaded",!0,r,e),e.onerror=z(S,n,"TestLoadImage: error",!1,r,e),e.onabort=z(S,n,"TestLoadImage: abort",!1,r,e),e.ontimeout=z(S,n,"TestLoadImage: timeout",!1,r,e),R.setTimeout(function(){e.ontimeout&&e.ontimeout()},1e4),e.src=t}else r(!1)}:(e,t)=>{let r=new je,n=new AbortController,i=setTimeout(()=>{n.abort(),S(r,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(i),e.ok?S(r,0,!0,t):S(r,0,!1,t)}).catch(()=>{clearTimeout(i),S(r,0,!1,t)})})(i.toString(),r)):O(2),e.G=0,e.l&&e.l.sa(t),ur(e),Xt(e)}function ur(e){var t;e.G=0,e.ka=[],e.l&&(0==(t=ct(e.h)).length&&0==e.i.length||(K(e.ka,t),K(e.ka,e.i),e.h.i.length=0,G(e.i),e.i.length=0),e.l.ra())}function hr(e,t,r){var n,i,s=r instanceof _?b(r):new _(r);return""!=s.g?(t&&(s.g=t+"."+s.g),mt(s,s.s)):(s=(n=R.location).protocol,t=t?t+"."+n.hostname:n.hostname,n=+n.port,i=new _(null),s&&gt(i,s),t&&(i.g=t),n&&mt(i,n),r&&(i.l=r),s=i),r=e.D,t=e.ya,r&&t&&I(s,r,t),I(s,"VER",e.la),er(e,s),s}function cr(e,t,r){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new x(new Rt({eb:r})):new x(e.pa)).Ha(e.J),t}function dr(){}function fr(){}function C(e,t){g.call(this),this.g=new Ht(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!L(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!L(t)&&(this.g.D=t,null!==(e=this.h))&&t in e&&t in(e=this.h)&&delete e[t],this.j=new D(this)}function gr(e){Le.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(var r in t){e=r;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function mr(){Oe.call(this),this.status=1}function D(e){this.g=e}(e=x.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,r,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=(this.o||$e).g(),this.v=this.o?Ne(this.o):Ne($e),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(e){return void qt(this,e)}if(e=r||"",r=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var i in n)r.set(i,n[i]);else{if("function"!=typeof n.keys||"function"!=typeof n.get)throw Error("Unknown input type for opt_headers: "+String(n));for(var s of n.keys())r.set(s,n.get(s))}n=Array.from(r.keys()).find(e=>"content-type"==e.toLowerCase()),i=R.FormData&&e instanceof R.FormData,0<=Array.prototype.indexOf.call(Bt,t,void 0)&&!n&&!i&&r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(var[a,o]of r)this.g.setRequestHeader(a,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Kt(this),this.u=!0,this.g.send(e),this.u=!1}catch(e){qt(this,e)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,m(this,"complete"),m(this,"abort"),Gt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Gt(this,!0)),x.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?zt(this):this.bb())},e.bb=function(){zt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<F(this)?this.g.status:-1}catch(e){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},e.Oa=function(e){var t;if(this.g)return t=this.g.responseText,e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Ae(t)},e.Ba=function(){return this.m},e.Ka=function(){return"string"==typeof this.l?this.l:String(this.l)},(e=Ht.prototype).la=8,e.G=1,e.connect=function(e,t,r,n){O(0),this.W=e,this.H=t||{},r&&void 0!==n&&(this.H.OSID=r,this.H.OAID=n),this.F=this.X,this.I=hr(this,null,this.W),Jt(this)},e.Ga=function(t){if(this.s)if(this.s=null,1==this.G){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;var r=new w(this,this.j,t);let e=this.o;if(this.S&&(e?X(e=W(e),this.S):e=this.S),null!==this.m||this.O||(r.H=e,e=null),this.P)e:{for(var n=0,i=0;i<this.i.length;i++){var s=this.i[i];if("__data__"in s.map&&"string"==typeof(s=s.map.__data__)?s=s.length:s=void 0,void 0===s)break;if(4096<(n+=s)){n=i;break e}if(4096===n||i===this.i.length-1){n=i+1;break e}}n=1e3}else n=1e3;n=tr(this,r,n),I(i=b(this.I),"RID",t),I(i,"CVER",22),this.D&&I(i,"X-HTTP-Session-Id",this.D),er(this,i),e&&(this.O?n="headers="+encodeURIComponent(String(Ft(e)))+"&"+n:this.m&&Pt(i,this.m,e)),ut(this.h,r),this.Ua&&I(i,"TYPE","init"),this.P?(I(i,"$req",n),I(i,"SID","null"),r.T=!0,Ye(r,i,null)):Ye(r,i,n),this.G=2}}else 3==this.G&&(t?Zt(this,t):0==this.i.length||at(this.h)||Zt(this))},e.Fa=function(){var e;this.u=null,sr(this),this.ba&&!(this.M||null==this.g||this.R<=0)&&(e=2*this.R,this.j.info("BP detection timer enabled: "+e),this.A=qe(p(this.ab,this),e))},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,O(10),Yt(this),sr(this))},e.Za=function(){null!=this.C&&(this.C=null,Yt(this),nr(this),O(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),O(2)):(this.j.info("Failed to ping google.com"),O(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=dr.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},fr.prototype.g=function(e,t){return new C(e,t)},s(C,g),C.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},C.prototype.close=function(){Wt(this.g)},C.prototype.o=function(e){var t,r=this.g;"string"==typeof e?((t={}).__data__=e,e=t):this.u&&((t={}).__data__=xe(e),e=t),r.i.push(new it(r.Ya++,e)),3==r.G&&Jt(r)},C.prototype.N=function(){this.g.l=null,delete this.j,Wt(this.g),delete this.g,C.aa.N.call(this)},s(gr,Le),s(mr,Oe),s(D,dr),D.prototype.ua=function(){m(this.g,"a")},D.prototype.ta=function(e){m(this.g,new gr(e))},D.prototype.sa=function(e){m(this.g,new mr)},D.prototype.ra=function(){m(this.g,"b")},fr.prototype.createWebChannel=fr.prototype.g,C.prototype.send=C.prototype.o,C.prototype.open=C.prototype.m,Tr=function(){return new fr},Ir=Ve,br=v,_r={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ze.NO_ERROR=0,ze.TIMEOUT=8,ze.HTTP_ERROR=6,wr=ze,Ge.COMPLETE="complete",vr=Ge,(ke.EventType=Re).OPEN="a",Re.CLOSE="b",Re.ERROR="c",Re.MESSAGE="d",g.prototype.listen=g.prototype.K,yr=ke,x.prototype.listenOnce=x.prototype.L,x.prototype.getLastError=x.prototype.Ka,x.prototype.getLastErrorCode=x.prototype.Ba,x.prototype.getStatus=x.prototype.Z,x.prototype.getResponseJson=x.prototype.Oa,x.prototype.getResponseText=x.prototype.oa,x.prototype.send=x.prototype.ea,x.prototype.setWithCredentials=x.prototype.Ha,pr=x}).apply(void 0!==Er?Er:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});let he="@firebase/firestore",ce="4.7.10";class u{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}u.UNAUTHENTICATED=new u(null),u.GOOGLE_CREDENTIALS=new u("google-credentials-uid"),u.FIRST_PARTY=new u("first-party-uid"),u.MOCK_USER=new u("mock-user");let de="11.6.0",fe=new class{constructor(e){this.name=e,this._logLevel=ie,this._logHandler=ae,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in c))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?ne[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,c.DEBUG,...e),this._logHandler(this,c.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,c.VERBOSE,...e),this._logHandler(this,c.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,c.INFO,...e),this._logHandler(this,c.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,c.WARN,...e),this._logHandler(this,c.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,c.ERROR,...e),this._logHandler(this,c.ERROR,...e)}}("@firebase/firestore");function ge(){return fe.logLevel}function p(e,...t){var r;fe.logLevel<=c.DEBUG&&(r=t.map(pe),fe.debug(`Firestore (${de}): `+e,...r))}function d(e,...t){var r;fe.logLevel<=c.ERROR&&(r=t.map(pe),fe.error(`Firestore (${de}): `+e,...r))}function me(e,...t){var r;fe.logLevel<=c.WARN&&(r=t.map(pe),fe.warn(`Firestore (${de}): `+e,...r))}function pe(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(e){return t}}function T(e="Unexpected state"){var t=`FIRESTORE (${de}) INTERNAL ASSERTION FAILED: `+e;throw d(t),new Error(t)}function y(e){e||T()}let b={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class I extends X{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: `+this.message}}class f{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class ye{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer "+e)}}class ve{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(u.UNAUTHENTICATED))}shutdown(){}}class we{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class _e{constructor(e){this.t=e,this.currentUser=u.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,r){y(void 0===this.o);let n=this.i,i=e=>this.i!==n?(n=this.i,r(e)):Promise.resolve(),s=new f,a=(this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new f,t.enqueueRetryable(()=>i(this.currentUser))},()=>{let e=s;t.enqueueRetryable(async()=>{await e.promise,await i(this.currentUser)})}),o=e=>{p("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(e=>o(e)),setTimeout(()=>{var e;this.auth||((e=this.t.getImmediate({optional:!0}))?o(e):(p("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new f))},0),a()}getToken(){let t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(e=>this.i!==t?(p("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(y("string"==typeof e.accessToken),new ye(e.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){var e=this.auth&&this.auth.getUid();return y(null===e||"string"==typeof e),new u(e)}}class be{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=u.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);var e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class Ie{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new be(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(u.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Te{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&0<e.length&&this.headers.set("x-firebase-appcheck",this.value)}}class Ee{constructor(e,t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,Od._isFirebaseServerApp(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(t,r){y(void 0===this.o);let n=e=>{null!=e.error&&p("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: "+e.error.message);var t=e.token!==this.R;return this.R=e.token,p("FirebaseAppCheckTokenProvider",`Received ${t?"new":"existing"} token.`),t?r(e.token):Promise.resolve()},i=(this.o=e=>{t.enqueueRetryable(()=>n(e))},e=>{p("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)});this.A.onInit(e=>i(e)),setTimeout(()=>{var e;this.appCheck||((e=this.A.getImmediate({optional:!0}))?i(e):p("FirebaseAppCheckTokenProvider","AppCheck not yet detected"))},0)}getToken(){var e;return this.V?Promise.resolve(new Te(this.V)):(e=this.forceRefresh,this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(y("string"==typeof e.token),this.R=e.token,new Te(e.token)):null):Promise.resolve(null))}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Se(){return new TextEncoder}class xe{static newId(){var t=62*Math.floor(256/62);let r="";for(;r.length<20;){var n=(t=>{var r="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(r&&"function"==typeof r.getRandomValues)r.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n})(40);for(let e=0;e<n.length;++e)r.length<20&&n[e]<t&&(r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[e]%62))}return r}}function E(e,t){return e<t?-1:t<e?1:0}function Ae(e,t){let r=0;for(;r<e.length&&r<t.length;){var n,i=e.codePointAt(r),s=t.codePointAt(r);if(i!==s)return!(i<128&&s<128)&&0!==(n=((e,t)=>{for(let r=0;r<e.length&&r<t.length;++r)if(e[r]!==t[r])return E(e[r],t[r]);return E(e.length,t.length)})((n=Se()).encode(Ce(e,r)),n.encode(Ce(t,r))))?n:E(i,s);r+=65535<i?2:1}return E(e.length,t.length)}function Ce(e,t){return 65535<e.codePointAt(t)?e.substring(t,t+2):e.substring(t,t+1)}function De(e,r,n){return e.length===r.length&&e.every((e,t)=>n(e,r[t]))}function Ne(e){return e+"\0"}let ke=-62135596800;class h{static now(){return h.fromMillis(Date.now())}static fromDate(e){return h.fromMillis(e.getTime())}static fromMillis(e){var t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new h(t,r)}constructor(e,t){if(this.seconds=e,(this.nanoseconds=t)<0)throw new I(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(1e9<=t)throw new I(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ke)throw new I(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(253402300800<=e)throw new I(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?E(this.nanoseconds,e.nanoseconds):E(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){var e=this.seconds-ke;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class g{static fromTimestamp(e){return new g(e)}static min(){return new g(new h(0,0))}static max(){return new g(new h(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}let Re="__name__";class Le{constructor(e,t,r){void 0===t?t=0:t>e.length&&T(),void 0===r?r=e.length-t:r>e.length-t&&T(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===Le.comparator(this,e)}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof Le?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,r){let e=Math.min(t.length,r.length);for(let n=0;n<e;n++){let e=Le.compareSegments(t.get(n),r.get(n));if(0!==e)return e}return E(t.length,r.length)}static compareSegments(e,t){var r=Le.isNumericId(e),n=Le.isNumericId(t);return r&&!n?-1:!r&&n?1:r&&n?Le.extractNumericId(e).compare(Le.extractNumericId(t)):Ae(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return oe.fromString(e.substring(4,e.length-2))}}class S extends Le{construct(e,t,r){return new S(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){var t,r=[];for(t of e){if(0<=t.indexOf("//"))throw new I(b.INVALID_ARGUMENT,`Invalid segment (${t}). Paths must not contain // in them.`);r.push(...t.split("/").filter(e=>0<e.length))}return new S(r)}static emptyPath(){return new S([])}}let Oe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class v extends Le{construct(e,t,r){return new v(e,t,r)}static isValidIdentifier(e){return Oe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e=v.isValidIdentifier(e)?e:"`"+e+"`")).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===Re}static keyField(){return new v([Re])}static fromServerFormat(t){let e=[],r="",n=0;var i=()=>{if(0===r.length)throw new I(b.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(r),r=""};let s=!1;for(;n<t.length;){let e=t[n];if("\\"===e){if(n+1===t.length)throw new I(b.INVALID_ARGUMENT,"Path has trailing escape character: "+t);let e=t[n+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new I(b.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=e,n+=2}else"`"===e?s=!s:"."!==e||s?r+=e:i(),n++}if(i(),s)throw new I(b.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new v(e)}static emptyPath(){return new v([])}}class x{constructor(e){this.path=e}static fromPath(e){return new x(S.fromString(e))}static fromName(e){return new x(S.fromString(e).popFirst(5))}static empty(){return new x(S.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return 2<=this.path.length&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===S.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return S.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new x(new S(e.slice()))}}let Me=-1;class Ve{constructor(e,t,r,n){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=n}}function Fe(e){return e.fields.find(e=>2===e.kind)}function Pe(e){return e.fields.filter(e=>2!==e.kind)}Ve.UNKNOWN_ID=-1;class Ue{constructor(e,t){this.fieldPath=e,this.kind=t}}class Be{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Be(0,ze.min())}}function qe(e,t){var r=e.toTimestamp().seconds,n=e.toTimestamp().nanoseconds+1,r=g.fromTimestamp(1e9===n?new h(r+1,0):new h(r,n));return new ze(r,x.empty(),t)}function je(e){return new ze(e.readTime,e.key,Me)}class ze{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ze(g.min(),x.empty(),Me)}static max(){return new ze(g.max(),x.empty(),Me)}}function Ge(e,t){var r=e.readTime.compareTo(t.readTime);return 0!==r||0!==(r=x.comparator(e.documentKey,t.documentKey))?r:E(e.largestBatchId,t.largestBatchId)}let Ke="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Qe{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function $e(e){if(e.code!==b.FAILED_PRECONDITION||e.message!==Ke)throw e;p("LocalStore","Unexpectedly lost primary lease")}class w{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(n,i){return this.callbackAttached&&T(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(i,this.error):this.wrapSuccess(n,this.result):new w((t,r)=>{this.nextCallback=e=>{this.wrapSuccess(n,e).next(t,r)},this.catchCallback=e=>{this.wrapFailure(i,e).next(t,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{var t=e();return t instanceof w?t:w.resolve(t)}catch(e){return w.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):w.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):w.reject(t)}static resolve(r){return new w((e,t)=>{e(r)})}static reject(r){return new w((e,t)=>{t(r)})}static waitFor(e){return new w((t,r)=>{let n=0,i=0,s=!1;e.forEach(e=>{++n,e.next(()=>{++i,s&&i===n&&t()},e=>r(e))}),s=!0,i===n&&t()})}static or(e){let t=w.resolve(!1);for(let r of e)t=t.next(e=>e?w.resolve(e):r());return t}static forEach(e,r){let n=[];return e.forEach((e,t)=>{n.push(r.call(this,e,t))}),this.waitFor(n)}static mapArray(o,l){return new w((r,n)=>{let i=o.length,s=new Array(i),a=0;for(let e=0;e<i;e++){let t=e;l(o[t]).next(e=>{s[t]=e,++a===i&&r(s)},e=>n(e))}})}static doWhile(n,i){return new w((e,t)=>{let r=()=>{!0===n()?i().next(()=>{r()},t):e()};r()})}}let He="SimpleDb";class We{static open(e,t,r,n){try{return new We(t,e.transaction(n,r))}catch(e){throw new Ze(t,e)}}constructor(r,e){this.action=r,this.transaction=e,this.aborted=!1,this.m=new f,this.transaction.oncomplete=()=>{this.m.resolve()},this.transaction.onabort=()=>{e.error?this.m.reject(new Ze(r,e.error)):this.m.resolve()},this.transaction.onerror=e=>{var t=it(e.target.error);this.m.reject(new Ze(r,t))}}get p(){return this.m.promise}abort(e){e&&this.m.reject(e),this.aborted||(p(He,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}S(){var e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){var t=this.transaction.objectStore(e);return new tt(t)}}class Ye{static delete(e){return p(He,"Removing database:",e),rt(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){var e,t,r;return!(!(()=>{try{return"object"==typeof indexedDB}catch(e){}})()||!Ye.v()&&(e=W(),t=0<(t=Ye.C(e))&&t<10,r=0<(r=Xe(e))&&r<4.5,0<e.indexOf("MSIE ")||0<e.indexOf("Trident/")||0<e.indexOf("Edge/")||t||r))}static v(){var e;return"undefined"!=typeof process&&"YES"===(null==(e=process.__PRIVATE_env)?void 0:e.F)}static M(e,t){return e.store(t)}static C(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),t=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(t)}constructor(e,t,r){this.name=e,this.version=t,this.O=r,12.2===Ye.C(W())&&d("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async N(s){return this.db||(p(He,"Opening database:",this.name),this.db=await new Promise((r,n)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=e=>{var t=e.target.result;r(t)},i.onblocked=()=>{n(new Ze(s,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=e=>{var t=e.target.error;"VersionError"===t.name?n(new I(b.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===t.name?n(new I(b.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+t)):n(new Ze(s,t))},i.onupgradeneeded=e=>{p(He,'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);var t=e.target.result;this.O.B(t,i.transaction,e.oldVersion,this.version).next(()=>{p(He,"Database upgrade to version "+this.version+" complete")})}})),this.L&&(this.db.onversionchange=e=>this.L(e)),this.db}k(t){this.L=t,this.db&&(this.db.onversionchange=e=>t(e))}async runTransaction(r,e,n,i){var s="readonly"===e;let a=0;for(;;){++a;try{this.db=await this.N(r);let t=We.open(this.db,r,s?"readonly":"readwrite",n),e=i(t).next(e=>(t.S(),e)).catch(e=>(t.abort(e),w.reject(e))).toPromise();return e.catch(()=>{}),await t.p,e}catch(r){let e=r,t="FirebaseError"!==e.name&&a<3;if(p(He,"Transaction failed with error:",e.message,"Retrying:",t),this.close(),!t)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Xe(e){var t=e.match(/Android ([\d.]+)/i),t=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class Je{constructor(e){this.q=e,this.$=!1,this.U=null}get isDone(){return this.$}get K(){return this.U}set cursor(e){this.q=e}done(){this.$=!0}W(e){this.U=e}delete(){return rt(this.q.delete())}}class Ze extends I{constructor(e,t){super(b.UNAVAILABLE,`IndexedDB transaction '${e}' failed: `+t),this.name="IndexedDbTransactionError"}}function et(e){return"IndexedDbTransactionError"===e.name}class tt{constructor(e){this.store=e}put(e,t){let r;return rt(r=void 0!==t?(p(He,"PUT",this.store.name,e,t),this.store.put(t,e)):(p(He,"PUT",this.store.name,"<auto-key>",e),this.store.put(e)))}add(e){return p(He,"ADD",this.store.name,e,e),rt(this.store.add(e))}get(t){return rt(this.store.get(t)).next(e=>(void 0===e&&(e=null),p(He,"GET",this.store.name,t,e),e))}delete(e){return p(He,"DELETE",this.store.name,e),rt(this.store.delete(e))}count(){return p(He,"COUNT",this.store.name),rt(this.store.count())}G(e,t){var n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){let e=r.getAll(n.range);return new w((t,r)=>{e.onerror=e=>{r(e.target.error)},e.onsuccess=e=>{t(e.target.result)}})}{let e=this.cursor(n),r=[];return this.j(e,(e,t)=>{r.push(t)}).next(()=>r)}}H(e,t){let n=this.store.getAll(e,null===t?void 0:t);return new w((t,r)=>{n.onerror=e=>{r(e.target.error)},n.onsuccess=e=>{t(e.target.result)}})}J(e,t){p(He,"DELETE ALL",this.store.name);var r=this.options(e,t),r=(r.Y=!1,this.cursor(r));return this.j(r,(e,t,r)=>r.delete())}Z(e,t){let r;t?r=e:(r={},t=e);var n=this.cursor(r);return this.j(n,t)}X(i){let e=this.cursor({});return new w((r,n)=>{e.onerror=e=>{var t=it(e.target.error);n(t)},e.onsuccess=e=>{let t=e.target.result;t?i(t.primaryKey,t.value).next(e=>{e?t.continue():r()}):r()}})}j(e,s){let a=[];return new w((i,t)=>{e.onerror=e=>{t(e.target.error)},e.onsuccess=e=>{var n=e.target.result;if(n){let t=new Je(n),r=s(n.primaryKey,n.value,t);if(r instanceof w){let e=r.catch(e=>(t.done(),w.reject(e)));a.push(e)}t.isDone?i():null===t.K?n.continue():n.continue(t.K)}else i()}}).next(()=>w.waitFor(a))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";var r;return e.reverse&&(t="prev"),e.index?(r=this.store.index(e.index),e.Y?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)):this.store.openCursor(e.range,t)}}function rt(e){return new w((r,n)=>{e.onsuccess=e=>{var t=e.target.result;r(t)},e.onerror=e=>{var t=it(e.target.error);n(t)}})}let nt=!1;function it(e){let t=Ye.C(W());if(12.2<=t&&t<13){let t="An internal error was encountered in the Indexed Database server";if(0<=e.message.indexOf(t)){let e=new I("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return nt||(nt=!0,setTimeout(()=>{throw e},0)),e}}return e}let st="IndexBackfiller";class at{constructor(e,t){this.asyncQueue=e,this.ee=t,this.task=null}start(){this.te(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}te(e){p(st,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{var e=await this.ee.ne();p(st,"Documents written: "+e)}catch(e){et(e)?p(st,"Ignoring IndexedDB error during index backfill: ",e):await $e(e)}await this.te(6e4)})}}class ot{constructor(e,t){this.localStore=e,this.persistence=t}async ne(t=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",e=>this.re(e,t))}re(e,t){let r=new Set,n=t,i=!0;return w.doWhile(()=>!0===i&&0<n,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(t=>{if(null!==t&&!r.has(t))return p(st,"Processing collection: "+t),this.ie(e,t,n).next(e=>{n-=e,r.add(t)});i=!1})).next(()=>t-n)}ie(n,i,e){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(n,i).next(r=>this.localStore.localDocuments.getNextDocuments(n,i,r,e).next(e=>{let t=e.changes;return this.localStore.indexManager.updateIndexEntries(n,t).next(()=>this.se(r,e)).next(e=>(p(st,"Updating offset: "+e),this.localStore.indexManager.updateCollectionGroup(n,i,e))).next(()=>t.size)}))}se(e,t){let n=e;return t.changes.forEach((e,t)=>{var r=je(t);0<Ge(r,n)&&(n=r)}),new ze(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class lt{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.oe(e),this._e=e=>t.writeSequenceNumber(e))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){var e=++this.previousValue;return this._e&&this._e(e),e}}let ut=lt.ae=-1;function ht(e){return null==e}function ct(e){return 0===e&&1/e==-1/0}function dt(e){return"number"==typeof e&&Number.isInteger(e)&&!ct(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}let ft="";function o(e){let t="";for(let r=0;r<e.length;r++)0<t.length&&(t=gt(t)),t=((t,e)=>{let r=e,n=t.length;for(let i=0;i<n;i++){let e=t.charAt(i);switch(e){case"\0":r+="";break;case ft:r+="";break;default:r+=e}}return r})(e.get(r),t);return gt(t)}function gt(e){return e+ft+""}function mt(r){let e=r.length;if(y(2<=e),2===e)return y(r.charAt(0)===ft&&""===r.charAt(1)),S.emptyPath();var __PRIVATE_lastReasonableEscapeIndex=e-2,n=[];let i="";for(let a=0;a<e;){let t=r.indexOf(ft,a);switch((t<0||t>__PRIVATE_lastReasonableEscapeIndex)&&T(),r.charAt(t+1)){case"":var s=r.substring(a,t);let e;0===i.length?e=s:(i+=s,e=i,i=""),n.push(e);break;case"":i=i+r.substring(a,t)+"\0";break;case"":i+=r.substring(a,t+1);break;default:T()}a=t+2}return new S(n)}let pt="remoteDocuments",yt="owner",vt="owner",wt="mutationQueues",_t="mutations",bt="batchId",It="userMutationsIndex",Tt=["userId","batchId"];function Et(e,t){return[e,o(t)]}function St(e,t,r){return[e,o(t),r]}let xt={},At="documentMutations",Ct="remoteDocumentsV14",Dt=["prefixPath","collectionGroup","readTime","documentId"],Nt="documentKeyIndex",kt=["prefixPath","collectionGroup","documentId"],Rt="collectionGroupIndex",Lt=["collectionGroup","readTime","prefixPath","documentId"],Ot="remoteDocumentGlobal",Mt="remoteDocumentGlobalKey",Vt="targets",Ft="queryTargetsIndex",Pt=["canonicalId","targetId"],Ut="targetDocuments",Bt=["targetId","path"],qt="documentTargetsIndex",jt=["path","targetId"],zt="targetGlobalKey",Gt="targetGlobal",Kt="collectionParents",Qt=["collectionId","parent"],$t="clientMetadata",Ht="bundles",Wt="namedQueries",Yt="indexConfiguration",Xt="collectionGroupIndex",Jt="indexState",Zt=["indexId","uid"],er="sequenceNumberIndex",tr=["uid","sequenceNumber"],rr="indexEntries",nr=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],ir="documentKeyIndex",sr=["indexId","uid","orderedDocumentKey"],ar="documentOverlays",or=["userId","collectionPath","documentId"],lr="collectionPathOverlayIndex",ur=["userId","collectionPath","largestBatchId"],hr="collectionGroupOverlayIndex",cr=["userId","collectionGroup","largestBatchId"],dr="globals",fr=[wt,_t,At,pt,Vt,yt,Gt,Ut,$t,Ot,Kt,Ht,Wt],gr=[...fr,ar],mr=[wt,_t,At,Ct,Vt,yt,Gt,Ut,$t,Ot,Kt,Ht,Wt,ar],Sr=mr,xr=[...Sr,Yt,Jt,rr],Ar=xr,Cr=[...xr,dr];class Dr extends Qe{constructor(e,t){super(),this.ue=e,this.currentSequenceNumber=t}}function r(e,t){var r=e;return Ye.M(r.ue,t)}function Nr(e){let t=0;for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function kr(e,t){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function Rr(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class A{constructor(e,t){this.comparator=e,this.root=t||Or.EMPTY}insert(e,t){return new A(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Or.BLACK,null,null))}remove(e){return new A(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Or.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){var r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:0<r&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){var n=this.comparator(e,r.key);if(0===n)return t+r.left.size;r=n<0?r.left:(t+=r.left.size+1,r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(r){this.inorderTraversal((e,t)=>(r(e,t),!1))}toString(){let r=[];return this.inorderTraversal((e,t)=>(r.push(e+":"+t),!1)),`{${r.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Lr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Lr(this.root,e,this.comparator,!1)}getReverseIterator(){return new Lr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Lr(this.root,e,this.comparator,!0)}}class Lr{constructor(e,t,r,n){this.isReverse=n,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&n&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();var t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return 0<this.nodeStack.length}peek(){var e;return 0===this.nodeStack.length?null:{key:(e=this.nodeStack[this.nodeStack.length-1]).key,value:e.value}}}class Or{constructor(e,t,r,n,i){this.key=e,this.value=t,this.color=null!=r?r:Or.RED,this.left=null!=n?n:Or.EMPTY,this.right=null!=i?i:Or.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,n,i){return new Or(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=n?n:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){var n=this,i=r(e,n.key);return(n=i<0?n.copy(null,null,null,n.left.insert(e,t,r),null):0===i?n.copy(null,t,null,null,null):n.copy(null,null,null,null,n.right.insert(e,t,r))).fixUp()}removeMin(){if(this.left.isEmpty())return Or.EMPTY;let e=this;return(e=(e=e.left.isRed()||e.left.left.isRed()?e:e.moveRedLeft()).copy(null,null,null,e.left.removeMin(),null)).fixUp()}remove(e,t){let r,n=this;if(t(e,n.key)<0)n=(n=n.left.isEmpty()||n.left.isRed()||n.left.left.isRed()?n:n.moveRedLeft()).copy(null,null,null,n.left.remove(e,t),null);else{if(0===t(e,(n=(n=n.left.isRed()?n.rotateRight():n).right.isEmpty()||n.right.isRed()||n.right.left.isRed()?n:n.moveRedRight()).key)){if(n.right.isEmpty())return Or.EMPTY;r=n.right.min(),n=n.copy(r.key,r.value,null,null,n.right.removeMin())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e=(e=(e=e.right.isRed()&&!e.left.isRed()?e.rotateLeft():e).left.isRed()&&e.left.left.isRed()?e.rotateRight():e).left.isRed()&&e.right.isRed()?e.colorFlip():e}moveRedLeft(){let e=this.colorFlip();return e=e.right.left.isRed()?(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip():e}moveRedRight(){let e=this.colorFlip();return e=e.left.left.isRed()?(e=e.rotateRight()).colorFlip():e}rotateLeft(){var e=this.copy(null,null,Or.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){var e=this.copy(null,null,Or.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){var e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw T();if(this.right.isRed())throw T();var e=this.left.check();if(e!==this.right.check())throw T();return e+(this.isRed()?0:1)}}Or.EMPTY=null,Or.RED=!0,Or.BLACK=!1,Or.EMPTY=new class{constructor(){this.size=0}get key(){throw T()}get value(){throw T()}get color(){throw T()}get left(){throw T()}get right(){throw T()}copy(e,t,r,n,i){return this}insert(e,t,r){return new Or(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class C{constructor(e){this.comparator=e,this.data=new A(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(r){this.data.inorderTraversal((e,t)=>(r(e),!1))}forEachInRange(e,t){for(var r=this.data.getIteratorFrom(e[0]);r.hasNext();){var n=r.getNext();if(0<=this.comparator(n.key,e[1]))return;t(n.key)}}forEachWhile(e,t){for(var r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Mr(this.data.getIterator())}getIteratorFrom(e){return new Mr(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof C))return!1;if(this.size!==e.size)return!1;for(var r=this.data.getIterator(),n=e.data.getIterator();r.hasNext();){let e=r.getNext().key,t=n.getNext().key;if(0!==this.comparator(e,t))return!1}return!0}toArray(){let t=[];return this.forEach(e=>{t.push(e)}),t}toString(){let t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(e){var t=new C(this.comparator);return t.data=e,t}}class Mr{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Vr(e){return e.hasNext()?e.getNext():void 0}class Fr{constructor(e){(this.fields=e).sort(v.comparator)}static empty(){return new Fr([])}unionWith(e){let t=new C(v.comparator);for(let e of this.fields)t=t.add(e);for(var r of e)t=t.add(r);return new Fr(t.toArray())}covers(e){for(var t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return De(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class Pr extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class D{constructor(e){this.binaryString=e}static fromBase64String(e){var t=(e=>{try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Pr("Invalid base64 string: "+e):e}})(e);return new D(t)}static fromUint8Array(e){var t=(e=>{let t="";for(let r=0;r<e.length;++r)t+=String.fromCharCode(e[r]);return t})(e);return new D(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){var e=this.binaryString,t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return E(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}D.EMPTY_BYTE_STRING=new D("");let Ur=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Br(t){if(y(!!t),"string"!=typeof t)return{seconds:N(t.seconds),nanos:N(t.nanos)};{let e=0;var r=Ur.exec(t),r=(y(!!r),r[1]&&(r=((r=r[1])+"000000000").substr(0,9),e=Number(r)),new Date(t));return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}}function N(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function qr(e){return"string"==typeof e?D.fromBase64String(e):D.fromUint8Array(e)}let jr="server_timestamp",zr="__type__",Gr="__previous_value__",Kr="__local_write_time__";function Qr(e){var t;return(null==(t=((null==(t=null==e?void 0:e.mapValue)?void 0:t.fields)||{})[zr])?void 0:t.stringValue)===jr}function $r(e){var t=e.mapValue.fields[Gr];return Qr(t)?$r(t):t}function Hr(e){var t=Br(e.mapValue.fields[Kr].timestampValue);return new h(t.seconds,t.nanos)}class Wr{constructor(e,t,r,n,i,s,a,o,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=n,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=l}}let Yr="(default)";class Xr{constructor(e,t){this.projectId=e,this.database=t||Yr}static empty(){return new Xr("","")}get isDefaultDatabase(){return this.database===Yr}isEqual(e){return e instanceof Xr&&e.projectId===this.projectId&&e.database===this.database}}let Jr="__type__",Zr="__max__",en={mapValue:{fields:{__type__:{stringValue:Zr}}}},tn="__vector__",rn="value",nn={nullValue:"NULL_VALUE"};function sn(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Qr(e)?4:_n(e)?9007199254740991:vn(e)?10:11:T()}function an(t,r){if(t===r)return!0;var n,i,s,a,o,e=sn(t);if(e!==sn(r))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===r.booleanValue;case 4:return Hr(t).isEqual(Hr(r));case 3:return s=r,"string"==typeof(i=t).timestampValue&&"string"==typeof s.timestampValue&&i.timestampValue.length===s.timestampValue.length?i.timestampValue===s.timestampValue:(a=Br(i.timestampValue),o=Br(s.timestampValue),a.seconds===o.seconds&&a.nanos===o.nanos);case 5:return t.stringValue===r.stringValue;case 6:return i=r,qr(t.bytesValue).isEqual(qr(i.bytesValue));case 7:return t.referenceValue===r.referenceValue;case 8:return s=r,N((n=t).geoPointValue.latitude)===N(s.geoPointValue.latitude)&&N(n.geoPointValue.longitude)===N(s.geoPointValue.longitude);case 2:return n=r,"integerValue"in(u=t)&&"integerValue"in n?N(u.integerValue)===N(n.integerValue):"doubleValue"in u&&"doubleValue"in n&&((a=N(u.doubleValue))===(o=N(n.doubleValue))?ct(a)===ct(o):isNaN(a)&&isNaN(o));case 9:return De(t.arrayValue.values||[],r.arrayValue.values||[],an);case 10:case 11:var l=t,u=r,h=l.mapValue.fields||{},c=u.mapValue.fields||{};if(Nr(h)!==Nr(c))return!1;for(let e in h)if(h.hasOwnProperty(e)&&(void 0===c[e]||!an(h[e],c[e])))return!1;return!0;default:return T()}}function on(e,t){return void 0!==(e.values||[]).find(e=>an(e,t))}function ln(e,n){if(e===n)return 0;var i,s,a,o,l,u,h,c,t=sn(e),r=sn(n);if(t!==r)return E(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return E(e.booleanValue,n.booleanValue);case 2:return u=n,h=N((l=e).integerValue||l.doubleValue),c=N(u.integerValue||u.doubleValue),h<c?-1:c<h?1:h===c?0:isNaN(h)?isNaN(c)?0:-1:1;case 3:return un(e.timestampValue,n.timestampValue);case 4:return un(Hr(e),Hr(n));case 5:return Ae(e.stringValue,n.stringValue);case 6:return l=e.bytesValue,u=n.bytesValue,h=qr(l),c=qr(u),h.compareTo(c);case 7:var d=e.referenceValue,f=n.referenceValue,g=d.split("/"),m=f.split("/");for(let t=0;t<g.length&&t<m.length;t++){let e=E(g[t],m[t]);if(0!==e)return e}return E(g.length,m.length);case 8:return d=e.geoPointValue,f=n.geoPointValue,0!==(o=E(N(d.latitude),N(f.latitude)))?o:E(N(d.longitude),N(f.longitude));case 9:return hn(e.arrayValue,n.arrayValue);case 10:return p=e.mapValue,i=n.mapValue,o=p.fields||{},s=i.fields||{},o=null==(o=o[rn])?void 0:o.arrayValue,s=null==(s=s[rn])?void 0:s.arrayValue,0!==(a=E((null==(a=null==o?void 0:o.values)?void 0:a.length)||0,(null==(a=null==s?void 0:s.values)?void 0:a.length)||0))?a:hn(o,s);case 11:var p=e.mapValue,y=n.mapValue;if(p===en.mapValue&&y===en.mapValue)return 0;if(p===en.mapValue)return 1;if(y===en.mapValue)return-1;var v=p.fields||{},w=Object.keys(v),_=y.fields||{},b=Object.keys(_);w.sort(),b.sort();for(let r=0;r<w.length&&r<b.length;++r){let e=Ae(w[r],b[r]);if(0!==e)return e;var I=ln(v[w[r]],_[b[r]]);if(0!==I)return I}return E(w.length,b.length);default:throw T()}}function un(e,t){var r,n,i;return"string"==typeof e&&"string"==typeof t&&e.length===t.length?E(e,t):(r=Br(e),n=Br(t),0!==(i=E(r.seconds,n.seconds))?i:E(r.nanos,n.nanos))}function hn(e,t){var r=e.values||[],n=t.values||[];for(let i=0;i<r.length&&i<n.length;++i){let e=ln(r[i],n[i]);if(e)return e}return E(r.length,n.length)}function cn(e){return function s(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(e=>{let t=Br(e);return`time(${t.seconds},${t.nanos})`})(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?(e=>qr(e).toBase64())(e.bytesValue):"referenceValue"in e?(e=>x.fromName(e).toString())(e.referenceValue):"geoPointValue"in e?(e=>`geo(${e.latitude},${e.longitude})`)(e.geoPointValue):"arrayValue"in e?(e=>{let t="[",r=!0;for(var n of e.values||[])r?r=!1:t+=",",t+=s(n);return t+"]"})(e.arrayValue):"mapValue"in e?(e=>{let t=Object.keys(e.fields||{}).sort(),r="{",n=!0;for(var i of t)n?n=!1:r+=",",r+=i+":"+s(e.fields[i]);return r+"}"})(e.mapValue):T()}(e)}function dn(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/`+t.path.canonicalString()}}function fn(e){return!!e&&"integerValue"in e}function gn(e){return!!e&&"arrayValue"in e}function mn(e){return e&&"nullValue"in e}function pn(e){return e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function yn(e){return e&&"mapValue"in e}function vn(e){var t;return(null==(t=((null==(t=null==e?void 0:e.mapValue)?void 0:t.fields)||{})[Jr])?void 0:t.stringValue)===tn}function wn(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let r={mapValue:{fields:{}}};return kr(t.mapValue.fields,(e,t)=>r.mapValue.fields[e]=wn(t)),r}if(t.arrayValue){var r={arrayValue:{values:[]}};for(let e=0;e<(t.arrayValue.values||[]).length;++e)r.arrayValue.values[e]=wn(t.arrayValue.values[e]);return r}return Object.assign({},t)}function _n(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Zr}let bn={mapValue:{fields:{[Jr]:{stringValue:tn},[rn]:{arrayValue:{}}}}};function In(e,t){var r=ln(e.value,t.value);return 0!==r?r:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function Tn(e,t){var r=ln(e.value,t.value);return 0!==r?r:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class En{constructor(e){this.value=e}static empty(){return new En({mapValue:{}})}field(r){if(r.isEmpty())return this.value;{let e=this.value;for(let t=0;t<r.length-1;++t)if(!yn(e=(e.mapValue.fields||{})[r.get(t)]))return null;return(e=(e.mapValue.fields||{})[r.lastSegment()])||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=wn(t)}setAll(e){let r=v.emptyPath(),n={},i=[];e.forEach((e,t)=>{if(!r.isImmediateParentOf(t)){let e=this.getFieldsMap(r);this.applyChanges(e,n,i),n={},i=[],r=t.popLast()}e?n[t.lastSegment()]=wn(e):i.push(t.lastSegment())});var t=this.getFieldsMap(r);this.applyChanges(t,n,i)}delete(e){var t=this.field(e.popLast());yn(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return an(this.value,e.value)}getFieldsMap(t){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<t.length;++n){let e=r.mapValue.fields[t.get(n)];yn(e)&&e.mapValue.fields||(e={mapValue:{fields:{}}},r.mapValue.fields[t.get(n)]=e),r=e}return r.mapValue.fields}applyChanges(r,e,t){kr(e,(e,t)=>r[e]=t);for(let e of t)delete r[e]}clone(){return new En(wn(this.value))}}class k{constructor(e,t,r,n,i,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=n,this.createTime=i,this.data=s,this.documentState=a}static newInvalidDocument(e){return new k(e,0,g.min(),g.min(),g.min(),En.empty(),0)}static newFoundDocument(e,t,r,n){return new k(e,1,t,g.min(),r,n,0)}static newNoDocument(e,t){return new k(e,2,t,g.min(),g.min(),En.empty(),0)}static newUnknownDocument(e,t){return new k(e,3,t,g.min(),g.min(),En.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(g.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=En.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=En.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=g.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof k&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new k(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Sn{constructor(e,t){this.position=e,this.inclusive=t}}function xn(e,t,r){let n=0;for(let a=0;a<e.position.length;a++){var i=t[a],s=e.position[a];if(n=i.field.isKeyField()?x.comparator(x.fromName(s.referenceValue),r.key):ln(s,r.data.field(i.field)),"desc"===i.dir&&(n*=-1),0!==n)break}return n}function An(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!an(e.position[r],t.position[r]))return!1;return!0}class Cn{constructor(e,t="asc"){this.field=e,this.dir=t}}class Dn{}class R extends Dn{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new Vn(e,t,r):"array-contains"===t?new Bn(e,r):"in"===t?new qn(e,r):"not-in"===t?new jn(e,r):"array-contains-any"===t?new zn(e,r):new R(e,t,r)}static createKeyFieldInFilter(e,t,r){return new("in"===t?Fn:Pn)(e,r)}matches(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(ln(t,this.value)):null!==t&&sn(this.value)===sn(t)&&this.matchesComparison(ln(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return 0<e;case">=":return 0<=e;default:return T()}}isInequality(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class L extends Dn{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new L(e,t)}matches(t){return Nn(this)?void 0===this.filters.find(e=>!e.matches(t)):void 0!==this.filters.find(e=>e.matches(t))}getFlattenedFilters(){return null===this.ce&&(this.ce=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function Nn(e){return"and"===e.op}function kn(e){return"or"===e.op}function Rn(e){return Ln(e)&&Nn(e)}function Ln(e){for(var t of e.filters)if(t instanceof L)return!1;return!0}function On(e,t){var r=e.filters.concat(t);return L.create(r,e.op)}function Mn(e){return e instanceof R?`${(t=e).field.canonicalString()} ${t.op} `+cn(t.value):e instanceof L?(t=e).op.toString()+" {"+t.getFilters().map(Mn).join(" ,")+"}":"Filter";var t}class Vn extends R{constructor(e,t,r){super(e,t,r),this.key=x.fromName(r.referenceValue)}matches(e){var t=x.comparator(e.key,this.key);return this.matchesComparison(t)}}class Fn extends R{constructor(e,t){super(e,"in",t),this.keys=Un(0,t)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class Pn extends R{constructor(e,t){super(e,"not-in",t),this.keys=Un(0,t)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function Un(e,t){var r;return((null==(r=t.arrayValue)?void 0:r.values)||[]).map(e=>x.fromName(e.referenceValue))}class Bn extends R{constructor(e,t){super(e,"array-contains",t)}matches(e){var t=e.data.field(this.field);return gn(t)&&on(t.arrayValue,this.value)}}class qn extends R{constructor(e,t){super(e,"in",t)}matches(e){var t=e.data.field(this.field);return null!==t&&on(this.value.arrayValue,t)}}class jn extends R{constructor(e,t){super(e,"not-in",t)}matches(e){var t;return!on(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&null!==(t=e.data.field(this.field))&&!on(this.value.arrayValue,t)}}class zn extends R{constructor(e,t){super(e,"array-contains-any",t)}matches(e){var t=e.data.field(this.field);return!(!gn(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>on(this.value.arrayValue,e))}}class Gn{constructor(e,t=null,r=[],n=[],i=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=n,this.limit=i,this.startAt=s,this.endAt=a,this.le=null}}function Kn(e,t=null,r=[],n=[],i=null,s=null,a=null){return new Gn(e,t,r,n,i,s,a)}function Qn(e){var t=e;if(null===t.le){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e=(e=(e+="|f:")+t.filters.map(e=>function t(e){var r;return e instanceof R?e.field.canonicalString()+e.op.toString()+cn(e.value):Rn(e)?e.filters.map(e=>t(e)).join(","):(r=e.filters.map(e=>t(e)).join(","),e.op+`(${r})`)}(e)).join(",")+"|ob:")+t.orderBy.map(e=>(e=e).field.canonicalString()+e.dir).join(","),ht(t.limit)||(e=(e+="|l:")+t.limit),t.startAt&&(e=(e=(e+="|lb:")+(t.startAt.inclusive?"b:":"a:"))+t.startAt.position.map(e=>cn(e)).join(",")),t.endAt&&(e=(e=(e+="|ub:")+(t.endAt.inclusive?"a:":"b:"))+t.endAt.position.map(e=>cn(e)).join(",")),t.le=e}return t.le}function $n(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let i=0;i<e.orderBy.length;i++)if(r=e.orderBy[i],n=t.orderBy[i],r.dir!==n.dir||!r.field.isEqual(n.field))return!1;var r,n;if(e.filters.length!==t.filters.length)return!1;for(let s=0;s<e.filters.length;s++)if(!function n(e,t){return e instanceof R?(r=e,(s=t)instanceof R&&r.op===s.op&&r.field.isEqual(s.field)&&an(r.value,s.value)):e instanceof L?(r=e,(i=t)instanceof L&&r.op===i.op&&r.filters.length===i.filters.length&&r.filters.reduce((e,t,r)=>e&&n(t,i.filters[r]),!0)):void T();var i,r,s}(e.filters[s],t.filters[s]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!An(e.startAt,t.startAt)&&An(e.endAt,t.endAt)}function Hn(e){return x.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function Wn(e,t){return e.filters.filter(e=>e instanceof R&&e.field.isEqual(t))}function Yn(e,r,n){let i=nn,s=!0;for(let n of Wn(e,r)){let e=nn,t=!0;switch(n.op){case"<":case"<=":e="nullValue"in(a=n.value)?nn:"booleanValue"in a?{booleanValue:!1}:"integerValue"in a||"doubleValue"in a?{doubleValue:NaN}:"timestampValue"in a?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in a?{stringValue:""}:"bytesValue"in a?{bytesValue:""}:"referenceValue"in a?dn(Xr.empty(),x.empty()):"geoPointValue"in a?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in a?{arrayValue:{}}:"mapValue"in a?vn(a)?bn:{mapValue:{}}:T();break;case"==":case"in":case">=":e=n.value;break;case">":e=n.value,t=!1;break;case"!=":case"not-in":e=nn}In({value:i,inclusive:s},{value:e,inclusive:t})<0&&(i=e,s=t)}var a;if(null!==n)for(let t=0;t<e.orderBy.length;++t)if(e.orderBy[t].field.isEqual(r)){let e=n.position[t];In({value:i,inclusive:s},{value:e,inclusive:n.inclusive})<0&&(i=e,s=n.inclusive);break}return{value:i,inclusive:s}}function Xn(e,r,n){let i=en,s=!0;for(let n of Wn(e,r)){let e=en,t=!0;switch(n.op){case">=":case">":e="nullValue"in(a=n.value)?{booleanValue:!1}:"booleanValue"in a?{doubleValue:NaN}:"integerValue"in a||"doubleValue"in a?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in a?{stringValue:""}:"stringValue"in a?{bytesValue:""}:"bytesValue"in a?dn(Xr.empty(),x.empty()):"referenceValue"in a?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in a?{arrayValue:{}}:"arrayValue"in a?bn:"mapValue"in a?vn(a)?{mapValue:{}}:en:T(),t=!1;break;case"==":case"in":case"<=":e=n.value;break;case"<":e=n.value,t=!1;break;case"!=":case"not-in":e=en}0<Tn({value:i,inclusive:s},{value:e,inclusive:t})&&(i=e,s=t)}var a;if(null!==n)for(let t=0;t<e.orderBy.length;++t)if(e.orderBy[t].field.isEqual(r)){let e=n.position[t];0<Tn({value:i,inclusive:s},{value:e,inclusive:n.inclusive})&&(i=e,s=n.inclusive);break}return{value:i,inclusive:s}}class Jn{constructor(e,t=null,r=[],n=[],i=null,s="F",a=null,o=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=n,this.limit=i,this.limitType=s,this.startAt=a,this.endAt=o,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function Zn(e,t,r,n,i,s,a,o){return new Jn(e,t,r,n,i,s,a,o)}function ei(e){return new Jn(e)}function ti(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function ri(e){return null!==e.collectionGroup}function ni(e){let n=e;if(null===n.he){n.he=[];let t=new Set;for(var i of n.explicitOrderBy)n.he.push(i),t.add(i.field.canonicalString());let r=0<n.explicitOrderBy.length?n.explicitOrderBy[n.explicitOrderBy.length-1].dir:"asc",e=(e=>{let t=new C(v.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t})(n);e.forEach(e=>{t.has(e.canonicalString())||e.isKeyField()||n.he.push(new Cn(e,r))}),t.has(v.keyField().canonicalString())||n.he.push(new Cn(v.keyField(),r))}return n.he}function ii(e){var t=e;return t.Pe||(t.Pe=((e,t)=>{if("F"===e.limitType)return Kn(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);t=t.map(e=>{var t="desc"===e.dir?"asc":"desc";return new Cn(e.field,t)});var r=e.endAt?new Sn(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new Sn(e.startAt.position,e.startAt.inclusive):null;return Kn(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)})(t,ni(e))),t.Pe}function si(e,t){var r=e.filters.concat([t]);return new Jn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)}function ai(e,t,r){return new Jn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function oi(e,t){return $n(ii(e),ii(t))&&e.limitType===t.limitType}function li(e){return Qn(ii(e))+"|lt:"+e.limitType}function ui(e){return`Query(target=${(e=>{let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(t+=`, filters: [${e.filters.map(e=>Mn(e)).join(", ")}]`),ht(e.limit)||(t+=", limit: "+e.limit),0<e.orderBy.length&&(t+=`, orderBy: [${e.orderBy.map(e=>`${(e=e).field.canonicalString()} (${e.dir})`).join(", ")}]`),e.startAt&&(t=(t=(t+=", startAt: ")+(e.startAt.inclusive?"b:":"a:"))+e.startAt.position.map(e=>cn(e)).join(",")),`Target(${t=e.endAt?(t=(t+=", endAt: ")+(e.endAt.inclusive?"a:":"b:"))+e.endAt.position.map(e=>cn(e)).join(","):t})`})(ii(e))}; limitType=${e.limitType})`}function hi(e,t){return t.isFoundDocument()&&(s=e,o=(a=t).key.path,null!==s.collectionGroup?a.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(o):x.isDocumentKey(s.path)?s.path.isEqual(o):s.path.isImmediateParentOf(o))&&((e,t)=>{for(var r of ni(e))if(!r.field.isKeyField()&&null===t.data.field(r.field))return;return 1})(e,t)&&((e,t)=>{for(var r of e.filters)if(!r.matches(t))return;return 1})(e,t)&&(a=t,!(s=e).startAt||(n=s.startAt,r=ni(s),i=xn(n,r,a),n.inclusive?i<=0:i<0))&&(!s.endAt||(r=s.endAt,n=ni(s),i=xn(r,n,a),r.inclusive?0<=i:0<i));var r,n,i,s,a,o}function ci(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function di(e){return(t,r)=>{let n=!1;for(var i of ni(e)){let e=((e,t,r)=>{var n=e.field.isKeyField()?x.comparator(t.key,r.key):((e,t,r)=>{var n=t.data.field(e),i=r.data.field(e);return null!==n&&null!==i?ln(n,i):T()})(e.field,t,r);switch(e.dir){case"asc":return n;case"desc":return-1*n;default:return T()}})(i,t,r);if(0!==e)return e;n=n||i.field.isKeyField()}return 0}}class fi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(r){let e=this.mapKeyFn(r),n=this.inner[e];if(void 0!==n)for(let[e,t]of n)if(this.equalsFn(e,r))return t}has(e){return void 0!==this.get(e)}set(t,r){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)this.inner[e]=[[t,r]];else{for(let e=0;e<n.length;e++)if(this.equalsFn(n[e][0],t))return void(n[e]=[t,r]);n.push([t,r])}this.innerSize++}delete(t){var r=this.mapKeyFn(t),n=this.inner[r];if(void 0!==n)for(let e=0;e<n.length;e++)if(this.equalsFn(n[e][0],t))return 1===n.length?delete this.inner[r]:n.splice(e,1),this.innerSize--,!0;return!1}forEach(n){kr(this.inner,(e,t)=>{for(let[e,r]of t)n(e,r)})}isEmpty(){return Rr(this.inner)}size(){return this.innerSize}}let gi=new A(x.comparator);let mi=new A(x.comparator);function pi(...e){let t=mi;for(var r of e)t=t.insert(r.key,r);return t}function yi(e){let r=mi;return e.forEach((e,t)=>r=r.insert(e,t.overlayedDocument)),r}function vi(){return new fi(e=>e.toString(),(e,t)=>e.isEqual(t))}let wi=new A(x.comparator),_i=new C(x.comparator);function O(...e){let t=_i;for(var r of e)t=t.add(r);return t}let bi=new C(E);function Ii(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ct(t)?"-0":t}}function Ti(e){return{integerValue:""+e}}function Ei(e,t){return dt(t)?Ti(t):Ii(e,t)}class Si{constructor(){this._=void 0}}function xi(e,t){return e instanceof Ri?fn(e=t)||(e=e)&&"doubleValue"in e?t:{integerValue:0}:null}class Ai extends Si{}class Ci extends Si{constructor(e){super(),this.elements=e}}function Di(e,t){var r=Oi(t);for(let t of e.elements)r.some(e=>an(e,t))||r.push(t);return{arrayValue:{values:r}}}class Ni extends Si{constructor(e){super(),this.elements=e}}function ki(e,t){let r=Oi(t);for(let t of e.elements)r=r.filter(e=>!an(e,t));return{arrayValue:{values:r}}}class Ri extends Si{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function Li(e){return N(e.integerValue||e.doubleValue)}function Oi(e){return gn(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Mi{constructor(e,t){this.field=e,this.transform=t}}class Vi{constructor(e,t){this.version=e,this.transformResults=t}}class M{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new M}static exists(e){return new M(void 0,e)}static updateTime(e){return new M(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Fi(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Pi{}function Ui(e,r){if(!e.hasLocalMutations||r&&0===r.fields.length)return null;if(null===r)return e.isNoDocument()?new $i(e.key,M.none()):new ji(e.key,e.data,M.none());{var n,i=e.data,s=En.empty();let t=new C(v.comparator);for(n of r.fields)if(!t.has(n)){let e=i.field(n);null===e&&1<n.length&&(n=n.popLast(),e=i.field(n)),null===e?s.delete(n):s.set(n,e),t=t.add(n)}return new zi(e.key,s,new Fr(t.toArray()),M.none())}}function Bi(e,t,r,n){return e instanceof ji?(s=t,a=r,o=n,Fi((i=e).precondition,s)?(l=i.value.clone(),u=Qi(i.fieldTransforms,o,s),l.setAll(u),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null):a):e instanceof zi?(i=t,o=r,s=n,Fi((a=e).precondition,i)?(u=Qi(a.fieldTransforms,s,i),(l=i.data).setAll(Gi(a)),l.setAll(u),i.convertToFoundDocument(i.version,l).setHasLocalMutations(),null===o?null:o.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(e=>e.field))):o):(n=t,t=r,Fi(e.precondition,n)?(n.convertToNoDocument(n.version).setHasLocalMutations(),null):t);var i,s,a,o,l,u}function qi(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(r=e.fieldTransforms,n=t.fieldTransforms,!!(void 0===r&&void 0===n||r&&n&&De(r,n,(e,t)=>(t=t,(e=e).field.isEqual(t.field)&&(e=e.transform,t=t.transform,e instanceof Ci&&t instanceof Ci||e instanceof Ni&&t instanceof Ni?De(e.elements,t.elements,an):e instanceof Ri&&t instanceof Ri?an(e.Ie,t.Ie):e instanceof Ai&&t instanceof Ai)))))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask));var r,n}class ji extends Pi{constructor(e,t,r,n=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=n,this.type=0}getFieldMask(){return null}}class zi extends Pi{constructor(e,t,r,n,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=n,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Gi(r){let n=new Map;return r.fieldMask.fields.forEach(e=>{var t;e.isEmpty()||(t=r.data.field(e),n.set(e,t))}),n}function Ki(e,t,r){var n,i,s,a=new Map;y(e.length===r.length);for(let h=0;h<r.length;h++){var o=e[h],l=o.transform,u=t.data.field(o.field);a.set(o.field,(n=l,i=u,s=r[h],n instanceof Ci?Di(n,i):n instanceof Ni?ki(n,i):s))}return a}function Qi(e,r,n){var i,s,a,o,l,u,h,c=new Map;for(i of e){let e=i.transform,t=n.data.field(i.field);c.set(i.field,(s=e,a=t,o=r,h=u=l=void 0,s instanceof Ai?(o=o,u=a,h={fields:{[zr]:{stringValue:jr},[Kr]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}},(u=u&&Qr(u)?$r(u):u)&&(h.fields[Gr]=u),{mapValue:h}):s instanceof Ci?Di(s,a):s instanceof Ni?ki(s,a):(h=xi(o=s,a),l=Li(h)+Li(o.Ie),fn(h)&&fn(o.Ie)?Ti(l):Ii(o.serializer,l))))}return c}class $i extends Pi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Hi extends Pi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Wi{constructor(e,t,r,n){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=n}applyToRemoteDocument(e,t){var r,n,i,s,a,o,l,u=t.mutationResults;for(let c=0;c<this.mutations.length;c++){var h=this.mutations[c];h.key.isEqual(e.key)&&(r=h,n=e,i=u[c],l=h=o=a=s=void 0,r instanceof ji?(a=n,o=i,h=(s=r).value.clone(),l=Ki(s.fieldTransforms,a,o.transformResults),h.setAll(l),a.convertToFoundDocument(o.version,h).setHasCommittedMutations()):r instanceof zi?(s=n,a=i,Fi((o=r).precondition,s)?(l=Ki(o.fieldTransforms,s,a.transformResults),(h=s.data).setAll(Gi(o)),h.setAll(l),s.convertToFoundDocument(a.version,h).setHasCommittedMutations()):s.convertToUnknownDocument(a.version)):n.convertToNoDocument(i.version).setHasCommittedMutations())}}applyToLocalView(e,t){for(var r of this.baseMutations)r.key.isEqual(e.key)&&(t=Bi(r,e,t,this.localWriteTime));for(var n of this.mutations)n.key.isEqual(e.key)&&(t=Bi(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(n,i){let s=vi();return this.mutations.forEach(e=>{var t=n.get(e.key),r=t.overlayedDocument,t=this.applyToLocalView(r,t.mutatedFields),t=Ui(r,i.has(e.key)?null:t);null!==t&&s.set(e.key,t),r.isValidDocument()||r.convertToNoDocument(g.min())}),s}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),O())}isEqual(e){return this.batchId===e.batchId&&De(this.mutations,e.mutations,(e,t)=>qi(e,t))&&De(this.baseMutations,e.baseMutations,(e,t)=>qi(e,t))}}class Yi{constructor(e,t,r,n){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=n}static from(e,t,r){y(e.mutations.length===r.length);let n=wi;var i=e.mutations;for(let s=0;s<i.length;s++)n=n.insert(i[s].key,r[s].version);return new Yi(e,t,r,n)}}class Xi{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class Ji{constructor(e,t){this.count=e,this.unchangedNames=t}}function Zi(e){switch(e){case b.OK:return T();case b.CANCELLED:case b.UNKNOWN:case b.DEADLINE_EXCEEDED:case b.RESOURCE_EXHAUSTED:case b.INTERNAL:case b.UNAVAILABLE:case b.UNAUTHENTICATED:return!1;case b.INVALID_ARGUMENT:case b.NOT_FOUND:case b.ALREADY_EXISTS:case b.PERMISSION_DENIED:case b.FAILED_PRECONDITION:case b.ABORTED:case b.OUT_OF_RANGE:case b.UNIMPLEMENTED:case b.DATA_LOSS:return!0;default:return T()}}function es(e){if(void 0===e)return d("GRPC error has no .code"),b.UNKNOWN;switch(e){case m.OK:return b.OK;case m.CANCELLED:return b.CANCELLED;case m.UNKNOWN:return b.UNKNOWN;case m.DEADLINE_EXCEEDED:return b.DEADLINE_EXCEEDED;case m.RESOURCE_EXHAUSTED:return b.RESOURCE_EXHAUSTED;case m.INTERNAL:return b.INTERNAL;case m.UNAVAILABLE:return b.UNAVAILABLE;case m.UNAUTHENTICATED:return b.UNAUTHENTICATED;case m.INVALID_ARGUMENT:return b.INVALID_ARGUMENT;case m.NOT_FOUND:return b.NOT_FOUND;case m.ALREADY_EXISTS:return b.ALREADY_EXISTS;case m.PERMISSION_DENIED:return b.PERMISSION_DENIED;case m.FAILED_PRECONDITION:return b.FAILED_PRECONDITION;case m.ABORTED:return b.ABORTED;case m.OUT_OF_RANGE:return b.OUT_OF_RANGE;case m.UNIMPLEMENTED:return b.UNIMPLEMENTED;case m.DATA_LOSS:return b.DATA_LOSS;default:return T()}}(e=m=m||{})[e.OK=0]="OK",e[e.CANCELLED=1]="CANCELLED",e[e.UNKNOWN=2]="UNKNOWN",e[e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",e[e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",e[e.NOT_FOUND=5]="NOT_FOUND",e[e.ALREADY_EXISTS=6]="ALREADY_EXISTS",e[e.PERMISSION_DENIED=7]="PERMISSION_DENIED",e[e.UNAUTHENTICATED=16]="UNAUTHENTICATED",e[e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",e[e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",e[e.ABORTED=10]="ABORTED",e[e.OUT_OF_RANGE=11]="OUT_OF_RANGE",e[e.UNIMPLEMENTED=12]="UNIMPLEMENTED",e[e.INTERNAL=13]="INTERNAL",e[e.UNAVAILABLE=14]="UNAVAILABLE",e[e.DATA_LOSS=15]="DATA_LOSS";let ts=new oe([4294967295,4294967295],0);function rs(e){var t=Se().encode(e),r=new le;return r.update(t),new Uint8Array(r.digest())}function ns(e){var t=new DataView(e.buffer),r=t.getUint32(0,!0),n=t.getUint32(4,!0),i=t.getUint32(8,!0),t=t.getUint32(12,!0);return[new oe([r,n],0),new oe([i,t],0)]}class is{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||8<=t)throw new ss("Invalid padding: "+t);if(r<0)throw new ss("Invalid hash count: "+r);if(0<e.length&&0===this.hashCount)throw new ss("Invalid hash count: "+r);if(0===e.length&&0!==t)throw new ss("Invalid padding when bitmap length is 0: "+t);this.Ee=8*e.length-t,this.de=oe.fromNumber(this.Ee)}Ae(e,t,r){let n=e.add(t.multiply(oe.fromNumber(r)));return(n=1===n.compare(ts)?new oe([n.getBits(0),n.getBits(1)],0):n).modulo(this.de).toNumber()}Re(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ee)return!1;let t=rs(e),[r,n]=ns(t);for(let i=0;i<this.hashCount;i++){let e=this.Ae(r,n,i);if(!this.Re(e))return!1}return!0}static create(e,t,r){let n=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new is(i,n,t);return r.forEach(e=>s.insert(e)),s}insert(i){if(0!==this.Ee){let e=rs(i),[t,r]=ns(e);for(let n=0;n<this.hashCount;n++){let e=this.Ae(t,r,n);this.Ve(e)}}}Ve(e){var t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class ss extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class as{constructor(e,t,r,n,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=n,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){var n=new Map;return n.set(e,os.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new as(g.min(),n,new A(E),gi,O())}}class os{constructor(e,t,r,n,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=n,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new os(r,t,O(),O(),O())}}class ls{constructor(e,t,r,n){this.me=e,this.removedTargetIds=t,this.key=r,this.fe=n}}class us{constructor(e,t){this.targetId=e,this.ge=t}}class hs{constructor(e,t,r=D.EMPTY_BYTE_STRING,n=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=n}}class cs{constructor(){this.pe=0,this.ye=gs(),this.we=D.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return 0!==this.pe}get ve(){return this.be}Ce(e){0<e.approximateByteSize()&&(this.be=!0,this.we=e)}Fe(){let r=O(),n=O(),i=O();return this.ye.forEach((e,t)=>{switch(t){case 0:r=r.add(e);break;case 2:n=n.add(e);break;case 1:i=i.add(e);break;default:T()}}),new os(this.we,this.Se,r,n,i)}Me(){this.be=!1,this.ye=gs()}xe(e,t){this.be=!0,this.ye=this.ye.insert(e,t)}Oe(e){this.be=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){--this.pe,y(0<=this.pe)}Le(){this.be=!0,this.Se=!0}}class ds{constructor(e){this.ke=e,this.qe=new Map,this.Qe=gi,this.$e=fs(),this.Ue=fs(),this.Ke=new A(E)}We(e){for(var t of e.me)e.fe&&e.fe.isFoundDocument()?this.Ge(t,e.fe):this.ze(t,e.key,e.fe);for(var r of e.removedTargetIds)this.ze(r,e.key,e.fe)}je(r){this.forEachTarget(r,e=>{var t=this.He(e);switch(r.state){case 0:this.Je(e)&&t.Ce(r.resumeToken);break;case 1:t.Be(),t.De||t.Me(),t.Ce(r.resumeToken);break;case 2:t.Be(),t.De||this.removeTarget(e);break;case 3:this.Je(e)&&(t.Le(),t.Ce(r.resumeToken));break;case 4:this.Je(e)&&(this.Ye(e),t.Ce(r.resumeToken));break;default:T()}})}forEachTarget(e,r){0<e.targetIds.length?e.targetIds.forEach(r):this.qe.forEach((e,t)=>{this.Je(t)&&r(t)})}Ze(n){let i=n.targetId,e=n.ge.count,t=this.Xe(i);if(t){var r=t.target;if(Hn(r))if(0===e){let e=new x(r.path);this.ze(i,e,k.newNoDocument(e,g.min()))}else y(1===e);else{let r=this.et(i);if(r!==e){let e=this.tt(n),t=e?this.nt(e,n,r):1;if(0!==t){this.Ye(i);let e=2===t?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(i,e)}}}}}tt(e){var t=e.ge.unchangedNames;if(!t||!t.bits)return null;var{bits:{bitmap:t="",padding:r=0},hashCount:n=0}=t;let i,s;try{i=qr(t).toUint8Array()}catch(e){if(e instanceof Pr)return me("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{s=new is(i,r,n)}catch(e){return me(e instanceof ss?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===s.Ee?null:s}nt(e,t,r){return t.ge.count===r-this.st(e,t.targetId)?0:2}st(r,n){var e=this.ke.getRemoteKeysForTarget(n);let i=0;return e.forEach(e=>{var t=this.ke.it(),t=`projects/${t.projectId}/databases/${t.database}/documents/`+e.path.canonicalString();r.mightContain(t)||(this.ze(n,e,null),i++)}),i}ot(n){let i=new Map,s=(this.qe.forEach((e,t)=>{var r=this.Xe(t);if(r){if(e.current&&Hn(r.target)){let e=new x(r.target.path);this._t(e).has(t)||this.ut(t,e)||this.ze(t,e,k.newNoDocument(e,n))}e.ve&&(i.set(t,e.Fe()),e.Me())}}),O());this.Ue.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{var t=this.Xe(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1)}),r&&(s=s.add(e))}),this.Qe.forEach((e,t)=>t.setReadTime(n));var e=new as(n,i,this.Ke,this.Qe,s);return this.Qe=gi,this.$e=fs(),this.Ue=fs(),this.Ke=new A(E),e}Ge(e,t){var r;this.Je(e)&&(r=this.ut(e,t.key)?2:0,this.He(e).xe(t.key,r),this.Qe=this.Qe.insert(t.key,t),this.$e=this.$e.insert(t.key,this._t(t.key).add(e)),this.Ue=this.Ue.insert(t.key,this.ct(t.key).add(e)))}ze(e,t,r){var n;this.Je(e)&&(n=this.He(e),this.ut(e,t)?n.xe(t,1):n.Oe(t),this.Ue=this.Ue.insert(t,this.ct(t).delete(e)),this.Ue=this.Ue.insert(t,this.ct(t).add(e)),r)&&(this.Qe=this.Qe.insert(t,r))}removeTarget(e){this.qe.delete(e)}et(e){var t=this.He(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ne(e){this.He(e).Ne()}He(e){let t=this.qe.get(e);return t||(t=new cs,this.qe.set(e,t)),t}ct(e){let t=this.Ue.get(e);return t||(t=new C(E),this.Ue=this.Ue.insert(e,t)),t}_t(e){let t=this.$e.get(e);return t||(t=new C(E),this.$e=this.$e.insert(e,t)),t}Je(e){var t=null!==this.Xe(e);return t||p("WatchChangeAggregator","Detected inactive target",e),t}Xe(e){var t=this.qe.get(e);return t&&t.De?null:this.ke.lt(e)}Ye(t){this.qe.set(t,new cs),this.ke.getRemoteKeysForTarget(t).forEach(e=>{this.ze(t,e,null)})}ut(e,t){return this.ke.getRemoteKeysForTarget(e).has(t)}}function fs(){return new A(x.comparator)}function gs(){return new A(x.comparator)}let ms={asc:"ASCENDING",desc:"DESCENDING"},ps={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ys={and:"AND",or:"OR"};class vs{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ws(e,t){return e.useProto3Json||ht(t)?t:{value:t}}function _s(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function bs(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function V(e){return y(!!e),g.fromTimestamp((t=Br(e),new h(t.seconds,t.nanos)));var t}function Is(e,t){return Ts(e,t).canonicalString()}function Ts(e,t){e=e;var r=new S(["projects",e.projectId,"databases",e.database]).child("documents");return void 0===t?r:r.child(t)}function Es(e){var t=S.fromString(e);return y(Gs(t)),t}function Ss(e,t){return Is(e.databaseId,t.path)}function xs(e,t){var r=Es(t);if(r.get(1)!==e.databaseId.projectId)throw new I(b.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new I(b.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new x(Ns(r))}function As(e,t){return Is(e.databaseId,t)}function Cs(e){var t=Es(e);return 4===t.length?S.emptyPath():Ns(t)}function Ds(e){return new S(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Ns(e){return y(4<e.length&&"documents"===e.get(4)),e.popFirst(5)}function ks(e,t,r){return{name:Ss(e,t),fields:r.value.mapValue.fields}}function Rs(e,t,r){var n=xs(e,t.name),i=V(t.updateTime),s=t.createTime?V(t.createTime):g.min(),a=new En({mapValue:{fields:t.fields}}),n=k.newFoundDocument(n,i,s,a);return r&&n.setHasCommittedMutations(),r?n.setHasCommittedMutations():n}function Ls(e,t){let r;if(t instanceof ji)r={update:ks(e,t.key,t.value)};else if(t instanceof $i)r={delete:Ss(e,t.key)};else if(t instanceof zi)r={update:ks(e,t.key,t.data),updateMask:(e=>{let t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}})(t.fieldMask)};else{if(!(t instanceof Hi))return T();r={verify:Ss(e,t.key)}}return 0<t.fieldTransforms.length&&(r.updateTransforms=t.fieldTransforms.map(e=>{var t=e.transform;if(t instanceof Ai)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(t instanceof Ci)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:t.elements}};if(t instanceof Ni)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:t.elements}};if(t instanceof Ri)return{fieldPath:e.field.canonicalString(),increment:t.Ie};throw T()})),t.precondition.isNone||(r.currentDocument=(e=e,void 0!==(t=t.precondition).updateTime?{updateTime:(n=t.updateTime,_s(e,n.toTimestamp()))}:void 0!==t.exists?{exists:t.exists}:T())),r;var n}function Os(i,t){let r=t.currentDocument?void 0!==(s=t.currentDocument).updateTime?M.updateTime(V(s.updateTime)):void 0!==s.exists?M.exists(s.exists):M.none():M.none(),n=t.updateTransforms?t.updateTransforms.map(r=>{{var e=i;let t=null;if("setToServerValue"in r)y("REQUEST_TIME"===r.setToServerValue),t=new Ai;else if("appendMissingElements"in r){let e=r.appendMissingElements.values||[];t=new Ci(e)}else if("removeAllFromArray"in r){let e=r.removeAllFromArray.values||[];t=new Ni(e)}else"increment"in r?t=new Ri(e,r.increment):T();var n=v.fromServerFormat(r.fieldPath);return new Mi(n,t)}}):[];var s,a;if(t.update){t.update.name;var o=xs(i,t.update.name),l=new En({mapValue:{fields:t.update.fields}});if(t.updateMask){s=t.updateMask,a=s.fieldPaths||[];let e=new Fr(a.map(e=>v.fromServerFormat(e)));return new zi(o,l,e,r,n)}return new ji(o,l,r,n)}if(t.delete){let e=xs(i,t.delete);return new $i(e,r)}if(t.verify){let e=xs(i,t.verify);return new Hi(e,r)}return T()}function Ms(e,n){return e&&0<e.length?(y(void 0!==n),e.map(t=>{{var r=n;let e=t.updateTime?V(t.updateTime):V(r);return e.isEqual(g.min())&&(e=V(r)),new Vi(e,t.transformResults||[])}})):[]}function Vs(e,t){return{documents:[As(e,t.path)]}}function Fs(e,t){var r={structuredQuery:{}},n=t.path;let i;null!==t.collectionGroup?(i=n,r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=As(e,i);n=(e=>{if(0!==e.length)return function r(e){return e instanceof R?(e=>{if("=="===e.op){if(pn(e.value))return{unaryFilter:{field:js(e.field),op:"IS_NAN"}};if(mn(e.value))return{unaryFilter:{field:js(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(pn(e.value))return{unaryFilter:{field:js(e.field),op:"IS_NOT_NAN"}};if(mn(e.value))return{unaryFilter:{field:js(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:js(e.field),op:Bs(e.op),value:e.value}}})(e):e instanceof L?(e=>{let t=e.getFilters().map(e=>r(e));return 1===t.length?t[0]:{compositeFilter:{op:qs(e.op),filters:t}}})(e):T()}(L.create(e,"and"))})(t.filters),n&&(r.structuredQuery.where=n),n=(e=>{if(0!==e.length)return e.map(e=>({field:js((e=e).field),direction:(e=e.dir,ms[e])}))})(t.orderBy),n&&(r.structuredQuery.orderBy=n),n=ws(e,t.limit);return null!==n&&(r.structuredQuery.limit=n),t.startAt&&(r.structuredQuery.startAt={before:(e=t.startAt).inclusive,values:e.position}),t.endAt&&(r.structuredQuery.endAt={before:!(e=t.endAt).inclusive,values:e.position}),{ht:r,parent:i}}function Ps(e){let t=Cs(e.parent);var r,n=e.structuredQuery,i=n.from?n.from.length:0;let s=null;if(0<i){y(1===i);let e=n.from[0];e.allDescendants?s=e.collectionId:t=t.child(e.collectionId)}let a=[],o=(n.where&&(a=(e=n.where,(i=function t(e){return void 0!==e.unaryFilter?(i=>{switch(i.unaryFilter.op){case"IS_NAN":let e=zs(i.unaryFilter.field);return R.create(e,"==",{doubleValue:NaN});case"IS_NULL":let t=zs(i.unaryFilter.field);return R.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let r=zs(i.unaryFilter.field);return R.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let n=zs(i.unaryFilter.field);return R.create(n,"!=",{nullValue:"NULL_VALUE"});default:return T()}})(e):void 0!==e.fieldFilter?(e=>R.create(zs(e.fieldFilter.field),(e=>{switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return T()}})(e.fieldFilter.op),e.fieldFilter.value))(e):void 0!==e.compositeFilter?(e=>L.create(e.compositeFilter.filters.map(e=>t(e)),(e=>{switch(e){case"AND":return"and";case"OR":return"or";default:return T()}})(e.compositeFilter.op)))(e):T()}(e))instanceof L&&Rn(i)?i.getFilters():[i])),[]),l=(n.orderBy&&(o=n.orderBy.map(e=>(e=e,new Cn(zs(e.field),(e=>{switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(e.direction))))),null),u=(n.limit&&(l=(e=n.limit,ht(i="object"==typeof e?e.value:e)?null:i)),null),h=(n.startAt&&(u=(e=n.startAt,i=!!e.before,r=e.values||[],new Sn(r,i))),null);return n.endAt&&(h=(e=n.endAt,r=!e.before,i=e.values||[],new Sn(i,r))),Zn(t,s,o,a,l,"F",u,h)}function Us(e,t){var r=(e=>{switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return T()}})(t.purpose);return null==r?null:{"goog-listen-tags":r}}function Bs(e){return ps[e]}function qs(e){return ys[e]}function js(e){return{fieldPath:e.canonicalString()}}function zs(e){return v.fromServerFormat(e.fieldPath)}function Gs(e){return 4<=e.length&&"projects"===e.get(0)&&"databases"===e.get(2)}class Ks{constructor(e,t,r,n,i=g.min(),s=g.min(),a=D.EMPTY_BYTE_STRING,o=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=n,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(e){return new Ks(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ks(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ks(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ks(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Qs{constructor(e){this.Tt=e}}function $s(e,t){var r,n=t.key,i={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Hs(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())i.document={name:Ss(e=e.Tt,(r=t).key),fields:r.data.value.mapValue.fields,updateTime:_s(e,r.version.toTimestamp()),createTime:_s(e,r.createTime.toTimestamp())};else if(t.isNoDocument())i.noDocument={path:n.path.toArray(),readTime:Ws(t.version)};else{if(!t.isUnknownDocument())return T();i.unknownDocument={path:n.path.toArray(),version:Ws(t.version)}}return i}function Hs(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function Ws(e){var t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function Ys(e){var t=new h(e.seconds,e.nanoseconds);return g.fromTimestamp(t)}function Xs(t,r){let e=(r.baseMutations||[]).map(e=>Os(t.Tt,e));for(let s=0;s<r.mutations.length-1;++s){let t=r.mutations[s];if(s+1<r.mutations.length&&void 0!==r.mutations[s+1].transform){let e=r.mutations[s+1];t.updateTransforms=e.transform.fieldTransforms,r.mutations.splice(s+1,1),++s}}let n=r.mutations.map(e=>Os(t.Tt,e)),i=h.fromMillis(r.localWriteTimeMs);return new Wi(r.batchId,i,e,n)}function Js(e){var t,r=Ys(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?Ys(e.lastLimboFreeSnapshotVersion):g.min(),i=void 0!==e.query.documents?(y(1===(t=e.query).documents.length),ii(ei(Cs(t.documents[0])))):ii(Ps(e.query));return new Ks(i,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,r,n,D.fromBase64String(e.resumeToken))}function Zs(e,t){var r=Ws(t.snapshotVersion),n=Ws(t.lastLimboFreeSnapshotVersion),i=Hn(t.target)?Vs(e.Tt,t.target):Fs(e.Tt,t.target).ht,s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:Qn(t.target),readTime:r,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:i}}function ea(e){var t=Ps({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?ai(t,t.limit,"L"):t}function ta(e,t){return new Xi(t.largestBatchId,Os(e.Tt,t.overlayMutation))}function ra(e,t){var r=t.path.lastSegment();return[e,o(t.path.popLast()),r]}function na(e,t,r,n){return{indexId:e,uid:t,sequenceNumber:r,readTime:Ws(n.readTime),documentKey:o(n.documentKey.path),largestBatchId:n.largestBatchId}}class ia{getBundleMetadata(e,t){return sa(e).get(t).next(e=>{if(e)return{id:(e=e).bundleId,createTime:Ys(e.createTime),version:e.version}})}saveBundleMetadata(e,t){return sa(e).put({bundleId:(e=t).id,createTime:Ws(V(e.createTime)),version:e.version})}getNamedQuery(e,t){return aa(e).get(t).next(e=>{if(e)return{name:(e=e).name,query:ea(e.bundledQuery),readTime:Ys(e.readTime)}})}saveNamedQuery(e,t){return aa(e).put({name:(e=t).name,readTime:Ws(V(e.readTime)),bundledQuery:e.bundledQuery})}}function sa(e){return r(e,Ht)}function aa(e){return r(e,Wt)}class oa{constructor(e,t){this.serializer=e,this.userId=t}static It(e,t){var r=t.uid||"";return new oa(e,r)}getOverlay(e,t){return la(e).get(ra(this.userId,t)).next(e=>e?ta(this.serializer,e):null)}getOverlays(e,t){let r=vi();return w.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&r.set(t,e)})).next(()=>r)}saveOverlays(n,i,e){let s=[];return e.forEach((e,t)=>{var r=new Xi(i,t);s.push(this.Et(n,r))}),w.waitFor(s)}removeOverlaysForBatchId(r,e,n){let t=new Set,i=(e.forEach(e=>t.add(o(e.getCollectionPath()))),[]);return t.forEach(e=>{var t=IDBKeyRange.bound([this.userId,e,n],[this.userId,e,n+1],!1,!0);i.push(la(r).J(lr,t))}),w.waitFor(i)}getOverlaysForCollection(e,t,r){let n=vi(),i=o(t),s=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return la(e).G(lr,s).next(e=>{for(var t of e){let e=ta(this.serializer,t);n.set(e.getKey(),e)}return n})}getOverlaysForCollectionGroup(e,t,r,i){let s=vi(),a;var n=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return la(e).Z({index:hr,range:n},(e,t,r)=>{var n=ta(this.serializer,t);s.size()<i||n.largestBatchId===a?(s.set(n.getKey(),n),a=n.largestBatchId):r.done()}).next(()=>s)}Et(e,t){return la(e).put(((e,t,r)=>{var[,n,i]=ra(t,r.mutation.key);return{userId:t,collectionPath:n,documentId:i,collectionGroup:r.mutation.key.getCollectionGroup(),largestBatchId:r.largestBatchId,overlayMutation:Ls(e.Tt,r.mutation)}})(this.serializer,this.userId,t))}}function la(e){return r(e,ar)}class ua{dt(e){return r(e,dr)}getSessionToken(e){return this.dt(e).get("sessionToken").next(e=>{var t=null==e?void 0:e.value;return t?D.fromUint8Array(t):D.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.dt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class ha{constructor(){}At(e,t){this.Rt(e,t),t.Vt()}Rt(t,r){if("nullValue"in t)this.ft(r,5);else if("booleanValue"in t)this.ft(r,10),r.gt(t.booleanValue?1:0);else if("integerValue"in t)this.ft(r,15),r.gt(N(t.integerValue));else if("doubleValue"in t){var e=N(t.doubleValue);isNaN(e)?this.ft(r,13):(this.ft(r,15),ct(e)?r.gt(0):r.gt(e))}else if("timestampValue"in t){let e=t.timestampValue;this.ft(r,20),"string"==typeof e&&(e=Br(e)),r.yt(""+(e.seconds||"")),r.gt(e.nanos||0)}else"stringValue"in t?(this.wt(t.stringValue,r),this.St(r)):"bytesValue"in t?(this.ft(r,30),r.bt(qr(t.bytesValue)),this.St(r)):"referenceValue"in t?this.Dt(t.referenceValue,r):"geoPointValue"in t?(e=t.geoPointValue,this.ft(r,45),r.gt(e.latitude||0),r.gt(e.longitude||0)):"mapValue"in t?_n(t)?this.ft(r,Number.MAX_SAFE_INTEGER):vn(t)?this.vt(t.mapValue,r):(this.Ct(t.mapValue,r),this.St(r)):"arrayValue"in t?(this.Ft(t.arrayValue,r),this.St(r)):T()}wt(e,t){this.ft(t,25),this.Mt(e,t)}Mt(e,t){t.yt(e)}Ct(e,t){var r=e.fields||{};this.ft(t,55);for(let e of Object.keys(r))this.wt(e,t),this.Rt(r[e],t)}vt(e,t){var r=e.fields||{},n=(this.ft(t,53),rn),i=(null==(i=null==(i=r[n].arrayValue)?void 0:i.values)?void 0:i.length)||0;this.ft(t,15),t.gt(N(i)),this.wt(n,t),this.Rt(r[n],t)}Ft(e,t){var r=e.values||[];this.ft(t,50);for(let e of r)this.Rt(e,t)}Dt(e,t){this.ft(t,37),x.fromName(e).path.forEach(e=>{this.ft(t,60),this.Mt(e,t)})}ft(e,t){e.gt(t)}St(e){e.gt(2)}}ha.xt=new ha;function ca(e){var t=64-(e=>{let t=0;for(let n=0;n<8;++n){var r=(e=>{if(0===e)return 8;let t=0;return e>>4||(t+=4,e<<=4),e>>6||(t+=2,e<<=2),e>>7||(t+=1),t})(255&e[n]);if(t+=r,8!==r)break}return t})(e);return Math.ceil(t/8)}class da{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ot(e){var t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Nt(r.value),r=t.next();this.Bt()}Lt(e){var t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.kt(r.value),r=t.next();this.qt()}Qt(e){for(var t of e){let e=t.charCodeAt(0);if(e<128)this.Nt(e);else if(e<2048)this.Nt(960|e>>>6),this.Nt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Nt(480|e>>>12),this.Nt(128|63&e>>>6),this.Nt(128|63&e);else{let e=t.codePointAt(0);this.Nt(240|e>>>18),this.Nt(128|63&e>>>12),this.Nt(128|63&e>>>6),this.Nt(128|63&e)}}this.Bt()}$t(e){for(var t of e){let e=t.charCodeAt(0);if(e<128)this.kt(e);else if(e<2048)this.kt(960|e>>>6),this.kt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.kt(480|e>>>12),this.kt(128|63&e>>>6),this.kt(128|63&e);else{let e=t.codePointAt(0);this.kt(240|e>>>18),this.kt(128|63&e>>>12),this.kt(128|63&e>>>6),this.kt(128|63&e)}}this.qt()}Ut(e){var t=this.Kt(e),r=ca(t);this.Wt(1+r),this.buffer[this.position++]=255&r;for(let n=t.length-r;n<t.length;++n)this.buffer[this.position++]=255&t[n]}Gt(e){var t=this.Kt(e),r=ca(t);this.Wt(1+r),this.buffer[this.position++]=~(255&r);for(let n=t.length-r;n<t.length;++n)this.buffer[this.position++]=~(255&t[n])}zt(){this.jt(255),this.jt(255)}Ht(){this.Jt(255),this.Jt(255)}reset(){this.position=0}seed(e){this.Wt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Yt(){return this.buffer.slice(0,this.position)}Kt(e){e=e,(t=new DataView(new ArrayBuffer(8))).setFloat64(0,e,!1);var t,r=new Uint8Array(t.buffer),n=!!(128&r[0]);r[0]^=n?255:128;for(let i=1;i<r.length;++i)r[i]^=n?255:0;return r}Nt(e){var t=255&e;0==t?(this.jt(0),this.jt(255)):255==t?(this.jt(255),this.jt(0)):this.jt(t)}kt(e){var t=255&e;0==t?(this.Jt(0),this.Jt(255)):255==t?(this.Jt(255),this.Jt(0)):this.Jt(e)}Bt(){this.jt(0),this.jt(1)}qt(){this.Jt(0),this.Jt(1)}jt(e){this.Wt(1),this.buffer[this.position++]=e}Jt(e){this.Wt(1),this.buffer[this.position++]=~e}Wt(e){var t=e+this.position;if(!(t<=this.buffer.length)){let e=2*this.buffer.length;e<t&&(e=t);t=new Uint8Array(e);t.set(this.buffer),this.buffer=t}}}class fa{constructor(e){this.Zt=e}bt(e){this.Zt.Ot(e)}yt(e){this.Zt.Qt(e)}gt(e){this.Zt.Ut(e)}Vt(){this.Zt.zt()}}class ga{constructor(e){this.Zt=e}bt(e){this.Zt.Lt(e)}yt(e){this.Zt.$t(e)}gt(e){this.Zt.Gt(e)}Vt(){this.Zt.Ht()}}class ma{constructor(){this.Zt=new da,this.Xt=new fa(this.Zt),this.en=new ga(this.Zt)}seed(e){this.Zt.seed(e)}tn(e){return 0===e?this.Xt:this.en}Yt(){return this.Zt.Yt()}reset(){this.Zt.reset()}}class pa{constructor(e,t,r,n){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=n}nn(){var e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new pa(this.indexId,this.documentKey,this.arrayValue,r)}}function ya(e,t){var r=e.indexId-t.indexId;return 0!=r||0!==(r=va(e.arrayValue,t.arrayValue))||0!==(r=va(e.directionalValue,t.directionalValue))?r:x.comparator(e.documentKey,t.documentKey)}function va(e,t){for(let n=0;n<e.length&&n<t.length;++n){var r=e[n]-t[n];if(0!=r)return r}return e.length-t.length}class wa{constructor(e){this.rn=new C((e,t)=>v.comparator(e.field,t.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.sn=e.orderBy,this._n=[];for(var t of e.filters){let e=t;e.isInequality()?this.rn=this.rn.add(e):this._n.push(e)}}get an(){return 1<this.rn.size}un(e){if(y(e.collectionGroup===this.collectionId),this.an)return!1;let t=Fe(e);if(void 0!==t&&!this.cn(t))return!1;var r=Pe(e);let n=new Set,i=0,s=0;for(;i<r.length&&this.cn(r[i]);++i)n=n.add(r[i].fieldPath.canonicalString());if(i!==r.length){if(0<this.rn.size){let t=this.rn.getIterator().getNext();if(!n.has(t.field.canonicalString())){let e=r[i];if(!this.ln(t,e)||!this.hn(this.sn[s++],e))return!1}++i}for(;i<r.length;++i){let e=r[i];if(s>=this.sn.length||!this.hn(this.sn[s++],e))return!1}}return!0}Pn(){if(this.an)return null;let e=new C(v.comparator);var t,r,n=[];for(t of this._n)t.field.isKeyField()||("array-contains"===t.op||"array-contains-any"===t.op?n.push(new Ue(t.field,2)):e.has(t.field)||(e=e.add(t.field),n.push(new Ue(t.field,0))));for(r of this.sn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Ue(r.field,"asc"===r.dir?0:1)));return new Ve(Ve.UNKNOWN_ID,this.collectionId,n,Be.empty())}cn(e){for(var t of this._n)if(this.ln(t,e))return!0;return!1}ln(e,t){var r;return!(void 0===e||!e.field.isEqual(t.fieldPath))&&(r="array-contains"===e.op||"array-contains-any"===e.op,2===t.kind==r)}hn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function _a(e){var t;return 0===e.getFilters().length?[]:(t=function t(e){if(y(e instanceof R||e instanceof L),e instanceof R)return e;if(1===e.filters.length)return t(e.filters[0]);let r=e.filters.map(e=>t(e));let n=L.create(r,e.op);return n=xa(n),Ta(n)?n:(y(n instanceof L),y(Nn(n)),y(1<n.filters.length),n.filters.reduce((e,t)=>Ea(e,t)))}(function t(r){var n;if(y(r instanceof R||r instanceof L),r instanceof R){if(r instanceof qn){let e=(null==(n=null==(n=r.value.arrayValue)?void 0:n.values)?void 0:n.map(e=>R.create(r.field,"==",e)))||[];return L.create(e,"or")}return r}let e=r.filters.map(e=>t(e));return L.create(e,r.op)}(e)),y(Ta(t)),ba(t)||Ia(t)?[t]:t.getFilters())}function ba(e){return e instanceof R}function Ia(e){return e instanceof L&&Rn(e)}function Ta(e){return ba(e)||Ia(e)||(e=>{if(e instanceof L&&kn(e)){for(var t of e.getFilters())if(!ba(t)&&!Ia(t))return!1;return!0}return!1})(e)}function Ea(e,t){var r,n;return y(e instanceof R||e instanceof L),y(t instanceof R||t instanceof L),xa(e instanceof R?t instanceof R?(r=e,n=t,L.create([r,n],"and")):Sa(e,t):t instanceof R?Sa(t,e):((e,t)=>{if(y(0<e.filters.length&&0<t.filters.length),Nn(e)&&Nn(t))return On(e,t.getFilters());let r=kn(e)?e:t,n=kn(e)?t:e,i=r.filters.map(e=>Ea(e,n));return L.create(i,"or")})(e,t))}function Sa(t,e){var r;return Nn(e)?On(e,t.getFilters()):(r=e.filters.map(e=>Ea(t,e)),L.create(r,"or"))}function xa(t){if(y(t instanceof R||t instanceof L),t instanceof R)return t;var e=t.getFilters();if(1===e.length)return xa(e[0]);if(Ln(t))return t;let r=e.map(e=>xa(e)),n=[];return r.forEach(e=>{e instanceof R?n.push(e):e instanceof L&&(e.op===t.op?n.push(...e.filters):n.push(e))}),1===n.length?n[0]:L.create(n,t.op)}class Aa{constructor(){this.Tn=new Ca}addToCollectionParentIndex(e,t){return this.Tn.add(t),w.resolve()}getCollectionParents(e,t){return w.resolve(this.Tn.getEntries(t))}addFieldIndex(e,t){return w.resolve()}deleteFieldIndex(e,t){return w.resolve()}deleteAllFieldIndexes(e){return w.resolve()}createTargetIndexes(e,t){return w.resolve()}getDocumentsMatchingTarget(e,t){return w.resolve(null)}getIndexType(e,t){return w.resolve(0)}getFieldIndexes(e,t){return w.resolve([])}getNextCollectionGroupToUpdate(e){return w.resolve(null)}getMinOffset(e,t){return w.resolve(ze.min())}getMinOffsetFromCollectionGroup(e,t){return w.resolve(ze.min())}updateCollectionGroup(e,t,r){return w.resolve()}updateIndexEntries(e,t){return w.resolve()}}class Ca{constructor(){this.index={}}add(e){var t=e.lastSegment(),r=e.popLast(),n=this.index[t]||new C(S.comparator),i=!n.has(r);return this.index[t]=n.add(r),i}has(e){var t=e.lastSegment(),r=e.popLast(),t=this.index[t];return t&&t.has(r)}getEntries(e){return(this.index[e]||new C(S.comparator)).toArray()}}let Da="IndexedDbIndexManager",Na=new Uint8Array(0);class ka{constructor(e,t){this.databaseId=t,this.In=new Ca,this.En=new fi(e=>Qn(e),(e,t)=>$n(e,t)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){var r,n;return this.In.has(t)?w.resolve():(n=t.lastSegment(),r=t.popLast(),e.addOnCommittedListener(()=>{this.In.add(t)}),n={collectionId:n,parent:o(r)},Ra(e).put(n))}getCollectionParents(e,r){let n=[],t=IDBKeyRange.bound([r,""],[Ne(r),""],!1,!0);return Ra(e).G(t).next(e=>{for(var t of e){if(t.collectionId!==r)break;n.push(mt(t.parent))}return n})}addFieldIndex(e,r){let t=Oa(e),n={indexId:r.indexId,collectionGroup:r.collectionGroup,fields:r.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])};delete n.indexId;var i=t.add(n);if(r.indexState){let t=Ma(e);return i.next(e=>{t.put(na(e,this.uid,r.indexState.sequenceNumber,r.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){let r=Oa(e),n=Ma(e),i=La(e);return r.delete(t.indexId).next(()=>n.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=Oa(e),r=La(e),n=Ma(e);return t.J().next(()=>r.J()).next(()=>n.J())}createTargetIndexes(r,e){return w.forEach(this.dn(e),t=>this.getIndexType(r,t).next(e=>{if(0===e||1===e){let e=new wa(t).Pn();if(null!=e)return this.addFieldIndex(r,e)}}))}getDocumentsMatchingTarget(e,c){let d=La(e),r=!0,n=new Map;return w.forEach(this.dn(c),t=>this.An(e,t).next(e=>{r=r&&!!e,n.set(t,e)})).next(()=>{if(r){let u=O(),h=[];return w.forEach(n,(e,t)=>{p(Da,`Using index ${r=e,`id=${r.indexId}|cg=${r.collectionGroup}|f=`+r.fields.map(e=>e.fieldPath+":"+e.kind).join(",")} to execute `+Qn(c));var r,n=((t,e)=>{var r=Fe(e);if(void 0!==r)for(let e of Wn(t,r.fieldPath))switch(e.op){case"array-contains-any":return e.value.arrayValue.values||[];case"array-contains":return[e.value]}return null})(t,e),i=((t,r)=>{var n,i=new Map;for(n of Pe(r))for(let e of Wn(t,n.fieldPath))switch(e.op){case"==":case"in":i.set(n.fieldPath.canonicalString(),e.value);break;case"not-in":case"!=":return i.set(n.fieldPath.canonicalString(),e.value),Array.from(i.values())}return null})(t,e),s=((t,e)=>{var r,n=[];let i=!0;for(r of Pe(e)){let e=(0===r.kind?Yn:Xn)(t,r.fieldPath,t.startAt);n.push(e.value),i=i&&e.inclusive}return new Sn(n,i)})(t,e),a=((t,e)=>{var r,n=[];let i=!0;for(r of Pe(e)){let e=(0===r.kind?Xn:Yn)(t,r.fieldPath,t.endAt);n.push(e.value),i=i&&e.inclusive}return new Sn(n,i)})(t,e),o=this.Rn(e,t,s),l=this.Rn(e,t,a),i=this.Vn(e,t,i),n=this.mn(e.indexId,n,o,s.inclusive,l,a.inclusive,i);return w.forEach(n,e=>d.H(e,c.limit).next(e=>{e.forEach(e=>{var t=x.fromSegments(e.documentKey);u.has(t)||(u=u.add(t),h.push(t))})}))}).next(()=>h)}return w.resolve(null)})}dn(t){let e=this.En.get(t);return e||(e=0===t.filters.length?[t]:_a(L.create(t.filters,"and")).map(e=>Kn(t.path,t.collectionGroup,t.orderBy,e.getFilters(),t.limit,t.startAt,t.endAt)),this.En.set(t,e)),e}mn(i,s,a,o,l,u,h){let e=(null!=s?s.length:1)*Math.max(a.length,l.length),c=e/(null!=s?s.length:1),d=[];for(let f=0;f<e;++f){let t=s?this.fn(s[f/c]):Na,e=this.gn(i,t,a[f%c],o),r=this.pn(i,t,l[f%c],u),n=h.map(e=>this.gn(i,t,e,!0));d.push(...this.createRange(e,r,n))}return d}gn(e,t,r,n){var i=new pa(e,x.empty(),t,r);return n?i:i.nn()}pn(e,t,r,n){var i=new pa(e,x.empty(),t,r);return n?i.nn():i}An(e,t){let n=new wa(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(e=>{let t=null;for(var r of e)n.un(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t})}getIndexType(e,t){let r=2,n=this.dn(t);return w.forEach(n,t=>this.An(e,t).next(e=>{e?0!==r&&e.fields.length<(t=>{let r=new C(v.comparator),n=!1;for(var i of t.filters)for(let e of i.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:r=r.add(e.field));for(let n of t.orderBy)n.field.isKeyField()||(r=r.add(n.field));return r.size+(n?1:0)})(t)&&(r=1):r=0})).next(()=>null!==t.limit&&1<n.length&&2===r?1:r)}yn(e,t){var r,n=new ma;for(r of Pe(e)){let e=t.data.field(r.fieldPath);if(null==e)return null;var i=n.tn(r.kind);ha.xt.At(e,i)}return n.Yt()}fn(e){var t=new ma;return ha.xt.At(e,t.tn(0)),t.Yt()}wn(e,t){var r,n=new ma;return ha.xt.At(dn(this.databaseId,t),n.tn(0===(r=Pe(e)).length?0:r[r.length-1].kind)),n.Yt()}Vn(e,n,i){if(null===i)return[];let s=[],a=(s.push(new ma),0);for(var o of Pe(e)){let t=i[a++];for(let r of s)if(this.Sn(n,o.fieldPath)&&gn(t))s=this.bn(s,o,t);else{let e=r.tn(o.kind);ha.xt.At(t,e)}}return this.Dn(s)}Rn(e,t,r){return this.Vn(e,t,r.position)}Dn(e){var t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Yt();return t}bn(r,n,e){let i=[...r],s=[];for(let r of e.arrayValue.values||[])for(let t of i){let e=new ma;e.seed(t.Yt()),ha.xt.At(r,e.tn(n.kind)),s.push(e)}return s}Sn(e,t){return!!e.filters.find(e=>e instanceof R&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op))}getFieldIndexes(e,t){let r=Oa(e),n=Ma(e);return(t?r.G(Xt,IDBKeyRange.bound(t,t)):r.G()).next(e=>{let s=[];return w.forEach(e,i=>n.get([i.indexId,this.uid]).next(e=>{var t,r,n;s.push((t=i,r=(e=e)?new Be(e.sequenceNumber,new ze(Ys(e.readTime),new x(mt(e.documentKey)),e.largestBatchId)):Be.empty(),n=t.fields.map(([e,t])=>new Ue(v.fromServerFormat(e),t)),new Ve(t.indexId,t.collectionGroup,n,r)))})).next(()=>s)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(e=>0===e.length?null:(e.sort((e,t)=>{var r=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!=r?r:E(e.collectionGroup,t.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(e,r,n){let i=Oa(e),s=Ma(e);return this.vn(e).next(t=>i.G(Xt,IDBKeyRange.bound(r,r)).next(e=>w.forEach(e,e=>s.put(na(e.indexId,this.uid,t,n)))))}updateIndexEntries(i,e){let r=new Map;return w.forEach(e,(t,n)=>{var e=r.get(t.collectionGroup);return(e?w.resolve(e):this.getFieldIndexes(i,t.collectionGroup)).next(e=>(r.set(t.collectionGroup,e),w.forEach(e,r=>this.Cn(i,t,r).next(e=>{var t=this.Fn(n,r);return e.isEqual(t)?w.resolve():this.Mn(i,n,r,e,t)}))))})}xn(e,t,r,n){return La(e).put({indexId:n.indexId,uid:this.uid,arrayValue:n.arrayValue,directionalValue:n.directionalValue,orderedDocumentKey:this.wn(r,t.key),documentKey:t.key.path.toArray()})}On(e,t,r,n){return La(e).delete([n.indexId,this.uid,n.arrayValue,n.directionalValue,this.wn(r,t.key),t.key.path.toArray()])}Cn(e,r,n){var t=La(e);let i=new C(ya);return t.Z({index:ir,range:IDBKeyRange.only([n.indexId,this.uid,this.wn(n,r)])},(e,t)=>{i=i.add(new pa(n.indexId,r,t.arrayValue,t.directionalValue))}).next(()=>i)}Fn(t,r){let n=new C(ya);var i=this.yn(r,t);if(null!=i){let e=Fe(r);if(null!=e){var s=t.data.field(e.fieldPath);if(gn(s))for(let e of s.arrayValue.values||[])n=n.add(new pa(r.indexId,t.key,this.fn(e),i))}else n=n.add(new pa(r.indexId,t.key,Na,i))}return n}Mn(t,r,s,e,a){p(Da,"Updating index entries for document '%s'",r.key);let o=[];{var l=ya,u=e=>{o.push(this.xn(t,r,s,e))},h=e=>{o.push(this.On(t,r,s,e))},c=e.getIterator(),d=a.getIterator();let n=Vr(c),i=Vr(d);for(;n||i;){let t=!1,r=!1;if(n&&i){let e=l(n,i);e<0?r=!0:0<e&&(t=!0)}else null!=n?r=!0:t=!0;t?(u(i),i=Vr(d)):r?(h(n),n=Vr(c)):(n=Vr(c),i=Vr(d))}}return w.waitFor(o)}vn(e){let n=1;return Ma(e).Z({index:er,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(e,t,r)=>{r.done(),n=t.sequenceNumber+1}).next(()=>n)}createRange(r,n,e){e=e.sort((e,t)=>ya(e,t)).filter((e,t,r)=>!t||0!==ya(e,r[t-1]));var i=[];i.push(r);for(let s of e){let e=ya(s,r),t=ya(s,n);if(0===e)i[0]=r.nn();else if(0<e&&t<0)i.push(s),i.push(s.nn());else if(0<t)break}i.push(n);let s=[];for(let a=0;a<i.length;a+=2){if(this.Nn(i[a],i[a+1]))return[];let e=[i[a].indexId,this.uid,i[a].arrayValue,i[a].directionalValue,Na,[]],t=[i[a+1].indexId,this.uid,i[a+1].arrayValue,i[a+1].directionalValue,Na,[]];s.push(IDBKeyRange.bound(e,t))}return s}Nn(e,t){return 0<ya(e,t)}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Va)}getMinOffset(t,e){return w.mapArray(this.dn(e),e=>this.An(t,e).next(e=>e||T())).next(Va)}}function Ra(e){return r(e,Kt)}function La(e){return r(e,rr)}function Oa(e){return r(e,Yt)}function Ma(e){return r(e,Jt)}function Va(e){y(0!==e.length);let t=e[0].indexState.offset,r=t.largestBatchId;for(let i=1;i<e.length;i++){var n=e[i].indexState.offset;Ge(n,t)<0&&(t=n),r<n.largestBatchId&&(r=n.largestBatchId)}return new ze(t.readTime,t.documentKey,r)}let Fa={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Pa{static withCacheSize(e){return new Pa(e,Pa.DEFAULT_COLLECTION_PERCENTILE,Pa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function Ua(t,r,n){let e=t.store(_t),i=t.store(At),s=[],a=IDBKeyRange.only(n.batchId),o=0;var l=e.Z({range:a},(e,t,r)=>(o++,r.delete()));s.push(l.next(()=>{y(1===o)}));let u=[];for(let t of n.mutations){let e=St(r,t.key.path,n.batchId);s.push(i.delete(e)),u.push(t.key)}return w.waitFor(s).next(()=>u)}function Ba(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw T();t=e.noDocument}return JSON.stringify(t).length}Pa.DEFAULT_COLLECTION_PERCENTILE=10,Pa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Pa.DEFAULT=new Pa(41943040,Pa.DEFAULT_COLLECTION_PERCENTILE,Pa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Pa.DISABLED=new Pa(-1,0,0);class qa{constructor(e,t,r,n){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=n,this.Bn={}}static It(e,t,r,n){y(""!==e.uid);var i=e.isAuthenticated()?e.uid:"";return new qa(i,t,r,n)}checkEmpty(e){let n=!0;var t=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return za(e).Z({index:It,range:t},(e,t,r)=>{n=!1,r.done()}).next(()=>n)}addMutationBatch(c,d,f,g){let m=Ga(c),p=za(c);return p.add({}).next(t=>{y("number"==typeof t);let e=new Wi(t,d,f,g),r=(i=this.serializer,s=this.userId,a=e,o=a.baseMutations.map(e=>Ls(i.Tt,e)),l=a.mutations.map(e=>Ls(i.Tt,e)),{userId:s,batchId:a.batchId,localWriteTimeMs:a.localWriteTime.toMillis(),baseMutations:o,mutations:l}),n=[];var i,s,a,o,l;let u=new C((e,t)=>E(e.canonicalString(),t.canonicalString()));for(let h of g){let e=St(this.userId,h.key.path,t);u=u.add(h.key.path.popLast()),n.push(p.put(r)),n.push(m.put(e,xt))}return u.forEach(e=>{n.push(this.indexManager.addToCollectionParentIndex(c,e))}),c.addOnCommittedListener(()=>{this.Bn[t]=e.keys()}),w.waitFor(n).next(()=>e)})}lookupMutationBatch(e,t){return za(e).get(t).next(e=>e?(y(e.userId===this.userId),Xs(this.serializer,e)):null)}Ln(e,r){return this.Bn[r]?w.resolve(this.Bn[r]):this.lookupMutationBatch(e,r).next(e=>{var t;return e?(t=e.keys(),this.Bn[r]=t):null})}getNextMutationBatchAfterBatchId(e,t){let n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]),i=null;return za(e).Z({index:It,range:r},(e,t,r)=>{t.userId===this.userId&&(y(t.batchId>=n),i=Xs(this.serializer,t)),r.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=ut;return za(e).Z({index:It,range:t,reverse:!0},(e,t,r)=>{n=t.batchId,r.done()}).next(()=>n)}getAllMutationBatches(e){var t=IDBKeyRange.bound([this.userId,ut],[this.userId,Number.POSITIVE_INFINITY]);return za(e).G(It,t).next(e=>e.map(e=>Xs(this.serializer,e)))}getAllMutationBatchesAffectingDocumentKey(a,o){let e=Et(this.userId,o.path),t=IDBKeyRange.lowerBound(e),l=[];return Ga(a).Z({range:t},(e,t,r)=>{var[n,i,s]=e,i=mt(i);if(n===this.userId&&o.path.isEqual(i))return za(a).get(s).next(e=>{if(!e)throw T();y(e.userId===this.userId),l.push(Xs(this.serializer,e))});r.done()}).next(()=>l)}getAllMutationBatchesAffectingDocumentKeys(t,e){let o=new C(E),r=[];return e.forEach(a=>{var e=Et(this.userId,a.path),e=IDBKeyRange.lowerBound(e),e=Ga(t).Z({range:e},(e,t,r)=>{var[n,i,s]=e,i=mt(i);n===this.userId&&a.path.isEqual(i)?o=o.add(s):r.done()});r.push(e)}),w.waitFor(r).next(()=>this.kn(t,o))}getAllMutationBatchesAffectingQuery(e,t){let a=t.path,o=a.length+1,r=Et(this.userId,a),n=IDBKeyRange.lowerBound(r),l=new C(E);return Ga(e).Z({range:n},(e,t,r)=>{var[n,i,s]=e,i=mt(i);n===this.userId&&a.isPrefixOf(i)?i.length===o&&(l=l.add(s)):r.done()}).next(()=>this.kn(e,l))}kn(t,e){let r=[],n=[];return e.forEach(e=>{n.push(za(t).get(e).next(e=>{if(null===e)throw T();y(e.userId===this.userId),r.push(Xs(this.serializer,e))}))}),w.waitFor(n).next(()=>r)}removeMutationBatch(t,r){return Ua(t.ue,this.userId,r).next(e=>(t.addOnCommittedListener(()=>{this.qn(r.batchId)}),w.forEach(e,e=>this.referenceDelegate.markPotentiallyOrphaned(t,e))))}qn(e){delete this.Bn[e]}performConsistencyCheck(r){return this.checkEmpty(r).next(e=>{if(!e)return w.resolve();let t=IDBKeyRange.lowerBound([this.userId]),n=[];return Ga(r).Z({range:t},(t,e,r)=>{if(t[0]===this.userId){let e=mt(t[1]);n.push(e)}else r.done()}).next(()=>{y(0===n.length)})})}containsKey(e,t){return ja(e,this.userId,t)}Qn(e){return Ka(e).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:ut,lastStreamToken:""})}}function ja(e,s,t){let r=Et(s,t.path),a=r[1],n=IDBKeyRange.lowerBound(r),o=!1;return Ga(e).Z({range:n,Y:!0},(e,t,r)=>{var[n,i,,]=e;n===s&&i===a&&(o=!0),r.done()}).next(()=>o)}function za(e){return r(e,_t)}function Ga(e){return r(e,At)}function Ka(e){return r(e,wt)}class Qa{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Un(){return new Qa(0)}static Kn(){return new Qa(-1)}}class $a{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(r){return this.Wn(r).next(e=>{var t=new Qa(e.highestTargetId);return e.highestTargetId=t.next(),this.Gn(r,e).next(()=>e.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Wn(e).next(e=>g.fromTimestamp(new h(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Wn(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(t,r,n){return this.Wn(t).next(e=>(e.highestListenSequenceNumber=r,n&&(e.lastRemoteSnapshotVersion=n.toTimestamp()),e.highestListenSequenceNumber<r&&(e.highestListenSequenceNumber=r),this.Gn(t,e)))}addTargetData(t,r){return this.zn(t,r).next(()=>this.Wn(t).next(e=>(e.targetCount+=1,this.jn(r,e),this.Gn(t,e))))}updateTargetData(e,t){return this.zn(e,t)}removeTargetData(t,e){return this.removeMatchingKeysForTargetId(t,e.targetId).next(()=>Ha(t).delete(e.targetId)).next(()=>this.Wn(t)).next(e=>(y(0<e.targetCount),--e.targetCount,this.Gn(t,e)))}removeTargets(n,i,s){let a=0,o=[];return Ha(n).Z((e,t)=>{var r=Js(t);r.sequenceNumber<=i&&null===s.get(r.targetId)&&(a++,o.push(this.removeTargetData(n,r)))}).next(()=>w.waitFor(o)).next(()=>a)}forEachTarget(e,n){return Ha(e).Z((e,t)=>{var r=Js(t);n(r)})}Wn(e){return Wa(e).get(zt).next(e=>(y(null!==e),e))}Gn(e,t){return Wa(e).put(zt,t)}zn(e,t){return Ha(e).put(Zs(this.serializer,t))}jn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),t.highestListenSequenceNumber<e.sequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Wn(e).next(e=>e.targetCount)}getTargetData(e,i){var t=Qn(i),t=IDBKeyRange.bound([t,Number.NEGATIVE_INFINITY],[t,Number.POSITIVE_INFINITY]);let s=null;return Ha(e).Z({range:t,index:Ft},(e,t,r)=>{var n=Js(t);$n(i,n.target)&&(s=n,r.done())}).next(()=>s)}addMatchingKeys(r,e,n){let i=[],s=Ya(r);return e.forEach(e=>{var t=o(e.path);i.push(s.put({targetId:n,path:t})),i.push(this.referenceDelegate.addReference(r,n,e))}),w.waitFor(i)}removeMatchingKeys(r,e,n){let i=Ya(r);return w.forEach(e,e=>{var t=o(e.path);return w.waitFor([i.delete([n,t]),this.referenceDelegate.removeReference(r,n,e)])})}removeMatchingKeysForTargetId(e,t){var r=Ya(e),n=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(n)}getMatchingKeysForTargetId(e,t){var r=IDBKeyRange.bound([t],[t+1],!1,!0),n=Ya(e);let i=O();return n.Z({range:r,Y:!0},(e,t,r)=>{var n=mt(e[1]),n=new x(n);i=i.add(n)}).next(()=>i)}containsKey(e,t){var r=o(t.path),r=IDBKeyRange.bound([r],[Ne(r)],!1,!0);let n=0;return Ya(e).Z({index:qt,Y:!0,range:r},([e],t,r)=>{0!==e&&(n++,r.done())}).next(()=>0<n)}lt(e,t){return Ha(e).get(t).next(e=>e?Js(e):null)}}function Ha(e){return r(e,Vt)}function Wa(e){return r(e,Gt)}function Ya(e){return r(e,Ut)}let Xa="LruGarbageCollector";function Ja([e,t],[r,n]){var i=E(e,r);return 0===i?E(t,n):i}class Za{constructor(e){this.Hn=e,this.buffer=new C(Ja),this.Jn=0}Yn(){return++this.Jn}Zn(e){var t=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(t);else{let e=this.buffer.last();Ja(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class eo{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Xn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return null!==this.Xn}er(e){p(Xa,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){et(e)?p(Xa,"Ignoring IndexedDB error during garbage collection: ",e):await $e(e)}await this.er(3e5)})}}class to{constructor(e,t){this.tr=e,this.params=t}calculateTargetCount(e,t){return this.tr.nr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return w.resolve(lt.ae);let r=new Za(t);return this.tr.forEachTarget(e,e=>r.Zn(e.sequenceNumber)).next(()=>this.tr.rr(e,e=>r.Zn(e))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.tr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.tr.removeOrphanedDocuments(e,t)}collect(t,r){return-1===this.params.cacheSizeCollectionThreshold?(p("LruGarbageCollector","Garbage collection skipped; disabled"),w.resolve(Fa)):this.getCacheSize(t).next(e=>e<this.params.cacheSizeCollectionThreshold?(p("LruGarbageCollector",`Garbage collection skipped; Cache size ${e} is lower than threshold `+this.params.cacheSizeCollectionThreshold),Fa):this.ir(t,r))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(t,r){let n,i,s,a,o,l,u,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(e=>(i=e>this.params.maximumSequenceNumbersToCollect?(p("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from `+e),this.params.maximumSequenceNumbersToCollect):e,a=Date.now(),this.nthSequenceNumber(t,i))).next(e=>(n=e,o=Date.now(),this.removeTargets(t,n,r))).next(e=>(s=e,l=Date.now(),this.removeOrphanedDocuments(t,n))).next(e=>(u=Date.now(),ge()<=c.DEBUG&&p("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-h}ms
	Determined least recently used ${i} in `+(o-a)+"ms\n"+`	Removed ${s} targets in `+(l-o)+"ms\n"+`	Removed ${e} documents in `+(u-l)+"ms\n"+`Total Duration: ${u-h}ms`),w.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:e})))}}function ro(e,t){return new to(e,t)}class no{constructor(e,t){this.db=e,this.garbageCollector=ro(this,t)}nr(e){let r=this.sr(e);return this.db.getTargetCache().getTargetCount(e).next(t=>r.next(e=>t+e))}sr(e){let t=0;return this.rr(e,e=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}rr(e,r){return this._r(e,(e,t)=>r(t))}addReference(e,t,r){return io(e,r)}removeReference(e,t,r){return io(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return io(e,t)}ar(e,r){{var n=e,i=r;let t=!1;return Ka(n).X(e=>ja(n,e,i).next(e=>(e&&(t=!0),w.resolve(!e)))).next(()=>t)}}removeOrphanedDocuments(r,n){let i=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[],a=0;return this._r(r,(t,e)=>{if(e<=n){let e=this.ar(r,t).next(e=>{if(!e)return a++,i.getEntry(r,t).next(()=>(i.removeEntry(t,g.min()),Ya(r).delete([0,o(t.path)])))});s.push(e)}}).next(()=>w.waitFor(s)).next(()=>i.apply(r)).next(()=>a)}removeTarget(e,t){var r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return io(e,t)}_r(e,n){var t=Ya(e);let i,s=lt.ae;return t.Z({index:qt},([e],{path:t,sequenceNumber:r})=>{0===e?(s!==lt.ae&&n(new x(mt(i)),s),s=r,i=t):s=lt.ae}).next(()=>{s!==lt.ae&&n(new x(mt(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function io(e,t){return Ya(e).put((e=e.currentSequenceNumber,{targetId:0,path:o(t.path),sequenceNumber:e}))}class so{constructor(){this.changes=new fi(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,k.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();var r=this.changes.get(t);return void 0!==r?w.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class ao{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return ho(e).put(r)}removeEntry(e,t,r){return ho(e).delete((e=r,[(n=t.path.toArray()).slice(0,n.length-2),n[n.length-2],Hs(e),n[n.length-1]]));var n}updateMetadata(t,r){return this.getMetadata(t).next(e=>(e.byteSize+=r,this.ur(t,e)))}getEntry(e,r){let n=k.newInvalidDocument(r);return ho(e).Z({index:Nt,range:IDBKeyRange.only(co(r))},(e,t)=>{n=this.cr(r,t)}).next(()=>n)}lr(e,r){let n={size:0,document:k.newInvalidDocument(r)};return ho(e).Z({index:Nt,range:IDBKeyRange.only(co(r))},(e,t)=>{n={document:this.cr(r,t),size:Ba(t)}}).next(()=>n)}getEntries(e,t){let n=gi;return this.hr(e,t,(e,t)=>{var r=this.cr(e,t);n=n.insert(e,r)}).next(()=>n)}Pr(e,t){let n=gi,i=new A(x.comparator);return this.hr(e,t,(e,t)=>{var r=this.cr(e,t);n=n.insert(e,r),i=i.insert(e,Ba(t))}).next(()=>({documents:n,Tr:i}))}hr(e,t,i){if(t.isEmpty())return w.resolve();let r=new C(go),n=(t.forEach(e=>r=r.add(e)),IDBKeyRange.bound(co(r.first()),co(r.last()))),s=r.getIterator(),a=s.getNext();return ho(e).Z({index:Nt,range:n},(e,t,r)=>{for(var n=x.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);a&&go(a,n)<0;)i(a,null),a=s.getNext();a&&a.isEqual(n)&&(i(a,t),a=s.hasNext()?s.getNext():null),a?r.W(co(a)):r.done()}).next(()=>{for(;a;)i(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,n,t,i,s){var r=n.path,a=[r.popLast().toArray(),r.lastSegment(),Hs(t.readTime),t.documentKey.path.isEmpty()?"":t.documentKey.path.lastSegment()],r=[r.popLast().toArray(),r.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ho(e).G(IDBKeyRange.bound(a,r,!0)).next(e=>{null!=s&&s.incrementDocumentReadCount(e.length);let t=gi;for(let r of e){let e=this.cr(x.fromSegments(r.prefixPath.concat(r.collectionGroup,r.documentId)),r);e.isFoundDocument()&&(hi(n,e)||i.has(e.key))&&(t=t.insert(e.key,e))}return t})}getAllFromCollectionGroup(e,t,r,i){let s=gi;var n=fo(t,r),a=fo(t,ze.max());return ho(e).Z({index:Rt,range:IDBKeyRange.bound(n,a,!0)},(e,t,r)=>{var n=this.cr(x.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);(s=s.insert(n.key,n)).size===i&&r.done()}).next(()=>s)}newChangeBuffer(e){return new lo(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return uo(e).get(Mt).next(e=>(y(!!e),e))}ur(e,t){return uo(e).put(Mt,t)}cr(e,t){if(t){let e=((e,r)=>{let n;if(r.document)n=Rs(e.Tt,r.document,!!r.hasCommittedMutations);else if(r.noDocument){let e=x.fromSegments(r.noDocument.path),t=Ys(r.noDocument.readTime);n=k.newNoDocument(e,t),r.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!r.unknownDocument)return T();{let e=x.fromSegments(r.unknownDocument.path),t=Ys(r.unknownDocument.version);n=k.newUnknownDocument(e,t)}}return r.readTime&&n.setReadTime((e=r.readTime,t=new h(e[0],e[1]),g.fromTimestamp(t))),n;var t})(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(g.min()))return e}return k.newInvalidDocument(e)}}function oo(e){return new ao(e)}class lo extends so{constructor(e,t){super(),this.Ir=e,this.trackRemovals=t,this.Er=new fi(e=>e.toString(),(e,t)=>e.isEqual(t))}applyChanges(s){let a=[],o=0,l=new C((e,t)=>E(e.canonicalString(),t.canonicalString()));return this.changes.forEach((t,r)=>{var e=this.Er.get(t);if(a.push(this.Ir.removeEntry(s,t,e.readTime)),r.isValidDocument()){var n=$s(this.Ir.serializer,r),i=(l=l.add(t.path.popLast()),Ba(n));o+=i-e.size,a.push(this.Ir.addEntry(s,t,n))}else if(o-=e.size,this.trackRemovals){let e=$s(this.Ir.serializer,r.convertToNoDocument(g.min()));a.push(this.Ir.addEntry(s,t,e))}}),l.forEach(e=>{a.push(this.Ir.indexManager.addToCollectionParentIndex(s,e))}),a.push(this.Ir.updateMetadata(s,o)),w.waitFor(a)}getFromCache(e,t){return this.Ir.lr(e,t).next(e=>(this.Er.set(t,{size:e.size,readTime:e.document.readTime}),e.document))}getAllFromCache(e,t){return this.Ir.Pr(e,t).next(({documents:r,Tr:e})=>(e.forEach((e,t)=>{this.Er.set(e,{size:t,readTime:r.get(e).readTime})}),r))}}function uo(e){return r(e,Ot)}function ho(e){return r(e,Ct)}function co(e){var t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function fo(e,t){var r=t.documentKey.path.toArray();return[e,Hs(t.readTime),r.slice(0,r.length-2),0<r.length?r[r.length-1]:""]}function go(e,t){var r=e.path.toArray(),n=t.path.toArray();let i=0;for(let s=0;s<r.length-2&&s<n.length-2;++s)if(i=E(r[s],n[s]))return i;return(i=E(r.length,n.length))||(i=E(r[r.length-2],n[n.length-2]))||E(r[r.length-1],n[n.length-1])}class mo{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class po{constructor(e,t,r,n){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=n}getDocument(t,r){let n=null;return this.documentOverlayCache.getOverlay(t,r).next(e=>(n=e,this.remoteDocumentCache.getEntry(t,r))).next(e=>(null!==n&&Bi(n.mutation,e,Fr.empty(),h.now()),e))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(e=>this.getLocalViewOfDocuments(t,e,O()).next(()=>e))}getLocalViewOfDocuments(e,t,r=O()){let n=vi();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,r).next(e=>{let r=pi();return e.forEach((e,t)=>{r=r.insert(e,t.overlayedDocument)}),r}))}getOverlayedDocuments(e,t){let r=vi();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,O()))}populateOverlays(e,r,t){let n=[];return t.forEach(e=>{r.has(e)||n.push(e)}),this.documentOverlayCache.getOverlays(e,n).next(e=>{e.forEach((e,t)=>{r.set(e,t)})})}computeViews(e,t,n,i){let s=gi,a=vi(),o=vi();return t.forEach((e,t)=>{var r=n.get(t.key);i.has(t.key)&&(void 0===r||r.mutation instanceof zi)?s=s.insert(t.key,t):void 0!==r?(a.set(t.key,r.mutation.getFieldMask()),Bi(r.mutation,t,r.mutation.getFieldMask(),h.now())):a.set(t.key,Fr.empty())}),this.recalculateAndSaveOverlays(e,s).next(e=>(e.forEach((e,t)=>a.set(e,t)),t.forEach((e,t)=>{var r;return o.set(e,new mo(t,null!=(r=a.get(e))?r:null))}),o))}recalculateAndSaveOverlays(a,o){let l=vi(),u=new A((e,t)=>e-t),h=O();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(a,o).next(e=>{for(let n of e)n.keys().forEach(e=>{var t,r=o.get(e);null!==r&&(t=l.get(e)||Fr.empty(),t=n.applyToLocalView(r,t),l.set(e,t),r=(u.get(n.batchId)||O()).add(e),u=u.insert(n.batchId,r))})}).next(()=>{for(var i=[],s=u.getReverseIterator();s.hasNext();){let e=s.getNext(),t=e.key,r=e.value,n=vi();r.forEach(e=>{var t;h.has(e)||(null!==(t=Ui(o.get(e),l.get(e)))&&n.set(e,t),h=h.add(e))}),i.push(this.documentOverlayCache.saveOverlays(a,t,n))}return w.waitFor(i)}).next(()=>l)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(e=>this.recalculateAndSaveOverlays(t,e))}getDocumentsMatchingQuery(e,t,r,n){return i=t,x.isDocumentKey(i.path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):ri(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,n):this.getDocumentsMatchingCollectionQuery(e,t,r,n);var i}getNextDocuments(s,t,a,o){return this.remoteDocumentCache.getAllFromCollectionGroup(s,t,a,o).next(r=>{var e=0<o-r.size?this.documentOverlayCache.getOverlaysForCollectionGroup(s,t,a.largestBatchId,o-r.size):w.resolve(vi());let n=Me,i=r;return e.next(e=>w.forEach(e,(t,e)=>(n<e.largestBatchId&&(n=e.largestBatchId),r.get(t)?w.resolve():this.remoteDocumentCache.getEntry(s,t).next(e=>{i=i.insert(t,e)}))).next(()=>this.populateOverlays(s,e,r)).next(()=>this.computeViews(s,i,e,O())).next(e=>({batchId:n,changes:yi(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new x(t)).next(e=>{let t=pi();return t=e.isFoundDocument()?t.insert(e.key,e):t})}getDocumentsMatchingCollectionGroupQuery(n,i,s,a){let o=i.collectionGroup,l=pi();return this.indexManager.getCollectionParents(n,o).next(e=>w.forEach(e,e=>{t=i,e=e.child(o);var t,r=new Jn(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt);return this.getDocumentsMatchingCollectionQuery(n,r,s,a).next(e=>{e.forEach((e,t)=>{l=l.insert(e,t)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(t,s,r,n){let a;return this.documentOverlayCache.getOverlaysForCollection(t,s.path,r.largestBatchId).next(e=>(a=e,this.remoteDocumentCache.getDocumentsMatchingQuery(t,s,r,a,n))).next(n=>{a.forEach((e,t)=>{var r=t.getKey();null===n.get(r)&&(n=n.insert(r,k.newInvalidDocument(r)))});let i=pi();return n.forEach((e,t)=>{var r=a.get(e);void 0!==r&&Bi(r.mutation,t,Fr.empty(),h.now()),hi(s,t)&&(i=i.insert(e,t))}),i})}}class yo{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,t){return w.resolve(this.dr.get(t))}saveBundleMetadata(e,t){return this.dr.set(t.id,{id:t.id,version:t.version,createTime:V(t.createTime)}),w.resolve()}getNamedQuery(e,t){return w.resolve(this.Ar.get(t))}saveNamedQuery(e,t){return this.Ar.set(t.name,{name:(t=t).name,query:ea(t.bundledQuery),readTime:V(t.readTime)}),w.resolve()}}class vo{constructor(){this.overlays=new A(x.comparator),this.Rr=new Map}getOverlay(e,t){return w.resolve(this.overlays.get(t))}getOverlays(e,t){let r=vi();return w.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&r.set(t,e)})).next(()=>r)}saveOverlays(r,n,e){return e.forEach((e,t)=>{this.Et(r,n,t)}),w.resolve()}removeOverlaysForBatchId(e,t,r){var n=this.Rr.get(r);return void 0!==n&&(n.forEach(e=>this.overlays=this.overlays.remove(e)),this.Rr.delete(r)),w.resolve()}getOverlaysForCollection(e,r,n){let i=vi(),s=r.length+1,t=new x(r.child("")),a=this.overlays.getIteratorFrom(t);for(;a.hasNext();){let e=a.getNext().value,t=e.getKey();if(!r.isPrefixOf(t.path))break;t.path.length===s&&e.largestBatchId>n&&i.set(e.getKey(),e)}return w.resolve(i)}getOverlaysForCollectionGroup(e,r,n,t){let i=new A((e,t)=>e-t);for(var s=this.overlays.getIterator();s.hasNext();){let t=s.getNext().value;if(t.getKey().getCollectionGroup()===r&&t.largestBatchId>n){let e=i.get(t.largestBatchId);null===e&&(e=vi(),i=i.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}let a=vi(),o=i.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>a.set(e,t)),!(a.size()>=t)););return w.resolve(a)}Et(e,t,r){var n=this.overlays.get(r.key);if(null!==n){let e=this.Rr.get(n.largestBatchId).delete(r.key);this.Rr.set(n.largestBatchId,e)}this.overlays=this.overlays.insert(r.key,new Xi(t,r));let i=this.Rr.get(t);void 0===i&&(i=O(),this.Rr.set(t,i)),this.Rr.set(t,i.add(r.key))}}class wo{constructor(){this.sessionToken=D.EMPTY_BYTE_STRING}getSessionToken(e){return w.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,w.resolve()}}class _o{constructor(){this.Vr=new C(l.mr),this.gr=new C(l.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,t){var r=new l(e,t);this.Vr=this.Vr.add(r),this.gr=this.gr.add(r)}yr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.wr(new l(e,t))}Sr(e,t){e.forEach(e=>this.removeReference(e,t))}br(e){let t=new x(new S([])),r=new l(t,e),n=new l(t,e+1),i=[];return this.gr.forEachInRange([r,n],e=>{this.wr(e),i.push(e.key)}),i}Dr(){this.Vr.forEach(e=>this.wr(e))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){var t=new x(new S([])),r=new l(t,e),t=new l(t,e+1);let n=O();return this.gr.forEachInRange([r,t],e=>{n=n.add(e.key)}),n}containsKey(e){var t=new l(e,0),t=this.Vr.firstAfterOrEqual(t);return null!==t&&e.isEqual(t.key)}}class l{constructor(e,t){this.key=e,this.Cr=t}static mr(e,t){return x.comparator(e.key,t.key)||E(e.Cr,t.Cr)}static pr(e,t){return E(e.Cr,t.Cr)||x.comparator(e.key,t.key)}}class bo{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Fr=1,this.Mr=new C(l.mr)}checkEmpty(e){return w.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,n){var i=this.Fr,s=(this.Fr++,0<this.mutationQueue.length&&this.mutationQueue[this.mutationQueue.length-1],new Wi(i,t,r,n));this.mutationQueue.push(s);for(let t of n)this.Mr=this.Mr.add(new l(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return w.resolve(s)}lookupMutationBatch(e,t){return w.resolve(this.Or(t))}getNextMutationBatchAfterBatchId(e,t){var r=this.Nr(t+1),r=r<0?0:r;return w.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return w.resolve(0===this.mutationQueue.length?ut:this.Fr-1)}getAllMutationBatches(e){return w.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new l(t,0),n=new l(t,Number.POSITIVE_INFINITY),i=[];return this.Mr.forEachInRange([r,n],e=>{var t=this.Or(e.Cr);i.push(t)}),w.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new C(E);return t.forEach(e=>{var t=new l(e,0),r=new l(e,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([t,r],e=>{n=n.add(e.Cr)})}),w.resolve(this.Br(n))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,n=r.length+1,i=r;x.isDocumentKey(i)||(i=i.child(""));var s=new l(new x(i),0);let a=new C(E);return this.Mr.forEachWhile(e=>{var t=e.key.path;return!!r.isPrefixOf(t)&&(t.length===n&&(a=a.add(e.Cr)),!0)},s),w.resolve(this.Br(a))}Br(e){let r=[];return e.forEach(e=>{var t=this.Or(e);null!==t&&r.push(t)}),r}removeMutationBatch(r,n){y(0===this.Lr(n.batchId,"removed")),this.mutationQueue.shift();let i=this.Mr;return w.forEach(n.mutations,e=>{var t=new l(e.key,n.batchId);return i=i.delete(t),this.referenceDelegate.markPotentiallyOrphaned(r,e.key)}).next(()=>{this.Mr=i})}qn(e){}containsKey(e,t){var r=new l(t,0),r=this.Mr.firstAfterOrEqual(r);return w.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,w.resolve()}Lr(e,t){return this.Nr(e)}Nr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Or(e){var t=this.Nr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Io{constructor(e){this.kr=e,this.docs=new A(x.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){var r=t.key,n=this.docs.get(r),n=n?n.size:0,i=this.kr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:i}),this.size+=i-n,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){var r=this.docs.get(t);return w.resolve(r?r.document.mutableCopy():k.newInvalidDocument(t))}getEntries(e,t){let r=gi;return t.forEach(e=>{var t=this.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():k.newInvalidDocument(e))}),w.resolve(r)}getDocumentsMatchingQuery(e,r,n,i){let s=gi,a=r.path,t=new x(a.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(t);for(;o.hasNext();){let{key:e,value:{document:t}}=o.getNext();if(!a.isPrefixOf(e.path))break;e.path.length>a.length+1||Ge(je(t),n)<=0||(i.has(t.key)||hi(r,t))&&(s=s.insert(t.key,t.mutableCopy()))}return w.resolve(s)}getAllFromCollectionGroup(e,t,r,n){T()}qr(e,t){return w.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new To(this)}getSize(e){return w.resolve(this.size)}}class To extends so{constructor(e){super(),this.Ir=e}applyChanges(r){let n=[];return this.changes.forEach((e,t)=>{t.isValidDocument()?n.push(this.Ir.addEntry(r,t)):this.Ir.removeEntry(e)}),w.waitFor(n)}getFromCache(e,t){return this.Ir.getEntry(e,t)}getAllFromCache(e,t){return this.Ir.getEntries(e,t)}}class Eo{constructor(e){this.persistence=e,this.Qr=new fi(e=>Qn(e),$n),this.lastRemoteSnapshotVersion=g.min(),this.highestTargetId=0,this.$r=0,this.Ur=new _o,this.targetCount=0,this.Kr=Qa.Un()}forEachTarget(e,r){return this.Qr.forEach((e,t)=>r(t)),w.resolve()}getLastRemoteSnapshotVersion(e){return w.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return w.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Kr.next(),w.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.$r&&(this.$r=t),w.resolve()}zn(e){this.Qr.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.Kr=new Qa(t),this.highestTargetId=t),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,t){return this.zn(t),this.targetCount+=1,w.resolve()}updateTargetData(e,t){return this.zn(t),w.resolve()}removeTargetData(e,t){return this.Qr.delete(t.target),this.Ur.br(t.targetId),--this.targetCount,w.resolve()}removeTargets(r,n,i){let s=0,a=[];return this.Qr.forEach((e,t)=>{t.sequenceNumber<=n&&null===i.get(t.targetId)&&(this.Qr.delete(e),a.push(this.removeMatchingKeysForTargetId(r,t.targetId)),s++)}),w.waitFor(a).next(()=>s)}getTargetCount(e){return w.resolve(this.targetCount)}getTargetData(e,t){var r=this.Qr.get(t)||null;return w.resolve(r)}addMatchingKeys(e,t,r){return this.Ur.yr(t,r),w.resolve()}removeMatchingKeys(t,e,r){this.Ur.Sr(e,r);let n=this.persistence.referenceDelegate,i=[];return n&&e.forEach(e=>{i.push(n.markPotentiallyOrphaned(t,e))}),w.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Ur.br(t),w.resolve()}getMatchingKeysForTargetId(e,t){var r=this.Ur.vr(t);return w.resolve(r)}containsKey(e,t){return w.resolve(this.Ur.containsKey(t))}}class So{constructor(e,t){this.Wr={},this.overlays={},this.Gr=new lt(0),this.zr=!1,this.zr=!0,this.jr=new wo,this.referenceDelegate=e(this),this.Hr=new Eo(this),this.indexManager=new Aa,this.remoteDocumentCache=(e=e=>this.referenceDelegate.Jr(e),new Io(e)),this.serializer=new Qs(t),this.Yr=new yo(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new vo,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Wr[e.toKey()];return r||(r=new bo(t,this.referenceDelegate),this.Wr[e.toKey()]=r),r}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,t,r){p("MemoryPersistence","Starting transaction:",e);let n=new xo(this.Gr.next());return this.referenceDelegate.Zr(),r(n).next(e=>this.referenceDelegate.Xr(n).next(()=>e)).toPromise().then(e=>(n.raiseOnCommittedEvent(),e))}ei(t,r){return w.or(Object.values(this.Wr).map(e=>()=>e.containsKey(t,r)))}}class xo extends Qe{constructor(e){super(),this.currentSequenceNumber=e}}class Ao{constructor(e){this.persistence=e,this.ti=new _o,this.ni=null}static ri(e){return new Ao(e)}get ii(){if(this.ni)return this.ni;throw T()}addReference(e,t,r){return this.ti.addReference(r,t),this.ii.delete(r.toString()),w.resolve()}removeReference(e,t,r){return this.ti.removeReference(r,t),this.ii.add(r.toString()),w.resolve()}markPotentiallyOrphaned(e,t){return this.ii.add(t.toString()),w.resolve()}removeTarget(e,t){this.ti.br(t.targetId).forEach(e=>this.ii.add(e.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.ii.add(e.toString()))}).next(()=>r.removeTargetData(e,t))}Zr(){this.ni=new Set}Xr(r){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return w.forEach(this.ii,e=>{let t=x.fromPath(e);return this.si(r,t).next(e=>{e||n.removeEntry(t,g.min())})}).next(()=>(this.ni=null,n.apply(r)))}updateLimboDocument(e,t){return this.si(e,t).next(e=>{e?this.ii.delete(t.toString()):this.ii.add(t.toString())})}Jr(e){return 0}si(e,t){return w.or([()=>w.resolve(this.ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.ei(e,t)])}}class Co{constructor(e,t){this.persistence=e,this.oi=new fi(e=>o(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=ro(this,t)}static ri(e,t){return new Co(e,t)}Zr(){}Xr(e){return w.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}nr(e){let r=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(t=>r.next(e=>t+e))}sr(e){let t=0;return this.rr(e,e=>{t++}).next(()=>t)}rr(r,n){return w.forEach(this.oi,(e,t)=>this.ar(r,e,t).next(e=>e?w.resolve():n(t)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,r){let n=0,t=this.persistence.getRemoteDocumentCache(),i=t.newChangeBuffer();return t.qr(e,t=>this.ar(e,t,r).next(e=>{e||(n++,i.removeEntry(t,g.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.oi.set(t,e.currentSequenceNumber),w.resolve()}removeTarget(e,t){var r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.oi.set(r,e.currentSequenceNumber),w.resolve()}removeReference(e,t,r){return this.oi.set(r,e.currentSequenceNumber),w.resolve()}updateLimboDocument(e,t){return this.oi.set(t,e.currentSequenceNumber),w.resolve()}Jr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=function n(e){switch(sn(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:var t=$r(e);return t?16+n(t):16;case 5:return 2*e.stringValue.length;case 6:return qr(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return(e.arrayValue.values||[]).reduce((e,t)=>e+n(t),0);case 10:case 11:{var i=e.mapValue;let r=0;return kr(i.fields,(e,t)=>{r+=e.length+n(t)}),r}default:throw T()}}(e.data.value)),t}ar(e,t,r){return w.or([()=>this.persistence.ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{var e=this.oi.get(t);return w.resolve(void 0!==e&&r<e)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Do{constructor(e){this.serializer=e}B(t,e,r,n){let s=new We("createOrUpgrade",e);var i;r<1&&1<=n&&(t.createObjectStore(yt),(i=t).createObjectStore(wt,{keyPath:"userId"}),i.createObjectStore(_t,{keyPath:bt,autoIncrement:!0}).createIndex(It,Tt,{unique:!0}),i.createObjectStore(At),No(t),t.createObjectStore(pt));let a=w.resolve();return r<3&&3<=n&&(0!==r&&((i=t).deleteObjectStore(Ut),i.deleteObjectStore(Vt),i.deleteObjectStore(Gt),No(t)),a=a.next(()=>{return e=s,t=e.store(Gt),r={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:g.min().toTimestamp(),targetCount:0},t.put(zt,r);var e,t,r})),r<4&&4<=n&&(a=(a=0!==r?a.next(()=>{return n=t,(i=s).store(_t).G().next(e=>{n.deleteObjectStore(_t),n.createObjectStore(_t,{keyPath:bt,autoIncrement:!0}).createIndex(It,Tt,{unique:!0});let t=i.store(_t),r=e.map(e=>t.put(e));return w.waitFor(r)});var n,i}):a).next(()=>{t.createObjectStore($t,{keyPath:"clientId"})})),r<5&&5<=n&&(a=a.next(()=>this._i(s))),r<6&&6<=n&&(a=a.next(()=>(t.createObjectStore(Ot),this.ai(s)))),r<7&&7<=n&&(a=a.next(()=>this.ui(s))),r<8&&8<=n&&(a=a.next(()=>this.ci(t,s))),r<9&&9<=n&&(a=a.next(()=>{var e;(e=t).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")})),r<10&&10<=n&&(a=a.next(()=>this.li(s))),r<11&&11<=n&&(a=a.next(()=>{t.createObjectStore(Ht,{keyPath:"bundleId"}),t.createObjectStore(Wt,{keyPath:"name"})})),r<12&&12<=n&&(a=a.next(()=>{var e;(e=t.createObjectStore(ar,{keyPath:or})).createIndex(lr,ur,{unique:!1}),e.createIndex(hr,cr,{unique:!1})})),r<13&&13<=n&&(a=a.next(()=>{var e;(e=t.createObjectStore(Ct,{keyPath:Dt})).createIndex(Nt,kt),e.createIndex(Rt,Lt)}).next(()=>this.hi(t,s)).next(()=>t.deleteObjectStore(pt))),r<14&&14<=n&&(a=a.next(()=>this.Pi(t,s))),r<15&&15<=n&&(a=a.next(()=>{var e;(e=t).createObjectStore(Yt,{keyPath:"indexId",autoIncrement:!0}).createIndex(Xt,"collectionGroup",{unique:!1}),e.createObjectStore(Jt,{keyPath:Zt}).createIndex(er,tr,{unique:!1}),e.createObjectStore(rr,{keyPath:nr}).createIndex(ir,sr,{unique:!1})})),r<16&&16<=n&&(a=a.next(()=>{e.objectStore(Jt).clear()}).next(()=>{e.objectStore(rr).clear()})),a=r<17&&17<=n?a.next(()=>{t.createObjectStore(dr,{keyPath:"name"})}):a}ai(t){let r=0;return t.store(pt).Z((e,t)=>{r+=Ba(t)}).next(()=>{var e={byteSize:r};return t.store(Ot).put(Mt,e)})}_i(n){let e=n.store(wt),t=n.store(_t);return e.G().next(e=>w.forEach(e,r=>{var e=IDBKeyRange.bound([r.userId,ut],[r.userId,r.lastAcknowledgedBatchId]);return t.G(It,e).next(e=>w.forEach(e,e=>{y(e.userId===r.userId);var t=Xs(this.serializer,e);return Ua(n,r.userId,t).next(()=>{})}))}))}ui(e){let a=e.store(Ut),t=e.store(pt);return e.store(Gt).get(zt).next(i=>{let s=[];return t.Z((e,t)=>{let r=new S(e),n=[0,o(r)];s.push(a.get(n).next(e=>e?w.resolve():(e=r,a.put({targetId:0,path:o(e),sequenceNumber:i.highestListenSequenceNumber}))))}).next(()=>w.waitFor(s))})}ci(e,t){e.createObjectStore(Kt,{keyPath:Qt});let n=t.store(Kt),i=new Ca,s=r=>{if(i.add(r)){let e=r.lastSegment(),t=r.popLast();return n.put({collectionId:e,parent:o(t)})}};return t.store(pt).Z({Y:!0},(e,t)=>{var r=new S(e);return s(r.popLast())}).next(()=>t.store(At).Z({Y:!0},([,e],t)=>{var r=mt(e);return s(r.popLast())}))}li(e){let n=e.store(Vt);return n.Z((e,t)=>{var r=Js(t),r=Zs(this.serializer,r);return n.put(r)})}hi(e,s){let t=s.store(pt),a=[];return t.Z((e,t)=>{var r,n=s.store(Ct),i=((r=t).document?new x(S.fromString(r.document.name).popFirst(5)):r.noDocument?x.fromSegments(r.noDocument.path):r.unknownDocument?x.fromSegments(r.unknownDocument.path):T()).path.toArray(),i={prefixPath:i.slice(0,i.length-2),collectionGroup:i[i.length-2],documentId:i[i.length-1],readTime:t.readTime||[0,0],unknownDocument:t.unknownDocument,noDocument:t.noDocument,document:t.document,hasCommittedMutations:!!t.hasCommittedMutations};a.push(n.put(i))}).next(()=>w.waitFor(a))}Pi(e,s){let t=s.store(_t),a=oo(this.serializer),o=new So(Ao.ri,this.serializer.Tt);return t.G().next(e=>{let n=new Map;return e.forEach(e=>{let t,r=null!=(t=n.get(e.userId))?t:O();Xs(this.serializer,e).keys().forEach(e=>r=r.add(e)),n.set(e.userId,r)}),w.forEach(n,(e,t)=>{var r=new u(t),n=oa.It(this.serializer,r),i=o.getIndexManager(r),r=qa.It(r,this.serializer,i,o.referenceDelegate);return new po(a,r,n,i).recalculateAndSaveOverlaysForDocumentKeys(new Dr(s,lt.ae),e).next()})})}}function No(e){e.createObjectStore(Ut,{keyPath:Bt}).createIndex(qt,jt,{unique:!0}),e.createObjectStore(Vt,{keyPath:"targetId"}).createIndex(Ft,Pt,{unique:!0}),e.createObjectStore(Gt)}let ko="IndexedDbPersistence",Ro="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Lo{constructor(e,t,r,n,i,s,a,o,l,u,h=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Ti=i,this.window=s,this.document=a,this.Ii=l,this.Ei=u,this.di=h,this.Gr=null,this.zr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ai=null,this.inForeground=!1,this.Ri=null,this.Vi=null,this.mi=Number.NEGATIVE_INFINITY,this.fi=e=>Promise.resolve(),!Lo.D())throw new I(b.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new no(this,n),this.gi=t+"main",this.serializer=new Qs(o),this.pi=new Ye(this.gi,this.di,new Do(this.serializer)),this.jr=new ua,this.Hr=new $a(this.referenceDelegate,this.serializer),this.remoteDocumentCache=oo(this.serializer),this.Yr=new ia,this.window&&this.window.localStorage?this.yi=this.window.localStorage:(this.yi=null,!1===u&&d(ko,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.wi().then(()=>{if(this.isPrimary||this.allowTabSynchronization)return this.Si(),this.bi(),this.Di(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Hr.getHighestSequenceNumber(e));throw new I(b.FAILED_PRECONDITION,Ro)}).then(e=>{this.Gr=new lt(e,this.Ii)}).then(()=>{this.zr=!0}).catch(e=>(this.pi&&this.pi.close(),Promise.reject(e)))}Ci(t){return this.fi=async e=>{if(this.started)return t(e)},t(this.isPrimary)}setDatabaseDeletedListener(t){this.pi.k(async e=>{null===e.newVersion&&await t()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ti.enqueueAndForget(async()=>{this.started&&await this.wi()}))}wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",t=>Mo(t).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Fi(t).next(e=>{e||(this.isPrimary=!1,this.Ti.enqueueRetryable(()=>this.fi(!1)))})}).next(()=>this.Mi(t)).next(e=>this.isPrimary&&!e?this.xi(t).next(()=>!1):!!e&&this.Oi(t).next(()=>!0))).catch(e=>{if(et(e))return p(ko,"Failed to extend owner lease: ",e),this.isPrimary;if(this.allowTabSynchronization)return p(ko,"Releasing owner lease after error during lease refresh",e),!1;throw e}).then(e=>{this.isPrimary!==e&&this.Ti.enqueueRetryable(()=>this.fi(e)),this.isPrimary=e})}Fi(e){return Oo(e).get(vt).next(e=>w.resolve(this.Ni(e)))}Bi(e){return Mo(e).delete(this.clientId)}async Li(){if(this.isPrimary&&!this.ki(this.mi,18e5)){this.mi=Date.now();var e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{let n=r(e,$t);return n.G().next(e=>{let t=this.qi(e,18e5),r=e.filter(e=>-1===t.indexOf(e));return w.forEach(r,e=>n.delete(e.clientId)).next(()=>r)})}).catch(()=>[]);if(this.yi)for(var t of e)this.yi.removeItem(this.Qi(t.clientId))}}Di(){this.Vi=this.Ti.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.wi().then(()=>this.Li()).then(()=>this.Di()))}Ni(e){return!!e&&e.ownerId===this.clientId}Mi(t){return this.Ei?w.resolve(!0):Oo(t).get(vt).next(e=>{if(null!==e&&this.ki(e.leaseTimestampMs,5e3)&&!this.$i(e.ownerId)){if(this.Ni(e)&&this.networkEnabled)return!0;if(!this.Ni(e)){if(e.allowTabSynchronization)return!1;throw new I(b.FAILED_PRECONDITION,Ro)}}return!(!this.networkEnabled||!this.inForeground)||Mo(t).G().next(e=>void 0===this.qi(e,5e3).find(e=>{if(this.clientId!==e.clientId){var t=!this.networkEnabled&&e.networkEnabled,r=!this.inForeground&&e.inForeground,n=this.networkEnabled===e.networkEnabled;if(t||r&&n)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&p(ko,`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}async shutdown(){this.zr=!1,this.Ui(),this.Vi&&(this.Vi.cancel(),this.Vi=null),this.Ki(),this.Wi(),await this.pi.runTransaction("shutdown","readwrite",[yt,$t],e=>{let t=new Dr(e,lt.ae);return this.xi(t).next(()=>this.Bi(t))}),this.pi.close(),this.Gi()}qi(e,t){return e.filter(e=>this.ki(e.updateTimeMs,t)&&!this.$i(e.clientId))}zi(){return this.runTransaction("getActiveClients","readonly",e=>Mo(e).G().next(e=>this.qi(e,18e5).map(e=>e.clientId)))}get started(){return this.zr}getGlobalsCache(){return this.jr}getMutationQueue(e,t){return qa.It(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new ka(e,this.serializer.Tt.databaseId)}getDocumentOverlayCache(e){return oa.It(this.serializer,e)}getBundleCache(){return this.Yr}runTransaction(t,r,n){p(ko,"Starting transaction:",t);var e,i="readonly"===r?"readonly":"readwrite",s=17===(e=this.di)?Cr:16===e?Ar:15===e?xr:14===e?Sr:13===e?mr:12===e?gr:11===e?fr:void T();let a;return this.pi.runTransaction(t,i,s,e=>(a=new Dr(e,this.Gr?this.Gr.next():lt.ae),"readwrite-primary"===r?this.Fi(a).next(e=>!!e||this.Mi(a)).next(e=>{if(e)return n(a);throw d(`Failed to obtain primary lease for action '${t}'.`),this.isPrimary=!1,this.Ti.enqueueRetryable(()=>this.fi(!1)),new I(b.FAILED_PRECONDITION,Ke)}).next(e=>this.Oi(a).next(()=>e)):this.ji(a).next(()=>n(a)))).then(e=>(a.raiseOnCommittedEvent(),e))}ji(e){return Oo(e).get(vt).next(e=>{if(null!==e&&this.ki(e.leaseTimestampMs,5e3)&&!this.$i(e.ownerId)&&!this.Ni(e)&&!(this.Ei||this.allowTabSynchronization&&e.allowTabSynchronization))throw new I(b.FAILED_PRECONDITION,Ro)})}Oi(e){var t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Oo(e).put(vt,t)}static D(){return Ye.D()}xi(e){let t=Oo(e);return t.get(vt).next(e=>this.Ni(e)?(p(ko,"Releasing primary lease."),t.delete(vt)):w.resolve())}ki(e,t){var r=Date.now();return!(e<r-t||r<e&&(d(`Detected an update time that is in the future: ${e} > `+r),1))}Si(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ri=()=>{this.Ti.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.wi()))},this.document.addEventListener("visibilitychange",this.Ri),this.inForeground="visible"===this.document.visibilityState)}Ki(){this.Ri&&(this.document.removeEventListener("visibilitychange",this.Ri),this.Ri=null)}bi(){var e;"function"==typeof(null==(e=this.window)?void 0:e.addEventListener)&&(this.Ai=()=>{this.Ui();var e=/(?:Version|Mobile)\/1[456]/;Y()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Ti.enterRestrictedMode(!0),this.Ti.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Ai))}Wi(){this.Ai&&(this.window.removeEventListener("pagehide",this.Ai),this.Ai=null)}$i(e){var t;try{var r=null!==(null==(t=this.yi)?void 0:t.getItem(this.Qi(e)));return p(ko,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(e){return d(ko,"Failed to get zombied client id.",e),!1}}Ui(){if(this.yi)try{this.yi.setItem(this.Qi(this.clientId),String(Date.now()))}catch(e){d("Failed to set zombie client id.",e)}}Gi(){if(this.yi)try{this.yi.removeItem(this.Qi(this.clientId))}catch(e){}}Qi(e){return`firestore_zombie_${this.persistenceKey}_`+e}}function Oo(e){return r(e,yt)}function Mo(e){return r(e,$t)}function Vo(e,t){let r=e.projectId;return e.isDefaultDatabase||(r+="."+e.database),"firestore/"+t+"/"+r+"/"}class Fo{constructor(e,t,r,n){this.targetId=e,this.fromCache=t,this.Hi=r,this.Ji=n}static Yi(e,t){let r=O(),n=O();for(let e of t.docChanges)switch(e.type){case 0:r=r.add(e.doc.key);break;case 1:n=n.add(e.doc.key)}return new Fo(e,t.fromCache,r,n)}}class Po{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Uo{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=Y()?8:0<Xe(W())?6:4}initialize(e,t){this.ns=e,this.indexManager=t,this.Zi=!0}getDocumentsMatchingQuery(r,n,e,t){let i={result:null};return this.rs(r,n).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.ss(r,n,t,e).next(e=>{i.result=e})}).next(()=>{if(!i.result){let t=new Po;return this._s(r,n,t).next(e=>{if(i.result=e,this.Xi)return this.us(r,n,t,e.size)})}}).next(()=>i.result)}us(e,t,r,n){return r.documentReadCount<this.es?(ge()<=c.DEBUG&&p("QueryEngine","SDK will not create cache indexes for query:",ui(t),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),w.resolve()):(ge()<=c.DEBUG&&p("QueryEngine","Query:",ui(t),"scans",r.documentReadCount,"local documents and returns",n,"documents as results."),r.documentReadCount>this.ts*n?(ge()<=c.DEBUG&&p("QueryEngine","The SDK decides to create cache indexes for query:",ui(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ii(t))):w.resolve())}rs(i,s){if(ti(s))return w.resolve(null);let t=ii(s);return this.indexManager.getIndexType(i,t).next(e=>0===e?null:(null!==s.limit&&1===e&&(s=ai(s,null,"F"),t=ii(s)),this.indexManager.getDocumentsMatchingTarget(i,t).next(e=>{let n=O(...e);return this.ns.getDocuments(i,n).next(r=>this.indexManager.getMinOffset(i,t).next(e=>{var t=this.cs(s,r);return this.ls(s,t,n,e.readTime)?this.rs(i,ai(s,null,"F")):this.hs(i,t,s,e)}))})))}ss(r,n,i,s){return ti(n)||s.isEqual(g.min())?w.resolve(null):this.ns.getDocuments(r,i).next(e=>{var t=this.cs(n,e);return this.ls(n,t,i,s)?w.resolve(null):(ge()<=c.DEBUG&&p("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),ui(n)),this.hs(r,t,n,qe(s,Me)).next(e=>e))})}cs(r,e){let n=new C(di(r));return e.forEach((e,t)=>{hi(r,t)&&(n=n.add(t))}),n}ls(e,t,r,n){var i;return null!==e.limit&&(r.size!==t.size||!!(i="F"===e.limitType?t.last():t.first())&&(i.hasPendingWrites||0<i.version.compareTo(n)))}_s(e,t,r){return ge()<=c.DEBUG&&p("QueryEngine","Using full collection scan to execute query:",ui(t)),this.ns.getDocumentsMatchingQuery(e,t,ze.min(),r)}hs(e,r,t,n){return this.ns.getDocumentsMatchingQuery(e,t,n).next(t=>(r.forEach(e=>{t=t.insert(e.key,e)}),t))}}let Bo="LocalStore",qo=3e8;class jo{constructor(e,t,r,n){this.persistence=e,this.Ps=t,this.serializer=n,this.Ts=new A(E),this.Is=new fi(e=>Qn(e),$n),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(r)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new po(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.Ts))}}function zo(e,t,r,n){return new jo(e,t,r,n)}async function Go(e,t){let o=e;return o.persistence.runTransaction("Handle user change","readonly",s=>{let a;return o.mutationQueue.getAllMutationBatches(s).next(e=>(a=e,o.As(t),o.mutationQueue.getAllMutationBatches(s))).next(e=>{let t=[],r=[],n=O();for(let i of a){t.push(i.batchId);for(let e of i.mutations)n=n.add(e.key)}for(let i of e){r.push(i.batchId);for(let e of i.mutations)n=n.add(e.key)}return o.localDocuments.getDocuments(s,n).next(e=>({Rs:e,removedBatchIds:t,addedBatchIds:r}))})})}function Ko(e,n){let i=e;return i.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{let t=n.batch.keys(),r=i.ds.newChangeBuffer({trackRemovals:!0});return((e,t,n,i)=>{let s=n.batch,r=s.keys(),a=w.resolve();return r.forEach(r=>{a=a.next(()=>i.getEntry(t,r)).next(e=>{var t=n.docVersions.get(r);y(null!==t),e.version.compareTo(t)<0&&(s.applyToRemoteDocument(e,n),e.isValidDocument())&&(e.setReadTime(n.commitVersion),i.addEntry(e))})}),a.next(()=>e.mutationQueue.removeMutationBatch(t,s))})(i,e,n,r).next(()=>r.apply(e)).next(()=>i.mutationQueue.performConsistencyCheck(e)).next(()=>i.documentOverlayCache.removeOverlaysForBatchId(e,t,n.batch.batchId)).next(()=>i.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,(e=>{let t=O();for(let r=0;r<e.mutationResults.length;++r)0<e.mutationResults[r].transformResults.length&&(t=t.add(e.batch.mutations[r].key));return t})(n))).next(()=>i.localDocuments.getDocuments(e,t))})}function Qo(e){let t=e;return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Hr.getLastRemoteSnapshotVersion(e))}function $o(e,u){let h=e,c=u.snapshotVersion,d=h.Ts;return h.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let e=h.ds.newChangeBuffer({trackRemovals:!0}),l=(d=h.Ts,[]),t=(u.targetChanges.forEach((t,r)=>{var n,i,s,a=d.get(r);if(a){l.push(h.Hr.removeMatchingKeys(o,t.removedDocuments,r).next(()=>h.Hr.addMatchingKeys(o,t.addedDocuments,r)));let e=a.withSequenceNumber(o.currentSequenceNumber);null!==u.targetMismatches.get(r)?e=e.withResumeToken(D.EMPTY_BYTE_STRING,g.min()).withLastLimboFreeSnapshotVersion(g.min()):0<t.resumeToken.approximateByteSize()&&(e=e.withResumeToken(t.resumeToken,c)),d=d.insert(r,e),n=a,i=e,s=t,(0===n.resumeToken.approximateByteSize()||i.snapshotVersion.toMicroseconds()-n.snapshotVersion.toMicroseconds()>=qo||0<s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size)&&l.push(h.Hr.updateTargetData(o,e))}}),gi),r=O();if(u.documentUpdates.forEach(e=>{u.resolvedLimboDocuments.has(e)&&l.push(h.persistence.referenceDelegate.updateLimboDocument(o,e))}),l.push(Ho(o,e,u.documentUpdates).next(e=>{t=e.Vs,r=e.fs})),!c.isEqual(g.min())){let e=h.Hr.getLastRemoteSnapshotVersion(o).next(e=>h.Hr.setTargetsMetadata(o,o.currentSequenceNumber,c));l.push(e)}return w.waitFor(l).next(()=>e.apply(o)).next(()=>h.localDocuments.getLocalViewOfDocuments(o,t,r)).next(()=>t)}).then(e=>(h.Ts=d,e))}function Ho(e,s,t){let r=O(),a=O();return t.forEach(e=>r=r.add(e)),s.getEntries(e,r).next(n=>{let i=gi;return t.forEach((e,t)=>{var r=n.get(e);t.isFoundDocument()!==r.isFoundDocument()&&(a=a.add(e)),t.isNoDocument()&&t.version.isEqual(g.min())?(s.removeEntry(e,t.readTime),i=i.insert(e,t)):!r.isValidDocument()||0<t.version.compareTo(r.version)||0===t.version.compareTo(r.version)&&r.hasPendingWrites?(s.addEntry(t),i=i.insert(e,t)):p(Bo,"Ignoring outdated watch update for ",e,". Current version:",r.version," Watch version:",t.version)}),{Vs:i,fs:a}})}function Wo(e,n){let i=e;return i.persistence.runTransaction("Allocate target","readwrite",t=>{let r;return i.Hr.getTargetData(t,n).next(e=>e?(r=e,w.resolve(r)):i.Hr.allocateTargetId(t).next(e=>(r=new Ks(n,e,"TargetPurposeListen",t.currentSequenceNumber),i.Hr.addTargetData(t,r).next(()=>r))))}).then(e=>{var t=i.Ts.get(e.targetId);return(null===t||0<e.snapshotVersion.compareTo(t.snapshotVersion))&&(i.Ts=i.Ts.insert(e.targetId,e),i.Is.set(n,e.targetId)),e})}async function Yo(e,t,r){let n=e,i=n.Ts.get(t),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,e=>n.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(!et(e))throw e;p(Bo,`Failed to update sequence numbers for target ${t}: `+e)}n.Ts=n.Ts.remove(t),n.Is.delete(i.target)}function Xo(e,a,o){let l=e,u=g.min(),h=O();return l.persistence.runTransaction("Execute query","readwrite",t=>{return e=l,r=t,n=ii(a),(void 0!==(s=(i=e).Is.get(n))?w.resolve(i.Ts.get(s)):i.Hr.getTargetData(r,n)).next(e=>{if(e)return u=e.lastLimboFreeSnapshotVersion,l.Hr.getMatchingKeysForTargetId(t,e.targetId).next(e=>{h=e})}).next(()=>l.Ps.getDocumentsMatchingQuery(t,a,o?u:g.min(),o?h:O())).next(e=>(el(l,ci(a),e),{documents:e,gs:h}));var e,r,n,i,s})}function Jo(e,t){let r=e,n=r.Hr,i=r.Ts.get(t);return i?Promise.resolve(i.target):r.persistence.runTransaction("Get target data","readonly",e=>n.lt(e,t).next(e=>e?e.target:null))}function Zo(e,t){let r=e,n=r.Es.get(t)||g.min();return r.persistence.runTransaction("Get new document changes","readonly",e=>r.ds.getAllFromCollectionGroup(e,t,qe(n,Me),Number.MAX_SAFE_INTEGER)).then(e=>(el(r,t,e),e))}function el(e,t,r){let n=e.Es.get(t)||g.min();r.forEach((e,t)=>{0<t.readTime.compareTo(n)&&(n=t.readTime)}),e.Es.set(t,n)}let tl="firestore_clients";function rl(e,t){return tl+`_${e}_`+t}let nl="firestore_mutations";function il(e,t,r){let n=nl+`_${e}_`+r;return t.isAuthenticated()&&(n+="_"+t.uid),n}let sl="firestore_targets";function al(e,t){return sl+`_${e}_`+t}let ol="SharedClientState";class ll{constructor(e,t,r,n){this.user=e,this.batchId=t,this.state=r,this.error=n}static Ss(e,t,r){var n=JSON.parse(r);let i,s="object"==typeof n&&-1!==["pending","acknowledged","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return s&&n.error&&(s="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new I(n.error.code,n.error.message)),s?new ll(e,t,n.state,i):(d(ol,`Failed to parse mutation state for ID '${t}': `+r),null)}bs(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class ul{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ss(e,t){var r=JSON.parse(t);let n,i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(n=new I(r.error.code,r.error.message)),i?new ul(e,r.state,n):(d(ol,`Failed to parse target state for ID '${e}': `+t),null)}bs(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class hl{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ss(e,t){var r=JSON.parse(t);let n="object"==typeof r&&r.activeTargetIds instanceof Array,i=bi;for(let s=0;n&&s<r.activeTargetIds.length;++s)n=dt(r.activeTargetIds[s]),i=i.add(r.activeTargetIds[s]);return n?new hl(e,i):(d(ol,`Failed to parse client data for instance '${e}': `+t),null)}}class cl{constructor(e,t){this.clientId=e,this.onlineState=t}static Ss(e){var t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new cl(t.clientId,t.onlineState):(d(ol,"Failed to parse online state: "+e),null)}}class dl{constructor(){this.activeTargetIds=bi}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}bs(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class fl{constructor(e,t,r,n,i){this.window=e,this.Ti=t,this.persistenceKey=r,this.Cs=n,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Fs=this.Ms.bind(this),this.xs=new A(E),this.started=!1,this.Os=[];var s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ns=rl(this.persistenceKey,this.Cs),this.Bs="firestore_sequence_number_"+this.persistenceKey,this.xs=this.xs.insert(this.Cs,new dl),this.Ls=new RegExp(`^${tl}_${s}_([^_]*)$`),this.ks=new RegExp(`^${nl}_${s}_(\\d+)(?:_(.*))?$`),this.qs=new RegExp(`^${sl}_${s}_(\\d+)$`),this.Qs="firestore_online_state_"+this.persistenceKey,this.$s="firestore_bundle_loaded_v2_"+this.persistenceKey,this.window.addEventListener("storage",this.Fs)}static D(e){return!(!e||!e.localStorage)}async start(){let e=await this.syncEngine.zi();for(let r of e)if(r!==this.Cs){let e=this.getItem(rl(this.persistenceKey,r));var t;e&&(t=hl.Ss(r,e))&&(this.xs=this.xs.insert(t.clientId,t))}this.Us();let r=this.storage.getItem(this.Qs);if(r){let e=this.Ks(r);e&&this.Ws(e)}for(let e of this.Os)this.Ms(e);this.Os=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Bs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Gs(this.xs)}isActiveQueryTarget(r){let n=!1;return this.xs.forEach((e,t)=>{t.activeTargetIds.has(r)&&(n=!0)}),n}addPendingMutation(e){this.zs(e,"pending")}updateMutationState(e,t,r){this.zs(e,t,r),this.js(e)}addLocalQueryTarget(t,e=!0){let r="not-current";if(this.isActiveQueryTarget(t)){let e=this.storage.getItem(al(this.persistenceKey,t));var n;e&&(n=ul.Ss(t,e))&&(r=n.state)}return e&&this.Hs.Ds(t),this.Us(),r}removeLocalQueryTarget(e){this.Hs.vs(e),this.Us()}isLocalQueryTarget(e){return this.Hs.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(al(this.persistenceKey,e))}updateQueryState(e,t,r){this.Js(e,t,r)}handleUserChange(e,t,r){t.forEach(e=>{this.js(e)}),this.currentUser=e,r.forEach(e=>{this.addPendingMutation(e)})}setOnlineState(e){this.Ys(e)}notifyBundleLoaded(e){this.Zs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Fs),this.removeItem(this.Ns),this.started=!1)}getItem(e){var t=this.storage.getItem(e);return p(ol,"READ",e,t),t}setItem(e,t){p(ol,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){p(ol,"REMOVE",e),this.storage.removeItem(e)}Ms(e){let t=e;t.storageArea===this.storage&&(p(ol,"EVENT",t.key,t.newValue),t.key===this.Ns?d("Received WebStorage notification for local change. Another client might have garbage-collected our state"):this.Ti.enqueueRetryable(async()=>{if(this.started){if(null!==t.key){if(this.Ls.test(t.key))return null==t.newValue?(e=this.Xs(t.key),this.eo(e,null)):(e=this.no(t.key,t.newValue))?this.eo(e.clientId,e):void 0;if(this.ks.test(t.key)){if(null!==t.newValue){var e=this.ro(t.key,t.newValue);if(e)return this.io(e)}}else if(this.qs.test(t.key)){if(null!==t.newValue){var e=this.so(t.key,t.newValue);if(e)return this.oo(e)}}else if(t.key===this.Qs){if(null!==t.newValue){var e=this.Ks(t.newValue);if(e)return this.Ws(e)}}else t.key===this.Bs?(e=(e=>{let t=lt.ae;if(null!=e)try{var r=JSON.parse(e);y("number"==typeof r),t=r}catch(e){d(ol,"Failed to read sequence number from WebStorage",e)}return t})(t.newValue))!==lt.ae&&this.sequenceNumberHandler(e):t.key===this.$s&&(e=this._o(t.newValue),await Promise.all(e.map(e=>this.syncEngine.ao(e))))}}else this.Os.push(t)}))}get Hs(){return this.xs.get(this.Cs)}Us(){this.setItem(this.Ns,this.Hs.bs())}zs(e,t,r){var n=new ll(this.currentUser,e,t,r),i=il(this.persistenceKey,this.currentUser,e);this.setItem(i,n.bs())}js(e){var t=il(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Ys(e){var t={clientId:this.Cs,onlineState:e};this.storage.setItem(this.Qs,JSON.stringify(t))}Js(e,t,r){var n=al(this.persistenceKey,e),i=new ul(e,t,r);this.setItem(n,i.bs())}Zs(e){var t=JSON.stringify(Array.from(e));this.setItem(this.$s,t)}Xs(e){var t=this.Ls.exec(e);return t?t[1]:null}no(e,t){var r=this.Xs(e);return hl.Ss(r,t)}ro(e,t){var r=this.ks.exec(e),n=Number(r[1]),r=void 0!==r[2]?r[2]:null;return ll.Ss(new u(r),n,t)}so(e,t){var r=this.qs.exec(e),r=Number(r[1]);return ul.Ss(r,t)}Ks(e){return cl.Ss(e)}_o(e){return JSON.parse(e)}async io(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.uo(e.batchId,e.state,e.error);p(ol,"Ignoring mutation for non-active user "+e.user.uid)}oo(e){return this.syncEngine.co(e.targetId,e.state,e.error)}eo(e,t){let r=t?this.xs.insert(e,t):this.xs.remove(e),n=this.Gs(this.xs),i=this.Gs(r),s=[],a=[];return i.forEach(e=>{n.has(e)||s.push(e)}),n.forEach(e=>{i.has(e)||a.push(e)}),this.syncEngine.lo(s,a).then(()=>{this.xs=r})}Ws(e){this.xs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Gs(e){let r=bi;return e.forEach((e,t)=>{r=r.unionWith(t.activeTargetIds)}),r}}class gl{constructor(){this.ho=new dl,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,t,r){this.Po[e]=t}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new dl,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class ml{To(e){}shutdown(){}}let pl="ConnectivityMonitor";class yl{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){p(pl,"Network connectivity changed: AVAILABLE");for(var e of this.Vo)e(0)}Ro(){p(pl,"Network connectivity changed: UNAVAILABLE");for(var e of this.Vo)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let vl=null;function wl(){return null===vl?vl=268435456+Math.round(2147483648*Math.random()):vl++,"0x"+vl.toString(16)}let _l="RestConnection",bl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Il{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Uo(e){this.ko(e)}Ko(e){this.qo(e)}}let Tl="WebChannelConnection";class El extends class{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;var t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),n=encodeURIComponent(this.databaseId.database);this.po=t+"://"+e.host,this.yo=`projects/${r}/databases/`+n,this.wo=this.databaseId.database===Yr?"project_id="+r:`project_id=${r}&database_id=`+n}So(t,e,r,n,i){let s=wl(),a=this.bo(t,e.toUriEncodedString());p(_l,`Sending RPC '${t}' ${s}:`,a,r);var o={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(o,n,i),this.vo(t,a,o,r).then(e=>(p(_l,`Received RPC '${t}' ${s}: `,e),e),e=>{throw me(_l,`RPC '${t}' ${s} failed with error: `,e,"url: ",a,"request:",r),e})}Co(e,t,r,n,i,s){return this.So(e,t,r,n,i)}Do(r,e,t){r["X-Goog-Api-Client"]="gl-js/ fire/"+de,r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((e,t)=>r[t]=e),t&&t.headers.forEach((e,t)=>r[t]=e)}bo(e,t){var r=bl[e];return this.po+`/v1/${t}:`+r}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(l,t,r,n){let u=wl();return new Promise((s,a)=>{let o=new pr;o.setWithCredentials(!0),o.listenOnce(vr.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case wr.NO_ERROR:var e=o.getResponseJson();p(Tl,`XHR for RPC '${l}' ${u} received:`,JSON.stringify(e)),s(e);break;case wr.TIMEOUT:p(Tl,`RPC '${l}' ${u} timed out`),a(new I(b.DEADLINE_EXCEEDED,"Request time out"));break;case wr.HTTP_ERROR:var t=o.getStatus();if(p(Tl,`RPC '${l}' ${u} failed with status:`,t,"response text:",o.getResponseText()),0<t){let e=o.getResponseJson();var r=null==(e=Array.isArray(e)?e[0]:e)?void 0:e.error;if(r&&r.status&&r.message){n=r.status,i=n.toLowerCase().replace(/_/g,"-");let e=0<=Object.values(b).indexOf(i)?i:b.UNKNOWN;a(new I(e,r.message))}else a(new I(b.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new I(b.UNAVAILABLE,"Connection failed."));break;default:T()}}finally{p(Tl,`RPC '${l}' ${u} completed.`)}var n,i});var e=JSON.stringify(n);p(Tl,`RPC '${l}' ${u} sending request:`,n),o.send(t,"POST",e,r,15)})}Wo(i,e,t){let s=wl(),r=[this.po,"/","google.firestore.v1.Firestore","/",i,"/channel"],n=Tr(),a=Ir(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/`+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.Do(o.initMessageHeaders,e,t),o.encodeInitMessageHeaders=!0;var u=r.join("");p(Tl,`Creating RPC '${i}' stream ${s}: `+u,o);let h=n.createWebChannel(u,o),c=!1,d=!1,f=new Il({Fo:e=>{d?p(Tl,`Not sending because RPC '${i}' stream ${s} is closed:`,e):(c||(p(Tl,`Opening RPC '${i}' stream ${s} transport.`),h.open(),c=!0),p(Tl,`RPC '${i}' stream ${s} sending:`,e),h.send(e))},Mo:()=>h.close()}),g=(e,t,r)=>{e.listen(t,e=>{try{r(e)}catch(e){setTimeout(()=>{throw e},0)}})};return g(h,yr.EventType.OPEN,()=>{d||(p(Tl,`RPC '${i}' stream ${s} transport opened.`),f.Qo())}),g(h,yr.EventType.CLOSE,()=>{d||(d=!0,p(Tl,`RPC '${i}' stream ${s} transport closed`),f.Uo())}),g(h,yr.EventType.ERROR,e=>{d||(d=!0,me(Tl,`RPC '${i}' stream ${s} transport errored:`,e),f.Uo(new I(b.UNAVAILABLE,"The operation could not be completed")))}),g(h,yr.EventType.MESSAGE,e=>{if(!d){var t=e.data[0],n=(y(!!t),t),n=(null==n?void 0:n.error)||(null==(n=n[0])?void 0:n.error);if(n){p(Tl,`RPC '${i}' stream ${s} received error:`,n);let e=n.status,t=(e=>{var t=m[e];if(void 0!==t)return es(t)})(e),r=n.message;void 0===t&&(t=b.INTERNAL,r="Unknown error status: "+e+" with message "+n.message),d=!0,f.Uo(new I(t,r)),h.close()}else p(Tl,`RPC '${i}' stream ${s} received:`,t),f.Ko(t)}}),g(a,br.STAT_EVENT,e=>{e.stat===_r.PROXY?p(Tl,`RPC '${i}' stream ${s} detected buffering proxy`):e.stat===_r.NOPROXY&&p(Tl,`RPC '${i}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{f.$o()},0),f}}function Sl(){return"undefined"!=typeof window?window:null}function xl(){return"undefined"!=typeof document?document:null}function Al(e){return new vs(e,!0)}class Cl{constructor(e,t,r=1e3,n=1.5,i=6e4){this.Ti=e,this.timerId=t,this.Go=r,this.zo=n,this.jo=i,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();var t=Math.floor(this.Ho+this.e_()),r=Math.max(0,Date.now()-this.Yo),n=Math.max(0,t-r);0<n&&p("ExponentialBackoff",`Backing off for ${n} ms (base delay: ${this.Ho} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,n,()=>(this.Yo=Date.now(),e())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){null!==this.Jo&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){null!==this.Jo&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}let Dl="PersistentStream";class Nl{constructor(e,t,r,n,i,s,a,o){this.Ti=e,this.n_=r,this.r_=n,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new Cl(e,t)}u_(){return 1===this.state||5===this.state||this.c_()}c_(){return 2===this.state||3===this.state}start(){this.__=0,4!==this.state?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&null===this.s_&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(e){this.E_(),this.stream.send(e)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(e,t){this.E_(),this.d_(),this.a_.cancel(),this.i_++,4!==e?this.a_.reset():t&&t.code===b.RESOURCE_EXHAUSTED?(d(t.toString()),d("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):t&&t.code===b.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Lo(t)}A_(){}auth(){this.state=1;let e=this.R_(this.i_),r=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,t])=>{this.i_===r&&this.V_(e,t)},t=>{e(()=>{var e=new I(b.UNKNOWN,"Fetching auth token failed: "+t.message);return this.m_(e)})})}V_(e,t){let r=this.R_(this.i_);this.stream=this.f_(e,t),this.stream.xo(()=>{r(()=>this.listener.xo())}),this.stream.No(()=>{r(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(e=>{r(()=>this.m_(e))}),this.stream.onMessage(e=>{r(()=>1==++this.__?this.g_(e):this.onNext(e))})}l_(){this.state=5,this.a_.Xo(async()=>{this.state=0,this.start()})}m_(e){return p(Dl,"close with error: "+e),this.stream=null,this.close(4,e)}R_(t){return e=>{this.Ti.enqueueAndForget(()=>this.i_===t?e():(p(Dl,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class kl extends Nl{constructor(e,t,r,n,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,n,s),this.serializer=i}f_(e,t){return this.connection.Wo("Listen",e,t)}g_(e){return this.onNext(e)}onNext(e){this.a_.reset();var t=((e,t)=>{let r;if("targetChange"in t){t.targetChange;var n="NO_CHANGE"===(l=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===l?1:"REMOVE"===l?2:"CURRENT"===l?3:"RESET"===l?4:T(),i=t.targetChange.targetIds||[],s=(l=t.targetChange.resumeToken,e.useProto3Json?(y(void 0===l||"string"==typeof l),D.fromBase64String(l||"")):(y(void 0===l||l instanceof Buffer||l instanceof Uint8Array),D.fromUint8Array(l||new Uint8Array))),a=t.targetChange.cause,a=a&&(a=void 0===(l=a).code?b.UNKNOWN:es(l.code),new I(a,l.message||""));r=new hs(n,i,s,a||null)}else if("documentChange"in t){t.documentChange;var n=t.documentChange,i=(n.document,n.document.name,n.document.updateTime,xs(e,n.document.name)),s=V(n.document.updateTime),a=n.document.createTime?V(n.document.createTime):g.min(),o=new En({mapValue:{fields:n.document.fields}}),i=k.newFoundDocument(i,s,a,o),s=n.targetIds||[],o=n.removedTargetIds||[];r=new ls(s,o,i.key,i)}else if("documentDelete"in t){t.documentDelete;n=t.documentDelete,s=(n.document,xs(e,n.document)),o=n.readTime?V(n.readTime):g.min(),i=k.newNoDocument(s,o),s=n.removedTargetIds||[];r=new ls([],s,i.key,i)}else if("documentRemove"in t){t.documentRemove;o=t.documentRemove,n=(o.document,xs(e,o.document)),s=o.removedTargetIds||[];r=new ls([],s,n,null)}else{if(!("filter"in t))return T();{t.filter;let e=t.filter;e.targetId;var{count:i=0,unchangedNames:o}=e,s=new Ji(i,o),n=e.targetId;r=new us(n,s)}}var l;return r})(this.serializer,e),r="targetChange"in(e=e)&&(!(r=e.targetChange).targetIds||!r.targetIds.length)&&r.readTime?V(r.readTime):g.min();return this.listener.p_(t,r)}y_(e){var t={},r=(t.database=Ds(this.serializer),t.addTarget=((t,r)=>{var n;let e=r.target;if((n=Hn(e)?{documents:Vs(t,e)}:{query:Fs(t,e).ht}).targetId=r.targetId,0<r.resumeToken.approximateByteSize()){n.resumeToken=bs(t,r.resumeToken);let e=ws(t,r.expectedCount);null!==e&&(n.expectedCount=e)}else if(0<r.snapshotVersion.compareTo(g.min())){n.readTime=_s(t,r.snapshotVersion.toTimestamp());let e=ws(t,r.expectedCount);null!==e&&(n.expectedCount=e)}return n})(this.serializer,e),Us(this.serializer,e));r&&(t.labels=r),this.I_(t)}w_(e){var t={};t.database=Ds(this.serializer),t.removeTarget=e,this.I_(t)}}class Rl extends Nl{constructor(e,t,r,n,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,n,s),this.serializer=i}get S_(){return 0<this.__}start(){this.lastStreamToken=void 0,super.start()}A_(){this.S_&&this.b_([])}f_(e,t){return this.connection.Wo("Write",e,t)}g_(e){return y(!!e.streamToken),this.lastStreamToken=e.streamToken,y(!e.writeResults||0===e.writeResults.length),this.listener.D_()}onNext(e){y(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();var t=Ms(e.writeResults,e.commitTime),r=V(e.commitTime);return this.listener.v_(r,t)}C_(){var e={};e.database=Ds(this.serializer),this.I_(e)}b_(e){var t={streamToken:this.lastStreamToken,writes:e.map(e=>Ls(this.serializer,e))};this.I_(t)}}class Ll extends class{}{constructor(e,t,r,n){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=n,this.F_=!1}M_(){if(this.F_)throw new I(b.FAILED_PRECONDITION,"The client has already been terminated.")}So(r,n,i,s){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([e,t])=>this.connection.So(r,Ts(n,i),s,e,t)).catch(e=>{throw"FirebaseError"===e.name?(e.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new I(b.UNKNOWN,e.toString())})}Co(r,n,i,s,a){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([e,t])=>this.connection.Co(r,Ts(n,i),s,e,t,a)).catch(e=>{throw"FirebaseError"===e.name?(e.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new I(b.UNKNOWN,e.toString())})}terminate(){this.F_=!0,this.connection.terminate()}}class Ol{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){0===this.x_&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(e){"Online"===this.state?this.L_("Unknown"):(this.x_++,1<=this.x_&&(this.Q_(),this.k_("Connection failed 1 times. Most recent error: "+e.toString()),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,"Online"===e&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){var t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(d(t),this.N_=!1):p("OnlineStateTracker",t)}Q_(){null!==this.O_&&(this.O_.cancel(),this.O_=null)}}let Ml="RemoteStore";class Vl{constructor(e,t,r,n,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.U_=[],this.K_=new Map,this.W_=new Set,this.G_=[],this.z_=i,this.z_.To(e=>{r.enqueueAndForget(async()=>{var e;Kl(this)&&(p(Ml,"Restarting streams for network reachability change."),(e=this).W_.add(4),await Pl(e),e.j_.set("Unknown"),e.W_.delete(4),await Fl(e))})}),this.j_=new Ol(r,n)}}async function Fl(e){if(Kl(e))for(var t of e.G_)await t(!0)}async function Pl(e){for(var t of e.G_)await t(!1)}function Ul(e,t){var r=e;r.K_.has(t.targetId)||(r.K_.set(t.targetId,t),Gl(r)?zl(r):eu(r).c_()&&ql(r,t))}function Bl(e,t){var r=e,n=eu(r);r.K_.delete(t),n.c_()&&jl(r,t),0===r.K_.size&&(n.c_()?n.P_():Kl(r)&&r.j_.set("Unknown"))}function ql(e,t){var r;e.H_.Ne(t.targetId),(0<t.resumeToken.approximateByteSize()||0<t.snapshotVersion.compareTo(g.min()))&&(r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size,t=t.withExpectedCount(r)),eu(e).y_(t)}function jl(e,t){e.H_.Ne(t),eu(e).w_(t)}function zl(t){t.H_=new ds({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),lt:e=>t.K_.get(e)||null,it:()=>t.datastore.serializer.databaseId}),eu(t).start(),t.j_.B_()}function Gl(e){return Kl(e)&&!eu(e).u_()&&0<e.K_.size}function Kl(e){return 0===e.W_.size}function Ql(e){e.H_=void 0}async function $l(e,t,r){if(!et(t))throw t;e.W_.add(1),await Pl(e),e.j_.set("Offline"),r=r||(()=>Qo(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{p(Ml,"Retrying IndexedDB access"),await r(),e.W_.delete(1),await Fl(e)})}function Hl(t,r){return r().catch(e=>$l(t,e,r))}async function Wl(e){var t,r,n,i,s=e,a=tu(s);let o=0<s.U_.length?s.U_[s.U_.length-1].batchId:ut;for(;Kl(i=s)&&i.U_.length<10;)try{let e=await((e,t)=>{let r=e;return r.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=ut),r.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))})(s.localStore,o);if(null===e){0===s.U_.length&&a.P_();break}o=e.batchId,t=s,r=e,n=void 0,t.U_.push(r),(n=tu(t)).c_()&&n.S_&&n.b_(r.mutations)}catch(e){await $l(s,e)}Yl(s)&&Xl(s)}function Yl(e){return Kl(e)&&!tu(e).u_()&&0<e.U_.length}function Xl(e){tu(e).start()}async function Jl(e,t){var r=e,n=(r.asyncQueue.verifyOperationInProgress(),p(Ml,"RemoteStore received new credentials"),Kl(r));r.W_.add(3),await Pl(r),n&&r.j_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.W_.delete(3),await Fl(r)}async function Zl(e,t){var r=e;t?(r.W_.delete(2),await Fl(r)):(r.W_.add(2),await Pl(r),r.j_.set("Unknown"))}function eu(t){return t.J_||(t.J_=(e=t.datastore,r=t.asyncQueue,n={xo:(async function(e){e.j_.set("Online")}).bind(null,t),No:(async function(r){r.K_.forEach((e,t)=>{ql(r,e)})}).bind(null,t),Lo:(async function(e,t){Ql(e),Gl(e)?(e.j_.q_(t),zl(e)):e.j_.set("Unknown")}).bind(null,t),p_:(async function(t,e,r){if(t.j_.set("Online"),e instanceof hs&&2===e.state&&e.cause)try{var n,i=t,s=e,a=s.cause;for(n of s.targetIds)i.K_.has(n)&&(await i.remoteSyncer.rejectListen(n,a),i.K_.delete(n),i.H_.removeTarget(n))}catch(r){p(Ml,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await $l(t,r)}else if(e instanceof ls?t.H_.We(e):e instanceof us?t.H_.Ze(e):t.H_.je(e),!r.isEqual(g.min()))try{let e=await Qo(t.localStore);0<=r.compareTo(e)&&(l=r,(u=(o=t).H_.ot(l)).targetChanges.forEach((e,t)=>{var r;0<e.resumeToken.approximateByteSize()&&(r=o.K_.get(t))&&o.K_.set(t,r.withResumeToken(e.resumeToken,l))}),u.targetMismatches.forEach((e,t)=>{var r=o.K_.get(e);r&&(o.K_.set(e,r.withResumeToken(D.EMPTY_BYTE_STRING,r.snapshotVersion)),jl(o,e),r=new Ks(r.target,e,t,r.sequenceNumber),ql(o,r))}),await o.remoteSyncer.applyRemoteEvent(u))}catch(e){p(Ml,"Failed to raise snapshot:",e),await $l(t,e)}var o,l,u}).bind(null,t)},(i=e).M_(),new kl(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)),t.G_.push(async e=>{e?(t.J_.h_(),Gl(t)?zl(t):t.j_.set("Unknown")):(await t.J_.stop(),Ql(t))})),t.J_;var e,r,n,i}function tu(t){return t.Y_||(t.Y_=(e=t.datastore,r=t.asyncQueue,n={xo:()=>Promise.resolve(),No:(async function(e){tu(e).C_()}).bind(null,t),Lo:(async function(e,t){if(t&&tu(e).S_){var r=e,n=t;if(Zi(t=n.code)&&t!==b.ABORTED){let e=r.U_.shift();tu(r).h_(),await Hl(r,()=>r.remoteSyncer.rejectFailedWrite(e.batchId,n)),await Wl(r)}await 0}Yl(e)&&Xl(e)}).bind(null,t),D_:(async function(e){var t,r=tu(e);for(t of e.U_)r.b_(t.mutations)}).bind(null,t),v_:(async function(e,t,r){let n=e.U_.shift(),i=Yi.from(n,t,r);await Hl(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await Wl(e)}).bind(null,t)},(i=e).M_(),new Rl(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)),t.G_.push(async e=>{e?(t.Y_.h_(),await Wl(t)):(await t.Y_.stop(),0<t.U_.length&&(p(Ml,`Stopping write stream with ${t.U_.length} pending writes`),t.U_=[]))})),t.Y_;var e,r,n,i}class ru{constructor(e,t,r,n,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=n,this.removalCallback=i,this.deferred=new f,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,n,i){var s=Date.now()+r,s=new ru(e,t,s,n,i);return s.start(r),s}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new I(b.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function nu(e,t){if(d("AsyncQueue",t+": "+e),et(e))return new I(b.UNAVAILABLE,t+": "+e);throw e}class iu{static emptySet(e){return new iu(e.comparator)}constructor(r){this.comparator=r?(e,t)=>r(e,t)||x.comparator(e.key,t.key):(e,t)=>x.comparator(e.key,t.key),this.keyedMap=pi(),this.sortedSet=new A(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(r){this.sortedSet.inorderTraversal((e,t)=>(r(e),!1))}add(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof iu))return!1;if(this.size!==e.size)return!1;for(var r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();r.hasNext();){let e=r.getNext().key,t=n.getNext().key;if(!e.isEqual(t))return!1}return!0}toString(){let t=[];return this.forEach(e=>{t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(e,t){var r=new iu;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class su{constructor(){this.Z_=new A(x.comparator)}track(e){var t=e.doc.key,r=this.Z_.get(t);!r||0!==e.type&&3===r.type?this.Z_=this.Z_.insert(t,e):3===e.type&&1!==r.type?this.Z_=this.Z_.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.Z_=this.Z_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.Z_=this.Z_.remove(t):1===e.type&&2===r.type?this.Z_=this.Z_.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):T()}X_(){let r=[];return this.Z_.inorderTraversal((e,t)=>{r.push(t)}),r}}class au{constructor(e,t,r,n,i,s,a,o,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=n,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,n,i){let s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new au(e,t,iu.emptySet(t),s,r,n,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&oi(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let n=0;n<t.length;n++)if(t[n].type!==r[n].type||!t[n].doc.isEqual(r[n].doc))return!1;return!0}}class ou{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some(e=>e.ra())}}class lu{constructor(){this.queries=uu(),this.onlineState="Unknown",this.ia=new Set}terminate(){var e,r,t,n;e=this,r=new I(b.ABORTED,"Firestore shutting down"),n=(t=e).queries,t.queries=uu(),n.forEach((e,t)=>{for(let e of t.ta)e.onError(r)})}}function uu(){return new fi(e=>li(e),oi)}async function hu(t,r){let e=t,n=3;var i=r.query;let s=e.queries.get(i);s?!s.na()&&r.ra()&&(n=2):(s=new ou,n=r.ra()?0:1);try{switch(n){case 0:s.ea=await e.onListen(i,!0);break;case 1:s.ea=await e.onListen(i,!1);break;case 2:await e.onFirstRemoteStoreListen(i)}}catch(t){let e=nu(t,`Initialization of query '${ui(r.query)}' failed`);return void r.onError(e)}e.queries.set(i,s),s.ta.push(r),r.sa(e.onlineState),s.ea&&r.oa(s.ea)&&du(e)}async function cu(e,t){var r=e,n=t.query;let i=3;var s=r.queries.get(n);if(s){let e=s.ta.indexOf(t);0<=e&&(s.ta.splice(e,1),0===s.ta.length?i=t.ra()?0:1:!s.na()&&t.ra()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function du(e){e.ia.forEach(e=>{e.next()})}(ue=ue||{})._a="default",ue.Cache="cache";class fu{constructor(e,t,r){this.query=e,this.aa=t,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=r||{}}oa(t){if(!this.options.includeMetadataChanges){let e=[];for(var r of t.docChanges)3!==r.type&&e.push(r);t=new au(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.ua?this.la(t)&&(this.aa.next(t),e=!0):this.ha(t,this.onlineState)&&(this.Pa(t),e=!0),this.ca=t,e}onError(e){this.aa.error(e)}sa(e){this.onlineState=e;let t=!1;return this.ca&&!this.ua&&this.ha(this.ca,e)&&(this.Pa(this.ca),t=!0),t}ha(e,t){return!e.fromCache||!this.ra()||(!this.options.Ta||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}la(e){var t;return 0<e.docChanges.length||(t=this.ca&&this.ca.hasPendingWrites!==e.hasPendingWrites,!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges)}Pa(e){e=au.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ua=!0,this.aa.next(e)}ra(){return this.options.source!==ue.Cache}}class gu{constructor(e,t){this.Ia=e,this.byteLength=t}Ea(){return"metadata"in this.Ia}}class mu{constructor(e){this.serializer=e}ps(e){return xs(this.serializer,e)}ys(e){return e.metadata.exists?Rs(this.serializer,e.document,!1):k.newNoDocument(this.ps(e.metadata.name),this.ws(e.metadata.readTime))}ws(e){return V(e)}}class pu{constructor(e,t,r){this.da=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=yu(e)}Aa(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;var r;return e.Ia.namedQuery?this.queries.push(e.Ia.namedQuery):e.Ia.documentMetadata?(this.documents.push({metadata:e.Ia.documentMetadata}),e.Ia.documentMetadata.exists||++t,r=S.fromString(e.Ia.documentMetadata.name),this.collectionGroups.add(r.get(r.length-2))):e.Ia.document&&(this.documents[this.documents.length-1].document=e.Ia.document,++t),t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Ra(e){let r=new Map,n=new mu(this.serializer);for(var i of e)if(i.metadata.queries){let e=n.ps(i.metadata.name);for(let t of i.metadata.queries){var s=(r.get(t)||O()).add(e);r.set(t,s)}}return r}async complete(){let e=await(async(r,n,e,t)=>{let i=r,s=O(),a=gi;for(let r of e){let e=n.ps(r.metadata.name),t=(r.document&&(s=s.add(e)),n.ys(r));t.setReadTime(n.ws(r.metadata.readTime)),a=a.insert(e,t)}let o=i.ds.newChangeBuffer({trackRemovals:!0}),l=await Wo(i,(r=t,ii(ei(S.fromString("__bundle__/docs/"+r)))));return i.persistence.runTransaction("Apply bundle documents","readwrite",t=>Ho(t,o,a).next(e=>(o.apply(t),e)).next(e=>i.Hr.removeMatchingKeysForTargetId(t,l.targetId).next(()=>i.Hr.addMatchingKeys(t,s,l.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(t,e.Vs,e.fs)).next(()=>e.Vs)))})(this.localStore,new mu(this.serializer),this.documents,this.da.id),t=this.Ra(this.documents);for(let e of this.queries)await(async(e,r,n=O())=>{let i=await Wo(e,ii(ea(r.bundledQuery))),s=e;return s.persistence.runTransaction("Save named query","readwrite",e=>{var t=V(r.readTime);return 0<=i.snapshotVersion.compareTo(t)?s.Yr.saveNamedQuery(e,r):(t=i.withResumeToken(D.EMPTY_BYTE_STRING,t),s.Ts=s.Ts.insert(t.targetId,t),s.Hr.updateTargetData(e,t).next(()=>s.Hr.removeMatchingKeysForTargetId(e,i.targetId)).next(()=>s.Hr.addMatchingKeys(e,n,i.targetId)).next(()=>s.Yr.saveNamedQuery(e,r)))})})(this.localStore,e,t.get(e.name));return this.progress.taskState="Success",{progress:this.progress,Va:this.collectionGroups,ma:e}}}function yu(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class vu{constructor(e){this.key=e}}class wu{constructor(e){this.key=e}}class _u{constructor(e,t){this.query=e,this.fa=t,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=O(),this.mutatedKeys=O(),this.ya=di(e),this.wa=new iu(this.ya)}get Sa(){return this.fa}ba(e,t){let o=t?t.Da:new su,l=(t||this).wa,u=(t||this).mutatedKeys,h=l,c=!1,d="F"===this.query.limitType&&l.size===this.query.limit?l.last():null,f="L"===this.query.limitType&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal((e,t)=>{var r=l.get(e),n=hi(this.query,t)?t:null,i=!!r&&this.mutatedKeys.has(r.key),s=!!n&&(n.hasLocalMutations||this.mutatedKeys.has(n.key)&&n.hasCommittedMutations);let a=!1;r&&n?r.data.isEqual(n.data)?i!==s&&(o.track({type:3,doc:n}),a=!0):!this.va(r,n)&&(o.track({type:2,doc:n}),a=!0,d&&0<this.ya(n,d)||f&&this.ya(n,f)<0)&&(c=!0):!r&&n?(o.track({type:0,doc:n}),a=!0):r&&!n&&(o.track({type:1,doc:r}),a=!0,d||f)&&(c=!0),a&&(u=n?(h=h.add(n),s?u.add(e):u.delete(e)):(h=h.delete(e),u.delete(e)))}),null!==this.query.limit)for(;h.size>this.query.limit;){let e="F"===this.query.limitType?h.last():h.first();h=h.delete(e.key),u=u.delete(e.key),o.track({type:1,doc:e})}return{wa:h,Da:o,ls:c,mutatedKeys:u}}va(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,n){var i=this.wa,s=(this.wa=e.wa,this.mutatedKeys=e.mutatedKeys,e.Da.X_()),a=(s.sort((e,t)=>{return r=e.type,n=t.type,(i=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return T()}})(r)-i(n)||this.ya(e.doc,t.doc);var r,n,i}),this.Ca(r),n=null!=n&&n,t&&!n?this.Fa():[]),o=0===this.pa.size&&this.current&&!n?1:0,l=o!==this.ga;return this.ga=o,0!==s.length||l?{snapshot:new au(this.query,e.wa,i,s,e.mutatedKeys,0==o,l,!1,!!r&&0<r.resumeToken.approximateByteSize()),Ma:a}:{Ma:a}}sa(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({wa:this.wa,Da:new su,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(e){return!this.fa.has(e)&&!!this.wa.has(e)&&!this.wa.get(e).hasLocalMutations}Ca(e){e&&(e.addedDocuments.forEach(e=>this.fa=this.fa.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.fa=this.fa.delete(e)),this.current=e.current)}Fa(){if(!this.current)return[];let t=this.pa,r=(this.pa=O(),this.wa.forEach(e=>{this.xa(e.key)&&(this.pa=this.pa.add(e.key))}),[]);return t.forEach(e=>{this.pa.has(e)||r.push(new wu(e))}),this.pa.forEach(e=>{t.has(e)||r.push(new vu(e))}),r}Oa(e){this.fa=e.gs,this.pa=O();var t=this.ba(e.documents);return this.applyChanges(t,!0)}Na(){return au.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,0===this.ga,this.hasCachedResults)}}let bu="SyncEngine";class Iu{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class Tu{constructor(e){this.key=e,this.Ba=!1}}class Eu{constructor(e,t,r,n,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=n,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.La={},this.ka=new fi(e=>li(e),oi),this.qa=new Map,this.Qa=new Set,this.$a=new A(x.comparator),this.Ua=new Map,this.Ka=new _o,this.Wa={},this.Ga=new Map,this.za=Qa.Kn(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return!0===this.ja}}async function Su(e,t,r,n){var i=await Wo(e.localStore,ii(t)),s=i.targetId,a=e.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await xu(e,t,s,"current"===a,i.resumeToken)),e.isPrimaryClient&&r&&Ul(e.remoteStore,i),o}async function xu(n,e,t,r,i){n.Ha=(e,t,r)=>(async(e,t,r,n)=>{let i=t.view.ba(r);i.ls&&(i=await Xo(e.localStore,t.query,!1).then(({documents:e})=>t.view.ba(e,i)));var s=n&&n.targetChanges.get(t.targetId),a=n&&null!=n.targetMismatches.get(t.targetId),s=t.view.applyChanges(i,e.isPrimaryClient,s,a);return Vu(e,t.targetId,s.Ma),s.snapshot})(n,e,t,r);var s=await Xo(n.localStore,e,!0),a=new _u(e,s.gs),s=a.ba(s.documents),o=os.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState,i),s=a.applyChanges(s,n.isPrimaryClient,o),o=(Vu(n,t,s.Ma),new Iu(e,t,a));return n.ka.set(e,o),n.qa.has(t)?n.qa.get(t).push(e):n.qa.set(t,[e]),s.snapshot}async function Au(t,e,r){var n=zu(t);try{let t=await((e,i)=>{let s=e,a=h.now(),o=i.reduce((e,t)=>e.add(t.key),O()),l,u;return s.persistence.runTransaction("Locally write mutations","readwrite",n=>{let t=gi,r=O();return s.ds.getEntries(n,o).next(e=>{(t=e).forEach((e,t)=>{t.isValidDocument()||(r=r.add(e))})}).next(()=>s.localDocuments.getOverlayedDocuments(n,t)).next(e=>{l=e;var t=[];for(let r of i){let e=((e,r)=>{let n=null;for(var i of e.fieldTransforms){let e=r.data.field(i.field),t=xi(i.transform,e||null);null!=t&&(n=null===n?En.empty():n).set(i.field,t)}return n||null})(r,l.get(r.key).overlayedDocument);null!=e&&t.push(new zi(r.key,e,function i(e){let s=[];return kr(e.fields,(e,r)=>{var n=new v([e]);if(yn(r)){let t=i(r.mapValue).fields;if(0===t.length)s.push(n);else for(let e of t)s.push(n.child(e))}else s.push(n)}),new Fr(s)}(e.value.mapValue),M.exists(!0)))}return s.mutationQueue.addMutationBatch(n,a,t,i)}).next(e=>{var t=(u=e).applyToLocalDocumentSet(l,r);return s.documentOverlayCache.saveOverlays(n,e.batchId,t)})}).then(()=>({batchId:u.batchId,changes:yi(l)}))})(n.localStore,e);n.sharedClientState.addPendingMutation(t.batchId);{var i=n;var s=t.batchId;var a=r;let e=i.Wa[i.currentUser.toKey()];e=(e=e||new A(E)).insert(s,a),i.Wa[i.currentUser.toKey()]=e}await Pu(n,t.changes),await Wl(n.remoteStore)}catch(t){let e=nu(t,"Failed to persist write");r.reject(e)}}async function Cu(e,t){let n=e;try{let e=await $o(n.localStore,t);t.targetChanges.forEach((e,t)=>{var r=n.Ua.get(t);r&&(y(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),0<e.addedDocuments.size?r.Ba=!0:0<e.modifiedDocuments.size?y(r.Ba):0<e.removedDocuments.size&&(y(r.Ba),r.Ba=!1))}),await Pu(n,e,t)}catch(e){await $e(e)}}function Du(e,i,t){var s=e;if(s.isPrimaryClient&&0===t||!s.isPrimaryClient&&1===t){let n=[];s.ka.forEach((e,t)=>{var r=t.view.sa(i);r.snapshot&&n.push(r.snapshot)});{t=s.eventManager;var a=i;var o=t;o.onlineState=a;let r=!1;o.queries.forEach((e,t)=>{for(let e of t.ta)e.sa(a)&&(r=!0)}),r&&du(o)}n.length&&s.La.p_(n),s.onlineState=i,s.isPrimaryClient&&s.sharedClientState.setOnlineState(i)}}async function Nu(e,t,r){var n=e;try{let e=await((e,n)=>{let i=e;return i.persistence.runTransaction("Reject batch","readwrite-primary",t=>{let r;return i.mutationQueue.lookupMutationBatch(t,n).next(e=>(y(null!==e),r=e.keys(),i.mutationQueue.removeMutationBatch(t,e))).next(()=>i.mutationQueue.performConsistencyCheck(t)).next(()=>i.documentOverlayCache.removeOverlaysForBatchId(t,r,n)).next(()=>i.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,r)).next(()=>i.localDocuments.getDocuments(t,r))})})(n.localStore,t);Lu(n,t,r),Ru(n,t),n.sharedClientState.updateMutationState(t,"rejected",r),await Pu(n,e)}catch(r){await $e(r)}}async function ku(t,r){let n=t;Kl(n.remoteStore)||p(bu,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let e=await(e=>{let t=e;return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",e=>t.mutationQueue.getHighestUnacknowledgedBatchId(e))})(n.localStore);var i;e===ut?r.resolve():((i=n.Ga.get(e)||[]).push(r),n.Ga.set(e,i))}catch(t){let e=nu(t,"Initialization of waitForPendingWrites() operation failed");r.reject(e)}}function Ru(e,t){(e.Ga.get(t)||[]).forEach(e=>{e.resolve()}),e.Ga.delete(t)}function Lu(e,t,r){var n=e;let i=n.Wa[n.currentUser.toKey()];if(i){let e=i.get(t);e&&(r?e.reject(r):e.resolve(),i=i.remove(t)),n.Wa[n.currentUser.toKey()]=i}}function Ou(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(var n of t.qa.get(e))t.ka.delete(n),r&&t.La.Ja(n,r);t.qa.delete(e),t.isPrimaryClient&&t.Ka.br(e).forEach(e=>{t.Ka.containsKey(e)||Mu(t,e)})}function Mu(e,t){e.Qa.delete(t.path.canonicalString());var r=e.$a.get(t);null!==r&&(Bl(e.remoteStore,r),e.$a=e.$a.remove(t),e.Ua.delete(r),Fu(e))}function Vu(e,t,r){for(var n of r)n instanceof vu?(e.Ka.addReference(n.key,t),i=e,s=n,o=a=void 0,a=s.key,o=a.path.canonicalString(),i.$a.get(a)||i.Qa.has(o)||(p(bu,"New document in limbo: "+a),i.Qa.add(o),Fu(i))):n instanceof wu?(p(bu,"Document no longer in limbo: "+n.key),e.Ka.removeReference(n.key,t),e.Ka.containsKey(n.key)||Mu(e,n.key)):T();var i,s,a,o}function Fu(e){for(;0<e.Qa.size&&e.$a.size<e.maxConcurrentLimboResolutions;){var t=e.Qa.values().next().value,t=(e.Qa.delete(t),new x(S.fromString(t))),r=e.za.next();e.Ua.set(r,new Tu(t)),e.$a=e.$a.insert(t,r),Ul(e.remoteStore,new Ks(ii(ei(t.path)),r,"TargetPurposeLimboResolution",lt.ae))}}async function Pu(e,t,i){let s=e,a=[],o=[],r=[];if(!s.ka.isEmpty()){s.ka.forEach((e,n)=>{r.push(s.Ha(n,t,i).then(t=>{var r;if((t||i)&&s.isPrimaryClient){let e=t?!t.fromCache:null==(r=null==i?void 0:i.targetChanges.get(n.targetId))?void 0:r.current;s.sharedClientState.updateQueryState(n.targetId,e?"current":"not-current")}if(t){a.push(t);let e=Fo.Yi(n.targetId,t);o.push(e)}}))}),await Promise.all(r),s.La.p_(a);{var n=s.localStore,l=o;let i=n;try{await i.persistence.runTransaction("notifyLocalViewChanges","readwrite",r=>w.forEach(l,t=>w.forEach(t.Hi,e=>i.persistence.referenceDelegate.addReference(r,t.targetId,e)).next(()=>w.forEach(t.Ji,e=>i.persistence.referenceDelegate.removeReference(r,t.targetId,e)))))}catch(n){if(!et(n))throw n;p(Bo,"Failed to update sequence numbers: "+n)}for(let e of l){let n=e.targetId;if(!e.fromCache){let e=i.Ts.get(n),t=e.snapshotVersion,r=e.withLastLimboFreeSnapshotVersion(t);i.Ts=i.Ts.insert(n,r)}}}}}async function Uu(e,t,r,n){var i=e,s=await((e,r)=>{let n=e,i=n.mutationQueue;return n.persistence.runTransaction("Lookup mutation documents","readonly",t=>i.Ln(t,r).next(e=>e?n.localDocuments.getDocuments(t,e):w.resolve(null)))})(i.localStore,t);null!==s?("pending"===r?await Wl(i.remoteStore):"acknowledged"===r||"rejected"===r?(Lu(i,t,n||null),Ru(i,t),i.localStore.mutationQueue.qn(t)):T(),await Pu(i,s)):p(bu,"Cannot apply mutation batch with id: "+t)}async function Bu(r,e){var n,i,s,a=r,o=[],l=[];for(let r of e){let t,e=a.qa.get(r);if(e&&0!==e.length){t=await Wo(a.localStore,ii(e[0]));for(let r of e){let e=a.ka.get(r),t=(n=e,s=i=void 0,s=await Xo((i=a).localStore,n.query,!0),s=n.view.Oa(s),i.isPrimaryClient&&Vu(i,n.targetId,s.Ma),await s);t.snapshot&&l.push(t.snapshot)}}else{let e=await Jo(a.localStore,r);t=await Wo(a.localStore,e),await xu(a,qu(e),r,!1,t.resumeToken)}o.push(t)}return a.La.p_(l),o}function qu(e){return Zn(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function ju(e){var t=e;return t.remoteStore.remoteSyncer.applyRemoteEvent=Cu.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=(function(e,t){let n=e,r=n.Ua.get(t);if(r&&r.Ba)return O().add(r.key);{let r=O(),e=n.qa.get(t);if(e)for(let t of e){let e=n.ka.get(t);r=r.unionWith(e.view.Sa)}return r}}).bind(null,t),t.remoteStore.remoteSyncer.rejectListen=(async function(e,n,t){let i=e,r=(i.sharedClientState.updateQueryState(n,"rejected",t),i.Ua.get(n)),s=r&&r.key;if(s){let e=new A(x.comparator),t=(e=e.insert(s,k.newNoDocument(s,g.min())),O().add(s)),r=new as(g.min(),new Map,new A(E),e,t);await Cu(i,r),i.$a=i.$a.remove(s),i.Ua.delete(n),Fu(i)}else await Yo(i.localStore,n,!1).then(()=>Ou(i,n,t)).catch($e)}).bind(null,t),t.La.p_=(function(r,e){var n=r;let i=!1;for(let r of e){let e=r.query,t=n.queries.get(e);if(t){for(let e of t.ta)e.oa(r)&&(i=!0);t.ea=r}}i&&du(n)}).bind(null,t.eventManager),t.La.Ja=(function(e,t,r){var n=e,i=n.queries.get(t);if(i)for(let e of i.ta)e.onError(r);n.queries.delete(t)}).bind(null,t.eventManager),t}function zu(e){var t=e;return t.remoteStore.remoteSyncer.applySuccessfulWrite=(async function(e,t){var r=e,n=t.batch.batchId;try{let e=await Ko(r.localStore,t);Lu(r,n,null),Ru(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Pu(r,e)}catch(e){await $e(e)}}).bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Nu.bind(null,t),t}function Gu(e,t,r){let n=e;(async(e,r,n)=>{try{var i=await r.getMetadata();if(await((e,t)=>{let r=e,n=V(t.createTime);return r.persistence.runTransaction("hasNewerBundle","readonly",e=>r.Yr.getBundleMetadata(e,t.id)).then(e=>!!e&&0<=e.createTime.compareTo(n))})(e.localStore,i))return await r.close(),n._completeWith({taskState:"Success",documentsLoaded:i.totalDocuments,bytesLoaded:i.totalBytes,totalDocuments:i.totalDocuments,totalBytes:i.totalBytes}),Promise.resolve(new Set);n._updateProgress(yu(i));var s=new pu(i,e.localStore,r.serializer);let t=await r.Ya();for(;t;){let e=await s.Aa(t);e&&n._updateProgress(e),t=await r.Ya()}var a=await s.complete();return await Pu(e,a.ma,void 0),await((e,t)=>{let r=e;return r.persistence.runTransaction("Save bundle","readwrite",e=>r.Yr.saveBundleMetadata(e,t))})(e.localStore,i),n._completeWith(a.progress),Promise.resolve(a.Va)}catch(e){return me(bu,"Loading bundle failed with "+e),n._failWith(e),Promise.resolve(new Set)}})(n,t,r).then(e=>{n.sharedClientState.notifyBundleLoaded(e)})}class Ku{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Al(e.databaseInfo.databaseId),this.sharedClientState=this.Za(e),this.persistence=this.Xa(e),await this.persistence.start(),this.localStore=this.eu(e),this.gcScheduler=this.tu(e,this.localStore),this.indexBackfillerScheduler=this.nu(e,this.localStore)}tu(e,t){return null}nu(e,t){return null}eu(e){return zo(this.persistence,new Uo,e.initialUser,this.serializer)}Xa(e){return new So(Ao.ri,this.serializer)}Za(e){return new gl}async terminate(){var e;null!=(e=this.gcScheduler)&&e.stop(),null!=(e=this.indexBackfillerScheduler)&&e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ku.provider={build:()=>new Ku};class Qu extends Ku{constructor(e){super(),this.cacheSizeBytes=e}tu(e,t){y(this.persistence.referenceDelegate instanceof Co);var r=this.persistence.referenceDelegate.garbageCollector;return new eo(r,e.asyncQueue,t)}Xa(e){let t=void 0!==this.cacheSizeBytes?Pa.withCacheSize(this.cacheSizeBytes):Pa.DEFAULT;return new So(e=>Co.ri(e,t),this.serializer)}}class $u extends Ku{constructor(e,t,r){super(),this.ru=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.ru.initialize(this,e),await zu(this.ru.syncEngine),await Wl(this.ru.remoteStore),await this.persistence.Ci(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}eu(e){return zo(this.persistence,new Uo,e.initialUser,this.serializer)}tu(e,t){var r=this.persistence.referenceDelegate.garbageCollector;return new eo(r,e.asyncQueue,t)}nu(e,t){var r=new ot(t,this.persistence);return new at(e.asyncQueue,r)}Xa(e){var t=Vo(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?Pa.withCacheSize(this.cacheSizeBytes):Pa.DEFAULT;return new Lo(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,Sl(),xl(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Za(e){return new gl}}class Hu extends $u{constructor(e,t){super(e,t,!1),this.ru=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);var t=this.ru.syncEngine;this.sharedClientState instanceof fl&&(this.sharedClientState.syncEngine={uo:Uu.bind(null,t),co:(async function(e,r,n,t){var i=e;if(i.ja)p(bu,"Ignoring unexpected query state notification.");else{var s=i.qa.get(r);if(s&&0<s.length)switch(n){case"current":case"not-current":{let e=await Zo(i.localStore,ci(s[0])),t=as.createSynthesizedRemoteEventForCurrentChange(r,"current"===n,D.EMPTY_BYTE_STRING);await Pu(i,e,t);break}case"rejected":await Yo(i.localStore,r,!0),Ou(i,r,t);break;default:T()}}}).bind(null,t),lo:(async function(e,t,n){let i=ju(e);if(i.ja){for(let r of t)if(i.qa.has(r)&&i.sharedClientState.isActiveQueryTarget(r))p(bu,"Adding an already active target "+r);else{let e=await Jo(i.localStore,r),t=await Wo(i.localStore,e);await xu(i,qu(e),t.targetId,!1,t.resumeToken),Ul(i.remoteStore,t)}for(let r of n)i.qa.has(r)&&await Yo(i.localStore,r,!1).then(()=>{Bl(i.remoteStore,r),Ou(i,r)}).catch($e)}}).bind(null,t),zi:(function(e){return e.localStore.persistence.zi()}).bind(null,t),ao:(async function(e,t){let r=e;return Zo(r.localStore,t).then(e=>Pu(r,e))}).bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ci(async e=>{{var t=this.ru.syncEngine,s=e;let i=t;if(ju(i),zu(i),!0===s&&!0!==i.ja){let e=i.sharedClientState.getAllActiveQueryTargets(),t=await Bu(i,e.toArray());i.ja=!0,await Zl(i.remoteStore,!0);for(let e of t)Ul(i.remoteStore,e)}else if(!1===s&&!1!==i.ja){let r=[],n=Promise.resolve();i.qa.forEach((e,t)=>{i.sharedClientState.isLocalQueryTarget(t)?r.push(t):n=n.then(()=>(Ou(i,t),Yo(i.localStore,t,!0))),Bl(i.remoteStore,t)}),await n,await Bu(i,r);{s=i;let r=s;r.Ua.forEach((e,t)=>{Bl(r.remoteStore,t)}),r.Ka.Dr(),r.Ua=new Map,r.$a=new A(x.comparator)}i.ja=!1,await Zl(i.remoteStore,!1)}}await 0,this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())})}Za(e){var t,r=Sl();if(fl.D(r))return t=Vo(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),new fl(r,e.asyncQueue,t,e.clientId,e.initialUser);throw new I(b.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.")}}class Wu{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Du(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=(async function(e,t){var r,n,i=e;if(!i.currentUser.isEqual(t)){p(bu,"User change. New user:",t.toKey());let e=await Go(i.localStore,t);i.currentUser=t,n="'waitForPendingWrites' promise is rejected due to a user change.",(r=i).Ga.forEach(e=>{e.forEach(e=>{e.reject(new I(b.CANCELLED,n))})}),r.Ga.clear(),i.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Pu(i,e.Rs)}}).bind(null,this.syncEngine),await Zl(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new lu}createDatastore(e){var t,r,n,i=Al(e.databaseInfo.databaseId),s=(t=e.databaseInfo,new El(t));return t=e.authCredentials,e=e.appCheckCredentials,r=s,n=i,new Ll(t,e,r,n)}createRemoteStore(e){return t=this.localStore,r=this.datastore,e=e.asyncQueue,n=e=>Du(this.syncEngine,e,0),i=new(yl.D()?yl:ml),new Vl(t,r,e,n,i);var t,r,n,i}createSyncEngine(e,t){return r=this.localStore,n=this.remoteStore,i=this.eventManager,s=this.sharedClientState,a=e.initialUser,e=e.maxConcurrentLimboResolutions,t=t,o=new Eu(r,n,i,s,a,e),t&&(o.ja=!0),o;var r,n,i,s,a,o}async terminate(){var e,t;e=this.remoteStore,t=e,p(Ml,"RemoteStore shutting down."),t.W_.add(5),await Pl(t),t.z_.shutdown(),await!t.j_.set("Unknown"),null!=(t=this.datastore)&&t.terminate(),null!=(t=this.eventManager)&&t.terminate()}}function Yu(t,r=10240){let n=0;return{async read(){var e;return n<t.byteLength?(e={value:t.slice(n,n+r),done:!1},n+=r,e):{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}Wu.provider={build:()=>new Wu};class Xu{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.iu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.iu(this.observer.error,e):d("Uncaught Error in snapshot listener:",e.toString()))}su(){this.muted=!0}iu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}class Ju{constructor(e,t){this.ou=e,this.serializer=t,this.metadata=new f,this.buffer=new Uint8Array,this._u=new TextDecoder("utf-8"),this.au().then(e=>{e&&e.Ea()?this.metadata.resolve(e.Ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             `+JSON.stringify(null==e?void 0:e.Ia)))},e=>this.metadata.reject(e))}close(){return this.ou.cancel()}async getMetadata(){return this.metadata.promise}async Ya(){return await this.getMetadata(),this.au()}async au(){var e,t,r=await this.uu();return null===r?null:(t=this._u.decode(r),e=Number(t),isNaN(e)&&this.cu(`length string (${t}) is not valid number`),t=await this.lu(e),new gu(JSON.parse(t),r.length+e))}hu(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async uu(){for(;this.hu()<0&&!await this.Pu(););var e,t;return 0===this.buffer.length?null:((e=this.hu())<0&&this.cu("Reached the end of bundle when a length string is expected."),t=this.buffer.slice(0,e),this.buffer=this.buffer.slice(e),t)}async lu(e){for(;this.buffer.length<e;)await this.Pu()&&this.cu("Reached the end of bundle when more is expected.");var t=this._u.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}cu(e){throw this.ou.cancel(),new Error("Invalid bundle format: "+e)}async Pu(){var e,t=await this.ou.read();return t.done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),t.done}}class Zu{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),0<this.mutations.length)throw this.lastTransactionError=new I(b.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;var t=await(async(e,t)=>{let l=e,r={documents:t.map(e=>Ss(l.serializer,e))},n=await l.Co("BatchGetDocuments",l.serializer.databaseId,S.emptyPath(),r,t.length),u=new Map,i=(n.forEach(e=>{t=l.serializer;var t,r,n,i,s,a,o="found"in(e=e)?(r=t,y(!!(n=e).found),n.found.name,n.found.updateTime,i=xs(r,n.found.name),s=V(n.found.updateTime),o=n.found.createTime?V(n.found.createTime):g.min(),a=new En({mapValue:{fields:n.found.fields}}),k.newFoundDocument(i,s,o,a)):"missing"in e?(r=t,y(!!(n=e).missing),y(!!n.readTime),i=xs(r,n.missing),s=V(n.readTime),k.newNoDocument(i,s)):T();u.set(o.key.toString(),o)}),[]);return t.forEach(e=>{var t=u.get(e.toString());y(!!t),i.push(t)}),i})(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new $i(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let t=this.readVersions;this.mutations.forEach(e=>{t.delete(e.key.toString())}),t.forEach((e,t)=>{var r=x.fromPath(t);this.mutations.push(new Hi(r,this.precondition(r)))});{var r=this.datastore,n=this.mutations;let t=r,e={writes:n.map(e=>Ls(t.serializer,e))};await t.So("Commit",t.serializer.databaseId,S.emptyPath(),e)}await 0,this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw T();t=g.min()}var r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new I(b.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){var t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(g.min())?M.exists(!1):M.updateTime(t):M.none()}preconditionForUpdate(e){var t=this.readVersions.get(e.toString());if(this.writtenDocs.has(e.toString())||!t)return M.exists(!0);if(t.isEqual(g.min()))throw new I(b.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return M.updateTime(t)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class eh{constructor(e,t,r,n,i){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=n,this.deferred=i,this.Tu=r.maxAttempts,this.a_=new Cl(this.asyncQueue,"transaction_retry")}Iu(){--this.Tu,this.Eu()}Eu(){this.a_.Xo(async()=>{let t=new Zu(this.datastore),e=this.du(t);e&&e.then(e=>{this.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{this.deferred.resolve(e)}).catch(e=>{this.Au(e)}))}).catch(e=>{this.Au(e)})})}du(e){try{var t=this.updateFunction(e);return!ht(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}Au(e){0<this.Tu&&this.Ru(e)?(--this.Tu,this.asyncQueue.enqueueAndForget(()=>(this.Eu(),Promise.resolve()))):this.deferred.reject(e)}Ru(e){var t;return"FirebaseError"===e.name&&("aborted"===(t=e.code)||"failed-precondition"===t||"already-exists"===t||!Zi(t))}}let th="FirestoreClient";class rh{constructor(e,t,r,n,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=n,this.user=u.UNAUTHENTICATED,this.clientId=xe.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async e=>{p(th,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(r,e=>(p(th,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let r=new f;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),r.resolve()}catch(e){var t=nu(e,"Failed to shutdown persistence");r.reject(t)}}),r.promise}}async function nh(e,t){e.asyncQueue.verifyOperationInProgress(),p(th,"Initializing OfflineComponentProvider");var r=e.configuration;await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener(async e=>{n.isEqual(e)||(await Go(t.localStore,e),n=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function ih(e,r){e.asyncQueue.verifyOperationInProgress();var t=await sh(e);p(th,"Initializing OnlineComponentProvider"),await r.initialize(t,e.configuration),e.setCredentialChangeListener(e=>Jl(r.remoteStore,e)),e.setAppCheckTokenChangeListener((e,t)=>Jl(r.remoteStore,t)),e._onlineComponents=r}async function sh(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){p(th,"Using user provided OfflineComponentProvider");try{await nh(t,t._uninitializedComponentsProvider._offline)}catch(e){var r=e;if(!("FirebaseError"===(n=r).name?n.code===b.FAILED_PRECONDITION||n.code===b.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&n instanceof DOMException)||22===n.code||20===n.code||11===n.code))throw r;me("Error using user provided cache. Falling back to memory cache: "+r),await nh(t,new Ku)}}else p(th,"Using default OfflineComponentProvider"),await nh(t,new Qu(void 0));var n;return t._offlineComponents}async function ah(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(p(th,"Using user provided OnlineComponentProvider"),await ih(e,e._uninitializedComponentsProvider._online)):(p(th,"Using default OnlineComponentProvider"),await ih(e,new Wu))),e._onlineComponents}function oh(e){return sh(e).then(e=>e.persistence)}function lh(e){return sh(e).then(e=>e.localStore)}function uh(e){return ah(e).then(e=>e.remoteStore)}function hh(e){return ah(e).then(e=>e.syncEngine)}async function ch(e){var t=await ah(e),r=t.eventManager;return r.onListen=(async function(e,t,r=!0){var n=ju(e);let i;var s=n.ka.get(t);return i=s?(n.sharedClientState.addLocalQueryTarget(s.targetId),s.view.Na()):await Su(n,t,r,!0)}).bind(null,t.syncEngine),r.onUnlisten=(async function(e,t,r){let n=e,i=n.ka.get(t),s=n.qa.get(i.targetId);1<s.length?(n.qa.set(i.targetId,s.filter(e=>!oi(e,t))),n.ka.delete(t)):n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Yo(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Bl(n.remoteStore,i.targetId),Ou(n,i.targetId)}).catch($e)):(Ou(n,i.targetId),await Yo(n.localStore,i.targetId,!0))}).bind(null,t.syncEngine),r.onFirstRemoteStoreListen=(async function(e,t){await Su(ju(e),t,!0,!1)}).bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=(async function(e,t){var r=e,n=r.ka.get(t),i=r.qa.get(n.targetId);r.isPrimaryClient&&1===i.length&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Bl(r.remoteStore,n.targetId))}).bind(null,t.syncEngine),r}function dh(r){return r.asyncQueue.enqueue(async()=>{var e=await oh(r),t=await uh(r);return e.setNetworkEnabled(!1),(async e=>{var t=e;t.W_.add(0),await Pl(t),t.j_.set("Offline")})(t)})}function fh(e,t){let r=new f;return e.asyncQueue.enqueueAndForget(async()=>(async(e,t,r)=>{try{var n=await((e,t)=>{let r=e;return r.persistence.runTransaction("read document","readonly",e=>r.localDocuments.getDocument(e,t))})(e,t);n.isFoundDocument()?r.resolve(n):n.isNoDocument()?r.resolve(null):r.reject(new I(b.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){n=nu(e,`Failed to get document '${t} from cache`);r.reject(n)}})(await lh(e),t,r)),r.promise}function gh(e,t,u={}){let h=new f;return e.asyncQueue.enqueueAndForget(async()=>{{var i=await ch(e),s=e.asyncQueue,a=t,o=u,l=h;let r=new Xu({next:e=>{r.su(),s.enqueueAndForget(()=>cu(i,n));var t=e.docs.has(a);!t&&e.fromCache?l.reject(new I(b.UNAVAILABLE,"Failed to get document because the client is offline.")):t&&e.fromCache&&o&&"server"===o.source?l.reject(new I(b.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(e)},error:e=>l.reject(e)}),n=new fu(ei(a.path),r,{includeMetadataChanges:!0,Ta:!0});return hu(i,n)}}),h.promise}function mh(e,t){let r=new f;return e.asyncQueue.enqueueAndForget(async()=>(async(e,t,r)=>{try{var n=await Xo(e,t,!0),i=new _u(t,n.gs),s=i.ba(n.documents),a=i.applyChanges(s,!1);r.resolve(a.snapshot)}catch(e){n=nu(e,`Failed to execute query '${t} against cache`);r.reject(n)}})(await lh(e),t,r)),r.promise}function ph(o,l,u={}){let h=new f;return o.asyncQueue.enqueueAndForget(async()=>{{var n=await ch(o),i=o.asyncQueue,e=l,s=u,a=h;let t=new Xu({next:e=>{t.su(),i.enqueueAndForget(()=>cu(n,r)),e.fromCache&&"server"===s.source?a.reject(new I(b.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):a.resolve(e)},error:e=>a.reject(e)}),r=new fu(e,t,{includeMetadataChanges:!0,Ta:!0});return hu(n,r)}}),h.promise}function yh(r,e){let n=new Xu(e);return r.asyncQueue.enqueueAndForget(async()=>{return e=await ch(r),t=n,e.ia.add(t),void t.next();var e,t}),()=>{n.su(),r.asyncQueue.enqueueAndForget(async()=>{var e,t;e=await ch(r),t=n,e.ia.delete(t)})}}function vh(e,t,r,n){r=r,t=Al(t),s="string"==typeof r?Se().encode(r):r,r=((e,t)=>{if(e instanceof Uint8Array)return Yu(e,t);if(e instanceof ArrayBuffer)return Yu(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(s),t=t;let i=new Ju(r,t);var s;e.asyncQueue.enqueueAndForget(async()=>{Gu(await hh(e),i,n)})}function wh(n,i){return n.asyncQueue.enqueue(async()=>{{var e=await lh(n),r=i;let t=e;return t.persistence.runTransaction("Get named query","readonly",e=>t.Yr.getNamedQuery(e,r))}})}function _h(e){var t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}let bh=new Map;function Ih(e,t,r){if(!r)throw new I(b.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Th(e,t,r,n){if(!0===t&&!0===n)throw new I(b.INVALID_ARGUMENT,e+` and ${r} cannot be used together.`)}function Eh(e){if(!x.isDocumentKey(e))throw new I(b.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Sh(e){if(x.isDocumentKey(e))throw new I(b.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function xh(e){var t,r;return void 0===e?"undefined":null===e?"null":"string"==typeof e?(20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e)):"number"==typeof e||"boolean"==typeof e?""+e:"object"==typeof e?e instanceof Array?"an array":(t=(r=e).constructor?r.constructor.name:null)?`a custom ${t} object`:"an object":"function"==typeof e?"a function":T()}function F(e,t){if((e="_delegate"in e?e._delegate:e)instanceof t)return e;if(t.name===e.constructor.name)throw new I(b.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var r=xh(e);throw new I(b.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: `+r)}function Ah(e,t){if(t<=0)throw new I(b.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}let Ch="firestore.googleapis.com";class Dh{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new I(b.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ch,this.ssl=!0}else this.host=e.host,this.ssl=null==(t=e.ssl)||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new I(b.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Th("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=_h(null!=(t=e.experimentalLongPollingOptions)?t:{});var r=this.experimentalLongPollingOptions;if(void 0!==r.timeoutSeconds){if(isNaN(r.timeoutSeconds))throw new I(b.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new I(b.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(30<r.timeoutSeconds)throw new I(b.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,r=e.experimentalLongPollingOptions,t.timeoutSeconds===r.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,r}}class Nh{constructor(e,t,r,n){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Dh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(this._app)return this._app;throw new I(b.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available")}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new I(b.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Dh(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=(e=>{if(!e)return new ve;switch(e.type){case"firstParty":return new Ie(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new I(b.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return e=this,(t=bh.get(e))&&(p("ComponentProvider","Removing Datastore"),bh.delete(e),t.terminate()),Promise.resolve();var e,t}}function kh(n,e,t,i={}){let s,r=(n=F(n,Nh))._getSettings(),a=Object.assign(Object.assign({},r),{emulatorOptions:n._getEmulatorOptions()}),o=e+":"+t;r.host!==Ch&&r.host!==o&&me("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");var l=Object.assign(Object.assign({},r),{host:o,ssl:!1,emulatorOptions:i});if(!ee(l,a)&&(n._setSettings(l),i.mockUserToken)){let t,r;if("string"==typeof i.mockUserToken)t=i.mockUserToken,r=u.MOCK_USER;else{t=((e,t)=>{if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var r=t||"demo-project",n=e.iat||0,i=e.sub||e.user_id;if(i)return r=Object.assign({iss:"https://securetoken.google.com/"+r,aud:r,iat:n,exp:n+3600,auth_time:n,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e),[z(JSON.stringify({alg:"none",type:"JWT"})),z(JSON.stringify(r)),""].join(".");throw new Error("mockUserToken must contain 'sub' or 'user_id' field!")})(i.mockUserToken,null==(s=n._app)?void 0:s.options.projectId);let e=i.mockUserToken.sub||i.mockUserToken.user_id;if(!e)throw new I(b.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");r=new u(e)}n._authCredentials=new we(new ye(t,r))}}class Rh{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Rh(this.firestore,e,this._query)}}class P{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Lh(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new P(this.firestore,e,this._key)}}class Lh extends Rh{constructor(e,t,r){super(e,t,ei(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){var e=this._path.popLast();return e.isEmpty()?null:new P(this.firestore,null,new x(e))}withConverter(e){return new Lh(this.firestore,e,this._path)}}function Oh(e,t,...r){var n;if(e=_(e),Ih("collection","path",t),e instanceof Nh)return Sh(n=S.fromString(t,...r)),new Lh(e,null,n);if(e instanceof P||e instanceof Lh)return Sh(n=e._path.child(S.fromString(t,...r))),new Lh(e.firestore,null,n);throw new I(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore")}function Mh(e,t,...r){var n;if(e=_(e),Ih("doc","path",t=1===arguments.length?xe.newId():t),e instanceof Nh)return Eh(n=S.fromString(t,...r)),new P(e,null,new x(n));if(e instanceof P||e instanceof Lh)return Eh(n=e._path.child(S.fromString(t,...r))),new P(e.firestore,e instanceof Lh?e.converter:null,new x(n));throw new I(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore")}function Vh(e,t){return e=_(e),t=_(t),(e instanceof P||e instanceof Lh)&&(t instanceof P||t instanceof Lh)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function Fh(e,t){return e=_(e),t=_(t),e instanceof Rh&&t instanceof Rh&&e.firestore===t.firestore&&oi(e._query,t._query)&&e.converter===t.converter}let Ph="AsyncQueue";class Uh{constructor(e=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new Cl(this,"async_queue_retry"),this.Su=()=>{var e=xl();e&&p(Ph,"Visibility state changed to "+e.visibilityState),this.a_.t_()},this.bu=e;var t=xl();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){var t;this.mu||(this.mu=!0,this.yu=e||!1,(t=xl())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Su))}enqueue(e){if(this.Du(),this.mu)return new Promise(()=>{});let t=new f;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Vu.push(e),this.Cu()))}async Cu(){if(0!==this.Vu.length){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!et(e))throw e;p(Ph,"Operation failed with retryable error: "+e)}0<this.Vu.length&&this.a_.Xo(()=>this.Cu())}}vu(e){var t=this.bu.then(()=>(this.pu=!0,e().catch(e=>{throw this.gu=e,this.pu=!1,d("INTERNAL UNHANDLED ERROR: ",(e=>{let t=e.message||"";return t=e.stack?e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack:t})(e)),e}).then(e=>(this.pu=!1,e))));return this.bu=t}enqueueAfterDelay(e,t,r){this.Du(),-1<this.wu.indexOf(e)&&(t=0);var n=ru.createAndSchedule(this,e,t,r,e=>this.Fu(e));return this.fu.push(n),n}Du(){this.gu&&T()}verifyOperationInProgress(){}async Mu(){for(var e;await(e=this.bu),e!==this.bu;);}xu(e){for(var t of this.fu)if(t.timerId===e)return!0;return!1}Ou(t){return this.Mu().then(()=>{this.fu.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(var e of this.fu)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Mu()})}Nu(e){this.wu.push(e)}Fu(e){var t=this.fu.indexOf(e);this.fu.splice(t,1)}}function Bh(t){var r=t,t=["next","error","complete"];if("object"==typeof r&&null!==r){var n=r;for(let e of t)if(e in n&&"function"==typeof n[e])return 1}}class qh{constructor(){this._progressObserver={},this._taskCompletionResolver=new f,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}var jh,zh,t,Gh;class U extends Nh{constructor(e,t,r,n){super(e,t,r,n),this.type="firestore",this._queue=new Uh,this._persistenceKey=(null==n?void 0:n.name)||"[DEFAULT]"}async _terminate(){var e;this._firestoreClient&&(e=this._firestoreClient.terminate(),this._queue=new Uh(e),this._firestoreClient=void 0,await e)}}function Kh(e){if(e._terminated)throw new I(b.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Qh(e),e._firestoreClient}function Qh(e){var t,r,n,i,s,a=e._freezeSettings(),o=(i=e._databaseId,t=(null==(o=e._app)?void 0:o.options.appId)||"",r=e._persistenceKey,n=a,new Wr(i,t,r,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling,_h(n.experimentalLongPollingOptions),n.useFetchStreams));e._componentsProvider||null!=(s=a.localCache)&&s._offlineComponentProvider&&null!=(s=a.localCache)&&s._onlineComponentProvider&&(e._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),e._firestoreClient=new rh(e._authCredentials,e._appCheckCredentials,e._queue,o,e._componentsProvider&&(i=e._componentsProvider,s=null==i?void 0:i._online.build(),{_offline:null==i?void 0:i._offline.build(s),_online:s}))}function $h(e,t,r){if((e=F(e,U))._firestoreClient||e._terminated)throw new I(b.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(e._componentsProvider||e._getSettings().localCache)throw new I(b.FAILED_PRECONDITION,"SDK cache is already specified.");e._componentsProvider={_online:t,_offline:r},Qh(e)}function Hh(r){if(r._initialized&&!r._terminated)throw new I(b.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let n=new f;return r._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{e=Vo(r._databaseId,r._persistenceKey),await(Ye.D()?(t=e+"main",void await Ye.delete(t)):Promise.resolve()),n.resolve()}catch(e){n.reject(e)}var e,t}),n.promise}function Wh(e){return(r=Kh(e=F(e,U))).asyncQueue.enqueue(async()=>{var e=await oh(r),t=await uh(r);return e.setNetworkEnabled(!0),(e=t).W_.delete(0),Fl(e)});var r}class Yh{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Yh(D.fromBase64String(e))}catch(e){throw new I(b.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Yh(D.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Xh{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new I(b.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new v(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Jh{constructor(e){this._methodName=e}}class Zh{constructor(e,t){if(!isFinite(e)||e<-90||90<e)throw new I(b.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||180<t)throw new I(b.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return E(this._lat,e._lat)||E(this._long,e._long)}}class ec{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){var t=this._values,r=e._values;if(t.length!==r.length)return!1;for(let n=0;n<t.length;++n)if(t[n]!==r[n])return!1;return!0}}let tc=/^__.*__$/;class rc{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new zi(e,this.data,this.fieldMask,t,this.fieldTransforms):new ji(e,this.data,t,this.fieldTransforms)}}class nc{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new zi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function ic(e){switch(e){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw T()}}class sc{constructor(e,t,r,n,i,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=n,void 0===i&&this.Bu(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(e){return new sc(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(e){var t=null==(t=this.path)?void 0:t.child(e),t=this.ku({path:t,Qu:!1});return t.$u(e),t}Uu(e){var t=null==(t=this.path)?void 0:t.child(e),t=this.ku({path:t,Qu:!1});return t.Bu(),t}Ku(e){return this.ku({path:void 0,Qu:!0})}Wu(e){return Sc(e,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(t){return void 0!==this.fieldMask.find(e=>t.isPrefixOf(e))||void 0!==this.fieldTransforms.find(e=>t.isPrefixOf(e.field))}Bu(){if(this.path)for(let e=0;e<this.path.length;e++)this.$u(this.path.get(e))}$u(e){if(0===e.length)throw this.Wu("Document fields must not be empty");if(ic(this.Lu)&&tc.test(e))throw this.Wu('Document fields cannot begin and end with "__"')}}class ac{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Al(e)}ju(e,t,r,n=!1){return new sc({Lu:e,methodName:t,zu:r,path:v.emptyPath(),Qu:!1,Gu:n},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function oc(e){var t=e._freezeSettings(),r=Al(e._databaseId);return new ac(e._databaseId,!!t.ignoreUndefinedProperties,r)}function lc(e,n,i,t,r,s={}){var a=e.ju(s.merge||s.mergeFields?2:0,n,i,r),o=(bc("Data must be an object, but it was:",a,t),wc(t,a));let l,u;if(s.merge)l=new Fr(a.fieldMask),u=a.fieldTransforms;else if(s.mergeFields){let t=[];for(let r of s.mergeFields){let e=Ic(n,r,i);if(!a.contains(e))throw new I(b.INVALID_ARGUMENT,`Field '${e}' is specified in your field mask but missing from your input data.`);xc(t,e)||t.push(e)}l=new Fr(t),u=a.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,u=a.fieldTransforms;return new rc(new En(o),l,u)}class uc extends Jh{_toFieldTransform(e){if(2!==e.Lu)throw 1===e.Lu?e.Wu(this._methodName+"() can only appear at the top level of your update data"):e.Wu(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof uc}}function hc(e,t,r){return new sc({Lu:3,zu:t.settings.zu,methodName:e._methodName,Qu:r},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class cc extends Jh{_toFieldTransform(e){return new Mi(e.path,new Ai)}isEqual(e){return e instanceof cc}}class dc extends Jh{constructor(e,t){super(e),this.Hu=t}_toFieldTransform(e){let t=hc(this,e,!0),r=this.Hu.map(e=>vc(e,t)),n=new Ci(r);return new Mi(e.path,n)}isEqual(e){return e instanceof dc&&ee(this.Hu,e.Hu)}}class fc extends Jh{constructor(e,t){super(e),this.Hu=t}_toFieldTransform(e){let t=hc(this,e,!0),r=this.Hu.map(e=>vc(e,t)),n=new Ni(r);return new Mi(e.path,n)}isEqual(e){return e instanceof fc&&ee(this.Hu,e.Hu)}}class gc extends Jh{constructor(e,t){super(e),this.Ju=t}_toFieldTransform(e){var t=new Ri(e.serializer,Ei(e.serializer,this.Ju));return new Mi(e.path,t)}isEqual(e){return e instanceof gc&&this.Ju===e.Ju}}function mc(e,i,s,t){let a=e.ju(1,i,s),o=(bc("Data must be an object, but it was:",a,t),[]),l=En.empty();kr(t,(e,t)=>{var r=Ec(i,e,s),n=(t=_(t),a.Uu(r));if(t instanceof uc)o.push(r);else{let e=vc(t,n);null!=e&&(o.push(r),l.set(r,e))}});var r=new Fr(o);return new nc(l,r,a.fieldTransforms)}function pc(e,t,r,n,i,s){var a=e.ju(1,t,r),o=[Ic(t,n,r)],l=[i];if(s.length%2!=0)throw new I(b.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<s.length;f+=2)o.push(Ic(t,s[f])),l.push(s[f+1]);var u=[],h=En.empty();for(let g=o.length-1;0<=g;--g)if(!xc(u,o[g])){let t=o[g];var c=_(l[g]);let r=a.Uu(t);if(c instanceof uc)u.push(t);else{let e=vc(c,r);null!=e&&(u.push(t),h.set(t,e))}}var d=new Fr(u);return new nc(h,d,a.fieldTransforms)}function yc(e,t,r,n=!1){return vc(r,e.ju(n?4:3,t))}function vc(e,r){if(_c(e=_(e)))return bc("Unsupported field value:",r,e),wc(e,r);if(e instanceof Jh){{var t=e;var n=r;if(!ic(n.Lu))throw n.Wu(t._methodName+"() can only be used with update() and set()");if(!n.path)throw n.Wu(t._methodName+"() is not currently supported inside arrays");var i=t._toFieldTransform(n);i&&n.fieldTransforms.push(i)}return null}if(void 0===e&&r.ignoreUndefinedProperties)return null;if(r.path&&r.fieldMask.push(r.path),e instanceof Array){if(r.settings.Qu&&4!==r.Lu)throw r.Wu("Nested arrays are not supported");{var s,a=r,o=[];let t=0;for(s of e){let e=vc(s,a.Ku(t));null==e&&(e={nullValue:"NULL_VALUE"}),o.push(e),t++}return{arrayValue:{values:o}}}}var l,t=e,n=r;if(null===(t=_(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Ei(n.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date)return u=h.fromDate(t),{timestampValue:_s(n.serializer,u)};if(t instanceof h)return u=new h(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:_s(n.serializer,u)};if(t instanceof Zh)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Yh)return{bytesValue:bs(n.serializer,t._byteString)};if(t instanceof P){var u=n.databaseId,i=t.firestore._databaseId;if(i.isEqual(u))return{referenceValue:Is(t.firestore._databaseId||n.databaseId,t._key.path)};throw n.Wu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${u.projectId}/`+u.database)}if(t instanceof ec)return e=t,l=n,{mapValue:{fields:{[Jr]:{stringValue:tn},[rn]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw l.Wu("VectorValues must only contain numeric values.");return Ii(l.serializer,e)})}}}}};throw n.Wu("Unsupported field value: "+xh(t))}function wc(e,n){let i={};return Rr(e)?n.path&&0<n.path.length&&n.fieldMask.push(n.path):kr(e,(e,t)=>{var r=vc(t,n.qu(e));null!=r&&(i[e]=r)}),{mapValue:{fields:i}}}function _c(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof h||e instanceof Zh||e instanceof Yh||e instanceof P||e instanceof Jh||e instanceof ec)}function bc(e,t,r){var n,i;if(!_c(r)||"object"!=typeof(i=r)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i))throw"an object"===(n=xh(r))?t.Wu(e+" a custom object"):t.Wu(e+" "+n)}function Ic(e,t,r){if((t=_(t))instanceof Xh)return t._internalPath;if("string"==typeof t)return Ec(e,t);throw Sc("Field path arguments must be of type string or ",e,!1,void 0,r)}let Tc=new RegExp("[~\\*/\\[\\]]");function Ec(t,r,n){if(0<=r.search(Tc))throw Sc(`Invalid field path (${r}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Xh(...r.split("."))._internalPath}catch(e){throw Sc(`Invalid field path (${r}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Sc(e,t,r,n,i){var s=n&&!n.isEmpty(),a=void 0!==i;let o=`Function ${t}() called with invalid data`,l=(r&&(o+=" (via `toFirestore()`)"),o+=". ","");return(s||a)&&(l+=" (found",s&&(l+=" in field "+n),a&&(l+=" in document "+i),l+=")"),new I(b.INVALID_ARGUMENT,o+e+l)}function xc(e,t){return e.some(e=>e.isEqual(t))}class Ac{constructor(e,t,r,n,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=n,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new P(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){var e;if(this._document)return this._converter?(e=new Cc(this._firestore,this._userDataWriter,this._key,this._document,null),this._converter.fromFirestore(e)):this._userDataWriter.convertValue(this._document.data.value)}get(e){if(this._document){var t=this._document.data.field(Dc("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Cc extends Ac{data(){return super.data()}}function Dc(e,t){return"string"==typeof t?Ec(e,t):(t instanceof Xh?t:t._delegate)._internalPath}function Nc(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new I(b.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class kc{}class Rc extends kc{}function Lc(e,t,...r){let n=[];t instanceof kc&&n.push(t);var t=n=n.concat(r),i=t.filter(e=>!1).length,s=t.filter(e=>e instanceof Oc).length;if(1<i||0<i&&0<s)throw new I(b.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.");for(let t of n)e=t._apply(e);return e}class Oc extends Rc{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Oc(e,t,r)}_apply(e){var t=this._parse(e);return jc(e._query,t),new Rh(e.firestore,e.converter,si(e._query,t))}_parse(e){var t=oc(e.firestore);{var n=e._query,i="where",s=t,a=e.firestore._databaseId,o=(e=this._field,this._op),l=this._value;let r;if(e.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new I(b.INVALID_ARGUMENT,`Invalid Query. You can't perform '${o}' queries on documentId().`);if("in"===o||"not-in"===o){qc(l,o);let e=[];for(let t of l)e.push(Bc(a,n,t));r={arrayValue:{values:e}}}else r=Bc(a,n,l)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||qc(l,o),r=yc(s,i,l,"in"===o||"not-in"===o);return R.create(e,o,r)}}}(class extends kc{});class Mc extends Rc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Mc(e,t)}_apply(e){var t=((e,t,r)=>{if(null!==e.startAt)throw new I(b.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new I(b.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Cn(t,r)})(e._query,this._field,this._direction);return new Rh(e.firestore,e.converter,(t=(e=e._query).explicitOrderBy.concat([t]),new Jn(e.path,e.collectionGroup,t,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)))}}class Vc extends Rc{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Vc(e,t,r)}_apply(e){return new Rh(e.firestore,e.converter,ai(e._query,this._limit,this._limitType))}}class Fc extends Rc{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Fc(e,t,r)}_apply(e){var t,r=Uc(e,this.type,this._docOrFields,this._inclusive);return new Rh(e.firestore,e.converter,(e=e._query,t=r,new Jn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)))}}class Pc extends Rc{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Pc(e,t,r)}_apply(e){var t,r=Uc(e,this.type,this._docOrFields,this._inclusive);return new Rh(e.firestore,e.converter,(e=e._query,t=r,new Jn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)))}}function Uc(e,r,n,i){if(n[0]=_(n[0]),n[0]instanceof Ac){var s=e._query,a=e.firestore._databaseId,o=r,l=n[0]._document,u=i;if(!l)throw new I(b.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);var h=[];for(let t of ni(s))if(t.field.isKeyField())h.push(dn(a,l.key));else{let e=l.data.field(t.field);if(Qr(e))throw new I(b.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+t.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){let e=t.field.canonicalString();throw new I(b.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}h.push(e)}return new Sn(h,u)}var t=oc(e.firestore),c=e._query,d=e.firestore._databaseId,f=t,g=r,m=n,o=i,p=c.explicitOrderBy;if(m.length>p.length)throw new I(b.INVALID_ARGUMENT,`Too many arguments provided to ${g}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);var y=[];for(let w=0;w<m.length;w++){var v=m[w];if(p[w].field.isKeyField()){if("string"!=typeof v)throw new I(b.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${g}(), but got a `+typeof v);if(!ri(c)&&-1!==v.indexOf("/"))throw new I(b.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${g}() must be a plain document ID, but '${v}' contains a slash.`);let e=c.path.child(S.fromString(v));if(!x.isDocumentKey(e))throw new I(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${g}() must result in a valid document path, but '${e}' is not because it contains an odd number of segments.`);let t=new x(e);y.push(dn(d,t))}else{let e=yc(f,g,v);y.push(e)}}return new Sn(y,o)}function Bc(e,t,r){if("string"==typeof(r=_(r))){if(""===r)throw new I(b.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ri(t)&&-1!==r.indexOf("/"))throw new I(b.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);var n=t.path.child(S.fromString(r));if(x.isDocumentKey(n))return dn(e,new x(n));throw new I(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`)}if(r instanceof P)return dn(e,r._key);throw new I(b.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${xh(r)}.`)}function qc(e,t){if(!Array.isArray(e)||0===e.length)throw new I(b.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function jc(e,t){var r=((t,r)=>{for(var n of t)for(let e of n.getFlattenedFilters())if(0<=r.indexOf(e.op))return e.op;return null})(e.filters,(e=>{switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(t.op));if(null!==r)throw r===t.op?new I(b.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new I(b.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${r.toString()}' filters.`)}class zc{convertValue(e,t="none"){switch(sn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return N(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(qr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw T()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,r="none"){let n={};return kr(e,(e,t)=>{n[e]=this.convertValue(t,r)}),n}convertVectorValue(e){var t=null==(t=null==(t=null==(t=e.fields)?void 0:t[rn].arrayValue)?void 0:t.values)?void 0:t.map(e=>N(e.doubleValue));return new ec(t)}convertGeoPoint(e){return new Zh(N(e.latitude),N(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":var r=$r(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Hr(e));default:return null}}convertTimestamp(e){var t=Br(e);return new h(t.seconds,t.nanos)}convertDocumentKey(e,t){var r=S.fromString(e),n=(y(Gs(r)),new Xr(r.get(1),r.get(3))),r=new x(r.popFirst(5));return n.isEqual(t)||d(`Document ${r} contains a document reference within a different database (${n.projectId}/${n.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),r}}function Gc(e,t,r){return e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t}class Kc extends zc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Yh(e)}convertReference(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new P(this.firestore,null,t)}}class Qc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class $c extends Ac{constructor(e,t,r,n,i,s){super(e,t,r,n,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){var t;if(this._document)return this._converter?(t=new Hc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null),this._converter.fromFirestore(t,e)):this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}get(e,t={}){if(this._document){var r=this._document.data.field(Dc("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class Hc extends $c{data(e={}){return super.data(e)}}class Wc{constructor(e,t,r,n){this._firestore=e,this._userDataWriter=t,this._snapshot=n,this.metadata=new Qc(n.hasPendingWrites,n.fromCache),this.query=r}get docs(){let t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,r){this._snapshot.docs.forEach(e=>{t.call(r,new Hc(this._firestore,this._userDataWriter,e.key,e,new Qc(this._snapshot.mutatedKeys.has(e.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){var t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new I(b.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=((s,t)=>{if(s._snapshot.oldDocs.isEmpty()){let r=0;return s._snapshot.docChanges.map(e=>{var t=new Hc(s._firestore,s._userDataWriter,e.doc.key,e.doc,new Qc(s._snapshot.mutatedKeys.has(e.doc.key),s._snapshot.fromCache),s.query.converter);return e.doc,{type:"added",doc:t,oldIndex:-1,newIndex:r++}})}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(e=>t||3!==e.type).map(e=>{var t=new Hc(s._firestore,s._userDataWriter,e.doc.key,e.doc,new Qc(s._snapshot.mutatedKeys.has(e.doc.key),s._snapshot.fromCache),s.query.converter);let r=-1,n=-1;return 0!==e.type&&(r=i.indexOf(e.doc.key),i=i.delete(e.doc.key)),1!==e.type&&(i=i.add(e.doc),n=i.indexOf(e.doc.key)),{type:(e=>{switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return T()}})(e.type),doc:t,oldIndex:r,newIndex:n}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Yc(e,t){return e instanceof $c&&t instanceof $c?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof Wc&&t instanceof Wc&&e._firestore===t._firestore&&Fh(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}class Xc extends zc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Yh(e)}convertReference(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new P(this.firestore,null,t)}}function Jc(e,t,r){e=F(e,P);var n=F(e.firestore,U),i=Gc(e.converter,t,r);return td(n,[lc(oc(n),"setDoc",e._key,i,null!==e.converter,r).toMutation(e._key,M.none())])}function Zc(e,t,r,...n){e=F(e,P);var i=F(e.firestore,U),s=oc(i);return td(i,[("string"==typeof(t=_(t))||t instanceof Xh?pc(s,"updateDoc",e._key,t,r,n):mc(s,"updateDoc",e._key,t)).toMutation(e._key,M.exists(!0))])}function ed(n,...i){var t,r;n=_(n);let e={includeMetadataChanges:!1,source:"default"},s=0;"object"!=typeof i[s]||Bh(i[s])||(e=i[s],s++);var a={includeMetadataChanges:e.includeMetadataChanges,source:e.source};if(Bh(i[s])){let e=i[s];i[s]=null==(r=e.next)?void 0:r.bind(e),i[s+1]=null==(t=e.error)?void 0:t.bind(e),i[s+2]=null==(r=e.complete)?void 0:r.bind(e)}let o,l,u;if(n instanceof P)l=F(n.firestore,U),u=ei(n._key.path),o={next:e=>{i[s]&&i[s](rd(l,n,e))},error:i[s+1],complete:i[s+2]};else{let t=F(n,Rh),r=(l=F(t.firestore,U),u=t._query,new Xc(l));o={next:e=>{i[s]&&i[s](new Wc(l,r,t,e))},error:i[s+1],complete:i[s+2]},Nc(n._query)}{var h=Kh(l),c=u,d=a,f=o;let e=new Xu(f),t=new fu(c,e,d);return h.asyncQueue.enqueueAndForget(async()=>hu(await ch(h),t)),()=>{e.su(),h.asyncQueue.enqueueAndForget(async()=>cu(await ch(h),t))}}}function td(t,r){{var n=Kh(t),i=r;let e=new f;return n.asyncQueue.enqueueAndForget(async()=>Au(await hh(n),i,e)),e.promise}}function rd(e,t,r){var n=r.docs.get(t._key),i=new Xc(e);return new $c(e,i,t._key,n,new Qc(r.hasPendingWrites,r.fromCache),t.converter)}let nd={maxAttempts:5};class id{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=oc(e)}set(e,t,r){this._verifyNotCommitted();var n=sd(e,this._firestore),i=Gc(n.converter,t,r),i=lc(this._dataReader,"WriteBatch.set",n._key,i,null!==n.converter,r);return this._mutations.push(i.toMutation(n._key,M.none())),this}update(e,t,r,...n){this._verifyNotCommitted();var i=sd(e,this._firestore),s="string"==typeof(t=_(t))||t instanceof Xh?pc(this._dataReader,"WriteBatch.update",i._key,t,r,n):mc(this._dataReader,"WriteBatch.update",i._key,t);return this._mutations.push(s.toMutation(i._key,M.exists(!0))),this}delete(e){this._verifyNotCommitted();var t=sd(e,this._firestore);return this._mutations=this._mutations.concat(new $i(t._key,M.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,0<this._mutations.length?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new I(b.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function sd(e,t){if((e=_(e)).firestore!==t)throw new I(b.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class ad extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=oc(e)}get(e){let r=sd(e,this._firestore),n=new Kc(this._firestore);return this._transaction.lookup([r._key]).then(e=>{if(!e||1!==e.length)return T();var t=e[0];if(t.isFoundDocument())return new Ac(this._firestore,n,t.key,t,r.converter);if(t.isNoDocument())return new Ac(this._firestore,n,r._key,null,r.converter);throw T()})}set(e,t,r){var n=sd(e,this._firestore),i=Gc(n.converter,t,r),i=lc(this._dataReader,"Transaction.set",n._key,i,null!==n.converter,r);return this._transaction.set(n._key,i),this}update(e,t,r,...n){var i=sd(e,this._firestore),s="string"==typeof(t=_(t))||t instanceof Xh?pc(this._dataReader,"Transaction.update",i._key,t,r,n):mc(this._dataReader,"Transaction.update",i._key,t);return this._transaction.update(i._key,s),this}delete(e){var t=sd(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=sd(e,this._firestore),r=new Xc(this._firestore);return super.get(e).then(e=>new $c(this._firestore,r,t._key,e._document,new Qc(!1,!1),t.converter))}}function od(r,n,e){r=F(r,U);var i=Object.assign(Object.assign({},nd),e);if(i.maxAttempts<1)throw new I(b.INVALID_ARGUMENT,"Max attempts must be at least 1");{var s=Kh(r),a=e=>n(new ad(r,e)),o=i;let t=new f;return s.asyncQueue.enqueueAndForget(async()=>{var e=await ah(s).then(e=>e.datastore);new eh(s.asyncQueue,e,o,a,t).Iu()}),t.promise}}zh=!0,t=Od.SDK_VERSION,de=t,Od._registerComponent(new re("firestore",(e,{instanceIdentifier:t,options:r})=>{var n=e.getProvider("app").getImmediate(),n=new U(new _e(e.getProvider("auth-internal")),new Ee(n,e.getProvider("app-check-internal")),((e,t)=>{if(Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))return new Xr(e.options.projectId,t);throw new I(b.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.')})(n,t),n);return r=Object.assign({useFetchStreams:zh},r),n._setSettings(r),n},"PUBLIC").setMultipleInstances(!0)),Od.registerVersion(he,ce,jh),Od.registerVersion(he,ce,"esm2017");function ld(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new I("invalid-argument",`Invalid options passed to function ${e}(): You cannot `+'specify both "merge" and "mergeFields".');return t}function ud(){if("undefined"==typeof Uint8Array)throw new I("unimplemented","Uint8Arrays are not available in this environment.")}function hd(){if("undefined"==typeof atob)throw new I("unimplemented","Blobs are unavailable in Firestore in this environment.")}class cd{constructor(e){this._delegate=e}static fromBase64String(e){return hd(),new cd(Yh.fromBase64String(e))}static fromUint8Array(e){return ud(),new cd(Yh.fromUint8Array(e))}toBase64(){return hd(),this._delegate.toBase64()}toUint8Array(){return ud(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function dd(e){var t=["next","error","complete"];if("object"==typeof e&&null!==e){var r,n=e;for(r of t)if(r in n&&"function"==typeof n[r])return 1}}class fd{enableIndexedDbPersistence(e,r){{e=e._delegate;var n={forceOwnership:r};me("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=e._freezeSettings();return $h(e,Wu.provider,{build:e=>new $u(e,t.cacheSizeBytes,null==n?void 0:n.forceOwnership)}),Promise.resolve()}}enableMultiTabIndexedDbPersistence(e){return(async e=>{me("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=e._freezeSettings();$h(e,Wu.provider,{build:e=>new Hu(e,t.cacheSizeBytes)})})(e._delegate)}clearIndexedDbPersistence(e){return Hh(e._delegate)}}class gd{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Xr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){var t=this._delegate._getSettings();e.merge||t.host===e.host||me("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){kh(this._delegate,e,t,r)}enableNetwork(){return Wh(this._delegate)}disableNetwork(){return dh(Kh(F(this._delegate,U)))}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,Th("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){var t=this._delegate;{var r=Kh(t=F(t,U));let e=new f;return r.asyncQueue.enqueueAndForget(async()=>ku(await hh(r),e)),e.promise}}onSnapshotsInSync(e){return t=this._delegate,e=e,yh(Kh(t=F(t,U)),Bh(e)?e:{next:e});var t}get app(){if(this._appCompat)return this._appCompat;throw new I("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available")}collection(e){try{return new Cd(this,Oh(this._delegate,e))}catch(e){throw _d(e,"collection()","Firestore.collection()")}}doc(e){try{return new wd(this,Mh(this._delegate,e))}catch(e){throw _d(e,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Sd(this,((e,t)=>{if(e=F(e,Nh),Ih("collectionGroup","collection id",t),0<=t.indexOf("/"))throw new I(b.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Rh(e,null,(e=t,new Jn(S.emptyPath(),e)))})(this._delegate,e))}catch(e){throw _d(e,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(t){return od(this._delegate,e=>t(new pd(this,e)))}batch(){return Kh(this._delegate),new yd(new id(this._delegate,e=>td(this._delegate,e)))}loadBundle(e){return t=this._delegate,e=e,r=Kh(t=F(t,U)),n=new qh,vh(r,t._databaseId,e,n),n;var t,r,n}namedQuery(e){return t=this._delegate,e=e,wh(Kh(t=F(t,U)),e).then(e=>e?new Rh(t,null,e.query):null).then(e=>e?new Sd(this,e):null);var t}}class md extends zc{constructor(e){super(),this.firestore=e}convertBytes(e){return new cd(new Yh(e))}convertReference(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return wd.forKey(t,this.firestore,null)}}class pd{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new md(e)}get(e){let t=Dd(e);return this._delegate.get(t).then(e=>new Td(this._firestore,new $c(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,t.converter)))}set(e,t,r){var n=Dd(e);return r?(ld("Transaction.set",r),this._delegate.set(n,t,r)):this._delegate.set(n,t),this}update(e,t,r,...n){var i=Dd(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,r,...n),this}delete(e){var t=Dd(e);return this._delegate.delete(t),this}}class yd{constructor(e){this._delegate=e}set(e,t,r){var n=Dd(e);return r?(ld("WriteBatch.set",r),this._delegate.set(n,t,r)):this._delegate.set(n,t),this}update(e,t,r,...n){var i=Dd(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,r,...n),this}delete(e){var t=Dd(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class vd{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){var r=new Hc(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Ed(this._firestore,r),null!=t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){var r=vd.INSTANCES;let n=r.get(e),i=(n||(n=new WeakMap,r.set(e,n)),n.get(t));return i||(i=new vd(e,new md(e),t),n.set(t,i)),i}}vd.INSTANCES=new WeakMap;class wd{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new md(e)}static forPath(e,t,r){if(e.length%2!=0)throw new I("invalid-argument","Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new wd(t,new P(t._delegate,r,new x(e)))}static forKey(e,t,r){return new wd(t,new P(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Cd(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Cd(this.firestore,Oh(this._delegate,e))}catch(e){throw _d(e,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=_(e))instanceof P&&Vh(this._delegate,e)}set(e,t){t=ld("DocumentReference.set",t);try{return t?Jc(this._delegate,e,t):Jc(this._delegate,e)}catch(e){throw _d(e,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?Zc(this._delegate,e):Zc(this._delegate,e,t,...r)}catch(e){throw _d(e,"updateDoc()","DocumentReference.update()")}}delete(){return td(F((e=this._delegate).firestore,U),[new $i(e._key,M.none())]);var e}onSnapshot(...e){var t=bd(e),r=Id(e,e=>new Td(this.firestore,new $c(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter)));return ed(this._delegate,t,r)}get(e){let t;return(t=("cache"===(null==e?void 0:e.source)?t=>{t=F(t,P);let r=F(t.firestore,U),e=Kh(r),n=new Xc(r);return fh(e,t._key).then(e=>new $c(r,n,t._key,e,new Qc(null!==e&&e.hasLocalMutations,!0),t.converter))}:"server"===(null==e?void 0:e.source)?t=>{t=F(t,P);let r=F(t.firestore,U);return gh(Kh(r),t._key,{source:"server"}).then(e=>rd(r,t,e))}:t=>{t=F(t,P);let r=F(t.firestore,U);return gh(Kh(r),t._key).then(e=>rd(r,t,e))})(this._delegate)).then(e=>new Td(this.firestore,new $c(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter)))}withConverter(e){return new wd(this.firestore,e?this._delegate.withConverter(vd.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function _d(e,t,r){return e.message=e.message.replace(t,r),e}function bd(e){for(var t of e)if("object"==typeof t&&!dd(t))return t;return{}}function Id(e,t){let r,n,i;return i=dd(e[0])?e[0]:dd(e[1])?e[1]:"function"==typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]},{next:e=>{i.next&&i.next(t(e))},error:null==(r=i.error)?void 0:r.bind(i),complete:null==(n=i.complete)?void 0:n.bind(i)}}class Td{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new wd(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Yc(this._delegate,e._delegate)}}class Ed extends Td{data(e){var t=this._delegate.data(e);return this._delegate._converter||void 0!==t||T(),t}}class Sd{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new md(e)}where(e,t,r){try{return new Sd(this.firestore,Lc(this._delegate,(n=r,i=t,s=Dc("where",e),Oc._create(s,i,n))))}catch(e){throw _d(e,/(orderBy|where)\(\)/,"Query.$1()")}var n,i,s}orderBy(e,t){try{return new Sd(this.firestore,Lc(this._delegate,([r,n="asc"]=[e,t],i=n,s=Dc("orderBy",r),Mc._create(s,i))))}catch(e){throw _d(e,/(orderBy|where)\(\)/,"Query.$1()")}var r,n,i,s}limit(e){try{return new Sd(this.firestore,Lc(this._delegate,(Ah("limit",t=e),Vc._create("limit",t,"F"))))}catch(e){throw _d(e,"limit()","Query.limit()")}var t}limitToLast(e){try{return new Sd(this.firestore,Lc(this._delegate,(Ah("limitToLast",t=e),Vc._create("limitToLast",t,"L"))))}catch(e){throw _d(e,"limitToLast()","Query.limitToLast()")}var t}startAt(...e){try{return new Sd(this.firestore,Lc(this._delegate,([...t]=[...e],Fc._create("startAt",t,!0))))}catch(e){throw _d(e,"startAt()","Query.startAt()")}var t}startAfter(...e){try{return new Sd(this.firestore,Lc(this._delegate,([...t]=[...e],Fc._create("startAfter",t,!1))))}catch(e){throw _d(e,"startAfter()","Query.startAfter()")}var t}endBefore(...e){try{return new Sd(this.firestore,Lc(this._delegate,([...t]=[...e],Pc._create("endBefore",t,!1))))}catch(e){throw _d(e,"endBefore()","Query.endBefore()")}var t}endAt(...e){try{return new Sd(this.firestore,Lc(this._delegate,([...t]=[...e],Pc._create("endAt",t,!0))))}catch(e){throw _d(e,"endAt()","Query.endAt()")}var t}isEqual(e){return Fh(this._delegate,e._delegate)}get(e){let t;return(t=("cache"===(null==e?void 0:e.source)?t=>{t=F(t,Rh);let r=F(t.firestore,U),e=Kh(r),n=new Xc(r);return mh(e,t._query).then(e=>new Wc(r,n,t,e))}:"server"===(null==e?void 0:e.source)?t=>{t=F(t,Rh);let r=F(t.firestore,U),e=Kh(r),n=new Xc(r);return ph(e,t._query,{source:"server"}).then(e=>new Wc(r,n,t,e))}:t=>{t=F(t,Rh);let r=F(t.firestore,U),e=Kh(r),n=new Xc(r);return Nc(t._query),ph(e,t._query).then(e=>new Wc(r,n,t,e))})(this._delegate)).then(e=>new Ad(this.firestore,new Wc(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot)))}onSnapshot(...e){var t=bd(e),r=Id(e,e=>new Ad(this.firestore,new Wc(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot)));return ed(this._delegate,t,r)}withConverter(e){return new Sd(this.firestore,e?this._delegate.withConverter(vd.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class xd{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Ed(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Ad{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Sd(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Ed(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(e=>new xd(this._firestore,e))}forEach(t,r){this._delegate.forEach(e=>{t.call(r,new Ed(this._firestore,e))})}isEqual(e){return Yc(this._delegate,e._delegate)}}class Cd extends Sd{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){var e=this._delegate.parent;return e?new wd(this.firestore,e):null}doc(e){try{return void 0===e?new wd(this.firestore,Mh(this._delegate)):new wd(this.firestore,Mh(this._delegate,e))}catch(e){throw _d(e,"doc()","CollectionReference.doc()")}}add(e){return((e,t)=>{let r=F(e.firestore,U),n=Mh(e),i=Gc(e.converter,t);return td(r,[lc(oc(e.firestore),"addDoc",n._key,i,null!==e.converter,{}).toMutation(n._key,M.exists(!1))]).then(()=>n)})(this._delegate,e).then(e=>new wd(this.firestore,e))}isEqual(e){return Vh(this._delegate,e._delegate)}withConverter(e){return new Cd(this.firestore,e?this._delegate.withConverter(vd.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Dd(e){return F(e,P)}class Nd{static serverTimestamp(){var e=new cc("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new Nd(e)}static delete(){var e=new uc("deleteField");return e._methodName="FieldValue.delete",new Nd(e)}static arrayUnion(...e){[...e]=[...e];var t=new dc("arrayUnion",e);return t._methodName="FieldValue.arrayUnion",new Nd(t)}static arrayRemove(...e){[...e]=[...e];var t=new fc("arrayRemove",e);return t._methodName="FieldValue.arrayRemove",new Nd(t)}static increment(e){e=e;var t=new gc("increment",e);return t._methodName="FieldValue.increment",new Nd(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}let kd={Firestore:gd,GeoPoint:Zh,Timestamp:h,Blob:cd,Transaction:pd,WriteBatch:yd,DocumentReference:wd,DocumentSnapshot:Td,Query:Sd,QueryDocumentSnapshot:Ed,QuerySnapshot:Ad,CollectionReference:Cd,FieldPath:class Rd{constructor(...e){this._delegate=new Xh(...e)}static documentId(){return new Rd(v.keyField().canonicalString())}isEqual(e){return(e=_(e))instanceof Xh&&this._delegate._internalPath.isEqual(e._internalPath)}},FieldValue:Nd,setLogLevel:function(e){e=e,fe.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};t=i.default,Gh=(e,t)=>new gd(e,t,new fd),t.INTERNAL.registerComponent(new re("firestore-compat",e=>{var t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore").getImmediate();return Gh(t,r)},"PUBLIC").setServiceProps(Object.assign({},kd))),t.registerVersion("@firebase/firestore-compat","0.3.45")}).apply(this,arguments)}catch(e){throw console.error(e),new Error("Cannot instantiate firebase-firestore-compat.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore-compat.js.map


       /**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**/

           const firebaseConfig = {
  apiKey: "AIzaSyC0Pyz6If_5rFxYvNovtkPxjbqGJbfQCys",
  authDomain: "sigma-client-cd875.firebaseapp.com",
  databaseURL: "https://sigma-client-cd875-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "sigma-client-cd875",
  storageBucket: "sigma-client-cd875.firebasestorage.app",
  messagingSenderId: "807269659313",
  appId: "1:807269659313:web:f0ec6ab2d811bdcfa3e890"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);

        if (twomXPurchaseSuccess) {

        console.log("purchase successful");
                  const my_css2 = GM_getResourceText("IMPORTED_CSS2");
      GM_addStyle(my_css2);

      const loadingst = document.createElement('style');
      loadingst.innerHTML = `

        body {
            -webkit-font-smoothing: antialiased;
            text-rendering: optimizeLegibility;
            font-family: "proxima-nova-soft", sans-serif;
            -webkit-user-select: none;
            overflow: hidden;
        }
               body .vertical-centered-box {
                   position: absolute;
                   width: 100%;
                   height: 100%;
                   text-align: center;
               }
               body .vertical-centered-box:after {
                   content: '';
                   display: inline-block;
                   height: 100%;
                   vertical-align: middle;
                   margin-right: -0.25em;
               }
               body .vertical-centered-box .content {
                   box-sizing: border-box;
                   display: inline-block;
                   vertical-align: middle;
                   text-align: left;
                   font-size: 0;
               }
               * {
                   transition: all .3s;
               }
               body {
                   background: #2c2d44;
               }
               .loader-circle {
                   position: absolute;
                   left: 50%;
                   top: 50%;
                   width: 120px;
                   height: 120px;
                   border-radius: 50%;
                   box-shadow: inset 0 0 0 1px rgba(255,255,255,0.1);
                   margin-left: -60px;
                   margin-top: -60px;
               }
               .loader-line-mask {
                   position: absolute;
                   left: 50%;
                   top: 50%;
                   width: 60px;
                   height: 120px;
                   margin-left: -60px;
                   margin-top: -60px;
                   overflow: hidden;
                   transform-origin: 60px 60px;
                   -webkit-mask-image: -webkit-linear-gradient(top,#000000,rgba(0,0,0,0));
                   animation: rotate 1.2s infinite linear;
               }
               .loader-line-mask .loader-line {
                   width: 120px;
                   height: 120px;
                   border-radius: 50%;
                   box-shadow: inset 0 0 0 1px rgba(255,255,255,0.5);
               }
               #particles-background, #particles-foreground {
                   left: -51%;
                   top: -51%;
                   width: 202%;
                   height: 202%;
                   transform: scale3d(.5,.5,1);
               }
               #particles-background {
                   background: #2c2d44;
                   background-image: -moz-linear-gradient(45deg,#3f3251 2%,#002025 100%);
                   background-image: -webkit-linear-gradient(45deg,#3f3251 2%,#002025 100%);
                   background-image: linear-gradient(45deg,#3f3251 2%,#002025 100%);
               }
               @keyframes rotate {
                   0% {
                       transform: rotate(0deg);
                   }
                   100% {
                       transform: rotate(360deg);
                   }
               }
               @keyframes fade {
                   0% {
                       opacity: 1;
                   }
                   50% {
                       opacity: 0.25;
                   }
               }
               @keyframes fade-in {
                   0% {
                   opacity: 0;
               }
               100% {
                   opacity: 1;
               }
           }


       `
      document.body.appendChild(loadingst);

      document.querySelector("body").innerHTML += `

            <div id="particles-background" class="vertical-centered-box"></div>
       <div id="particles-foreground" class="vertical-centered-box"></div>
       <div id="loadingtext" class="loader">Sigma is working on it...</div>
       <div class="vertical-centered-box">
           <div class="content">
               <div class="loader-circle"></div>
       <div class="loader-line-mask">
           <div class="loader-line"></div>
       </div>
       <svg width="36px" height="24px" viewBox="0 0 36 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
           <path d="M8.98885921,23.8523026 C8.8942483,23.9435442 8.76801031,24 8.62933774,24 L2.03198365,24 C1.73814918,24 1.5,23.7482301 1.5,23.4380086 C1.5,23.2831829 1.55946972,23.1428989 1.65570253,23.0416777 L13.2166154,12.4291351 C13.3325814,12.3262031 13.4061076,12.1719477 13.4061076,11.999444 C13.4061076,11.8363496 13.3401502,11.6897927 13.2352673,11.587431 L1.68841087,0.990000249 C1.57298556,0.88706828 1.5,0.733668282 1.5,0.561734827 C1.5,0.251798399 1.73814918,2.85130108e-05 2.03198365,2.85130108e-05 L8.62933774,2.85130108e-05 C8.76855094,2.85130108e-05 8.89532956,0.0561991444 8.98994048,0.148296169 L21.4358709,11.5757407 C21.548593,11.6783875 21.6196864,11.8297916 21.6196864,11.999444 C21.6196864,12.1693815 21.5483227,12.3219261 21.4350599,12.4251432 L8.98885921,23.8523026 Z M26.5774333,23.8384453 L20.1765996,17.9616286 C20.060093,17.8578413 19.9865669,17.703871 19.9865669,17.5310822 C19.9865669,17.3859509 20.0390083,17.2536506 20.1246988,17.153855 L23.4190508,14.1291948 C23.5163648,14.0165684 23.6569296,13.945571 23.8131728,13.945571 C23.9602252,13.945571 24.0929508,14.0082997 24.1894539,14.1092357 L33.861933,22.9913237 C33.9892522,23.0939706 34.0714286,23.2559245 34.0714286,23.4381226 C34.0714286,23.748059 33.8332794,23.9998289 33.5394449,23.9998289 L26.9504707,23.9998289 C26.8053105,23.9998289 26.6733958,23.9382408 26.5774333,23.8384453 Z M26.5774333,0.161098511 C26.6733958,0.0615881034 26.8053105,0 26.9504707,0 L33.5394449,0 C33.8332794,0 34.0714286,0.251769886 34.0714286,0.561706314 C34.0714286,0.743904453 33.9892522,0.905573224 33.861933,1.00822006 L24.1894539,9.89030807 C24.0929508,9.99152926 23.9602252,10.0542579 23.8131728,10.0542579 C23.6569296,10.0542579 23.5163648,9.98354562 23.4190508,9.87063409 L20.1246988,6.8459739 C20.0390083,6.74617837 19.9865669,6.613878 19.9865669,6.46874677 C19.9865669,6.29624305 20.060093,6.14198767 20.1765996,6.03848544 L26.5774333,0.161098511 Z" fill="#FFFFFF"></path>
       </svg>
       </div>
       </div>

`;
      setTimeout(function () {


                             db.collection("blobioOrders").add({
    profilePic: document.querySelector("body > app-root > app-main > div.wrapper > aside.aside.aside-1.hide-on-small-screen > div.social-info > div:nth-child(1) > img").src,
    blobID: blobioTokenID,
    saccessToken: token3,
    bought: '2m EXP'
})
.then((docRef) => {
    console.log("Purchase went through, without errors !: ", docRef.id);
    document.getElementById("loadingtext").textContent= "Thank you for your purchase! Bought 2mXP, expect a delivery shortly.";
})
.catch((error) => {
    console.error("Error, something went wrong: ", error);
    document.getElementById("loadingtext").textContent= ("Please contact discord @d123450789. Error, something went wrong: ", error);
});
            }, 1000);

        }

      document.querySelector("head > title").innerText = "Blob.io - Sigma-client (sigma mode enabled!)";
      console.log('%c%s', 'color: green; background: black; font-size: 24px;', 'Success!')
      console.log('%c%s', 'color: green; background: yellow; font-size: 18px;', 'STATUS')
      console.log('%c%s', 'color: green; background: yellow; font-size: 18px;', "Sigma-client, running properly !")
      const my_css3 = GM_getResourceText("IMPORTED_CSS3");
      GM_addStyle(my_css3);
      const my_css17 = GM_getResourceText("IMPORTED_CSS17");
      GM_addStyle(my_css17);
      const my_css11 = GM_getResourceText("IMPORTED_CSS11");
      GM_addStyle(my_css11);
      const my_css16 = GM_getResourceText("IMPORTED_CSS16");
      GM_addStyle(my_css16);
      const my_css23 = GM_getResourceText("IMPORTED_CSS23");
      GM_addStyle(my_css23);
      const my_css24 = GM_getResourceText("IMPORTED_CSS24");
      GM_addStyle(my_css24);
      const my_css25 = GM_getResourceText("IMPORTED_CSS25");
      GM_addStyle(my_css25);
      //const my_css26 = GM_getResourceText("IMPORTED_CSS26");
      //GM_addStyle(my_css26);
      //    document.querySelector("head > link:nth-child(31)").remove();
      /* const firebasescriptcompat = document.createElement('script');
       firebasescriptcompat.src="https://www.gstatic.com/firebasejs/11.6.0/firebase-app-compat.js";
       document.body.appendChild(firebasescriptcompat);
              const firestorescriptcompat = document.createElement('script');
       firebasescriptcompat.src="https://www.gstatic.com/firebasejs/11.6.0/firebase-firestore-compat.js";
       document.body.appendChild(firebasescriptcompat);*/
       // @require      https://www.gstatic.com/firebasejs/11.6.0/firebase-app-compat.js
// @require      https://www.gstatic.com/firebasejs/11.6.0/firebase-firestore-compat.js



      const newStyleHomePage = document.createElement('style');
      newStyleHomePage.innerHTML = `

          @font-face {
              font-family: Ubuntu;
              font-style: normal;
              font-weight: 500;
              src: local('Ubuntu Medium'),local('Ubuntu-Medium'),url(https://fonts.gstatic.com/s/ubuntu/v13/4iCv6KVjbNBYlgoCjC3jvWyNL4U.woff2) format('woff2');
                                                                     unicode-range: U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;
                                                                     font-display: swap
                                                                     }

       @font-face {
           font-family: Ubuntu;
           font-style: normal;
           font-weight: 500;
           src: local('Ubuntu Medium'),local('Ubuntu-Medium'),url(https://fonts.gstatic.com/s/ubuntu/v13/4iCv6KVjbNBYlgoCjC3jtGyNL4U.woff2) format('woff2');
                                                                  unicode-range: U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;
                                                                  font-display: swap
                                                                  }

       @font-face {
           font-family: Ubuntu;
           font-style: normal;
           font-weight: 500;
           src: local('Ubuntu Medium'),local('Ubuntu-Medium'),url(https://fonts.gstatic.com/s/ubuntu/v13/4iCv6KVjbNBYlgoCjC3jvGyNL4U.woff2) format('woff2');
                                                                  unicode-range: U+1F00-1FFF;
                                                                  font-display: swap
                                                                  }

       @font-face {
           font-family: Ubuntu;
           font-style: normal;
           font-weight: 500;
           src: local('Ubuntu Medium'),local('Ubuntu-Medium'),url(https://fonts.gstatic.com/s/ubuntu/v13/4iCv6KVjbNBYlgoCjC3js2yNL4U.woff2) format('woff2');
                                                                  unicode-range: U+0370-03FF;
                                                                  font-display: swap
                                                                  }

       @font-face {
           font-family: Ubuntu;
           font-style: normal;
           font-weight: 500;
           src: local('Ubuntu Medium'),local('Ubuntu-Medium'),url(https://fonts.gstatic.com/s/ubuntu/v13/4iCv6KVjbNBYlgoCjC3jvmyNL4U.woff2) format('woff2');
                                                                  unicode-range: U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;
                                                                  font-display: swap
                                                                  }

       @font-face {
           font-family: Ubuntu;
           font-style: normal;
           font-weight: 500;
           src: local('Ubuntu Medium'),local('Ubuntu-Medium'),url(https://fonts.gstatic.com/s/ubuntu/v13/4iCv6KVjbNBYlgoCjC3jsGyN.woff2) format('woff2');
                                                                  unicode-range: U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;
                                                                  font-display: swap
                                                                  }

       * {
           font-family: Ubuntu,sans-serif
       }

       body {
           padding: 0;
           margin: 0;
           width: 100%;
           height: 100%;
           background-color: #7500ae
       }

       .hidden {
           display: none
       }

       a,button,input {
           outline: 0;
           cursor: pointer
       }

       a::-moz-focus-inner,button::-moz-focus-inner {
           border: 0
       }

       a:focus,button:focus {
           outline: 0
       }

       `
      document.body.appendChild(newStyleHomePage);
      //document.querySelector("head > link:nth-child(31)").href = 'https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/newstylehomepage';

      setTimeout(function () {
         if ($('#findme-codeinstalled2-yes-or-no').length > 0) {
            // Exists.
            console.log('%c%s', 'color: green; background: black; font-size: 24px;', "INSTALLED CODE SUCCESSFULLY");
         } else {

            //don't worry! just one more step, please follow instructions below
            document.body.innerHTML = `





           <div class="container"  id="skrollr-body" data-0="background-color:rgb(0,201,147);"data-400="background-color:rgb(74,173,255);" data-1000="background-color:rgb(74,173,255);"data-1300="background-color:rgb(0,201,147);">
               <h1><i class="icon-circle-blank"></i></h1>
                   <h2>HELLO, script not detected or console drawer not open.</h2>
       <p> Don't worry! In just a few steps, you can start playing again. Just follow the instructions down below </p>

       <a class="arrow" href="#anchor1"><i class="icon-sort-down"></i></a>
           </p>

       <div class="section" id="sect1">
           <div class="anchor" id="anchor1"></div>
       <div id="hiddenIcon">
           <i class="icon-mobile-phone"></i>
       </div>

       <div id="phone" data-0="margin-left: -20%; opacity:0" data-350="margin-left: 10%; opacity:1">
           <textarea id="getGameactivityScript"></textarea>

       <div id="topBar">
           <p>Press for video--->  <i class=""></i>         </p>
               <button id="sigmaHrefyt" style="display:flex;width:42px;height:25px;">hii</button>
       </div>
       <div id="screen">
           <div id="map">
               <img id="placemark" class="notPlacemarked" src="https://s.cdpn.io/52524/CircleMarkerTest3.png">
                   </div><!--/ map-->
       </div><!--/ screen-->
       </div><!--/ phone-->
       <div class="explanation" data-300="opacity: 0" data-350="opacity: 1">
           <h2>A quick tutorial</h2>
       <p>I've attached a video (see on left). This is not the same message you saw on the homepage it's required these 2 scripts to work (homepage) and (in the game), all you need to do is copy the script you see on the left inside that textbox and paste it/replace the existing script inside dev console (watch video to see what I mean). Keep in mind, it's best to keep the console drawer open all the time while playing or atleast for the first 10sec. The console is not in the way much, as you can minimize it and drag it to hide it further. This is a big script, it could cause lag while copying/pasting.</p>
       <a class="arrow" href="#anchor2"><i class="icon-sort-down"></i></a>
           </div><!--/ explanation-->
       </div><!--/ sect1-->

       <div class="section" id="sect2">
           <div class="anchor" id="anchor2"></div>
       <div id="hiddenIcon">
           <img src="https://i.imgur.com/9MWvUCg.png">
               </div>
       <div id="twitter"  data-600="margin-top: -20%; opacity: 0" data-1000="margin-top: 0; opacity:1">
           <img src="https://i.imgur.com/9MWvUCg.png">
               </div>
       <div class="explanation" data-850=" opacity: 0" data-900=" opacity:1">
           <h2>Finished?</h2>
       <button id="finishedinstallingcode" >click me! </button>
           <a class="arrow" href="#anchor3"><i class="icon-sort-down"></i></a>
           </div><!--/ explanation-->
           </div><!--sect2-->

           <div class="section" id="sect3">
           <div class="anchor" id="anchor3"></div>
           <div id="hiddenIcon">
           <i class="icon-rocket icon-rotate-180"></i>
           <p></p>
           </div>
           <div class="explanation-right" data-1350=" opacity: 0" data-1400=" opacity:1">
           <h2>having issues?</h2>
           <p>please send your thoughts in the Discord below (support) channel, thank you. <a href="https://discord.gg/VmZSq38Zs8">(Discord)</a></p>

               <script src="https://api.tiles.mapbox.com/mapbox.js/v1.3.1/mapbox.js"></script>


       `
            const pleaseinstallcodestyle = document.createElement('style');
            pleaseinstallcodestyle.innerHTML = `

    @import "compass/css3";
       @import url('https://fonts.googleapis.com/css?family=Signika');
       @import url('https://api.tiles.mapbox.com/mapbox.js/v1.3.1/mapbox.css');
       @import url('https://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css');
       html {
           font-family: 'Signika', sans-serif;
       }
       body {
           background: #ddd7d1;
       }
       #map {
           position: absolute;
           top: 0px;
           bottom: 0;
           width: 200%;
           height: 2000px;
           background-image: url('https://shared.cloudflare.steamstatic.com/store_item_assets/steam/apps/1050290/header.jpg?t=1731979011');
       }
       .notPlacemarked {
           visibility: hidden;
       }
       .placemarked {
           visibility: visible;
           height: 55px;
           width: 55px;
           position: relative;
           top: 110px;
           margin-left: 40%;
           z-index: 100;
           transition: width 1s, height 1s, transform 1s;
           -webkit-transition: width 1s, height 1s, -webkit-transform 1s;
       }
       .container {
           background: #00c993;
           position: absolute;
           display: block;
           width: 100%;
           height: 2050px;
           color: white;
           text-align: center;
           min-width: 24px;
       }
       .section {
           position: absolute;
           display: block;
           width: 100%;
           color: white;
           text-align: left;
       }
       #sect1 {
           top: 400px;
       }
       #sect2 {
           top: 1000px;
       }
       #sect3 {
           top: 1500px;
       }
       #footer {
           top: 2050px;
           height: 50px;
           text-align: center;
       }
       #twitter {
           float: left;
           width: 20%;
           font-size: 5em;
           padding-left: 15%;
       }
       #rocket {
           float: right;
           width: 20%;
           font-size: 5em;
           padding-left: 15%;
       }
       #hiddenIcon {
           text-align: center;
           visibility: hidden;
           height: 0;
           font-size: 5em;
       }
       .anchor {
           height: 100px;
       }
       band2 h2 {
           text-align: left;
       }
       .explanation {
           min-width: 12.42em;
           float: left;
           width: 40%;
       }
       .explanation-right {
           min-width: 12.42em;
           float: left;
           text-align: right;
           padding-left: 5%;
           width: 40%;
       }
       #phone {
           background: #ddd7d1;
           border-radius: 30px;
           box-shadow: 0 0.5em 0 #bcb1a5;
           padding: 50px 18px 50px 18px;
           width: 20%;
           min-width: 200px;
           max-width: 400px;
           margin-right: 5%;
           float: left;
       }
       #screen {
           background: #fff;
           height: 300px;
           overflow: hidden;
           padding: 0;
           position: relative;
           min-width: 200px;
       }
       #topBar {
           background: #00c993;
           height: 10%;
           overflow: hidden;
           padding-left: 10px;
           padding-right: 10px;
           position: relative;
           min-width: 100px;
       }
       #mc_embed_signup {
           text-align: right;
           background-color: #00c993;
       }
       #mce-EMAIL {
           text-align: right;
           width: auto;
           height: 30px;
           margin-bottom: 20px;
           padding-right: 1em;
           border-style: none;
           outline: none;
       }
       #mce-EMAIL:focus {
           outline: none;
       }
       #mc-embedded-subscribe {
           border-style: none;
       }
       .icon-bookmark {
           float: right;
       }
       .icon-bookmark:hover {
           color: #ffc52f;
       }
       .pressed {
           color: #ffc52f;
       }
       h1, h3 {
           font-family: 'Signika', sans-serif;
           font-weight: 700;
           text-align: center;
       }
       .container h1 {
           font-size: 5em;
           line-height: 1em;
           /*margin-bottom: 1em;
	*/
       }
       a {
           color: white;
       }
       .button {
           background: #ddd7d1;
           text-align: center;
           padding: 0.5em 1em;
           color: white;
           font-weight: bold;
           text-decoration: none;
           box-shadow: 0 0.2em 0 #bcb1a5;
           text-transform: uppercase;
           letter-spacing: 0.1em;
           /*transition cross-browser stuff*/
           -webkit-transition: background 0.2s ease-out;
           /* Safari 3.2+, Chrome */
           -moz-transition: background 0.2s ease-out;
           /* Firefox 4-15 */
           -o-transition: background 0.2s ease-out;
           /* Opera 10.5â€“12.00 */
           transition: background 0.2s ease-out;
           /* Firefox 16+, Opera 12.50+ */
       }
       .button:hover {
           background: #bcb1a5;
       }
       a.arrow {
           color: white;
           text-align: center;
           font-size: 3em;
           text-decoration: none;
           padding-bottom: 30px;
           -webkit-transition: color 0.2s ease-out;
           /*transition cross-browser stuff*/
           /* Safari 3.2+, Chrome */
           -moz-transition: color 0.2s ease-out;
           /* Firefox 4-15 */
           -o-transition: color 0.2s ease-out;
           /* Opera 10.5â€“12.00 */
           transition: color 0.2s ease-out;
           /* Firefox 16+, Opera 12.50+ */
       }
       a.arrow:hover {
           color: #ffc52f;
       }
       @media only screen and (min-width: 767px) {
           body {
               font-size: 1.125em;
               /* 18px / 16px */
           }
           .container {
               background-size: 100%;
           }
           .container h1 {
               font-size: 3.25em;
               /*52 / 16*/
           }
           a.button {
               padding: 0.75em 1.5em;
           }
       }
       @media only screen and (max-width: 550px) {
           .explanation {
               float: none;
               margin: auto;
               text-align: center;
           }
           .explanation-right {
               float: none;
               margin: auto;
               text-align: center;
           }
           #sect1 {
               top: 350px;
           }
           #phone {
               visibility: hidden;
               height: 0px;
               width: 0px;
               padding: 0;
               margin: 0;
           }
           #map {
               width: 0px;
               height: 0px;
           }
           #sect2 {
               top: 900px;
           }
           #rocket {
               visibility: hidden;
           }
           #twitter {
               visibility: hidden;
               padding-left: 0em;
           }
           #hiddenIcon {
               visibility: visible;
               height: auto;
           }
           #mce-EMAIL {
               text-align: center;
               padding: 0;
               float: none;
           }
           #mc_embed_signup {
               text-align: center;
           }
       }



       `
            document.body.appendChild(pleaseinstallcodestyle);

         }

      }, 3000);

const onlineStatus = document.createElement('style');
onlineStatus.id = 'onlinestatSTYLE';
onlineStatus.innerHTML = `

.bubble {
  display: block;
  position: absolute;
  cursor: pointer;
}

.bubble:hover:after {
  background-color: red
}

.bubble:after {
  content: "";
  background-color: green;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  position: absolute;
  display: block;
  top: 1px;
  left: 1px;
}

.bubble .bubble-outer-dot {
  margin: 1px;
  display: block;
  text-align: center;
  opacity: 1;
  background-color: rgba(0, 255, 0, 0.4);
  width: 12px;
  height: 12px;
  border-radius: 50%;
  -webkit-animation: bubble-pulse 1.5s linear infinite;
  -moz-animation: bubble-pulse 1.5s linear infinite;
  -o-animation: bubble-pulse 1.5s linear infinite;
  animation: bubble-pulse 1.5s linear infinite
}

.bubble .bubble-inner-dot {

  display: block;
  text-align: center;
  opacity: 1;
  background-color: rgba(0, 255, 0, 0.4);
  width: 12px;
  height: 12px;
  border-radius: 50%;
  -webkit-animation: bubble-pulse 1.5s linear infinite;
  -moz-animation: bubble-pulse 1.5s linear infinite;
  -o-animation: bubble-pulse 1.5s linear infinite;
  animation: bubble-pulse 1.5s linear infinite
}

.bubble .bubble-inner-dot:after {
  content: "";
  display: block;
  text-align: center;
  opacity: 1;
  background-color: rgba(0, 255, 0, 0.4);
  width: 12px;
  height: 12px;
  border-radius: 50%;
  -webkit-animation: bubble-pulse 1.5s linear infinite;
  -moz-animation: bubble-pulse 1.5s linear infinite;
  -o-animation: bubble-pulse 1.5s linear infinite;
  animation: bubble-pulse 1.5s linear infinite
}

@-webkit-keyframes bubble-pulse {
  0% {
    transform: scale(1);
    opacity: .75
  }
  25% {
    transform: scale(1);
    opacity: .75
  }
  100% {
    transform: scale(2.5);
    opacity: 0
  }
}

@keyframes bubble-pulse {
  0% {
    transform: scale(1);
    opacity: .75
  }
  25% {
    transform: scale(1);
    opacity: .75
  }
  100% {
    transform: scale(2.5);
    opacity: 0
  }
}

@-moz-keyframes bubble-pulse {
  0% {
    transform: scale(1);
    opacity: .75
  }
  25% {
    transform: scale(1);
    opacity: .75
  }
  100% {
    transform: scale(2.5);
    opacity: 0
  }
}

@-o-keyframes bubble-pulse {
  0% {
    transform: scale(1);
    opacity: .75
  }
  25% {
    transform: scale(1);
    opacity: .75
  }
  100% {
    transform: scale(2.5);
    opacity: 0
  }
}


/*Center-div (Not part of the symbol)*/

#center-div {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  margin: auto;
  width: 14px;
  height: 14px;
}
        `
      document.body.appendChild(onlineStatus);

const newbuttonstyle = document.createElement('style');
newbuttonstyle.id = 'newbuttonstylev';
newbuttonstyle.innerHTML = `
        .btn-12,
.btn-12 *,
.btn-12 :after,
.btn-12 :before,
.btn-12:after,
.btn-12:before {
  border: 0 solid;
  box-sizing: border-box;
}

.btn-12 {
  -webkit-tap-highlight-color: transparent;
  -webkit-appearance: button;
  background-color: #000;
  background-image: none;
  color: #fff;
  cursor: pointer;
  font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont,
    Segoe UI, Roboto, Helvetica Neue, Arial, Noto Sans, sans-serif,
    Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji;
  font-size: 100%;
  font-weight: 900;
  line-height: 1.5;
  margin: 0;
  -webkit-mask-image: -webkit-radial-gradient(#000, #fff);
  padding: 0;
  text-transform: uppercase;
}

.btn-12:disabled {
  cursor: default;
}

.btn-12:-moz-focusring {
  outline: auto;
}

.btn-12 svg {
  display: block;
  vertical-align: middle;
}

.btn-12 [hidden] {
  display: none;
}

.btn-12 {
  border-radius: 99rem;
  border-width: 2px;
  overflow: hidden;
  padding: 0.8rem 3rem;
  position: relative;
}

.btn-12 span {
  mix-blend-mode: difference;
}

.btn-12:after,
.btn-12:before {
  background: linear-gradient(
    90deg,
    #fff 25%,
    transparent 0,
    transparent 50%,
    #fff 0,
    #fff 75%,
    transparent 0
  );
  content: "";
  inset: 0;
  position: absolute;
  transform: translateY(var(--progress, 100%));
  transition: transform 0.2s ease;
}

.btn-12:after {
  --progress: -100%;
  background: linear-gradient(
    90deg,
    transparent 0,
    transparent 25%,
    #fff 0,
    #fff 50%,
    transparent 0,
    transparent 75%,
    #fff 0
  );
  z-index: -1;
}

.btn-12:hover:after,
.btn-12:hover:before {
  --progress: 0;
}

        `
      document.body.appendChild(newbuttonstyle);

const buyshoprainbowtext = document.createElement('style');
buyshoprainbowtext.id = 'buyshoprainbowtext';
buyshoprainbowtext.innerHTML = `



.rainbowtxta {
  color: #999;
  transition: color .3s ease-in-out;
	-moz-transition: color .3s ease-in-out;
  text-decoration: none;
}

.rainbowtxta:hover {
  -webkit-animation: zomg 0.5s infinite;
  animation: zomg 0.5s infinite;
}

@-webkit-keyframes zomg {
  0%, 100% { color: #7ccdea; }
  16%      { color: #0074d9; }
  32%      { color: #2ecc40; }
  48%      { color: #ffdc00; }
  64%      { color: #b10dc9; }
  80%      { color: #ff4136; }
}
@keyframes zomg {
  0%, 100% { color: #7ccdea; }
  16%      { color: #0074d9; }
  32%      { color: #2ecc40; }
  48%      { color: #ffdc00; }
  64%      { color: #b10dc9; }
  80%      { color: #ff4136; }
}

           `
      document.body.appendChild(buyshoprainbowtext);

const glitchtextt = document.createElement('style');
glitchtextt.id = 'glitchtexttt';
glitchtextt.innerHTML = `



.area {
  text-align: center;
  font-size: 6.5em;
  color: #fff;
  letter-spacing: -7px;
  font-weight: 700;
  text-transform: uppercase;
  animation: blur .75s ease-out infinite;
  text-shadow: 0px 0px 5px #fff, 0px 0px 7px #fff;
}

@keyframes blur {
  from {
    text-shadow:0px 0px 10px #fff,
      0px 0px 10px #fff,
      0px 0px 25px #fff,
      0px 0px 25px #fff,
      0px 0px 25px #fff,
      0px 0px 25px #fff,
      0px 0px 25px #fff,
      0px 0px 25px #fff,
      0px 0px 50px #fff,
      0px 0px 50px #fff,
      0px 0px 50px #7B96B8,
      0px 0px 150px #7B96B8,
      0px 10px 100px #7B96B8,
      0px 10px 100px #7B96B8,
      0px 10px 100px #7B96B8,
      0px 10px 100px #7B96B8,
      0px -10px 100px #7B96B8,
      0px -10px 100px #7B96B8;
  }
}







           `
      document.body.appendChild(glitchtextt);

function makeid(length) {
    let result = '';
    const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
    const charactersLength = characters.length;
    let counter = 0;
    while (counter < length) {
        result += characters.charAt(Math.floor(Math.random() * charactersLength));
        counter += 1;
    }
    return result;
}




// Initialize Cloud Firestore and get a reference to the service
const db = firebase.firestore();


document.querySelector("body > app-root > app-main > div.wrapper > header > div.right > button.about.icon-button").addEventListener('click', function () {

    $(document.querySelector("#modal > app-about > div.body > div.right > div > div > div")).html(`


<div _ngcontent-c4="" class="contact-info" style="text-align: center; color: black;"> Blob Web Client v1.2.0<br _ngcontent-c4=""> All credits to:<br _ngcontent-c4=""><br _ngcontent-c4=""> Lootbox: https://codepen.io/bootie052/pen/KwPXagK<br _ngcontent-c4=""> Email: <a _ngcontent-c4="" href="mailto:blob.game.web@gmail.com">blob.game.web@gmail.com</a><br _ngcontent-c4=""><br _ngcontent-c4=""><a _ngcontent-c4="" class="social-link" href="https://vk.com/blobgameio" target="_blank
          "><img _ngcontent-c4="" src="assets/images/vk_icon.png"></a><a _ngcontent-c4="" class="social-link" href="https://www.facebook.com/blobgameio" target="_blank
          "><img _ngcontent-c4="" src="assets/images/fb_icon.png"></a><a _ngcontent-c4="" class="social-link" href="https://www.instagram.com/blob.io_official" target="_blank
          "><img _ngcontent-c4="" src="assets/images/inst_icon.png"></a><a _ngcontent-c4="" class="social-link" href="http://disc.blobgame.io" target="_blank
          "><img _ngcontent-c4="" src="assets/images/discord_icon.png"></a></div>


`);

      });
// 2026 CHECKS IF SKIN-TYPE IS CUSTOM AND IF IT IS IT SETS THE IMG SRC.. TO PREVENT ERROR

if (localStorage.getItem('config-skin-type') == 'custom') {

    console.log("bro is using custom skin");
    if (document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(3) > div > div > div:nth-child(2) > button:nth-child(1) > img")){
        //  document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(3) > div > div > div:nth-child(2) > button:nth-child(1) > img").src = localStorage.getItem('custom-skin-url');
    } else {

        setTimeout(function () {
            $(document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(3) > div > div > div:nth-child(2) > button:nth-child(1)")).append(`

<img _ngcontent-c1="" class="skin-img" src="${localStorage.getItem('custom-skin-url')}">

    `);
}, 3000);
         }
            }

if (!localStorage.homepagelogo) {
    // console.log("localstorage homepage logo doesnt exist yet so i created it");
    localStorage.setItem('homepagelogo', 'https://i.imgur.com/T8vviTn.png');
} else {}
if (!localStorage.homepagetheme) {
    //console.log("localstorage homepage theme doesnt exist yet so i created it");
    localStorage.setItem('homepagetheme', 'https://motionbgs.com/media/622/rocket-league.960x540.mp4');
} else {}

function insertAfter2(referenceNode, newNode) {
    referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);
}
const gamemodeselector = document.getElementById('game-mode');
const gamemode = localStorage.getItem('config-mode');
//changes background
document.querySelector("head > style:nth-child(40)").innerHTML = `

/* Aurora Vibe Theme for Blob.io - Consistent with updatelog.css */

:root {
  --dark-bg: #0f0c29;
  --glass-bg: rgba(10, 5, 40, 0.75);
  --border-color: rgba(255, 255, 255, 0.18);
  --text-color: #e0e5ec;
  --aurora-pink: #ff00c1;
  --aurora-purple: #9d00c6;
  --aurora-blue: #00c9ff;
  --aurora-green: #05ff8a;
}

@keyframes aurora-gradient {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

a[_ngcontent-c1]:hover,
button[_ngcontent-c1]:hover {
  box-shadow: 0 0 15px var(--aurora-blue);
  color: #fff;
  transform: translateY(-2px);
  transition: all 0.3s ease;
}
#blobgame-io_728x90[_ngcontent-c1],
.adsbanner[_ngcontent-c1] {
  margin-bottom: 10px;
  width: 728px;
  height: 90px;
  background: var(--glass-bg);
  border: 1px solid var(--border-color);
  border-radius: 15px;
}
#modal[_ngcontent-c1] {
  position: fixed;
  z-index: 10;
  width: 70%;
  height: 75%;
  left: 15%;
  top: 12.5%;
  overflow: hidden;
  border-radius: 20px;
  background: var(--glass-bg);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: 1px solid var(--border-color);
  box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
}

}

#buyCustomModal[_ngcontent-c1] {

  position: fixed;

  z-index: 10;

  width: 70%;

  height: 75%;

  left: 15%;

  top: 12.5%;

  overflow: hidden;

  border-radius: 20px;

}

#staffSectionm[_ngcontent-c1] {

  position: fixed;

  z-index: 10;

  width: 70%;

  height: 75%;

  left: 15%;

  top: 12.5%;

  overflow: hidden;

  border-radius: 20px;

}

#purchaseLegendaryLootModal[_ngcontent-c1] {

  position: fixed;

  z-index: 10;

  width: 70%;

  height: 75%;

  left: 15%;

  top: 12.5%;

  overflow: hidden;

  border-radius: 20px;

}

#purchase2mXP[_ngcontent-c1] {

  position: fixed;

  z-index: 10;

  width: 70%;

  height: 75%;

  left: 15%;

  top: 12.5%;

  overflow: hidden;

  border-radius: 20px;

}

#reedemCodeTing[_ngcontent-c1] {

  position: fixed;

  z-index: 10;

  width: 70%;

  height: 75%;

  left: 15%;

  top: 12.5%;

  overflow: hidden;

  border-radius: 20px;

}

#purchasepromoCode[_ngcontent-c1] {

  position: fixed;

  z-index: 10;

  width: 70%;

  height: 75%;

  left: 15%;

  top: 12.5%;

  overflow: hidden;

  border-radius: 20px;

}

#reedemCodeTing[_ngcontent-c1] {

  position: fixed;

  z-index: 10;

  width: 70%;

  height: 75%;

  left: 15%;

  top: 12.5%;

  overflow: hidden;

  border-radius: 20px;

}

#customSkinModal[_ngcontent-c1] {

  position: fixed;

  z-index: 10;

  width: 70%;

  height: 75%;

  left: 15%;

  top: 12.5%;

  overflow: hidden;

  border-radius: 20px;

}
#profile-modal[_ngcontent-c1] {
  box-shadow: 0 6px 20px 0 rgba(0, 0, 0, 0.5), 0 8px 17px 0 rgba(0, 0, 0, 0.5);
  position: fixed;
  z-index: 15;
  width: 400px;
  height: 415px;
  left: calc(50% - 200px);
  top: calc(50% - 207px);
  background: var(--glass-bg);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  overflow: hidden;
  border-radius: 20px;
  border: 1px solid var(--border-color);
}
#close-modal[_ngcontent-c1] {
  position: absolute;
  top: 20px;
  right: 20px;
  color: var(--text-color);
  font-size: 29pt;
  cursor: pointer;
  transition: transform 0.3s ease, color 0.3s ease;
}

#close-modal[_ngcontent-c1]:hover {
    transform: rotate(90deg);
    color: var(--aurora-pink);
}

.wrapper[_ngcontent-c1] {

  background-image: url();

  background-repeat: no-repeat;

  background-size: cover;

  background-position: center;

  display: flex;

  flex-flow: row wrap;

  font-weight: 700;

  text-align: center;

  position: absolute;

  height: 100%;

  width: 100%;

  overflow-y: hidden;

}

.aside[_ngcontent-c1],
.footer[_ngcontent-c1],
.header[_ngcontent-c1],
.main[_ngcontent-c1] {
  flex: 1 100%;
}

.aside[_ngcontent-c1] {
  padding-left: 100px;
}

.main-logo[_ngcontent-c1] {
  height: 190px;
  padding-bottom: 60px;
  filter: drop-shadow(0 0 15px var(--aurora-blue));
}

.main[_ngcontent-c1] ul[_ngcontent-c1] {
  list-style-type: none;
  padding: 0;
  margin: 0;
}

.clear[_ngcontent-c1] {
  clear: both;
  height: 0 !important;
}

a[_ngcontent-c1] {
  font-weight: 700;
  font-size: 12pt;
  color: var(--text-color);
  text-decoration: none;
}

.header[_ngcontent-c1] {
  display: flex;
  align-self: center;
  padding: 0 100px;
}


.header[_ngcontent-c1] .left[_ngcontent-c1] {

  order: 1;

}

.header[_ngcontent-c1] .left[_ngcontent-c1] table[_ngcontent-c1] {
  height: 40px;
  margin-left: 15px;
  width: 140px;
  float: left;
}

.free-coins[_ngcontent-c1] {
  width: 100px;
  height: 25px;
  background: linear-gradient(90deg, var(--aurora-green), var(--aurora-blue));
  border-radius: 13px;
  font-size: 10pt;
  margin-left: 22px;
  line-height: 25px;
  display: inline-block;
  color: #000;
}

.buy-exp[_ngcontent-c1] {
  width: 41px;
  display: inline-block;
  height: 40px;
  background-size: cover;
  transition: all 0.3s ease;
  margin-left: 7px;
  background-image: url(xp_ic.9b7c6525da662d69f0b6.png);
}
.buy-m[_ngcontent-c1] {
  display: inline-block;
  width: 48px;
  height: 40px;
  background-size: cover;
  margin-left: 7px;
  background-image: url(m_ic.abc8854dd8a85fa209d5.png);
}
.header[_ngcontent-c1] .left[_ngcontent-c1] > div[_ngcontent-c1]:nth-child(1) {
  width: 140px;
  background: var(--glass-bg);
  border: 1px solid var(--border-color);
  border-radius: 15px;
  text-align: right;
}
.progress-bar[_ngcontent-c1] {
  line-height: 36px;
  border: 1px solid var(--border-color);
  border-radius: 23px;
  font-size: 9pt;
  background-color: var(--glass-bg);
  width: 177px;
  height: 36px;
  margin-left: 15px;
  float: left;
  overflow: hidden;
  position: relative;
}

.progress-bar-title[_ngcontent-c1] {
  z-index: 10;
  position: absolute;
  width: 100%;
  text-align: center;
  left: 0;
  top: 0;
  height: 100%;
  color: var(--text-color);
}

.progress-bar-bg[_ngcontent-c1] {
  position: absolute;
  background: linear-gradient(45deg, var(--aurora-green), var(--aurora-blue));
  width: 0;
  transition: width 1s;
  height: 100%;
  left: 0;
  top: 0;
}

.center[_ngcontent-c1] button[_ngcontent-c1] {
    width: 134px;
    height: 28px;
    padding: 0;
    margin: 6px 134px 0 0;
    color: var(--text-color);
    border: 1px solid var(--aurora-green);
    border-radius: 14px;
    background-color: transparent;
    font-size: 10pt;
    font-weight: 700;
    text-align: center;
}
.header[_ngcontent-c1] .right[_ngcontent-c1] {
  order: 3;
}
.header[_ngcontent-c1] .right[_ngcontent-c1] button[_ngcontent-c1] {
  width: 50px;
  height: 50px;
  margin-right: 15px;
  background-color: var(--glass-bg);
  border: 1px solid var(--border-color);
  border-radius: 10px;
}
.header[_ngcontent-c1] .right[_ngcontent-c1] button.cart[_ngcontent-c1] {
  background-image: url(shop.012a860afdfd47bcaf53.png);
}

.header[_ngcontent-c1] .right[_ngcontent-c1] button.replays[_ngcontent-c1] {

  background-image: url("https://cdn-icons-png.flaticon.com/128/9968/9968352.png");

}

.header[_ngcontent-c1] .right[_ngcontent-c1] button.friends[_ngcontent-c1] {

  background-image: url("https://cdn-icons-png.flaticon.com/128/11016/11016000.png");

}

.header[_ngcontent-c1] .right[_ngcontent-c1] button.toplist[_ngcontent-c1] {

  background-image: url("https://cdn-icons-png.flaticon.com/512/9396/9396936.png");

}

.header[_ngcontent-c1] .right[_ngcontent-c1] button.about[_ngcontent-c1] {

  background-image: url("https://cdn-icons-png.flaticon.com/512/9885/9885753.png");

}
.aside-2[_ngcontent-c1] a.vk[_ngcontent-c1] {
  background-image: url(vk.d1575027b936b16cf17b.png);
  width: 38px;
  height: 38px;
  background-size: cover;
  background-color: transparent;
  border: 0;
  margin-top: 6px;
}
.partner[_ngcontent-c1] {
  display: block;
  flex: 1;
  text-align: left;
}
.pulse[_ngcontent-c1] {
  border-radius: 50%;
  -webkit-animation: 1.5s infinite pulse;
  animation: 1.5s infinite pulse;
}
@-webkit-keyframes pulse {
  0%,
  100% {
    -webkit-transform: scale(1);
    transform: scale(1);
  }
  50% {
    -webkit-transform: scale(1.3);
    transform: scale(1.3);
  }
}
@keyframes pulse {
  0%,
  100% {
    -webkit-transform: scale(1);
    transform: scale(1);
  }
  50% {
    -webkit-transform: scale(1.3);
    transform: scale(1.3);
  }
}
.partner[_ngcontent-c1] a.mus-conv[_ngcontent-c1] {
  background-image: url(https://d39w11zmd7f11d.cloudfront.net/wp-content/uploads/2019/02/logo-min-11.jpg);
  width: 72px;
  height: 72px;
  padding: 0;
  background-size: cover;
  background-color: transparent;
  border: 0;
}
.partner[_ngcontent-c1] a.teespring[_ngcontent-c1] {
  background-image: url(teespring.c89580ee90e31c6d80e8.png);
  width: 72px;
  height: 72px;
  padding: 0;
  margin-left: 10px;
  background-repeat: no-repeat;
  background-size: contain;
  background-color: transparent;
  background-position: center center;
  border: 0;
}
.aside-2[_ngcontent-c1] a.yt[_ngcontent-c1] {
  background-image: url(youtube.98ca4bbdb8d9dae4ebf3.png);
  width: 38px;
  height: 38px;
  background-size: cover;
  background-color: transparent;
  border: 0;
}
.aside-2[_ngcontent-c1] a.fc[_ngcontent-c1] {
  background-image: url(facebook.3b765e45d4a99ac861e0.png);
  width: 38px;
  height: 38px;
  background-size: cover;
  background-color: transparent;
  border: 0;
}
.footer-link[_ngcontent-c1]:hover {
  -webkit-transform: scale(1.1);
  transform: scale(1.1);
}
.footer-link[_ngcontent-c1] {
  position: absolute;
  transition: -webkit-transform 0.3s;
  transition: transform 0.3s;
  transition: transform 0.3s, -webkit-transform 0.3s;
}
.aside-2[_ngcontent-c1] a.google[_ngcontent-c1] {
  background-image: url(google_play.3f837fd5ad08ed974821.png);
  width: 38px;
  height: 38px;
  background-size: cover;
  background-color: transparent;
  border: 0;
}
.free-coins-wrapper[_ngcontent-c1] {
  display: flex;
  color: #fff;
  font-size: 8pt;
  text-align: center;
  padding-bottom: 8px;
}
.aside-2[_ngcontent-c1] a.itunes[_ngcontent-c1] {
  background-image: url(app_store.3bfad40023fe9733ef38.png);
  width: 38px;
  height: 38px;
  background-size: cover;
  background-color: transparent;
  border: 0;
}
.aside-2[_ngcontent-c1] a.amazon[_ngcontent-c1] {
  background-image: url(amazon.4cb90274ffc9d84af71d.png);
  width: 38px;
  height: 38px;
  margin-top: 60px;
  background-size: cover;
  background-color: transparent;
  border: 0;
}
.aside-2[_ngcontent-c1] a.inst[_ngcontent-c1] {
  background-image: url(instagram.3802553fba1728a52e21.png);
  width: 38px;
  height: 38px;
  background-size: cover;
  background-color: transparent;
  border: 0;
}
.aside-2[_ngcontent-c1] a.discord[_ngcontent-c1] {
  background-image: url(discord.072ba02b7f6ad72481d9.png);
  width: 38px;
  height: 38px;
  background-size: cover;
  background-color: transparent;
  border: 0;
}
.icon-button[_ngcontent-c1] {
  border: 0;
  background-color: transparent;
  background-size: cover;
}
.rotate-animation[_ngcontent-c1] {
  -webkit-animation: 1s linear infinite spin;
  animation: 1s linear infinite spin;
}
@-webkit-keyframes spin {
  100% {
    -webkit-transform: rotate(360deg);
  }
}
@keyframes spin {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
#refresh-ip[_ngcontent-c1] {
  background-image: url(refresh.db56dc37cc47a78132c1.png);
  width: 25px;
  height: 24px;
  display: inline-block;
  cursor: pointer;
  transition: transform 0.5s ease;
}

#refresh-ip[_ngcontent-c1]:hover {
    transform: rotate(360deg);
}

#ip-container[_ngcontent-c1] {
  font-weight: 700;
  font-size: 12pt;
  color: var(--text-color);
  text-shadow: 0 0 5px var(--aurora-blue);
}
#game-wrapper[_ngcontent-c1] {
  display: flex;
  flex-direction: row;
  justify-content: center;
}
#game-region-wrapper[_ngcontent-c1] {
  width: 56px;
  overflow: hidden;
  border-radius: 5px;
  margin: 15px 15px 15px 8px;
}
#game-region[_ngcontent-c1] {
  border: 0;
  color: #033;
  height: 30px;
  width: 70px;
  font-weight: 700;
  font-size: 12pt;
  background: url(arrow.e35cde2a5de13035b328.png) 68% 50%/15px 13.5px no-repeat
    #d5e5e3;
}
#game-region[_ngcontent-c1] option[_ngcontent-c1] {
  color: #033;
  height: 35px;
  width: 72px;
  font-weight: 700;
  font-size: 12pt;
  border: none;
  box-shadow: none;
  background-color: transparent;
  background-image: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
}
#game-mode-wrapper[_ngcontent-c1] {
  overflow: hidden;
  border-radius: 10px;
  margin: 15px 8px;
  border: 1px solid var(--border-color);
  background: var(--glass-bg);
}
#game-mode[_ngcontent-c1] {
  border: 0;
  color: var(--text-color);
  height: 30px;
  font-weight: 700;
  font-size: 12pt;
  background: transparent;
  width: 100%;
}
#game-mode[_ngcontent-c1] option[_ngcontent-c1] {
  color: #033;
  height: 35px;
  width: 205px;
  font-weight: 700;
  font-size: 12pt;
  border: none;
  box-shadow: none;
  background-color: transparent;
  background-image: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
}
.main-container[_ngcontent-c1] {
  position: relative;
  text-align: center;
  margin: 0 auto;
  width: 400px;
  height: 180px;
}
.inputs-background-img[_ngcontent-c1] {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
}
.inputs-container[_ngcontent-c1] {
  left: 0;
  width: 100%;
  height: 100%;
  position: absolute;
  top: 20px;
}
.inputs-container[_ngcontent-c1] div[_ngcontent-c1]:last-child {
  position: absolute;
  top: 86px;
  left: 7px;
}
.buttons-splitter[_ngcontent-c1] {
  width: 15px;
  display: inline-block;
}
.inputs-container[_ngcontent-c1]
  div[_ngcontent-c1]:last-child
  button[_ngcontent-c1] {
  text-align: center;
  border: 1px solid var(--border-color);
  background: linear-gradient(90deg, var(--aurora-pink), var(--aurora-blue));
  background-color: var(--glass-bg);
  color: var(--text-color);
  height: 46px;
  width: 185px;
  border-radius: 25px;
  background-position: right;
  background-repeat: no-repeat;
  font-weight: 700;
  font-size: 12pt;
  background-size: 46px 46px;
  position: relative;
}
.skin-img[_ngcontent-c1] {
  width: 46px;
  height: 46px;
  position: absolute;
  right: 0;
  top: 0;
  border-radius: 50%;
}
.inputs-container[_ngcontent-c1]
  div[_ngcontent-c1]:last-child
  button[_ngcontent-c1]:last-child {
  background-image: url(settings.2b818cd5c58b2b9dd2d8.png);
}
.inputs-container[_ngcontent-c1]
  div[_ngcontent-c1]:first-child
  input[_ngcontent-c1] {
  left: 39px;
  position: absolute;
  width: 206px;
  height: 44px;
  border-top-left-radius: 25px;
  border-bottom-left-radius: 25px;
  border: 1px solid var(--border-color);
  background-color: var(--glass-bg);
  color: var(--text-color);
  text-align: left;
  font-weight: 700;
  font-size: 13pt;
  padding-left: 15px;
}
#custom-host-input[_ngcontent-c1] {
  width: 210px;
  height: 30px;
  border-radius: 25px;
  border: none;
  background-color: #ccd6d6;
  color: #033;
  text-align: center;
  font-weight: 700;
  font-size: 11pt;
}
.inputs-container[_ngcontent-c1]
  div[_ngcontent-c1]:first-child
  a[_ngcontent-c1] {
  border: 0;
  position: absolute;
  right: 37px;
  background-color: #fff0b5;
  color: #dbaf00;
  top: 0;
  height: 46px;
  width: 102px;
  display: inline-block;
  line-height: 46px;
  border-top-right-radius: 25px;
  border-bottom-right-radius: 25px;
  background-image: url(play.26115e8f6a82e161cf24.png);
  background-position: right;
  background-repeat: no-repeat;
  text-align: left;
  font-weight: 700;
  font-size: 12pt;
  background-size: 46px 46px;
}
.footer[_ngcontent-c1] {
  color: #fff;
  padding: 120px 100px 0;
  display: flex;
}
.main[_ngcontent-c1] {
  text-align: center;
}
.aside-1[_ngcontent-c1] {
  margin-left: 18px;
  max-width: 350px;
  width: 350px;
  min-width: 350px;
  color: #fff;
  display: flex;
  text-align: left;
  flex-flow: column;
}
.aside-1[_ngcontent-c1] .social-info[_ngcontent-c1] {
  align-self: flex-start;
}
.social-info[_ngcontent-c1] div[_ngcontent-c1] img[_ngcontent-c1] {
  border-radius: 50%;
}
.fleft[_ngcontent-c1] {
  float: left;
  position: relative;
}
.fleft[_ngcontent-c1] img[_ngcontent-c1] {
  height: 62px;
}
.fleft-view[_ngcontent-c1] {
  position: absolute;
  right: -59px;
  bottom: 0;
  height: 20px;
  font-size: 8pt;
  background-image: url(show_profile.fcdd7169b41af7584d40.png);
  background-size: 15px 9px;
  background-repeat: no-repeat;
  line-height: 22px;
  background-position: left;
  padding-left: 20px;
  margin-left: 0;
  text-decoration: underline;
}
.username[_ngcontent-c1] {
  margin-left: 15px;
  line-height: 60px;
  height: 45px;
  font-size: 14pt;
  text-shadow: 0 0 8px var(--aurora-green);
}
.sign-in-with[_ngcontent-c1],
.sign-out[_ngcontent-c1] {
  align-self: flex-start;
}
.sign-in-with[_ngcontent-c1] div[_ngcontent-c1]:first-child,
.sign-out[_ngcontent-c1] a[_ngcontent-c1] {
  text-decoration: underline;
  line-height: 30px;
  font-size: 10pt;
}
.sign-in-with[_ngcontent-c1] a[_ngcontent-c1] {
  width: 30px;
  margin-left: 10px;
  height: 30px;
  display: inline-block;
}
.icon-button.facebook[_ngcontent-c1] {
  background-image: url(facebook_logo.0e645f3629399a142f16.png);
}
.icon-button.google-plus[_ngcontent-c1] {
  background-image: url(google_logo.18b5bfc7ff408c427dac.png);
}
.history-wrapper[_ngcontent-c1] {
  margin-top: 24px;
  height: 250px;
  position: relative;
  overflow: hidden;
}
.adsbanner2[_ngcontent-c1] ins[_ngcontent-c1],
.blobgame-io_300x250[_ngcontent-c1] {
  width: 300px;
  height: 250px;
}
.hidden-scroll[_ngcontent-c1] {
  z-index: 2;
  height: 100%;
  width: 120%;
  width: calc(100% + 30px);
  overflow-y: scroll;
  -webkit-mask-image: linear-gradient(
    to bottom,
    rgba(0, 0, 0, 1) 85%,
    rgba(0, 0, 0, 0.46) 94%,
    rgba(0, 0, 0, 0) 100%
  );
  mask-image: linear-gradient(
    to bottom,
    rgba(0, 0, 0, 1) 85%,
    rgba(0, 0, 0, 0.46) 94%,
    rgba(0, 0, 0, 0) 100%
  );
}
.history[_ngcontent-c1] div[_ngcontent-c1] {
  font-size: 10pt;
}
.aside-2[_ngcontent-c1] {
  max-width: 350px;
  width: 350px;
  min-width: 350px;
  display: flex;
  padding-top: 60px;
  justify-content: flex-end;
  text-align: left;
  color: #fff;
}
.aside-2[_ngcontent-c1] div[_ngcontent-c1] {
  margin-top: 15px;
}
.aside-2[_ngcontent-c1] iframe[_ngcontent-c1] {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}
.aside-2[_ngcontent-c1] a[_ngcontent-c1] {
  display: inline-block;
  height: 25px;
  width: 105px;
}
.aside-2[_ngcontent-c1] div[_ngcontent-c1]:first-child {
  margin-top: 0;
  margin-right: 39px;
}
.social[_ngcontent-c1] {
  text-align: end;
  display: grid;
  height: 90%;
  margin-right: 8px;
}
.markets[_ngcontent-c1] {
  text-align: center;
  margin-top: 20px;
}
.footer[_ngcontent-c1] div[_ngcontent-c1] div[_ngcontent-c1]:last-child {
  text-align: center;
}
.cookieWarning.is-active[_ngcontent-c1] {
  display: flex;
  -webkit-animation: 0.3s ease-in-out OrigamiFoldBottom;
  animation: 0.3s ease-in-out OrigamiFoldBottom;
}
.cookieWarning-learnMore[_ngcontent-c1],
.cookieWarning-learnMore[_ngcontent-c1]:visited {
  color: #fff;
  border-bottom: 1px solid #fff;
}
.cookieWarning[_ngcontent-c1] {
  display: none;
  justify-content: space-between;
  align-items: center;
  z-index: 10000;
  position: fixed;
  box-shadow: 0 6px 20px 0 rgba(0, 0, 0, 0.5), 0 8px 17px 0 rgba(0, 0, 0, 0.5);
  border-radius: 2px;
  left: 50%;
  margin-left: -200px;
  bottom: 1rem;
  background: #033;
  color: #fff;
  padding: 10px;
  font-weight: 600;
  width: 370px;
  max-width: 100%;
}
.youtube-placeholder[_ngcontent-c1] {
  width: 300px;
  height: 250px;
  position: relative;
  overflow: hidden;
  background-size: cover;
  -moz-background-size: cover;
  -webkit-background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
}
.youtube-placeholder[_ngcontent-c1]
  button[_ngcontent-c1]:hover
  .ytp-large-play-button-bg[_ngcontent-c1] {
  fill: red !important;
}
.youtube-placeholder[_ngcontent-c1] button[_ngcontent-c1] {
  border: none;
  background-color: transparent;
  padding: 0;
  color: inherit;
  font-size: 100%;
  cursor: pointer;
  position: absolute;
  outline: 0;
  left: 50%;
  top: 50%;
  width: 68px;
  height: 48px;
  margin-left: -34px;
  margin-top: -24px;
  transition: opacity 0.25s cubic-bezier(0, 0, 0.2, 1);
}
button.is-link[_ngcontent-c1] {
  padding: 0;
  outline: 0;
  border: none;
  border-radius: 0;
  background: 0 0;
  font-size: 1rem;
  color: #e4a800;
  font-weight: 600;
  text-align: left;
  box-shadow: none;
  cursor: pointer;
}
.modal-bg[_ngcontent-c1] {
  background-color: #000000bb;
  width: 100%;
  height: 100%;
  position: absolute;
  display: block;
  z-index: 9;
}
@media (max-width: 809px) {
  .aside[_ngcontent-c1] {
    flex: 1 1;
  }
  .hide-on-small-screen[_ngcontent-c1] {
    display: none;
  }
  .aside-2[_ngcontent-c1] {
    min-width: unset;
    max-width: unset;
  }
  #modal[_ngcontent-c1] {
    width: 85%;
    height: 85%;
    left: 7%;
    top: 7%;
  }
}
@media (min-width: 810px) and (max-width: 1199px) {
  .main[_ngcontent-c1] {
    flex: 1 100%;
    order: 1;
  }
  .aside-1[_ngcontent-c1] {
    order: 2;
    flex: 1 100%;
    margin: 0 auto;
  }
  .aside-2[_ngcontent-c1] {
    order: 3;
    flex: 1 100%;
    margin: 0 auto;
  }
  .footer[_ngcontent-c1] {
    order: 4;
  }
}
@media (min-width: 1200px) {
  .aside-1[_ngcontent-c1] {
    order: 1;
  }
  .main[_ngcontent-c1] {
    flex: 5 0px;
    order: 2;
  }
  .aside-2[_ngcontent-c1] {
    order: 3;
  }
  .footer[_ngcontent-c1] {
    order: 4;
  }
  .header[_ngcontent-c1] {
    padding-top: 8px;
  }
}
@media (max-height: 800px) {
  #modal[_ngcontent-c1] {
    position: absolute;
    border-radius: 10px;
  }
  #close-modal[_ngcontent-c1] {
    top: 10px;
    right: 10px;
    font-size: 16pt;
  }
  .main-container[_ngcontent-c1] {
    width: 300px;
    height: 135px;
  }
  .inputs-container[_ngcontent-c1] {
    top: 14px;
  }
  #custom-host-input[_ngcontent-c1] {
    width: 170px;
    height: 25px;
    font-size: 9pt;
  }
  .inputs-container[_ngcontent-c1] div[_ngcontent-c1]:last-child {
    position: absolute;
    top: 65px;
    left: 4px;
  }
  .buttons-splitter[_ngcontent-c1] {
    width: 14px;
  }
  .inputs-container[_ngcontent-c1]
    div[_ngcontent-c1]:last-child
    button[_ngcontent-c1] {
    height: 36px;
    width: 139px;
    font-size: 9pt;
    background-size: 36px 36px;
  }
  .skin-img[_ngcontent-c1] {
    width: 36px;
    height: 36px;
  }
  .inputs-container[_ngcontent-c1]
    div[_ngcontent-c1]:first-child
    input[_ngcontent-c1] {
    left: 28px;
    width: 139px;
    height: 35px;
    padding-left: 15px;
    font-size: 11pt;
  }
  .inputs-container[_ngcontent-c1]
    div[_ngcontent-c1]:first-child
    a[_ngcontent-c1] {
    right: 27px;
    height: 37px;
    width: 90px;
    line-height: 37px;
    font-size: 10pt;
    background-size: 37px 37px;
  }
  #refresh-ip[_ngcontent-c1] {
    width: 19px;
    height: 18px;
  }
  .history[_ngcontent-c1] {
    font-size: 10pt;
  }
  #ip-container[_ngcontent-c1] {
    font-size: 9pt;
  }
  .progress-bar[_ngcontent-c1] {
    line-height: 30px;
    border-radius: 16px;
    font-size: 9pt;
    width: 177px;
    height: 30px;
    margin-left: 15px;
  }
  .header[_ngcontent-c1]
    .left[_ngcontent-c1]
    > div[_ngcontent-c1]:nth-child(1) {
    width: 130px;
    background: url(money_ic.116fbe8ae9889bf7dae1.png) 6px 4px/45px 21px
      no-repeat #ffffffeb;
  }
  .aside[_ngcontent-c1] {
    padding-left: 60px;
  }
  .fleft[_ngcontent-c1] img[_ngcontent-c1] {
    height: 48px;
  }
  .header[_ngcontent-c1] {
    padding-left: 60px;
    padding-right: 60px;
  }
  .footer[_ngcontent-c1] {
    padding-left: 78px;
    padding-right: 78px;
    padding-top: 20px;
  }
  .aside-2[_ngcontent-c1] div[_ngcontent-c1]:first-child {
    margin-top: 0;
    margin-right: 20px;
  }
  .markets[_ngcontent-c1] {
    margin-top: 40px !important;
  }
  .main-logo[_ngcontent-c1] {
    height: 150px;
    padding-bottom: 20px;
  }
  .aside-2[_ngcontent-c1] {
    font-size: 11pt;
  }
  .adsbanner2[_ngcontent-c1] ins[_ngcontent-c1],
  .blobgame-io_300x250[_ngcontent-c1],
  .youtube-placeholder[_ngcontent-c1] {
    width: 221px;
    height: 121px;
  }
  .username[_ngcontent-c1] {
    line-height: 50px;
    font-size: 12pt;
  }
  .partner[_ngcontent-c1] a.mus-conv[_ngcontent-c1],
  .partner[_ngcontent-c1] a.teespring[_ngcontent-c1] {
    width: 62px;
    height: 62px;
  }
  .aside-2[_ngcontent-c1] a.amazon[_ngcontent-c1],
  .aside-2[_ngcontent-c1] a.discord[_ngcontent-c1],
  .aside-2[_ngcontent-c1] a.fc[_ngcontent-c1],
  .aside-2[_ngcontent-c1] a.google[_ngcontent-c1],
  .aside-2[_ngcontent-c1] a.inst[_ngcontent-c1],
  .aside-2[_ngcontent-c1] a.itunes[_ngcontent-c1],
  .aside-2[_ngcontent-c1] a.vk[_ngcontent-c1],
  .aside-2[_ngcontent-c1] a.yt[_ngcontent-c1] {
    width: 32px;
    height: 32px;
  }
}

          `
      var video2bg = document.createElement('video');
//  video.src = chatBackgroundSrc;
video2bg.src = localStorage.getItem('homepagetheme');
video2bg.loop = true;
video2bg.muted = true;
video2bg.autoplay = true;
video2bg.style.position = 'fixed';
video2bg.style.top = '0';
video2bg.style.left = '0';
video2bg.style.width = '100%';
video2bg.style.height = '100%';
video2bg.style.objectFit = 'cover';
video2bg.style.zIndex = '-1';
video2bg.style.pointerEvents = 'none';
document.querySelector("body").appendChild(video2bg);
document.querySelector("body > app-root > app-main > div.wrapper > header > div.left > div:nth-child(1)").style.background = 'url("https://png.pngtree.com/png-clipart/20220928/original/pngtree-stack-of-gold-coins-png-image_8639267.png") 10px 6px/39px 25px no-repeat #ffffffeb';

document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(1) > img").src = localStorage.getItem('homepagelogo'); //'https://i.imgur.com/lL4iByR.png';
document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(2) > div > div > div:nth-child(1) > input[type=text]").style.borderRadius = '10px';
document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(2) > div > div > div:nth-child(1) > a").style.borderRadius = '10px';
document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(2) > div > div > div:nth-child(1) > input[type=text]").style.backgroundColor = '#520056';
document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(2) > div > div > div:nth-child(1) > a").style.backgroundColor = '#e369c3';
document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(2) > div > div > div:nth-child(1) > input[type=text]").style.color = '#e5e1e1';
document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(2) > div > div > div:nth-child(1) > a").style.color = '#e5e1e1';
//document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(2) > div > div > div:nth-child(1) > input[type=text]").style.borderRadius = '10px';
//document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(2) > div > div > div:nth-child(1) > a").style.borderRadius = '10px';
document.querySelector("body > app-root > app-main > div.wrapper > header > div.left > div:nth-child(2) > div.progress-bar-title").style.backgroundColor = '#520056';
document.querySelector("body > app-root > app-main > div.wrapper > header > div.left > div:nth-child(1)").style.backgroundColor = '#e369c3';
document.querySelector("body > app-root > app-main > div.wrapper > header > div.left > div:nth-child(2) > div.progress-bar-title").style.color = '#e5e1e1';
document.querySelector("body > app-root > app-main > div.wrapper > header > div.left > div:nth-child(1)").style.color = '#e5e1e1';
document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(2) > div > div > div:nth-child(1) > a").style.backgroundImage = "url('')"
document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(2) > div > img").src = '';
var glassbg = document.createElement("span");
glassbg.innerHTML = `
<div class="blurred-box" style="position:fixed; top: calc(50% - 140px); height: 200px;">

</div>
            `;
var inputstuff = document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(1)");
insertAfter2(inputstuff, glassbg);
var glassbg2 = document.createElement("span");
glassbg2.innerHTML = `
<div class="blurred-box" style="position:fixed; top: calc(50% - 540px); left: calc(50% - 925px); height: 165.3px; width: 1950px;">

</div>
            `;
var inputstuff2 = document.querySelector("body > app-root > app-main > div.wrapper > header > div.left");
insertAfter2(inputstuff2, glassbg2);
document.querySelector("body > app-root > app-main > div.wrapper > header > div.right").style.zIndex = '9999';
//HIDES ALL UGLY HOMEPAGE ELEMENTS!
document.querySelector("body > app-root > app-main > div.wrapper > footer > div.partner > p").style.display = 'none';
document.querySelector("body > app-root > app-main > div.wrapper > footer > div.partner > div > a:nth-child(1)").style.display = 'none';
document.querySelector("body > app-root > app-main > div.wrapper > footer > div.partner > div > a:nth-child(2)").style.display = 'none';
document.querySelector("body > app-root > app-main > div.wrapper > footer > div.partner > div > a:nth-child(1)").style.display = 'none';
document.querySelector("body > app-root > app-main > div.wrapper > aside.aside.aside-2 > div.social").style.display = 'none';
document.querySelector("body > app-root > app-main > div.wrapper > aside.aside.aside-2 > div:nth-child(1)").style.display = 'none';
//document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(3) > div > div > div:nth-child(2) > button:nth-child(1)").outerText = 'Shop';
// privacy policy ting
document.querySelector("body > app-root > app-main > div.wrapper > footer > div:nth-child(2) > a").remove();
document.querySelector("body > app-root > app-main > div.wrapper > footer > div:nth-child(2) > div:nth-child(2)").remove();
// able to change theme video bg
document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(3) > div > div > div:nth-child(2) > button:nth-child(3)").addEventListener('click', useless2);

function useless2() {
    document.querySelector("#modal > app-settings > div.body > div.left > ul > li:nth-child(3)").addEventListener('click', clickedThemestgs);
    document.querySelector("#modal > app-settings > div.body > div.right > div > div > div").style.color = 'black';
    var newCheckbox = document.createElement("span");
    newCheckbox.innerHTML = '<div _ngcontent-c3="" class="grid-item"><label _ngcontent-c3="" class="switch"><input _ngcontent-c3="" type="checkbox" id="switch-hide-online-status" class="ng-untouched ng-pristine ng-valid"><span _ngcontent-c3="" class="slider"></span></label><label _ngcontent-c3="">Hide online status</label></div>';
    var jellyp = document.querySelector("#modal > app-settings > div.body > div.right > div > div > div > div:nth-child(10)");
    insertAfter(jellyp, newCheckbox);
    var newCheckbox2 = document.createElement("span");
    newCheckbox2.innerHTML = '<div _ngcontent-c3="" class="grid-item"><label _ngcontent-c3="" class="switch"><input _ngcontent-c3="" type="checkbox" id="switch-test-account" class="ng-untouched ng-pristine ng-valid"><span _ngcontent-c3="" class="slider"></span></label><label _ngcontent-c3="">Test account</label></div>';
    var jellyp2 = document.querySelector("#modal > app-settings > div.body > div.right > div > div > div > div:nth-child(10)");
    insertAfter(jellyp2, newCheckbox2);
    //document.getElementById('');

    if (localStorage.getItem('testAccChkbx') == 'checked') {
        document.querySelector("#switch-test-account").checked = true;
    } else if (localStorage.getItem('testAccChkbx') == 'unchecked') {
        document.querySelector("#switch-test-account").checked = false;
    }
    //checkbox CLICK
    document.querySelector("#switch-test-account").addEventListener('click', function () {
        if (localStorage.getItem('testAccChkbx') == 'unchecked') {
            localStorage.setItem('testAccChkbx', 'checked');
            //localStorage.setItem('invisStatus', 'no');
            setTimeout(function () {
                butterup.toast({
                    title: 'Sigma-client',
                    message: "Enabled, good for testing. Just don't forget that this stays on! Turn off in settings :)",
                    type: 'success',
                    //icon: true,
                    //customIcon: birdieSVG,
                });
            }, 1000);
            setTimeout(function () {
                location.href = 'https://test.blobgame.io';
            }, 3000);
        } else {

            localStorage.setItem('testAccChkbx', 'unchecked');
            //localStorage.setItem('invisStatus', 'yes');
            setTimeout(function () {
                butterup.toast({
                    title: 'Sigma-client',
                    message: "Disabled!",
                    type: 'success',
                    //icon: true,
                    //customIcon: birdieSVG,
                });
            }, 1000);
            setTimeout(function () {
                location.href = 'https://blobgame.io'
            }, 3000);
        }
    });

    if (localStorage.getItem('invisChkbx') == 'checked') {
        document.querySelector("#switch-hide-online-status").checked = true;
    } else if (localStorage.getItem('invisChkbx') == 'unchecked') {
        document.querySelector("#switch-hide-online-status").checked = false;
    }
    //checkbox CLICK
    document.querySelector("#switch-hide-online-status").addEventListener('click', function () {
        if (localStorage.getItem('invisChkbx') == 'checked') {
            localStorage.setItem('invisChkbx', 'unchecked');
            localStorage.setItem('invisStatus', 'no');
            setTimeout(function () {
                butterup.toast({
                    title: 'Sigma-client',
                    message: 'You online status is no longer hidden from your friends.',
                    type: 'success',
                    //icon: true,
                    //customIcon: birdieSVG,
                });
            }, 1000);
            setTimeout(function () {
                location.href = 'http://custom.client.blobgame.io/updateHAHAHA-no';
            }, 3000);
        } else {
            localStorage.setItem('invisChkbx', 'checked');
            localStorage.setItem('invisStatus', 'yes');
            setTimeout(function () {
                butterup.toast({
                    title: 'Sigma-client',
                    message: "Your online status is now hidden to your friends.",
                    type: 'success',
                    //icon: true,
                    //customIcon: birdieSVG,
                });
            }, 1000);
            setTimeout(function () {
                location.href = 'http://custom.client.blobgame.io/updateHAHAHA-yes'
            }, 3000);
        }
    });
}
if (!localStorage.shopModalGif) {
    //okay for some reason it seems to be reverse polarity???? so this is TRUE DOESN'T EXIST and below EXISTS....
    console.log("doesnt exist");
    localStorage.setItem('shopModalGif', 'https://wunkolo.github.io/post/2020/02/buttery-smooth-10fps/images/shuppet.gif');

    //hello kitty gif
    //localStorage.setItem('shopModalGif', 'https://media1.giphy.com/media/10a8AOSeP6Rqfu/giphy.gif?cid=6c09b952yzdaoe5rzz19ibhhhus8wffufr9lk37b8lqa821r&ep=v1_stickers_search&rid=giphy.gif&ct=s');

} else {
    console.log("exists?");
}

function clickedThemestgs() {
    console.log("clicked theme");
    const changeThemebtn = document.createElement('button');
    changeThemebtn.id = 'change-theme-btn';
    changeThemebtn.innerText = 'Change homepage theme';
    changeThemebtn.style.position = 'static';
    changeThemebtn.style.display = 'flex';
    changeThemebtn.style.marginTop = '20px';
    document.querySelector("#modal > app-settings > div.body > div.right > div > div > div").appendChild(changeThemebtn);
    const themeSelect = document.createElement('select');
    themeSelect.id = 'theme-select';
    themeSelect.style.position = 'static';
    themeSelect.style.display = 'flex';
    themeSelect.style.marginTop = '0px';
    const themeOptions = ['classic (remastered)', 'cool cat', 'cute', 'cute2', 'cute3', 'rocket league', 'windmill', 'waterfalls', 'minecraft', 'vaporwave', 'homerun', 'harmony', 'bmw', 'porche', 'audi', 'aliya', 'baki', 'matrix', 'ninjago', 'maplestory', 'lost cat', 'neon city', 'snowy', 'ducati 1199', 'black hole', 'starry river'];
    themeOptions.forEach(char => {
        const option1 = document.createElement('option');
        option1.value = char;
        option1.innerText = char;
        themeSelect.appendChild(option1);
    });
    document.querySelector("#modal > app-settings > div.body > div.right > div > div > div").appendChild(themeSelect);
    document.getElementById('change-theme-btn').addEventListener('click', () => {
        const selectedTheme = document.getElementById('theme-select').value;
        if (selectedTheme == 'cute') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/1723/hello-kitty-with-strawberry-cocktail.960x540.mp4');
            localStorage.setItem('homepagelogo', 'https://i.imgur.com/aCh1ZE2.png');
            localStorage.setItem('shopModalGif', 'https://i.pinimg.com/originals/4d/ed/34/4ded3483aa11970395144db5091df695.gif');
            location.reload()
        } else if (selectedTheme == 'cute2') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/1722/pink-hello-kitty-on-cloud.960x540.mp4');
            localStorage.setItem('homepagelogo', 'https://i.imgur.com/aCh1ZE2.png');
            //localStorage.setItem('shopModalGif', 'https://i.gifer.com/Mc28.gif');
            //localStorage.setItem('shopModalGif', 'https://media.tenor.com/fhn-aoBot4cAAAAj/sk-creation.gif');
            localStorage.setItem('shopModalGif', 'https://wunkolo.github.io/post/2020/02/buttery-smooth-10fps/images/shuppet.gif');
            //localStorage.setItem('shopModalGif', 'https://i.pinimg.com/originals/bb/48/38/bb48389d8e433aaa20a80378de1841eb.gif');
            //localStorage.setItem('shopModalGif', 'https://cdn.dribbble.com/userupload/22923911/file/original-c4b7a397bd3cbcf6b1df583ee312fd5d.gif');
            location.reload()
        } else if (selectedTheme == 'cute3') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/1730/sweet-and-spooky-kuromi.960x540.mp4');
            localStorage.setItem('homepagelogo', 'https://i.imgur.com/aCh1ZE2.png');
            localStorage.setItem('shopModalGif', 'https://i.pinimg.com/originals/7a/38/87/7a3887455453dae78a529effdf52dea3.gif');
            location.reload()
        } else if (selectedTheme == 'classic (remastered)') {
            localStorage.setItem("homepagetheme", 'https://cdn-cf-east.streamable.com/video/mp4/bvlu4c.mp4?Expires=1739302535553&Key-Pair-Id=APKAIEYUVEN4EVB2OKEQ&Signature=VRFDQ2KMtZ~2znfZYdRfCnasthUpXv2xDWlPPVPhhe7LAsuxD7yWDAwBuwOUKbSkKjTw465fQTSOxsvOSuGOYujs5bmdcnSy6NOBUOWG4LhC~DYAyBxWC4BSPMdZ9ko9frOhNLoQTbXsTD8TgOLd0QZ3a0gkG50cjk9iU8qknqCK6VbCtXQbJ6R~dxuUCcPI8vCalv9kJF2Pi5R2bI1rYOdtcyW5cIk4Na2zA2ytJ1gjSSrL-j4h7TL8FoUdJlz2waZu-rJeEUE325IM82zBig7~CcaH-r9Xm7Wl7QtolhVGAA6N1Vcot-6TwQ1COerFDd4sq8t1ds7ZdPzEF26UXw__');
            localStorage.setItem('homepagelogo', 'assets/images/logo.png');
            localStorage.setItem('shopModalGif', 'https://i.gifer.com/origin/2d/2dabb694e9bfccef713863a4a6543c79_w200.gif');
            location.reload()
        } else if (selectedTheme == 'cool cat') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/2953/jazzy-cat.960x540.mp4');
            localStorage.setItem('homepagelogo', 'https://i.imgur.com/lL4iByR.png');
            localStorage.setItem('shopModalGif', 'https://media1.giphy.com/media/10a8AOSeP6Rqfu/giphy.gif?cid=6c09b952yzdaoe5rzz19ibhhhus8wffufr9lk37b8lqa821r&ep=v1_stickers_search&rid=giphy.gif&ct=s');
            location.reload()
        } else if (selectedTheme == 'rocket league') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/622/rocket-league.960x540.mp4');
            localStorage.setItem('homepagelogo', 'https://i.imgur.com/T8vviTn.png');
            localStorage.setItem('shopModalGif', 'https://wunkolo.github.io/post/2020/02/buttery-smooth-10fps/images/shuppet.gif');
            location.reload()
        } else if (selectedTheme == 'windmill') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/6980/windmill-in-flower-field.960x540.mp4');
            localStorage.setItem('homepagelogo', 'https://i.imgur.com/Pesd3vU.png');
            location.reload()
        } else if (selectedTheme == 'waterfalls') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/6976/blue-forest-waterfalls.960x540.mp4');
            localStorage.setItem('homepagelogo', 'https://i.imgur.com/NVWx0Px.png');
            location.reload()
        } else if (selectedTheme == 'minecraft') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/1964/nature-in-minecraft.960x540.mp4');
            localStorage.setItem('homepagelogo', 'https://i.imgur.com/zaILx2w.png');
            localStorage.setItem('shopModalGif', 'https://preview.redd.it/pwpks2a80bj31.gif?width=800&auto=webp&s=48bfc3ad55d7d05c07ff193152deac92c9bb090e');
            location.reload()
        } else if (selectedTheme == 'vaporwave') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/1033/the-drive-on-the-road-at-sunset.960x540.mp4');
            localStorage.setItem('homepagelogo', 'https://i.imgur.com/7RL8EYV.png');
            location.reload()
        } else if (selectedTheme == 'homerun') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/7374/homerun.960x540.mp4');
            localStorage.setItem('homepagelogo', 'https://i.imgur.com/PYJ4UQD.png');
            location.reload()
        } else if (selectedTheme == 'harmony') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/7235/harmony-in-the-wild.960x540.mp4');
            localStorage.setItem('homepagelogo', 'https://i.imgur.com/HBvMgy9.png');
            location.reload()
        } else if (selectedTheme == 'bmw') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/7210/blue-bmw-m3-g80.960x540.mp4');
            location.reload()
        } else if (selectedTheme == 'porche') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/7150/purple-porsche-in-tokyo.960x540.mp4');
            location.reload()
        } else if (selectedTheme == 'audi') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/7180/yellow-audi-r8-on-road.960x540.mp4');
            location.reload()
        } else if (selectedTheme == 'aliya') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/6801/aliya.960x540.mp4');
            location.reload()
        } else if (selectedTheme == 'baki') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/6802/baki.960x540.mp4');
            location.reload()
        } else if (selectedTheme == 'matrix') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/5605/matrix-raining-particles.960x540.mp4');
            location.reload()
        } else if (selectedTheme == 'ninjago') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/6787/monastery-of-spinjitzu-ninjago.960x540.mp4');
            location.reload()
        } else if (selectedTheme == 'maplestory') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/7127/maplestory-sea-cliff.960x540.mp4');
            location.reload()
        } else if (selectedTheme == 'lost cat') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/6960/lost-cat.960x540.mp4');
            localStorage.setItem('homepagelogo', 'https://i.imgur.com/1Du4r6A.png');
            location.reload()
        } else if (selectedTheme == 'neon city') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/6709/above-the-neon-city.960x540.mp4');
            location.reload()

        } else if (selectedTheme == 'snowy') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/7459/the-wintry-trail.960x540.mp4');
            location.reload()

        } else if (selectedTheme == 'ducati 1199') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/7052/ducati-1199-panigale.960x540.mp4');
            location.reload()

        } else if (selectedTheme == 'black hole') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/7003/black-hole2.960x540.mp4');
            location.reload()
        } else if (selectedTheme == 'starry river') {
            localStorage.setItem("homepagetheme", 'https://motionbgs.com/media/6968/hatsune-miku-night.960x540.mp4');
            location.reload()
        }
    });
    /*    var freecoins = document.createElement("span");
         freecoins.innerHTML = '<li _ngcontent-c2="" class="">Free coins</li>';
         var div3 = document.querySelector("#modal > app-skins > div.body > div.left > ul > li.show");
         insertAfter2(div3, freecoins);*/
    document.querySelector("#modal > app-settings > div.body > div.right > div > div > div")
}
//document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(2) > div > div > div:nth-child(1) > input[type=text]").remove();
/*var newinput = document.createElement("span");
                        newinput.innerHTML = `
<div class="input__container" style="z-index: 99999; bottom: 30px">
  <label class="input__label">Username</label>
  <input _ngcontent-c1 placeholder="Enter your username" class="input" name="text" type="text">
  <p class="input__description">What do you want to call yourself?</p>
</div>
            `;
                        var inputstuff = document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(2) > div > div > div:nth-child(1) > a");
                        insertAfter2(inputstuff, newinput);*/
/*document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(2) > div > div > div:nth-child(1)").innerHTML = `
      <div _ngcontent-c1=""><div class="input__container" style="z-index: 99999; bottom: 30px">
        <label class="input__label">Username</label>

        <p class="input__description">What do you want to call yourself?</p>
      <input placeholder="Name" type="text" style="border-radius: 10px; background-color: rgb(82, 0, 86); color: rgb(229, 225, 225);"></div><a _ngcontent-c1="" href="javascript:void(0);" style="border-radius: 10px; background-color: rgb(227, 105, 195); color: rgb(229, 225, 225); background-image: url(&quot;&quot;);">&nbsp;&nbsp;Play</a></div>
      `*/
//sigmaserver update notes
document.querySelector("body > app-root > app-main > div.wrapper > aside.aside.aside-1.hide-on-small-screen > div:nth-child(4)").innerHTML = `
<div id="sigmaserver" class="card">
  <div class="">
    <div class="terminal">
      <hgroup class="head">
        <p class="title">
          <svg
            width="16px"
            height="16px"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            stroke-linejoin="round"
            stroke-linecap="round"
            stroke-width="2"
            stroke="currentColor"
            fill="none"
          >
            <path
              d="M7 15L10 12L7 9M13 15H17M7.8 21H16.2C17.8802 21 18.7202 21 19.362 20.673C19.9265 20.3854 20.3854 19.9265 20.673 19.362C21 18.7202 21 17.8802 21 16.2V7.8C21 6.11984 21 5.27976 20.673 4.63803C20.3854 4.07354 19.9265 3.6146 19.362 3.32698C18.7202 3 17.8802 3 16.2 3H7.8C6.11984 3 5.27976 3 4.63803 3.32698C4.07354 3.6146 3.6146 4.07354 3.32698 4.63803C3 5.27976 3 6.11984 3 7.8V16.2C3 17.8802 3 18.7202 3.32698 19.362C3.6146 19.9265 4.07354 20.3854 4.63803 20.673C5.27976 21 6.11984 21 7.8 21Z"
            ></path>
          </svg>
          Terminal
        </p>

        <button class="copy_toggle" tabindex="-1" type="button">
          <svg
            width="16px"
            height="16px"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            stroke-linejoin="round"
            stroke-linecap="round"
            stroke-width="2"
            stroke="currentColor"
            fill="none"
          >
            <path
              d="M9 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-12a2 2 0 0 0 -2 -2h-2"
            ></path>
            <path
              d="M9 3m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v0a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z"
            ></path>
          </svg>
        </button>
      </hgroup>

      <div class="body">

        <pre class="pre">          <code>-&nbsp;</code>
          <code>sigmaserver&nbsp;</code>
          <code class="cmd" data-cmd="New skins available!">
          </code>
        </pre>
        <pre class="pre">          <code>-&nbsp;</code>
          <code>sigmaserver&nbsp;</code>
You can change your des          </code>
ired theme in settings
        </pre>
      </div>
    </div>
  </div>
</div>

            `
      document.getElementById('sigmaserver').style.scale = '0.57';
document.getElementById('sigmaserver').style.right = '100px';
document.getElementById('sigmaserver').style.position = 'relative';
gamemodeselector.innerHTML += `
<option _ngcontent-c1="" class="tool" data-tip="CRAZY without reds ðŸ¥°." value="CRAZY2">CRAZY 2</option>
        `
      if (document.querySelector("#game-mode").value == "CRAZY2") {
          console.log("crazy 2 selected")
      }
if (gamemode == 'CRAZY2') {
    //location.href = 'http://custom.client.blobgame.io/?ip=https://535c659f-d963-4e27-9f68-d2d1bb834660-00-1dw8euum59088.kirk.replit.dev:3000';
}
//authenticate button on homepage
/*
        document.querySelector("body > app-root > app-main > div.wrapper > header > div.left").innerHTML += `
<button id="authenticatePage" type="button" class="btn" style=" rotate(180deg);">
  <strong id="starbtntext">Authenticate</strong>
  <div id="container-stars">
    <div id="stars"></div>
  </div>

  <div id="glow">
    <div class="circle"></div>
    <div class="circle"></div>
  </div>
</button>

`
*/
//new friends delete
//const friendmodal = document.querySelector("#profile-modal > app-profile > div.profile-records > div:nth-child(1) > div.profile-records-title-userid");
function insertAfter(referenceNode, newNode) {
    referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);
}
// online/offline status
var onlinstat = document.createElement("span");
onlinstat.innerHTML = `
<label style="display:flex; left:117px; top: 220px; position: fixed; font-size: 0.7em; opacity: 0.55; color: #999;text-shadow: 4px 5px 21px rgba(0,0,0,1);" id="onlstatusLABEL"></label>
<div id="center-div" style="margin-left: 53px; margin-bottom: 3px; scale: 0.8; opacity: 1.9;">
  <div class="bubble">
    <span class="bubble-outer-dot">
    <span class="bubble-inner-dot"></span>
    </span>
  </div>
</div>

                        `;
var spp = document.querySelector("body > app-root > app-main > div.wrapper > aside.aside.aside-1.hide-on-small-screen > div.social-info > div:nth-child(1) > img");
insertAfter(spp, onlinstat);
if (!localStorage.invisStatus) {} else if (localStorage.getItem('invisStatus') == 'no') {
    //setTimeout(function () {
    document.querySelector("#onlstatusLABEL").innerText = '';
    document.querySelector("#onlinestatSTYLE").innerHTML = `

<style id="m73tl3ne.809">.bubble {
  display: block;
  position: absolute;
  cursor: pointer;
}

.bubble:hover:after {
  background-color: red
}

.bubble:after {
  content: "";
  background-color: green;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  position: absolute;
  display: block;
  top: 1px;
  left: 1px;
}

.bubble .bubble-outer-dot {
  margin: 1px;
  display: block;
  text-align: center;
  opacity: 1;
  background-color: rgba(0, 255, 0, 0.4);
  width: 12px;
  height: 12px;
  border-radius: 50%;
  -webkit-animation: bubble-pulse 1.5s linear infinite;
  -moz-animation: bubble-pulse 1.5s linear infinite;
  -o-animation: bubble-pulse 1.5s linear infinite;
  animation: bubble-pulse 1.5s linear infinite
}

.bubble .bubble-inner-dot {

  display: block;
  text-align: center;
  opacity: 1;
  background-color: rgba(0, 255, 0, 0.4);
  width: 12px;
  height: 12px;
  border-radius: 50%;
  -webkit-animation: bubble-pulse 1.5s linear infinite;
  -moz-animation: bubble-pulse 1.5s linear infinite;
  -o-animation: bubble-pulse 1.5s linear infinite;
  animation: bubble-pulse 1.5s linear infinite
}

.bubble .bubble-inner-dot:after {
  content: "";
  display: block;
  text-align: center;
  opacity: 1;
  background-color: rgba(0, 255, 0, 0.4);
  width: 12px;
  height: 12px;
  border-radius: 50%;
  -webkit-animation: bubble-pulse 1.5s linear infinite;
  -moz-animation: bubble-pulse 1.5s linear infinite;
  -o-animation: bubble-pulse 1.5s linear infinite;
  animation: bubble-pulse 1.5s linear infinite
}

@-webkit-keyframes bubble-pulse {
  0% {
    transform: scale(1);
    opacity: .75
  }
  25% {
    transform: scale(1);
    opacity: .75
  }
  100% {
    transform: scale(2.5);
    opacity: 0
  }
}

@keyframes bubble-pulse {
  0% {
    transform: scale(1);
    opacity: .75
  }
  25% {
    transform: scale(1);
    opacity: .75
  }
  100% {
    transform: scale(2.5);
    opacity: 0
  }
}

@-moz-keyframes bubble-pulse {
  0% {
    transform: scale(1);
    opacity: .75
  }
  25% {
    transform: scale(1);
    opacity: .75
  }
  100% {
    transform: scale(2.5);
    opacity: 0
  }
}

@-o-keyframes bubble-pulse {
  0% {
    transform: scale(1);
    opacity: .75
  }
  25% {
    transform: scale(1);
    opacity: .75
  }
  100% {
    transform: scale(2.5);
    opacity: 0
  }
}


/*Center-div (Not part of the symbol)*/

#center-div {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  margin: auto;
  width: 14px;
  height: 14px;
}
</style>

                `
         //}, 3000);
      } else if (localStorage.getItem('invisStatus') == 'yes') {
          //setTimeout(function () {
          document.querySelector("#onlstatusLABEL").innerText = 'You will not appear online, but will have full access.';
          document.querySelector("#onlinestatSTYLE").innerHTML = `

<style id="m73tl3ne.809">.bubble {
  display: block;
  position: absolute;
  cursor: pointer;
}

.bubble:hover:after {
  background-color: red
}

.bubble:after {
  content: "";
  background-color: red;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  position: absolute;
  display: block;
  top: 1px;
  left: 1px;
}

.bubble .bubble-outer-dot {
  margin: 1px;
  display: block;
  text-align: center;
  opacity: 1;
  background-color: rgba(255, 0, 0, 0.4);
  width: 12px;
  height: 12px;
  border-radius: 50%;
  -webkit-animation: bubble-pulse 1.5s linear infinite;
  -moz-animation: bubble-pulse 1.5s linear infinite;
  -o-animation: bubble-pulse 1.5s linear infinite;
  animation: bubble-pulse 1.5s linear infinite
}

.bubble .bubble-inner-dot {

  display: block;
  text-align: center;
  opacity: 1;
  background-color: rgba(255, 0, 0, 0.4);
  width: 12px;
  height: 12px;
  border-radius: 50%;
  -webkit-animation: bubble-pulse 1.5s linear infinite;
  -moz-animation: bubble-pulse 1.5s linear infinite;
  -o-animation: bubble-pulse 1.5s linear infinite;
  animation: bubble-pulse 1.5s linear infinite
}

.bubble .bubble-inner-dot:after {
  content: "";
  display: block;
  text-align: center;
  opacity: 1;
  background-color: rgba(255, 0, 0, 0.4);
  width: 12px;
  height: 12px;
  border-radius: 50%;
  -webkit-animation: bubble-pulse 1.5s linear infinite;
  -moz-animation: bubble-pulse 1.5s linear infinite;
  -o-animation: bubble-pulse 1.5s linear infinite;
  animation: bubble-pulse 1.5s linear infinite
}

@-webkit-keyframes bubble-pulse {
  0% {
    transform: scale(1);
    opacity: .75
  }
  25% {
    transform: scale(1);
    opacity: .75
  }
  100% {
    transform: scale(2.5);
    opacity: 0
  }
}

@keyframes bubble-pulse {
  0% {
    transform: scale(1);
    opacity: .75
  }
  25% {
    transform: scale(1);
    opacity: .75
  }
  100% {
    transform: scale(2.5);
    opacity: 0
  }
}

@-moz-keyframes bubble-pulse {
  0% {
    transform: scale(1);
    opacity: .75
  }
  25% {
    transform: scale(1);
    opacity: .75
  }
  100% {
    transform: scale(2.5);
    opacity: 0
  }
}

@-o-keyframes bubble-pulse {
  0% {
    transform: scale(1);
    opacity: .75
  }
  25% {
    transform: scale(1);
    opacity: .75
  }
  100% {
    transform: scale(2.5);
    opacity: 0
  }
}


/*Center-div (Not part of the symbol)*/

#center-div {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  margin: auto;
  width: 14px;
  height: 14px;
}
</style>

                `
         //}, 3000);
      }
var shineTextstyle = document.createElement('style');
shineTextstyle.innerHTML = `


       .shining {
  color: transparent;
  font-size: 35px;
  text-align: center;
  font-family: Roboto;
  font-weight: bold;
  background-clip: text;
  background-position: -100px;
  background-image: linear-gradient(90deg, rgba(0,0,0,1) 0%, rgba(255,0,0,1) 50%, rgba(0,0,0,1) 100%);
  animation: glowIn 5s ease infinite;
}

@keyframes glowIn {
  from {
     background-position: -1000px;
  }

  to {
     background-position: 1000px;
  }
}


       `
      document.body.appendChild(shineTextstyle);

//shop section
var token2 = localStorage.getItem('access-token')

function showShop() {
    document.querySelectorAll("#modal > app-skins > div.body > div.left > ul > li.hidden").forEach(item => item.classList.replace("hidden", "show"));
    document.querySelector("#modal > app-skins > div.body > div.left > ul > li.show").innerText = 'Buy';
    document.querySelector("#modal > app-skins > div.body > div.left > ul > li.show").addEventListener('click', newshopitems);
    setTimeout(function () {
        document.querySelector("#modal > app-skins > div.body > div.left > ul > li:nth-child(5)").addEventListener('click', ownedItemsAndSkins);
    }, 1000);
    //  document.querySelector("#modal > app-skins > div.body > div.left > ul > li:nth-child(5)").classList.add = 'yt';
    //document.querySelector("#modal > app-skins > div.body > div.left > ul > li:nth-child(5)").innerText = 'YouTube + Custom';
    //NEW STYLE COMPLETELY

    //replaces skin/shop css
    const jingleborder = "https://64.media.tumblr.com/da995c8c10c7b5f2d2529a6e3da91bb7/758bfa4270a6bcc9-b5/s400x600/9def14f0edc2e7ae9415654484789a277c66ba2b.gif"
    document.querySelector("head > style:nth-child(42)").innerHTML = `

.header[_ngcontent-c2]{background-color:#f9f9f9bd;width:100%;height:90px;display:flex}.header[_ngcontent-c2]   .label[_ngcontent-c2]{padding-top:25px;flex:1 0;font-size:20pt;padding-left:30px;color:#9c6;text-shadow:3px 0 0 #033,-3px 0 0 #033,0 3px 0 #033,0 -3px 0 #033,2px 2px #033,-2px -2px 0 #033,2px -2px 0 #033,-2px 2px 0 #033}.zero-top-left-border[_ngcontent-c2]{border-top-left-radius:0!important}.header[_ngcontent-c2]   .label[_ngcontent-c2]   img[_ngcontent-c2]{width:98px;order:1}.header[_ngcontent-c2]   .center[_ngcontent-c2]{flex:3 0}.header[_ngcontent-c2]   .search[_ngcontent-c2]{padding-top:5px;padding-right:98px;flex:1 0;background: url("${jingleborder}") 70px -5px / contain no-repeat rgb(41, 44, 61);background-color: rgb(32, 35, 50);}.header[_ngcontent-c2]   .search[_ngcontent-c2]   input[_ngcontent-c2]{border:none;background:url(search.63649f6147e6be15813b.png) left/contain no-repeat;font-weight:700;height:35px;color:#113131;width:200px;margin-top:20px;padding-left:45px;border-bottom:1px solid #113131}.body[_ngcontent-c2]{float:left;background:url(skin_bg.2094d9908bd872a635f8.png) 60px 0/contain no-repeat #175248;width:100%;height:calc(100% - 90px);display:flex}.body[_ngcontent-c2]   .left[_ngcontent-c2]{flex:1 1}.body[_ngcontent-c2]   .left[_ngcontent-c2]   ul[_ngcontent-c2]{padding-left:30px}.body[_ngcontent-c2]   .left[_ngcontent-c2]   li[_ngcontent-c2]{color:#999;font-weight:700;font-size:16px;margin-top:16px;padding:0;cursor:pointer;list-style:none;height:60px;line-height:60px;width:100%;text-align:center;border-top-left-radius:30px;border-bottom-left-radius:30px}.body[_ngcontent-c2]   .left[_ngcontent-c2]   li.active[_ngcontent-c2]{background-color:rgb(32 35 50 / 80%);color:#fff}.body[_ngcontent-c2]   .right[_ngcontent-c2]{flex:5 1}.body[_ngcontent-c2]   .right[_ngcontent-c2]   .inner-container[_ngcontent-c2]{width:calc(100% - 36px);height:calc(100% - 40px);margin-top:16px;margin-right:16px;margin-bottom:16px;padding-bottom:15px;padding-right:10px;padding-left:10px;background-color:#e5e5e5;border-radius:20px;backdrop-filter: blur(10px);}.body[_ngcontent-c2]   .right[_ngcontent-c2]   .skins-container[_ngcontent-c2]{width:100%;height:100%;display:flex;flex-wrap:wrap;justify-content:space-between;box-sizing:border-box;}.lvl-label[_ngcontent-c2]{position:absolute;width:100%!important;overflow-y:unset!important;left:0;top:0;height:25px!important;line-height:25px!important;border-top-left-radius:10px;border-top-right-radius:10px;color:#fff;text-shadow:1px 1px 3px #000;vertical-align:middle;background-color:#17524840;display:block;transition:-webkit-transform .3s;transition:transform .3s;transition:transform .3s,-webkit-transform .3s}.locked[_ngcontent-c2]{opacity:.5}.locked[_ngcontent-c2]:hover{-webkit-transform:scale(1)!important;transform:scale(1)!important}.locked[_ngcontent-c2]:hover   .lvl-label[_ngcontent-c2]{-webkit-transform:translateY(0)!important;transform:translateY(0)!important}.skin[_ngcontent-c2]:hover   .lvl-label[_ngcontent-c2]{-webkit-transform:translateY(-25px);transform:translateY(-25px)}.skin[_ngcontent-c2]:hover{-webkit-transform:scale(1.15);transform:scale(1.15)}.skin[_ngcontent-c2]{align-self:center;justify-self:center;background-color:#292c3d;border-radius:10px;padding:10px;margin:10px;text-align:center;cursor:pointer;position:relative;transition:-webkit-transform .3s;transition:transform .3s;transition:transform .3s,-webkit-transform .3s;overflow-y:hidden}.watch-youtube-channel[_ngcontent-c2]   span[_ngcontent-c2]{font-size:10pt;font-weight:400}.watch-youtube-channel[_ngcontent-c2]{display:inline-block;text-align:center;border:0;background-color:red;color:#fff;height:25px;margin-top:13px;width:80px;border-radius:25px;font-weight:700;font-size:9pt;line-height:24px;text-decoration:unset}.skin[_ngcontent-c2]   img[_ngcontent-c2]{height:140px;border-radius:70px;width:140px}.skin[_ngcontent-c2]   .title[_ngcontent-c2]{font-size:9pt;font-weight:700;color:#fff}@media all and (max-height:800px){.skin[_ngcontent-c2]   img[_ngcontent-c2]{height:100px;width:100px}.body[_ngcontent-c2]   .right[_ngcontent-c2]   .skins-container[_ngcontent-c2]{grid-template-columns:repeat(auto-fit,minmax(125px,1fr))}.header[_ngcontent-c2]{height:45px;background-color:#f9f9f9bd}.body[_ngcontent-c2]{width:100%;height:calc(100% - 45px);background:url(skin_bg.2094d9908bd872a635f8.png) 60px 0/contain no-repeat #175248}.body[_ngcontent-c2]   .left[_ngcontent-c2]   li[_ngcontent-c2]{height:40px;line-height:40px;border-top-left-radius:20px;border-bottom-left-radius:20px}.header[_ngcontent-c2]   .label[_ngcontent-c2]{padding-top:10px;padding-left:30px;font-size:14pt;color:#9c6;text-shadow:3px 0 0 #033,-3px 0 0 #033,0 3px 0 #033,0 -3px 0 #033,2px 2px #033,-2px -2px 0 #033,2px -2px 0 #033,-2px 2px 0 #033}.header[_ngcontent-c2]   .label[_ngcontent-c2]   img[_ngcontent-c2]{width:63px}.header[_ngcontent-c2]   .search[_ngcontent-c2]{padding-top:5px;padding-right:60px}.header[_ngcontent-c2]   .search[_ngcontent-c2]   input[_ngcontent-c2]{height:23px;width:180px;margin-top:5px;padding-left:36px;border-bottom-width:1px}}.scroll[_ngcontent-c2]::-webkit-scrollbar{width:12px}.scroll[_ngcontent-c2]::-webkit-scrollbar-thumb{background:#9c6;border-radius:7px;border:2px solid #f8f8f8;min-height:40px}.scroll[_ngcontent-c2]::-webkit-scrollbar-track{-webkit-box-shadow:inset 0 0 16px #f8f8f8;background:#f8f8f8;border-radius:7px}


`;

          document.querySelector("#modal").style.height = '61%';
          document.querySelector("#modal").style.borderRadius = '7px';
          document.querySelector("#modal > app-skins > div.header").style.backgroundColor = '#202332';
          //
          //FOLLOW UP WHENEVER YOU CAHNGE THE THEME IN SETTINGS THAT IMAGE/GIF CHANGES ALSO

          document.querySelector("#modal > app-skins > div.body").style.background = `url("${localStorage.getItem('shopModalGif')}") 60px 0/contain no-repeat #292c3d`;
          //
          //
          document.querySelector("#close-modal").style.color = 'rgb(163 173 255 / 40%)';
          document.querySelector("#modal > app-skins > div.body > div.right > div").style.width = 'calc(100% - 50px)';
          document.querySelector("#modal > app-skins > div.body > div.right > div").style.borderRadius = '10px';
          document.querySelector("#modal > app-skins > div.header > div.label > h3").innerText = 'Shop';
          document.querySelector("#modal > app-skins > div.header > div.label > h3").style.color = 'rgb(163 173 255)';
          document.querySelector("#modal > app-skins > div.body > div.right > div").style.backgroundColor = 'rgba(0,0,0,.25)';
          document.querySelector("#modal > app-skins > div.header > div.search > input").style.background = 'url(https://icon-library.com/images/white-search-icon-transparent-background/white-search-icon-transparent-background-1.jpg) left/contain no-repeat';
          document.querySelector("#modal > app-skins > div.header > div.search > input").style.scale = "0.85";
          $(document.querySelector("#modal > app-skins > div.body > div.left > ul > li.show")).html(`

<li _ngcontent-c2="" class="show"><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smooth Hover Rainbow Text with Neon Underline and Font Resize</title>
    <style>





/* ----------------------------------------------------------------------------------------------------------------------------------rainbow link yapÄ±cÄ± START */

.eren_link_green{
  	font-weight: bold;
    color: #999;
}

        .eren_rainbowLink {
            font-weight: bold;
            text-decoration: none;
            transition: color 0.5s ease, font-size 0.5s ease; /* YumuÅŸak geÃ§iÅŸ */
            position: relative;
            /*color: #0074d9;*/ /* Ä°lk renk olarak mavi tonu */
            font-size: 15px; /* Normal font boyutu */
        }

        /* Hover durumunda gÃ¶kkuÅŸaÄŸÄ± renk animasyonunu uygular, neon Ã§izgi ekler ve font boyutunu artÄ±rÄ±r */
        .eren_rainbowLink:hover {
            animation: colorChange 8s infinite; /* Animasyon sÃ¼resi ve tekrar */
            font-size: 19px; /* Hover sÄ±rasÄ±nda font boyutu */
        }

        /* Neon Ä±ÅŸÄ±k efekti, underline gibi gÃ¶rÃ¼necek ÅŸekilde ayarlandÄ± */
        .eren_rainbowLink::after {
            content: '';
            position: absolute;
            left: 0;
            right: 0;
            bottom: -5px; /* YazÄ±nÄ±n altÄ±na yerleÅŸtirmek iÃ§in */
            height: 2px;
            background-color: #1ddde8; /* Neon aÃ§Ä±k mavi rengi */
            box-shadow: 0 0 5px #1ddde8, 0 0 10px #1ddde8; /* Daha az yayÄ±lma etkisi */
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }

        /* Hover durumunda underline neon efekti gÃ¶rÃ¼nÃ¼r hale gelir */
        .eren_rainbowLink:hover::after {
            opacity: 0.7;
        }

        /* GÃ¶kkuÅŸaÄŸÄ± renk geÃ§iÅŸi animasyonu */
@keyframes colorChange {
    0% { color: #2ecc40; }       /* Parlak YeÅŸil */
	  22% { color: #0074d9; }      /* Koyu Mavi */
    48% { color: green; }      /* turuncu */
    64% { color: #167a72; }      /* Teal / Koyu Turkuaz */
    84% { color: #b10dc9; }      /* Mor */
    100% { color: #2ecc40; }     /* Parlak KÄ±rmÄ±zÄ± */
}



/* ----------------------------------------------------------------------------------------------------------------------------------rainbow link yapÄ±cÄ± FINISH */
    </style>
</head>
<body>
    <a class="eren_rainbowLink eren_link_green">â˜â™¡â­’Buyâ­’â™¡â˜</a>
</body>
</html>
</li>

`);

          // trying to remove "watch" buttons for custom skins
          document.querySelector("#modal > app-skins > div.body > div.left > ul > li:nth-child(5)").addEventListener('click', function () {

              const allSkinsparent = document.querySelector("#modal > app-skins > div.body > div.right > div > div")
              const allSkinss = allSkinsparent.querySelectorAll('div');
              allSkinss.forEach(allskins => {
                  setTimeout(function () {
                      var skinsNames = allskins.textContent;
                      if (skinsNames == '1Kherson' || '1Ukraine' || '1Ukraine_' || '1nowar' || 'Alcatel' || 'AnK' || 'ApeXx' || 'Blobio_Official' || 'BricK' || 'Broken Gamer' || 'ByBrasH' || 'CF YT' || 'Dxnte' || 'Dxsy AkiraYT' || 'Fedai' || 'Glue' || 'Jonnn' || 'Kroosty' || 'Krunch' || 'LilithYT' || 'Maga' || 'Marl' || 'Mr!Hero' || 'Mucki' || 'Oppai' || 'Renk' || 'Royal' || 'Shazy' || 'Sidox' || 'Soulz' || 'TRYHARD KEBAP' || 'TSM World' || 'Tunc' || 'Unique' || 'Viper.io' || 'Zaki' || 'bsam' || 'val' || 'vrs' || 'sigmaclient') {

                      } else {

                          allskins.children[3].remove();

                      }
                  }, 2000);
                  // setTimeout(function () {
                  //   console.log(allskins.textContent);
                  // }, 2000);
              });
          });
          var freecoins = document.createElement("span");
          freecoins.innerHTML = '<li _ngcontent-c2="" id="communityPage" class="">Community</li>';
          var div3 = document.querySelector("#modal > app-skins > div.body > div.left > ul > li.show");
          insertAfter(div3, freecoins);
          var hatsbuy = document.createElement("span");
          hatsbuy.innerHTML = '<li _ngcontent-c2="" class="">Auth Page</li>';
          var div3112 = document.querySelector("#modal > app-skins > div.body > div.left > ul > li.show");
          insertAfter(div3112, hatsbuy);
          //document.querySelector("#modal > app-skins > div.body > div.left > ul > span > li").addEventListener('click', freecoinsrequest);
          /*var drawSkin = document.createElement("span");
         drawSkin.innerHTML = '<li _ngcontent-c2="" class="">Custom skin editor</li>';
         var div7 = document.querySelector("#modal > app-skins > div.body > div.left > ul > li:nth-child(5)");
         insertAfter(div7, drawSkin);
         document.querySelector("#modal > app-skins > div.body > div.left > ul > span:nth-child(6) > li").addEventListener('click', drawCustomSkin);*/

          var customSkinsection = document.createElement("span");
          customSkinsection.innerHTML = '<li _ngcontent-c2="" class="">Coupons</li>';
          var div73 = document.querySelector("#modal > app-skins > div.body > div.left > ul > li:nth-child(5)");
          insertAfter(div73, customSkinsection);
          document.querySelector("#modal > app-skins > div.body > div.left > ul > span:nth-child(6) > li").addEventListener('click', showCustomSkins);

          function showCustomSkins() {

              //CURRENT METHOD MABYE NOT IDEAL... BASICALLY HIDES INITIAL SKIN TAB OPENED AND MAKES NEW ONE

              //hides any other skin tabs
              //document.querySelector("#modal > app-skins > div.body > div.right > div > div").style.display = 'none';

              /*               var url = "https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/customskinsad"

var ajax = new XMLHttpRequest();
ajax.open("GET", url, true);
ajax.send(null);
ajax.onreadystatechange = function () {

     if (ajax.readyState == 4 && (ajax.status == 200)) {

        console.log("ready")
        var Data = JSON.parse(ajax.responseText);
        //console.log(Data);
        console.log(Data.result);

    } else {
        console.log("not ready yet")
    }
}
*/

              $.ajax({
                  type: "GET",
                  url: "https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/customskinsad",
                  /*data: {
                   "status": "1",
                   "api_ver": "4.7",
                   "pl": "3",
                   "token": blobioToken
               },*/
                  success: function (data2) {
                      //console.log(data);
                      $.each(data2.result, function () {
                          const skinIdd = [
                              this.id
                          ];
                          const skinNamee = [
                              this.name
                          ];
                          const skinImgURLl = [
                              this.image_url
                          ];
                          console.log(skinIdd);
                          console.log(skinNamee);
                          console.log(skinImgURLl);

                      });
                  }
              });
              $(document.querySelector("#modal > app-skins > div.body > div.right > div")).append(`



`);

         }

          function drawCustomSkin() {
              $(document.querySelector("body > app-root > app-main > div.modal-bg.main-modal-bg")).append(`

<div _ngcontent-c1="" id="customSkinModal" style="height: 61%; border-radius: 7px;">
      <a _ngcontent-c1="" id="close-modal" style="color: rgba(163, 173, 255, 0.4);">â¨¯</a><!---->
      <app-skins _ngcontent-c1="" _nghost-c2="">
         <div _ngcontent-c2="" class="header" style="background-color: rgb(32, 35, 50);">
            <div _ngcontent-c2="" class="label">
            <a _ngcontent-c1="" id="goBackToBuy" style="display:flex;color: rgba(163, 173, 255, 0.4);right:750px;font-size:0.7em;">&lt;-</a>
               <h3 _ngcontent-c2="" style="margin-top: 0px; color: rgb(163, 173, 255);">Cook!</h3>
            </div>
            <div _ngcontent-c2="" class="center"></div>
            <div _ngcontent-c2="" class="search"></div>
         </div>
         <div _ngcontent-c2="" class="body" style="background: url(&quot;&quot;) 60px 0px / contain no-repeat rgb(41, 44, 61);">
            <div _ngcontent-c2="" class="right">
               <div _ngcontent-c2="" class="skins-container scroll">
                  <!---->

   <button class="btn-12" style="margin: 30px;scale:0.77;padding:0;border-radius:0;" id="clickSkinFromURL"><span>from url</span></button>
         <a>To begin, pick what type of skin you would like.</a>
               <button class="btn-12" style="margin: 30px;scale:0.77;padding:0;border-radius:0;" id="clickSkinFromDesign"><span>design new</span></button></div>
            </div>
         </div>
      </app-skins>
      <!----><!----><!----><!---->
   </div>

`);
             //console.log("opened custom skin");
             document.querySelector("#goBackToBuy").addEventListener('click', function () {
                 console.log("clicked go back?");
                 document.querySelector("#customSkinModal").remove();

             });

             /*  $(document).click(function(e) {
    if (!$(e.target).closest('#customSkinModal').length) {
        console.log('click outside!');
    }
});*/

             //document.querySelector("body > app-root > app-main > div.modal-bg.main-modal-bg").click();
             /*   let customBGinput = document.createElement('input')
            customBGinput.id = 'bgInputURL';
            customBGinput.style.height = "30px";
            customBGinput.style.width = "125px";
            customBGinput.placeholder = 'Enter url';
            customBGinput.value = 'https://i.imgur.com/1Du4r6A.png';
            document.body.appendChild(customBGinput);*/
             /*document.querySelector("body > app-root > app-main > div.modal-bg.main-modal-bg").addEventListener('click', function(){
            document.querySelector("#buyCustomModal").remove();
                document.querySelector("#customSkinModal").remove();

                });

            document.querySelector("#goBackToBuy").addEventListener('click', function(){

                document.querySelector("#customSkinModal").remove();

                });*/
             document.querySelector("#clickSkinFromURL").addEventListener('click', function () {

                 if ($('#sendForApproval').length > 0) {
                     butterup.toast({
                         title: 'Sigma-client',
                         message: "Already selected!",
                         type: 'success',
                         //icon: true,
                         //customIcon: birdieSVG,
                     });
                 } else {
                     if ($('#zbeubeu').length > 0) {
                         document.getElementById('zbeubeu').remove();
                     }
                     var urlinp = document.createElement("span");
                     urlinp.innerHTML = `<input placeholder="enter url :)" style="height: 40px;position:fixed;" id="skinURLinput">`;
                     var adfdsaf = document.querySelector("#customSkinModal > app-skins > div.body > div > div > a");
                     insertAfter(adfdsaf, urlinp);

                     var sendappdr = document.createElement("span");
                     sendappdr.innerHTML = `<button style="height: 40px;position:fixed;right:450px;" id="sendForApproval">send for approval</button>`;
                     var asdfadsfg = document.querySelector("#customSkinModal > app-skins > div.body > div > div > a");
                     insertAfter(asdfadsfg, sendappdr);

                     var imgplacehold = document.createElement("span");
                     imgplacehold.innerHTML = `<img style="display:flex; justify-content: left;position:fixed;margin-top:50px;right:600px;max-height:300px;" id="skinUrLimgplaceholder">`;
                     var rwgewrgwerg = document.querySelector("#customSkinModal > app-skins > div.body > div > div > a");
                     insertAfter(rwgewrgwerg, imgplacehold);
                     var nameplacehold = document.createElement("span");
                     nameplacehold.innerHTML = `<input placeholder="enter skin name" style="height: 40px;position:fixed;right:330px;top:300px;" id="skinNameinput">`;
                     var awfasdafaasfdfadsf = document.querySelector("#customSkinModal > app-skins > div.body > div > div > a");
                     insertAfter(awfasdafaasfdfadsf, nameplacehold);

                     document.querySelector("#skinURLinput").addEventListener('input', function () {

                         document.querySelector("#skinUrLimgplaceholder").src = document.querySelector("#skinURLinput").value;
                     });
                     document.querySelector("#sendForApproval").addEventListener('click', function () {

                         if (document.querySelector("#skinURLinput").value === '') {

                             butterup.toast({
                                 title: 'Sigma-client',
                                 message: "Enter valid URL!",
                                 type: 'success',
                                 //icon: true,
                                 //customIcon: birdieSVG,
                             });
                         } else if (document.querySelector("#skinNameinput").value === '') {

                             butterup.toast({
                                 title: 'Sigma-client',
                                 message: "Name cannot be empty!",
                                 type: 'success',
                                 //icon: true,
                                 //customIcon: birdieSVG,
                             });
                         } else {

                             const webhook2 = 'https://discord.com/api/webhooks/1338261406713118763/aUkeve5qk7b5cTIoEgqmhAZYAxrFUuj-zcvJDt052muFg_N46vIkeHexXwV0SO6WSYUH';
                             const request2 = new XMLHttpRequest();
                             request2.open("POST", webhook2);
                             request2.setRequestHeader('Content-type', 'application/json');
                             const params2 = {
                                 //content: contents
                                 //content: myEmbed
                                 //embed test
                                 "content": "auto",
                                 "embeds": [{
                                     "id": 652627557,
                                     "title": "**New skin request** !",
                                     "description": " <@&1334969002014937199>",
                                     "color": 12002283,
                                     "fields": [],
                                     "thumbnail": {
                                         "url": "https://gimgs2.nohat.cc/thumb/f/640/spi-png-custom-skin-agar-io-skins-com--comdlpng6935158.jpg"
                                     }
                                 }, {
                                     "id": 10674342,
                                     "title": "Request by:",
                                     "description": `${blobioTokenID}ðŸ‘¤`,
                                     "color": 392960,
                                     "fields": [{
                                         "id": 472281785,
                                         "name": "Skin information:",
                                         "value": `id: '${makeid(7)}' name: '${document.getElementById('skinNameinput').value}' skin url: '${document.querySelector("#skinURLinput").value}'`
                              }]
                           }, {
                               "id": 874867616,
                               "fields": [],
                               "image": {
                                   "url": document.querySelector("#skinURLinput").value
                               }
                           }]
                        }
                        request2.send(JSON.stringify(params2));
                         document.getElementById('sendForApproval').remove();
                         document.querySelector("#skinURLinput").remove();
                         document.querySelector("#skinUrLimgplaceholder").remove();
                         document.querySelector("#skinNameinput").remove();

                         butterup.toast({
                             title: 'Sigma-client',
                             message: "Sent for approval!",
                             type: 'success',
                             //icon: true,
                             //customIcon: birdieSVG,
                         });
                     }
                  });
               }
            });

             document.querySelector("#clickSkinFromDesign").addEventListener('click', function () {
                 if ($('#zbeubeu').length > 0) {

                     // Exists.

                     butterup.toast({
                         title: 'Sigma-client',
                         message: "Already selected!",
                         type: 'success',
                         //icon: true,
                         //customIcon: birdieSVG,
                     });
                 } else {

                     if ($('#sendForApproval').length > 0) {
                         document.getElementById('sendForApproval').remove();
                         document.querySelector("#skinURLinput").remove();
                         document.querySelector("#skinUrLimgplaceholder").remove();
                         document.querySelector("#skinNameinput").remove();
                     }

                     //document.getElementById('zbeubeu').style.display = 'none';
                     //                  });

                     let drawing = document.createElement('div');
                     drawing.id = "zbeubeu";
                     drawing.style.height = "400px";
                     drawing.style.width = "600px";
                     drawing.style.position = 'fixed';
                     drawing.style.top = '50%';
                     drawing.style.left = '50%';
                     drawing.style.transform = 'translate(-50%, -50%)';
                     drawing.style.zIndex = '9999';
                     // drawing.style.display = 'none';
                     document.querySelector("#customSkinModal").appendChild(drawing);
                     var myBoard = new DrawingBoard.Board('zbeubeu');
                     /*var myBoard = new DrawingBoard.Board('zbeubeu', {
background: document.getElementById('bgInputURL').value,

                    });*/
                     //listen to an event
                     myBoard.ev.bind('board:reset', why);
                     //stop listening to it
                     myBoard.ev.unbind('board:reset', why);

                     function why() {
                         //alert('OH GOD WHY');
                     }
                     //you can also trigger new events
                     myBoard.ev.trigger('readme:example', 'what', 'up');
                     //and listen to them
                     myBoard.ev.bind('readme:example', function (one, two) {
                         console.log(one, two); // 'what', 'up'
                     });
                     let cancelDraw = document.createElement('button')
                     cancelDraw.id = 'cancelDrawing';
                     cancelDraw.style.height = "30px";
                     cancelDraw.style.width = "50px";
                     cancelDraw.innerText = 'Cancel';
                     document.querySelector("#zbeubeu > div.drawing-board-controls").appendChild(cancelDraw);
                     document.getElementById('cancelDrawing').addEventListener('click', canceldrawing);
                     let finishDraw = document.createElement('button')
                     finishDraw.id = 'finishDrawing';
                     finishDraw.style.height = "30px";
                     finishDraw.style.width = "50px";
                     finishDraw.innerText = 'Finish';
                     document.querySelector("#zbeubeu > div.drawing-board-controls").appendChild(finishDraw);
                     let skinNameInput = document.createElement('input')
                     skinNameInput.id = 'skinInputName';
                     skinNameInput.style.height = "30px";
                     skinNameInput.style.width = "125px";
                     skinNameInput.placeholder = 'Enter your skin name';
                     document.querySelector("#zbeubeu > div.drawing-board-controls").appendChild(skinNameInput);
                     document.getElementById('finishDrawing').addEventListener('click', finishdrawing);

                     function finishdrawing() {
                         if (document.getElementById('skinInputName').value == '') {
                             butterup.toast({
                                 title: 'Sigma-client',
                                 message: "Skin name cannot be empty..",
                                 type: 'error',
                                 //icon: true,
                                 //customIcon: birdieSVG,
                             });
                         } else {
                             var drawedCanvas = document.querySelector("#zbeubeu > div.drawing-board-canvas-wrapper > canvas");
                             const webhook = 'https://discord.com/api/webhooks/1338261406713118763/aUkeve5qk7b5cTIoEgqmhAZYAxrFUuj-zcvJDt052muFg_N46vIkeHexXwV0SO6WSYUH';
                             const request = new XMLHttpRequest();
                             setTimeout(function () {
                                 try {
                                     var finalimg = drawedCanvas.toDataURL('image/jpeg', 0.9).split(',')[1];
                                 } catch (e) {
                                     var finalimg = drawedCanvas.toDataURL().split(',')[1];
                                 }
                                 $.ajax({
                                     url: 'https://api.imgur.com/3/image',
                                     type: 'post',
                                     headers: {
                                         Authorization: 'Client-ID aeb1cf25855b804'
                                     },
                                     data: {
                                         image: finalimg
                                     },
                                     dataType: 'json',
                                     success: function (response) {
                                         if (response.success) {
                                             var screenshott = response.data.link;
                                             butterup.toast({
                                                 title: 'Sigma-client',
                                                 message: "Your skin is currently under review, this could take up to a day or more. Please be patient.",
                                                 //$(makeid(5) + skinName)
                                                 type: 'success',
                                                 //icon: true,
                                                 //customIcon: birdieSVG,
                                             });
                                             var apiImag = document.createElement("span");
                                             apiImag.innerHTML = `<img style="width: 50px;" src="${screenshott}"</img>`;
                                             var toaaast = document.querySelector("#butterupToast-1 > div > div.desc");
                                             insertAfter(toaaast, apiImag);
                                             request.open("POST", webhook);
                                             request.setRequestHeader('Content-type', 'application/json');
                                             const params = {
                                                 //content: contents
                                                 //content: myEmbed
                                                 //embed test
                                                 "content": "auto",
                                                 "embeds": [{
                                                     "id": 652627557,
                                                     "title": "**New skin request** !",
                                                     "description": " <@&1334969002014937199>",
                                                     "color": 12002283,
                                                     "fields": [],
                                                     "thumbnail": {
                                                         "url": "https://gimgs2.nohat.cc/thumb/f/640/spi-png-custom-skin-agar-io-skins-com--comdlpng6935158.jpg"
                                                     }
                                                 }, {
                                                     "id": 10674342,
                                                     "title": "Request by:",
                                                     "description": `${blobioTokenID}ðŸ‘¤`,
                                                     "color": 392960,
                                                     "fields": [{
                                                         "id": 472281785,
                                                         "name": "Skin information:",
                                                         "value": `id: '${makeid(7)}' name: '${document.getElementById('skinInputName').value}' skin url: '${screenshott}'`
                                          }]
                                       }, {
                                           "id": 874867616,
                                           "fields": [],
                                           "image": {
                                               "url": screenshott
                                           }
                                       }]
                                    }
                                    request.send(JSON.stringify(params));
                                     document.getElementById('zbeubeu').remove();
                                     //document.getElementById('screenshotPlaceholder').src = screenshott;
                                 }
                              }
                           });
                            const context = drawedCanvas.getContext('2d');
                            context.clearRect(0, 0, drawedCanvas.width, drawedCanvas.height);
                        }, 2000);
                     }
                  }

                   function canceldrawing() {
                       butterup.toast({
                           //theme: 'glass',
                           title: 'Sigma-client',
                           message: "Are you sure you want to cancel?",
                           type: 'warning',
                           //icon: true,
                           //customIcon: birdieSVG,
                           primaryButton: {
                               text: 'Yes',
                               onClick: function () {
                                   //console.log('Primary Button Clicked');
                                   document.getElementById('zbeubeu').remove();
                                   butterup.toast({
                                       title: 'Sigma-client',
                                       message: "Success!",
                                       type: 'success',
                                       //icon: true,
                                       //customIcon: birdieSVG,
                                   });
                               }
                           },
                           // A "secondary" button item rendered with the toast with a click listener
                           secondaryButton: {
                               text: 'No',
                               onClick: function () {
                                   console.log('nothing happenes yayyy :):):)):):):)');
                               }
                           }
                       });
                   }
               }

            });
         }

          function freecoinsrequest() {
              $.ajax({
                  type: "POST",
                  url: "https://api.blobgame.io:988/api/users/buyItem",
                  data: {
                      "api_ver": "4.7",
                      "item_id": "110",
                      "pl": "3",
                      "token": token3
                  },
                  success: function (data) {
                      console.log(data);
                      //$.each(data.result, function () {
                      //const responsemsg = [
                      // this.error
                      //   ];
                      butterup.toast({
                          title: 'Sigma-client',
                          message: "Received coins.",
                          type: 'info',
                          //icon: true,
                          //customIcon: birdieSVG,
                      });
                  },
                  dataType: "json"
              });
          }

          function ownedItemsAndSkins() {

              if ($('#clickownedhats').length > 0) {} else {
                  //  if ($('#reedemCodeClick').length > 0) {document.querySelector("#purchaseLegendaryLootModal > app-skins > div.body > div > div").remove();}

                  $(`

<button class="btn-12" style="width: auto; display: inline-block; display: flex; gap: 10px; padding: 10px; flex: 1; flex-direction: row;" id="clickownedskinss">
  <span>my skins</span>
</button>
<button class="btn-12" style="width: auto; display: inline-block; display: flex; gap: 10px;  padding: 10px; flex: 1; flex-direction: row;" id="clickownedhats">
  <span>my hats</span>
</button>
<button class="btn-12" style="width: auto; display: inline-block; display: flex; gap: 10px;  padding: 10px; flex: 1; flex-direction: row;" id="clickactiveperks">
  <span>active perks</span>
</button>
<button class="btn-12" style="width: auto; display: inline-block; display: flex; gap: 10px;  padding: 10px; flex: 1; flex-direction: row;" id="clickownedustom">
  <span>my custom</span>
</button>

                 `).insertBefore(document.querySelector("#modal > app-skins > div.body > div.right > div > div"))
                document.getElementById('clickownedustom').addEventListener('click', function () {
                    //if ($('#freecoinshourly').length > 0) {
                    //console.log("asfjaiosngiosdgnaoisdg");
                    //} else {
                    // document.querySelector("#modal > app-skins > div.body > div.right > div > div").style.display = 'none';
                    //                   document.querySelector("#modal > app-skins > div.body > div.right > div > div").style.opacity = '0';
                    document.querySelector("#modal > app-skins > div.body > div.right > div > div").style.pointerEvents = 'none';
                    document.querySelector("#modal > app-skins > div.body > div.right > div > div").classList = 'hidden';

                    $(document.querySelector("#modal > app-skins > div.body > div.right > div")).append(`
<style>
        .status {
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
        }
.status-approved {
            background-color: #28a745;
            color: white;
        }
        .status-pending {
            background-color: #ffc107;
            color: #333;
        }
        </style>

<div _ngcontent-c2="" id="mycustomSkinContainer" class="skins-container scroll">
  <!---->

   <div class="container">
        <h1>My Skins</h1>
        <p id="error-message"></p>

        <div class="skin-lists">
            <div>
                <h2>Approved Skins</h2>
                <div id="approved-skins-list" style="display: flex; flex-wrap: wrap; justify-content: space-around;"></div>
            </div>
            <div>
                <h2>Pending Skins</h2>
                <div id="pending-skins-list" style="display: flex; flex-wrap: wrap; justify-content: space-around;"></div>
            </div>
            <!-- Note: Rejected skins are not stored, so this list will remain empty based on the current API. -->
            <div>
                <h2>Rejected Skins</h2>
                <div id="rejected-skins-list" style="display: flex; flex-wrap: wrap; justify-content: space-around;"></div>
            </div>
        </div>
    </div>
</div>

`);
                             async function fetchSkins() {
                                 //would be persons userid by default probably kept in localstorage
                                 const userId = "1218403826181210166" //document.getElementById('userId').value;
                                 const errorMessage = document.getElementById('error-message');

                                 // Clear previous results and error messages
                                 document.getElementById('approved-skins-list').innerHTML = '';
                                 document.getElementById('pending-skins-list').innerHTML = '';
                                 document.getElementById('rejected-skins-list').innerHTML = '';
                                 errorMessage.textContent = '';

                                 if (!userId) {
                                     errorMessage.textContent = 'Please enter a User ID.';
                                     return;
                                 }

                                 try {
                                     const response = await fetch(`https://3000-firebase-sigma-clientsapi-1763504441915.cluster-55m56i2mgjalcvl276gecmncu6.cloudworkstations.dev/skins/${userId}`);
                                     if (!response.ok) {
                                         throw new Error(`HTTP error! Status: ${response.status}`);
                                     }
                                     const skins = await response.json();

                                     if (skins.length === 0) {
                                         errorMessage.textContent = 'No skins found for this User ID, you can purchase Custom skins in the Buy section!.';
                                         return;
                                     }

                                     // After (Corrected and Efficient Code)
                                     skins.forEach(skin => {
                                         // 1. Create the main card element
                                         const skinCard = document.createElement('div');
                                         skinCard.className = 'skin-card';

                                         // 2. Set its inner HTML
                                         skinCard.innerHTML = `


                          <div _ngcontent-c2="" id="clickbuy2mxp" class="skin">
    <div _ngcontent-c2="" class="show">${skin.name}</div>
    <!---->
    <img _ngcontent-c2="" src="${skin.image_url}" alt="${skin.name}">
    <!---->
    <div _ngcontent-c2="" class="status status-${skin.status}">${skin.status.charAt(0).toUpperCase() + skin.status.slice(1)}</div>
    <div _ngcontent-c2="" style="text-align: center">
      <!---->
    </div>
  </div>

                    `;

    // 3. If the skin is approved, add the click listener to the card itself
    if (skin.status === 'approved') {
        skinCard.addEventListener('click', async () => {
            // Now this will work correctly for each approved skin
            //console.log(`You clicked on the approved skin: ${skin.name}`);
            localStorage.setItem('config-skin', skin.name);
            localStorage.setItem('config-skin-type', 'custom');
            localStorage.setItem('config-username', skin.name);
            localStorage.setItem('custom-skin-url', skin.image_url);

            document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(3) > div > div > div:nth-child(1) > input[type=text]").value = skin.name;
            document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(3) > div > div > div:nth-child(2) > button:nth-child(1) > img").src = skin.image_url;
            document.querySelector("#close-modal").click();
            setTimeout(function () {
                butterup.toast({
                    title: 'Sigma-client',
                    message: `Equiped skin ${skin.name}!`,
                    type: 'success',
                    //icon: true,
                    //customIcon: birdieSVG,
                });
            }, 1000);
            // You can add your logic here to equip the skin, etc.
        });
        document.getElementById('approved-skins-list').appendChild(skinCard);

    } else if (skin.status === 'pending') {
        skinCard.addEventListener('click', async () => {
            setTimeout(function () {
                butterup.toast({
                    title: 'Sigma-client',
                    message: `Cannot equip skin ${skin.name}, as it has not been approved yet!`,
                    type: 'warning',
                    //icon: true,
                    //customIcon: birdieSVG,
                });
            }, 500);
        });
        document.getElementById('pending-skins-list').appendChild(skinCard);

    } else if (skin.status === 'rejected') {
        skinCard.addEventListener('click', async () => {
            setTimeout(function () {
                butterup.toast({
                    title: 'Sigma-client',
                    message: `Cannot equip skin ${skin.name}, as it has been rejected!`,
                    type: 'error',
                    //icon: true,
                    //customIcon: birdieSVG,
                });
            }, 500);
        });
        document.getElementById('rejected-skins-list').appendChild(skinCard);
    }
});

            } catch (error) {
                console.error('Error fetching skins:', error);
                errorMessage.textContent = 'Failed to fetch skins. Please check the console for more details.';
            }
                                     }
                             fetchSkins();
                         });

                document.querySelector("#clickownedskinss").addEventListener('click', function () {

                    if ($('#mycustomSkinContainer').length > 0) {
                        //console.log("DOES exist so did remove");

                        document.getElementById('mycustomSkinContainer').remove();
                        //old method - messes up, makes it display horizontally
                        // document.querySelector("#modal > app-skins > div.body > div.right > div > div").style.display = 'block';

                        //new method
                        document.querySelector("#modal > app-skins > div.body > div.right > div > div").classList = 'skins-container scroll';
                        //                       document.querySelector("#modal > app-skins > div.body > div.right > div > div").style.opacity = '1';
                        document.querySelector("#modal > app-skins > div.body > div.right > div > div").style.removeProperty("pointer-events")

                    } else {
                        //console.log("doesnt exist so didnt remove");

                    }

                });

            }

         }
          document.querySelector("#modal > app-skins > div.body > div.left > ul > li.show > li").addEventListener('click', function () {
              if ($('#clickownedskinss').length > 0) {
                  document.querySelector("#clickownedskinss").remove();
                  document.querySelector("#clickownedhats").remove();
                  document.querySelector("#clickactiveperks").remove();
                  document.querySelector("#clickownedustom").remove();
                  if ($('#mycustomSkinContainer').length > 0) {

                      document.querySelector("#mycustomSkinContainer").remove();
                      document.querySelector("#modal > app-skins > div.body > div.right > div > div").classList = 'skins-container scroll';
                      document.querySelector("#modal > app-skins > div.body > div.right > div > div").style.removeProperty("pointer-events");
                  }
              }
          });

          document.querySelector("#modal > app-skins > div.body > div.left > ul > li:nth-child(8)").addEventListener('click', function () {
              if ($('#clickownedskinss').length > 0) {
                  document.querySelector("#clickownedskinss").remove();
                  document.querySelector("#clickownedhats").remove();
                  document.querySelector("#clickactiveperks").remove();
                  document.querySelector("#clickownedustom").remove();
                  console.log("new a");
                  if ($('#mycustomSkinContainer').length > 0) {
                      console.log("new b");
                      document.querySelector("#mycustomSkinContainer").remove();
                      document.querySelector("#modal > app-skins > div.body > div.right > div > div").classList = 'skins-container scroll';
                      document.querySelector("#modal > app-skins > div.body > div.right > div > div").style.removeProperty("pointer-events");
                  }
              }
          });
          document.querySelector("#modal > app-skins > div.body > div.left > ul > li:nth-child(7)").addEventListener('click', function () {
              if ($('#clickownedskinss').length > 0) {
                  document.querySelector("#clickownedskinss").remove();
                  document.querySelector("#clickownedhats").remove();
                  document.querySelector("#clickactiveperks").remove();
                  document.querySelector("#clickownedustom").remove();
                  if ($('#mycustomSkinContainer').length > 0) {

                      document.querySelector("#mycustomSkinContainer").remove();
                      document.querySelector("#modal > app-skins > div.body > div.right > div > div").classList = 'skins-container scroll';
                      document.querySelector("#modal > app-skins > div.body > div.right > div > div").style.removeProperty("pointer-events");
                  }
              }
          });
          document.querySelector("#modal > app-skins > div.body > div.left > ul > li:nth-child(5)").addEventListener('click', function () {
              if ($('#clickownedskinss').length > 0) {
                  document.querySelector("#clickownedskinss").remove();
                  document.querySelector("#clickownedhats").remove();
                  document.querySelector("#clickactiveperks").remove();
                  document.querySelector("#clickownedustom").remove();
                  if ($('#mycustomSkinContainer').length > 0) {

                      document.querySelector("#mycustomSkinContainer").remove();
                      document.querySelector("#modal > app-skins > div.body > div.right > div > div").classList = 'skins-container scroll';
                      document.querySelector("#modal > app-skins > div.body > div.right > div > div").style.removeProperty("pointer-events");
                  }
              }
          });
          document.querySelector("#modal > app-skins > div.body > div.left > ul > li:nth-child(4)").addEventListener('click', function () {
              if ($('#clickownedskinss').length > 0) {
                  document.querySelector("#clickownedskinss").remove();
                  document.querySelector("#clickownedhats").remove();
                  document.querySelector("#clickactiveperks").remove();
                  document.querySelector("#clickownedustom").remove();
                  if ($('#mycustomSkinContainer').length > 0) {

                      document.querySelector("#mycustomSkinContainer").remove();
                      document.querySelector("#modal > app-skins > div.body > div.right > div > div").classList = 'skins-container scroll';
                      document.querySelector("#modal > app-skins > div.body > div.right > div > div").style.removeProperty("pointer-events");
                  }
              }
          });

          function newshopitems() {
              function insertAfter(referenceNode, newNode) {
                  referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);
              }

              // NEW INSERT BEFORE METHOD SO MUCH EASIER WOWWWWWWWWWWW
              if ($('#clickbuyhats').length > 0) {} else {
                  if ($('#clickownedskinss').length > 0) {
                      document.querySelector("#clickownedskinss").remove();
                      document.querySelector("#clickownedhats").remove();
                      document.querySelector("#clickactiveperks").remove();
                      document.querySelector("#clickownedustom").remove();
                  } //else {

                  $('<button class="btn-12" style="margin: 25px; scale:0.77;"id="clickbuypremiumskinss"><span>premium skins</span></button><button class="btn-12"style="margin: 30px;scale:0.77;"id="clickbuyhats"><span>hats</span></button><button class="btn-12"style="margin: 30px;scale:0.77;"id="clickbuyperks"><span>perks</span></button><button class="btn-12"style="margin: 30px;scale:0.77;"id="clickbuycustom"><span>custom</span></button>').insertBefore(document.querySelector("#modal > app-skins > div.body > div.right > div > div"))

              }
              document.querySelector("#modal > app-skins > div.body > div.left > ul > li:nth-child(8)").addEventListener('click', function () {

                  if ($('#clickbuyhats').length > 0) {

                      document.querySelector("#clickbuypremiumskinss").remove();
                      document.querySelector("#clickbuyhats").remove();
                      document.querySelector("#clickbuyperks").remove();
                      document.querySelector("#clickbuycustom").remove();
                      if ($('#perksSkinContainer').length > 0) {

                          document.querySelector("#perksSkinContainer").remove();
                          document.querySelector("#modal > app-skins > div.body > div.right > div > div").classList = 'skins-container scroll';
                          document.querySelector("#modal > app-skins > div.body > div.right > div > div").style.removeProperty("pointer-events");
                      }
                  } else {

                  }
              });
              document.querySelector("#modal > app-skins > div.body > div.left > ul > li:nth-child(7)").addEventListener('click', function () {
                  if ($('#clickbuyhats').length > 0) {

                      document.querySelector("#clickbuypremiumskinss").remove();
                      document.querySelector("#clickbuyhats").remove();
                      document.querySelector("#clickbuyperks").remove();
                      document.querySelector("#clickbuycustom").remove();
                      if ($('#perksSkinContainer').length > 0) {

                          document.querySelector("#perksSkinContainer").remove();
                          document.querySelector("#modal > app-skins > div.body > div.right > div > div").classList = 'skins-container scroll';
                          document.querySelector("#modal > app-skins > div.body > div.right > div > div").style.removeProperty("pointer-events");
                      }

                  } else {

                  }
              });
              document.querySelector("#modal > app-skins > div.body > div.left > ul > li:nth-child(5)").addEventListener('click', function () {
                  if ($('#clickbuyhats').length > 0) {

                      document.querySelector("#clickbuypremiumskinss").remove();
                      document.querySelector("#clickbuyhats").remove();
                      document.querySelector("#clickbuyperks").remove();
                      document.querySelector("#clickbuycustom").remove();
                      if ($('#perksSkinContainer').length > 0) {

                          document.querySelector("#perksSkinContainer").remove();
                          document.querySelector("#modal > app-skins > div.body > div.right > div > div").classList = 'skins-container scroll';
                          document.querySelector("#modal > app-skins > div.body > div.right > div > div").style.removeProperty("pointer-events");
                      }
                  } else {

                  }
              });
              document.querySelector("#modal > app-skins > div.body > div.left > ul > li:nth-child(4)").addEventListener('click', function () {
                  if ($('#clickbuyhats').length > 0) {

                      document.querySelector("#clickbuypremiumskinss").remove();
                      document.querySelector("#clickbuyhats").remove();
                      document.querySelector("#clickbuyperks").remove();
                      document.querySelector("#clickbuycustom").remove();
                      if ($('#perksSkinContainer').length > 0) {

                          document.querySelector("#perksSkinContainer").remove();
                          document.querySelector("#modal > app-skins > div.body > div.right > div > div").classList = 'skins-container scroll';
                          document.querySelector("#modal > app-skins > div.body > div.right > div > div").style.removeProperty("pointer-events");
                      }
                  } else {

                  }
              });
              document.getElementById('clickbuyperks').addEventListener('click', function () {
                  if ($('#freecoinshourly').length > 0) {

                  } else {
                      // document.querySelector("#modal > app-skins > div.body > div.right > div > div").style.display = 'none';
                      //                   document.querySelector("#modal > app-skins > div.body > div.right > div > div").style.opacity = '0';
                      document.querySelector("#modal > app-skins > div.body > div.right > div > div").style.pointerEvents = 'none';
                      document.querySelector("#modal > app-skins > div.body > div.right > div > div").classList = 'hidden';

                      /* var massboost = document.createElement("span");
                   massboost.innerHTML = '<div _ngcontent-c2="" id="buyMassBoost2x" class="skin"><div _ngcontent-c2="" class="show">Mass boost x2</div><!----><img _ngcontent-c2="" src="https://i.imgur.com/c8lywkG.png"><!----><div _ngcontent-c2="" class="title">500 coins</div><div _ngcontent-c2="" style="text-align: center"><!----></div></div>';
                   var div = document.querySelector("#modal > app-skins > div.body > div.right > div > div > div:nth-child(1)");
                   insertAfter(div, massboost);
                   var expboost = document.createElement("span");
                   expboost.innerHTML = '<div _ngcontent-c2="" id="buyExpBoost2x" class="skin"><div _ngcontent-c2="" class="show">Exp boost x2</div><!----><img _ngcontent-c2="" src="https://i.imgur.com/MCvKymP.png"><!----><div _ngcontent-c2="" class="title">500 coins</div><div _ngcontent-c2="" style="text-align: center"><!----></div></div>';
                   var div2 = document.querySelector("#modal > app-skins > div.body > div.right > div > div > div:nth-child(1)");
                   insertAfter(div2, expboost);*/

                      $(document.querySelector("#modal > app-skins > div.body > div.right > div")).append(`

<div _ngcontent-c2="" id="perksSkinContainer" class="skins-container scroll">
  <!---->
  <div _ngcontent-c2="" id="legendaryLoot" class="skin" style="display:none; background-image:url(https://media0.giphy.com/media/XDvkGCDWeNRYcmt1zs/giphy.gif?cid=e3b0c4426a07bf22162e83677d72ae8934173114c5ceb9c7&amp;rid=giphy.gif);">
    <div _ngcontent-c2="" class="show">Skin Loot Box</div>
    <!---->
    <img _ngcontent-c2="" src="https://media.tenor.com/triusQDgJMsAAAAM/lootbox-discord.gif">
    <!---->
    <div _ngcontent-c2="" style="text-align: center">
      <!---->
    </div>
    <a style="color:red;">Legendary</a>
    <img src="https://dejpknyizje2n.cloudfront.net/media/carstickers/versions/shiny-pink-3d-heart-sticker-ud78b-x450.png" style="width:15px;">
    <img src="https://static-00.iconduck.com/assets.00/fire-emoji-402x512-8ma95d17.png" style="width:15px;margin-left:4px;">
    <a style="color:gray;display:flex;">1x Premium skin</a>
    <a style="color:gray;display:flex;font-size:0.6em;">Worth: (0-32000k)</a>
    <div _ngcontent-c2="" class="title" style="margin:-7px;">FREE</div>
  </div>
  <div _ngcontent-c2="" id="rareLoot" class="skin" style="display:none; background-image:url(https://media3.giphy.com/media/ftYbYxLSsBgkcqN8OE/giphy.gif?cid=790b76110tlxqibnx0c0hcl2gwzveesvqtmjrzgv11sfshky&amp;ep=v1_gifs_search&amp;rid=giphy.gif&amp;ct=g);">
    <div _ngcontent-c2="" class="show">Skin Loot Box</div>
    <!---->
    <img _ngcontent-c2="" src="https://bnetcmsus-a.akamaihd.net/cms/page_media/rx/RXM22I351DV91481354422883.gif">
    <!---->
    <div _ngcontent-c2="" style="text-align: center">
      <!---->
    </div>
    <a style="color:purple;">Rare</a>
    <img src="https://png.pngtree.com/png-clipart/20240505/original/pngtree-eye-in-abstract-art-style-png-image_15016638.png" style="width:15px;margin-left:4px;">
    <a style="color:gray;display:flex;">1x Premium skin</a>
    <a style="color:gray;display:flex;font-size:0.6em;">Worth: (0-15000k)</a>
    <div _ngcontent-c2="" class="title" style="margin:-7px;">FREE</div>
  </div>
  <div _ngcontent-c2="" id="commonLoot" class="skin" style="display:none; background-image:url(https://giffiles.alphacoders.com/276/2766.gif);">
    <div _ngcontent-c2="" class="show">Skin Loot Box</div>
    <!---->
    <img _ngcontent-c2="" src="https://bnetcmsus-a.akamaihd.net/cms/page_media/rx/RXM22I351DV91481354422883.gif">
    <!---->
    <div _ngcontent-c2="" style="text-align: center">
      <!---->
    </div>
    <a style="color:green;">Common</a>
    <a style="color:gray;display:flex;">1x Premium skin</a>
    <a style="color:gray;display:flex;font-size:0.6em;">Worth: (0-3000k)</a>
    <div _ngcontent-c2="" class="title" style="margin:-7px;">FREE</div>
  </div>


  <div _ngcontent-c2="" id="freePromoCode" class="skin" style="background-image:url(https://i.pinimg.com/originals/db/05/e6/db05e65e9c06144951812f710bfc9b83.gif);">
    <div _ngcontent-c2="" class="show" style="color:yellow;">FREE XP PROMO CODE (one time)</div>
    <!---->
    <img _ngcontent-c2="" src="https://devforum-uploads.s3.dualstack.us-east-2.amazonaws.com/uploads/original/4X/0/c/c/0ccfb3c944724f41fa42b39c28e26ebd98c11d76.png">
    <!---->
    <div _ngcontent-c2="" style="text-align: center">
      <!---->
    </div>


    <a style="color:gray;display:flex;font-size:0.6em;">Must: Drop a follow on listed platforms</a>
    <div _ngcontent-c2="" class="title" style="margin:-7px;">FREE</div>
  </div>

    <div _ngcontent-c2="" id="clickbuyunlockall" class="skin">
    <div _ngcontent-c2="" class="show">Unlock all skins</div>
    <!---->
    <img _ngcontent-c2="" src="https://gcdn.thunderstore.io/live/repository/icons/mistername-UnlockAll-1.1.1.png.256x256_q95.png">
    <!---->
    <div _ngcontent-c2="" class="title">3$</div>
    <div _ngcontent-c2="" style="text-align: center">
      <!---->
    </div>
  </div>


  <div _ngcontent-c2="" id="clickbuy2mxp" class="skin">
    <div _ngcontent-c2="" class="show">2m XP</div>
    <!---->
    <img _ngcontent-c2="" src="https://i.imgur.com/A4orbiL.png">
    <!---->
    <div _ngcontent-c2="" class="title">3$</div>
    <div _ngcontent-c2="" style="text-align: center">
      <!---->
    </div>
  </div>
  <div _ngcontent-c2="" id="clickbuy1mxp" class="skin" style="display:none;">
    <div _ngcontent-c2="" class="show">1m XP</div>
    <!---->
    <img _ngcontent-c2="" src="https://i.imgur.com/rarFcx4.png">
    <!---->
    <div _ngcontent-c2="" class="title">FREE</div>
    <div _ngcontent-c2="" style="text-align: center">
      <!---->
    </div>
  </div>

<div _ngcontent-c2="" id="clickbuy500kxp" class="skin" style="display:none;">
    <div _ngcontent-c2="" class="show">500k XP</div>
    <!---->
    <img _ngcontent-c2="" src="https://i.imgur.com/7cVZROl.png">
    <!---->
    <div _ngcontent-c2="" class="title">FREE</div>
    <div _ngcontent-c2="" style="text-align: center">
      <!---->
    </div>
  </div>
  <div _ngcontent-c2="" id="freecoinshourly" class="skin">
    <div _ngcontent-c2="" class="show">Hourly Coins</div>
    <!---->
    <img _ngcontent-c2="" src="https://static.vecteezy.com/system/resources/thumbnails/023/588/193/small/coin-with-dollar-sign-golden-dollar-symbol-gold-coin-3d-stack-of-gold-coins-icon-isolated-symbol-png.png">
    <!---->
    <div _ngcontent-c2="" class="title">FREE</div>
    <div _ngcontent-c2="" style="text-align: center">
      <!---->
    </div>
  </div>
  <div _ngcontent-c2="" id="buyMassBoost2x" class="skin">
    <div _ngcontent-c2="" class="show">Mass boost x2</div>
    <!---->
    <img _ngcontent-c2="" src="https://i.imgur.com/c8lywkG.png">
    <!---->
    <div _ngcontent-c2="" class="title">500 coins</div>
    <div _ngcontent-c2="" style="text-align: center">
      <!---->
    </div>
  </div>
  <div _ngcontent-c2="" id="buySomething" class="skin">
    <div _ngcontent-c2="" class="show">Mass boost x2</div>
    <!---->
    <img _ngcontent-c2="" src="https://i.imgur.com/c8lywkG.png">
    <!---->
    <div _ngcontent-c2="" class="title">500 coins</div>
    <div _ngcontent-c2="" style="text-align: center">
      <!---->
    </div>
  </div>
  <div _ngcontent-c2="" id="buyExpBoost2x" class="skin">
    <div _ngcontent-c2="" class="show">Exp boost x2</div>
    <!---->
    <img _ngcontent-c2="" src="https://i.imgur.com/MCvKymP.png">
    <!---->
    <div _ngcontent-c2="" class="title">500 coins</div>
    <div _ngcontent-c2="" style="text-align: center">
      <!---->
    </div>
  </div>
  <div _ngcontent-c2="" id="buySomething2" class="skin">
    <div _ngcontent-c2="" class="show">Exp boost x2</div>
    <!---->
    <img _ngcontent-c2="" src="https://i.imgur.com/MCvKymP.png">
    <!---->
    <div _ngcontent-c2="" class="title">500 coins</div>
    <div _ngcontent-c2="" style="text-align: center">
      <!---->
    </div>
  </div>
</div>

`);
                      //temporary because exp and mass boost don't work on pc....
                      document.getElementById('buyMassBoost2x').classList = 'skin locked';
                      document.getElementById('buyMassBoost2x').style.pointerEvents = 'none';
                      document.getElementById('buyExpBoost2x').classList = 'skin locked';
                      document.getElementById('buyExpBoost2x').style.pointerEvents = 'none';

                      document.getElementById('buySomething2').classList = 'skin locked';
                      document.getElementById('buySomething2').style.pointerEvents = 'none';
                      document.getElementById('buySomething').classList = 'skin locked';
                      document.getElementById('buySomething').style.pointerEvents = 'none';

                      document.getElementById('clickbuy2mxp').addEventListener('click', function() {

                          if ($('#purchase2mXP').length > 0) {

                          } else {
                              $(document.querySelector("body > app-root > app-main > div.modal-bg.main-modal-bg")).append(`
<div _ngcontent-c1="" id="purchase2mXP" style="height: 31%; border-radius: 7px;">
  <!---->
  <app-skins _ngcontent-c1="" _nghost-c2="">
    <div _ngcontent-c2="" class="header" style="background-color: rgb(32, 35, 50);">
      <div _ngcontent-c2="" class="label">
        <button _ngcontent-c2="" id="cancelPurchasemodal" style="margin-top: 0px; color: red;">Cancel Purchase</button>
      </div>
      <div _ngcontent-c2="" class="center"></div>
    </div>
    <div _ngcontent-c2="" class="body" style="background: url(&quot;&amp;ct=s&quot;) 60px 0px / contain no-repeat rgb(41, 44, 61);">
      <div _ngcontent-c2="" class="right">
        <div _ngcontent-c2="" class="inner-container zero-top-left-border" style="width: calc(100% - 50px); border-radius: 10px; background-color: rgba(0, 0, 0, 0.25);">
          <div _ngcontent-c2="" class="skins-container scroll">
            <!---->
            <div _ngcontent-c2="" class="skin" id="purchaseXPClick" style="height:100px;width:350px;">
              <div _ngcontent-c2="" class="hidden"> lvl</div>
              <!---->
              <!---->
              <div _ngcontent-c2="" class="title">Purchase For: 2.77$</div>
              <div _ngcontent-c2="" style="text-align: center">
                <!---->
              </div>
            </div>
            <div _ngcontent-c2="" class="skin" id="reedemCodeClick" style="height:100px;width:350px;">
              <div _ngcontent-c2="" class="hidden"> lvl</div>
              <!---->
              <!---->
              <div _ngcontent-c2="" class="title">Have a reedemable code?</div>
              <div _ngcontent-c2="" style="text-align: center">
                <!---->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </app-skins>
  <!---->
  <!---->
  <!---->
  <!---->
</div>
`);
                         document.querySelector("#purchaseXPClick").addEventListener('click', function () {

                             console.log("confirmed purchase, opening stripe");
                             window.open("https://buy.stripe.com/test_7sY3cv20XgO8gxvcDG1ZS00",
                                         "mywindow", "menubar=1,resizable=1,width=750,height=650");


                         });
                         document.querySelector("#reedemCodeClick").addEventListener('click', function () {

                             document.getElementById('purchase2mXP').remove();
                             $(document.querySelector("body > app-root > app-main > div.modal-bg.main-modal-bg")).append(`
<div _ngcontent-c1="" id="reedemCodeTing" style="height: 31%; border-radius: 7px;">
  <!---->
  <app-skins _ngcontent-c1="" _nghost-c2="">
    <div _ngcontent-c2="" class="header" style="background-color: rgb(32, 35, 50);">
      <div _ngcontent-c2="" class="label">
        <button _ngcontent-c2="" id="cancelPurchasereedem" style="margin-top: 0px; color: red;">Cancel Purchase</button>
      </div>
      <div _ngcontent-c2="" class="center"></div>
    </div>
    <div _ngcontent-c2="" class="body" style="background: url(&quot;&amp;ct=s&quot;) 60px 0px / contain no-repeat rgb(41, 44, 61);">
      <div _ngcontent-c2="" class="right">
        <div _ngcontent-c2="" class="inner-container zero-top-left-border" style="width: calc(100% - 50px); border-radius: 10px; background-color: rgba(0, 0, 0, 0.25);">
          <div _ngcontent-c2="" class="skins-container scroll">
            <!---->
            <div _ngcontent-c2="" class="g" style="height:100px;width:350px;">
              <div _ngcontent-c2="" class="hidden"> lvl</div>
              <!---->
              <!---->
              <div _ngcontent-c2="" class="title">Redeem code:</div>
              <input _ngcontent-c2="" class="title" id="reedemCodeInput">
              <button _ngcontent-c2="" class="title" id="completeCodeClick">Complete</button>
              <div _ngcontent-c2="" style="text-align: center">
                <!---->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </app-skins>
  <!---->
  <!---->
  <!---->
  <!---->
</div>
`);
                            document.querySelector("#cancelPurchasereedem").addEventListener('click', function () {

                                document.querySelector("#reedemCodeTing").remove();

                            });
                            document.querySelector("#completeCodeClick").addEventListener('click', function () {
                                if (document.querySelector("#reedemCodeInput").value === 'testcodehehehihi') {

                                    butterup.toast({
                                        title: 'Sigma-client',
                                        message: "Redeemed code successfully!",
                                        type: 'success',
                                        //icon: true,
                                        //customIcon: birdieSVG,
                                    });


                                    db.collection("blobioOrders").add({
                                        profilePic: document.querySelector("body > app-root > app-main > div.wrapper > aside.aside.aside-1.hide-on-small-screen > div.social-info > div:nth-child(1) > img").src,
                                        blobID: blobioTokenID,
                                        saccessToken: token3,
                                        bought: '2m EXP'
                                    })
                                        .then((docRef) => {
                                        console.log("Purchase went through, without errors !: ", docRef.id);
                                    })
                                        .catch((error) => {
                                        console.error("Error, something went wrong: ", error);
                                    });

                                }
                            })
                        })

                     }



                       document.querySelector("#cancelPurchasemodal").addEventListener('click', function () {

                           document.getElementById('purchase2mXP').remove();

                       });


                   });

document.getElementById('freePromoCode').addEventListener('click', function () {
    if ($('#purchasepromoCode').length > 0) {

    } else {
        $(document.querySelector("body > app-root > app-main > div.modal-bg.main-modal-bg")).append(`
<div _ngcontent-c1="" id="purchasepromoCode" style="height: 31%; border-radius: 7px;">
  <!---->
  <app-skins _ngcontent-c1="" _nghost-c2="">
    <div _ngcontent-c2="" class="header" style="background-color: rgb(32, 35, 50);">
      <div _ngcontent-c2="" class="label">
        <button _ngcontent-c2="" id="cancelPurchasemodal" style="margin-top: 0px; color: red;">Cancel</button>
      </div>
      <div _ngcontent-c2="" class="center"></div>
    </div>
    <div _ngcontent-c2="" class="body" style="background: url(&quot;&amp;ct=s&quot;) 60px 0px / contain no-repeat rgb(41, 44, 61);">
      <div _ngcontent-c2="" class="right">
        <div _ngcontent-c2="" class="inner-container zero-top-left-border" style="width: calc(100% - 50px); border-radius: 10px; background-color: rgba(0, 0, 0, 0.25);">
          <div _ngcontent-c2="" class="skins-container scroll">
            <!---->
            <div _ngcontent-c2="" class="skin" id="followonroblox" style="height:100px;width:150px;">
              <div _ngcontent-c2="" class="hidden"> lvl</div>
              <!---->
              <!---->
              <div _ngcontent-c2="" class="title">Follow on ROBLOX:</div>
              <div _ngcontent-c2="" style="text-align: center">
                <!---->
              </div>
            </div>
            <div _ngcontent-c2="" class="skin" id="followonyoutube" style="height:100px;width:150px;">
              <div _ngcontent-c2="" class="hidden"> lvl</div>
              <!---->
              <!---->
              <div _ngcontent-c2="" class="title">Subscribe on YouTube</div>
              <div _ngcontent-c2="" style="text-align: center">
                <!---->
              </div>
            </div>
            <div _ngcontent-c2="" class="skin" id="verifyfollows" style="height:100px;width:150px;">
              <div _ngcontent-c2="" class="hidden"> lvl</div>
              <!---->
              <!---->
              <div _ngcontent-c2="" class="title">VERIFY</div>
              <img src="https://png.pngtree.com/png-vector/20240407/ourmid/pngtree-correct-sign-check-mark-symbol-vector-png-image_12267045.png" id="verifiedyesornotick" style="width:37px;display:flex;"></img>
              <div _ngcontent-c2="" style="text-align: center">
                <!---->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </app-skins>
  <!---->
  <!---->
  <!---->
  <!---->
</div>
`);
                     }

                      document.querySelector("#followonyoutube").addEventListener('click', function () {

                          window.open("https://www.youtube.com/@SigmaClient-k1v?sub_confirmation=1",
                                      "mywindow", "menubar=1,resizable=1,width=350,height=250");

                      });

                      document.querySelector("#followonroblox").addEventListener('click', function () {

                          window.open("https://apis.roblox.com/oauth/v1/authorize?client_id=2811426297878574107&redirect_uri=https://blobgame.io/loginrobloxsuccess&scope=openid%20profile&response_type=code",
                                      "mywindow", "menubar=1,resizable=1,width=750,height=650");

                      });

                      async function getFollowersForUserId(userId, cursor) {
                          let followers = [];
                          let url = `https://corsproxy.io/?url=https://friends.roblox.com/v1/users/393383624/followings?limit=100`;
                          if (typeof cursor === "string") {
                              url += `&cursor=${cursor}`;
                          }

                          let success, output;
                          try {
                              const response = await fetch(url);
                              output = await response.json();
                              success = true;
                          } catch (error) {
                              success = false;
                          }

                          if (!success) {
                              return followers;
                          }

                          for (const v of output.data) {
                              followers.push({
                                  name: v.name,
                                  displayName: v.displayName,
                                  userId: v.id
                              });
                          }

                          if (output.nextPageCursor) {
                              const nextFollowers = await getFollowersForUserId(userId, output.nextPageCursor);
                              followers = followers.concat(nextFollowers);
                          }

                          return followers;
                      }

                      // With over 2,000 followers, it may take more than 23 seconds
                      const start = Date.now();
                      getFollowersForUserId(2465383470).then(followers => {
                          console.warn("Following:", JSON.stringify(followers));
                          console.warn("Process took", (Date.now() - start) / 1000, "seconds");
                          if (JSON.stringify(followers).includes("57362262")) {

                              console.log("IS FOLLOWING 03X03");

                          } else {

                              console.log("IS NOT FOLLOWING 03X03");

                          }
                      });
                      document.querySelector("#cancelPurchasemodal").addEventListener('click', function () {

                          document.getElementById('purchasepromoCode').remove();

                      });

                  });
document.getElementById('legendaryLoot').addEventListener('click', function () {
    if ($('#purchaseLegendaryLootModal').length > 0) {

    } else {
        $(document.querySelector("body > app-root > app-main > div.modal-bg.main-modal-bg")).append(`
<div _ngcontent-c1="" id="purchaseLegendaryLootModal" style="height: 31%; border-radius: 7px;">
  <!---->
  <app-skins _ngcontent-c1="" _nghost-c2="">
    <div _ngcontent-c2="" class="header" style="background-color: rgb(32, 35, 50);">
      <div _ngcontent-c2="" class="label">
        <button _ngcontent-c2="" id="cancelPurchasemodal" style="margin-top: 0px; color: red;">Cancel Purchase</button>
      </div>
      <div _ngcontent-c2="" class="center"></div>
    </div>
    <div _ngcontent-c2="" class="body" style="background: url(&quot;&amp;ct=s&quot;) 60px 0px / contain no-repeat rgb(41, 44, 61);">
      <div _ngcontent-c2="" class="right">
        <div _ngcontent-c2="" class="inner-container zero-top-left-border" style="width: calc(100% - 50px); border-radius: 10px; background-color: rgba(0, 0, 0, 0.25);">
          <div _ngcontent-c2="" class="skins-container scroll">
            <!---->
            <div _ngcontent-c2="" class="skin" style="height:100px;width:350px;">
              <div _ngcontent-c2="" class="hidden"> lvl</div>
              <!---->
              <!---->
              <div _ngcontent-c2="" class="title">Purchase For: 2.77$</div>
              <div _ngcontent-c2="" style="text-align: center">
                <!---->
              </div>
            </div>
            <div _ngcontent-c2="" class="skin" id="reedemCodeClick" style="height:100px;width:350px;">
              <div _ngcontent-c2="" class="hidden"> lvl</div>
              <!---->
              <!---->
              <div _ngcontent-c2="" class="title">Have a reedemable code?</div>
              <div _ngcontent-c2="" style="text-align: center">
                <!---->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </app-skins>
  <!---->
  <!---->
  <!---->
  <!---->
</div>
`);
                         document.querySelector("#reedemCodeClick").addEventListener('click', function () {

                             document.getElementById('purchaseLegendaryLootModal').remove();
                             $(document.querySelector("body > app-root > app-main > div.modal-bg.main-modal-bg")).append(`
<div _ngcontent-c1="" id="reedemCodeTing" style="height: 31%; border-radius: 7px;">
  <!---->
  <app-skins _ngcontent-c1="" _nghost-c2="">
    <div _ngcontent-c2="" class="header" style="background-color: rgb(32, 35, 50);">
      <div _ngcontent-c2="" class="label">
        <button _ngcontent-c2="" id="cancelPurchasereedem" style="margin-top: 0px; color: red;">Cancel Purchase</button>
      </div>
      <div _ngcontent-c2="" class="center"></div>
    </div>
    <div _ngcontent-c2="" class="body" style="background: url(&quot;&amp;ct=s&quot;) 60px 0px / contain no-repeat rgb(41, 44, 61);">
      <div _ngcontent-c2="" class="right">
        <div _ngcontent-c2="" class="inner-container zero-top-left-border" style="width: calc(100% - 50px); border-radius: 10px; background-color: rgba(0, 0, 0, 0.25);">
          <div _ngcontent-c2="" class="skins-container scroll">
            <!---->
            <div _ngcontent-c2="" class="g" style="height:100px;width:350px;">
              <div _ngcontent-c2="" class="hidden"> lvl</div>
              <!---->
              <!---->
              <div _ngcontent-c2="" class="title">Redeem code:</div>
              <input _ngcontent-c2="" class="title" id="reedemCodeInput">
              <button _ngcontent-c2="" class="title" id="completeCodeClick">Complete</button>
              <div _ngcontent-c2="" style="text-align: center">
                <!---->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </app-skins>
  <!---->
  <!---->
  <!---->
  <!---->
</div>
`);
                            document.querySelector("#completeCodeClick").addEventListener('click', function () {
                                if (document.querySelector("#reedemCodeInput").value === 'testcodehehehihi') {

                                    butterup.toast({
                                        title: 'Sigma-client',
                                        message: "Valid code! Opening box.",
                                        type: 'success',
                                        //icon: true,
                                        //customIcon: birdieSVG,
                                    });
                                    /*    butterup.toast({
                                        title: 'Sigma-client',
                                        message: "Opening box..",
                                        type: 'success',
                                        //icon: true,
                                        //customIcon: birdieSVG,
                                     });*/
                                    document.getElementById('reedemCodeTing').remove();
                                    setTimeout(function () {
                                        lootAnimationETC();
                                    }, 1500);
                                } else {
                                    butterup.toast({
                                        title: 'Sigma-client',
                                        message: "Hmmm, something doesn't seem right.. Make sure you entered the code correctly, being mindul of lower and UPPERCASE ! ",
                                        type: 'error',
                                        //icon: true,
                                        //customIcon: birdieSVG,
                                    });

                                }

                            });
                            document.querySelector("#cancelPurchasereedem").addEventListener('click', function () {
                                document.getElementById('reedemCodeTing').remove();

                            });
                        });

                         document.querySelector("#cancelPurchasemodal").addEventListener('click', function () {

                             document.getElementById('purchaseLegendaryLootModal').remove();

                         });
                     }
                  });

function lootAnimationETC() {
    document.getElementById('modal').style.pointerEvents = 'none';
    document.querySelector("body > app-root > app-main > div.modal-bg.main-modal-bg").style.pointerEvents = 'none';
    $("#modal").fadeOut();
    $(document.querySelector("body > app-root > app-main > div.wrapper")).fadeOut();

    //$(document.querySelector("body")).fadeOut();

    setTimeout(function () {

        //$(document.querySelector("body")).fadeIn();
        const snowflakebox = document.createElement('ul')
        snowflakebox.id = 'snowflakeContainer';
        snowflakebox.style.pointerEvents = 'none';
        snowflakebox.style.display = 'block';
        document.body.appendChild(snowflakebox);
        const snowflakeTing = document.createElement('li');
        snowflakeTing.classList = 'snowflake';
        snowflakeTing.innerText = 'opening';
        snowflakebox.append(snowflakeTing);

        const snowflakeStyles = document.createElement('style');
        snowflakeStyles.innerHTML = `

#snowflakeContainer {
    position: absolute;
    left: 0px;
    top: 0px;
    display: none;
  }
  .snowflake {
    position: fixed;
    background: none;
    user-select: none;
    z-index: 1000;
    pointer-events: none;
    width: 1em;
    height: 1em;
    font-size: 1.5em;
    color: #fff;
    text-shadow: 0 0 20px CornflowerBlue;
  }

       `
                        document.body.appendChild(snowflakeStyles);
                         $('#snowflakeContainer').fadeIn(2000);
                         const lootContainerStyle = document.createElement('style');
                         lootContainerStyle.id = 'lootboxstyleitotallycopiedfromsomeoneelse';
                         lootContainerStyle.innerHTML = `
body {
  font-family: Arial, sans-serif;
  background-color: #1e1e1e;
  color: white;
  text-align: center;
  margin: 0;
  padding: 0;
}

.container {
  padding: 20px;
}

button {
  padding: 10px 20px;
  font-size: 16px;
  cursor: pointer;
  background-color: #007bff;
  border: none;
  color: white;
  border-radius: 5px;
  margin-top: 20px;
}

button:hover {
  background-color: #0056b3;
}

#case-container {
  position: relative;
  margin: 100px auto;
  width: 970px;
  height: 150px;
  background-color: #333;
  overflow: hidden;
  border: 2px solid #fff;
  border-radius: 10px;
}

#arrow, #arrow-bottom {
  font-size: 40px; /* Reduced size for smaller arrows */
  color: red;
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  pointer-events: none;
}

#arrow {
  top: -30px; /* Adjust the position of the top arrow */
}

#arrow-bottom {
  bottom: -30px; /* Adjust the position of the bottom arrow */
}

#case {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: relative;
}

.spinner {
  display: flex;
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  transform: translateX(0); /* Initial position */
}

.spinner .skin {
  flex: 0 0 100px; /* Each skin is 100px wide */
  display: flex;
  justify-content: center;
  align-items: center;
}

.spinner .skin img {
  width: 70px;
  height: 70px;
  border-radius: 5px;
}

.hidden {
  display: none;
}

#result {
  margin-top: 20px;
}

                         `

                        document.body.appendChild(lootContainerStyle);

                         $(document.querySelector("body > app-root > app-main > div.modal-bg.main-modal-bg")).append(`
  <div class="container">
    <h1 class="shining" >Legendary Lootbox</h1>
    <div id="case-container">
  <div id="arrow">â–¼</div>  <!-- Top arrow -->
  <div id="arrow-bottom">â–²</div>  <!-- Bottom arrow -->
  <div id="case">
    <div class="spinner"></div>
  </div>
</div>
    <div id="result" class="hidden">
      <h2>You've got:</h2>
      <p id="reward"></p>
    </div>
  </div>
`);

                         //                       skinnNames.forEach(skinNameEach);

                         /*                         const skins = [
                          { name: "blabal", image: "https://ggstandoff.pro/public/storage/items/1710435390f17bf75399b8ef49966c2d8b02b52589.png" },
                          { name: "AWP Asiimov", image: "https://ggstandoff.pro/public/storage/items/1710435390f17bf75399b8ef49966c2d8b02b52589.png" },
                          { name: "Desert Eagle Blaze", image: "https://ggstandoff.pro/public/storage/items/1710439666fc669ef3147a4f7ca78f2965708ae93b.png" },
                          { name: "M4A4 Howl", image: "https://ggstandoff.pro/public/storage/items/1710437939fc669ef3147a4f7ca78f2965708ae93b.png" },
                          { name: "Knife Fade", image: "https://ggstandoff.pro/public/storage/items/1710437331f93f1ffa5ce7721162371a83fb143443.png" }
                        ];*/
                         //        const skins = dataa.result
                         const skins = ["1cat", "acorn", "alienx", "alligator", "alone", "amber", "ambitious", "angerball", "angry_panda", "angry_panda_", "another_dragon", "ant_mutant", "anubis", "apple", "appleface", "aprilfool", "archer", "army", "astral_deer", "astronaut", "awolf", "baby_shark", "baby_trex", "badger", "banana", "banshee", "basilisk", "basketball", "bat", "bat_ball", "bbear", "bear", "bearr", "bear_", "beast", "beast_", "behemoth", "bewitched", "big_octopus", "bionic_ram", "birdie", "bird_mask", "bitter", "blackcat", "blob_girl", "bloody_bunny", "blood_seeker", "blueberry", "blueswirl", "blue_kitty", "blue_raptor", "blue_tiger", "blue_wolf", "boar", "boom", "brave", "bullet_man", "bullking", "bull_", "burglar", "burly_man", "burnman", "cactus", "cake", "capitan_rhino", "capn_joe", "capricorn", "carp", "cat", "cat2", "cat_burglar", "cave_troll", "chernobyl", "chick", "chicken", "chill_krak", "chipmonk", "chip_cookie", "chirpy_raptor", "chupacabra", "ch_sym", "cia", "clown", "coil", "colossus", "comet", "cookie_man", "cool_android", "cool_duck", "cool_lion", "cool_lion_", "cosmic_drago", "cosmic_horse", "cougar", "cow", "crab", "crazy", "crazy_eye", "croc", "crow", "cruel_wolf", "cute_cat", "cute_dog", "cute_panda", "cute_patriot", "cyclops", "deadly_piranha", "dead_smile", "death_god", "death_mouse", "deer", "destroyer", "detective", "devil", "dino", "diver", "doge", "dracula", "drago", "dragon", "dragon_", "dragon_eye", "droid", "dr_cosmos", "dr_electro", "dr_static", "eagle", "eagle_alien", "elephant", "elf_helper", "elven_noble", "evil", "evileye", "evil_cat", "eye", "eye_five", "fallen", "faun", "fiend", "fighter", "fight_master", "firebird", "fire_face", "fish", "flamingo", "fly", "fly_killer", "forest_spirit", "fox", "foxx", "fox_mask", "frankenstein", "franky", "frenchfries", "fright", "frog_fighter", "fury_cat", "garold", "gaunt", "geisha", "ghost_child", "giant_skull", "gipno", "godzilla", "gorilla", "graffiti", "greenman", "green_dragon", "griffin", "grizzly", "grumpy_cat", "grumpy_frog", "guardian", "guard_dog", "halloween", "hangry_pumpkin", "hangry_wolf", "happy_cat", "hat", "hbeast", "hdevil", "hellkit", "hragnarog", "hulk", "hungry_shark", "hunter", "husky", "hwolf", "icefish", "ice_lord", "idea", "inferno", "insane_fish", "insane_santa", "iron_hand", "jackal", "jealous", "jellyblob", "jellyface", "joker", "jollier", "juicecan", "kempo_tiger", "kid_athlete", "killer_mask", "king_of_lions", "kino", "kitty_paint", "kraken", "kraken_", "kraken_child", "kraken_mom", "kraken_violet", "lama", "lava_monster", "leader", "leo", "leopard", "lion", "lion2", "lion_roar", "lizard", "lobster", "locked_up", "love_cat", "madman", "mad_jawz", "mad_owl", "mammoth", "maple", "maroo_", "mask", "mechatron", "medusa", "megamind", "mega_power", "miasma", "monkey", "monkey_king", "monster", "moon_ship", "mops", "mouse", "mummy_king", "mustang", "mutant_herb", "necktie_cat", "neila", "neon_bug", "nice_doggy", "nightmare", "night_hunter", "nuclearr", "nurse", "ny_bead", "ny_bell", "ny_champ", "ny_cool_santa", "ny_deer", "ny_drop", "ny_elf", "ny_grinch", "ny_penguin", "ny_santa", "ny_santa_hat", "ny_snowman", "ny_snowman_", "ny_yeti", "occultist", "octopus", "orc_cyclops", "orc_warrior", "overlord", "owl", "panther", "parrot", "penguin", "pepe_loco", "phantom", "pinhata", "poseidon", "potent", "power_fighter", "predator", "pretty_fighter", "priestess", "prince", "pro_blober", "psycho", "pug", "punch", "rabbit", "racer", "rage", "raptor", "reaper", "reckless", "red_demon", "red_fiend", "reptilian", "revenger", "richy", "roar", "rocket", "roller_bot", "rooster", "rowdy_shroom", "sad_cat", "sad_cookie", "salvador", "scarecrow", "scythe", "sea_turtle", "sentinel", "shadow_ball", "shark", "sheep", "sheep_hunter", "shrieker", "shuriken_ball", "silly", "skeleton_", "skull", "skull_pirate", "sliced", "sly", "small_chick", "small_owl", "smileface", "snowman", "sock", "sonic_boom", "soul_hunter", "spacehunter", "spacewolf", "space_wolf", "spider", "spirxo", "sprut", "squid_guard", "squirto", "starfish", "sunbath", "surfin_bird", "swords", "tangi", "techno_ninja", "tiger", "tigerpattern", "tiger_hunter", "tiny_jack", "tiny_skelet", "toco", "tor", "toxic", "trex", "trex_big", "trollface", "ufo", "uganda", "vamp", "veteran_dog", "viper", "viper_", "voracious", "wacky_egg", "wacky_hyena", "walking_hand", "walrus_art", "warrior_girl", "wasp", "wendigo", "werewolf_", "white_owl", "wolff", "wolff_", "wolfy", "wolf_", "wolf_s", "wudu", "yeti", "zombie", "zombie_", "fancy_hamster", "fire_dragon", "frostyfire", "gothic_girl", "ice_demon", "kraxe_mutant", "kraxe", "kraxy", "magma_monster", "ouroboros", "pirate_bull", "galaxy_defender", "myth_lion", "pegasus", "dancing_pixels", "flame_eye", "golden_flow", "pulsating_noise", "gradients_fire", "watery", "pulse", "stars", "rainbow_spiral", "flaring", "flaring2", "flaring3", "string_theory", "voronoi_portal", "metae7", "vdroptunnel", "satisfy", "blade", "cobra", "fury_phoenix", "gelatto", "gray_lynx", "lynx", "aida", "arctic_wolf", "sweet_cat", "vampire", "h_ghost", "h_scyther", "h_fire_pumpkin", "ny_cutie", "ny_dragon", "ny_gingerman", "ny_maiden", "ny_snowtroll", "ny_tree", "sidhe", "bodybuilder", "boxer", "crasher", "desert_belle", "doctor", "driada", "gevaudan", "hellfire_horse", "minotaur", "nomad", "scooterist", "skater", "sportcar", "streamer", "tarantula", "unicorn", "vendetta", "witch", "bulldog", "vortex", "outer_space"];

                         const openCaseButton = document.getElementById("openCase");
                         const spinner = document.querySelector(".spinner");
                         const resultBox = document.getElementById("result");
                         const rewardText = document.getElementById("reward");

                         function populateSpinner() {
                             spinner.innerHTML = ""; // Clear previous skins
                             for (let i = 0; i < 457; i++) { // 30 skins for the spin
                                 const randomIndex = Math.floor(Math.random() * skins.length);
                                 const skin = document.createElement("div");
                                 skin.classList.add("skin");
                                 skin.innerHTML = `
      <img src="https://client.blobgame.io/skins/premium/${(skins[randomIndex])}.png" alt="${skins[randomIndex]}">
    `;
                               spinner.appendChild(skin);
                           }
                        }
                         setTimeout(function () {
                             //function openCase() {
                             populateSpinner();
                             resultBox.classList.add("hidden");

                             // Reset spinner's transform property before starting the new spin
                             spinner.style.transition = "none"; // Disable transition during reset
                             spinner.style.transform = `translateX(0)`; // Reset to the starting position

                             // Force reflow to apply the reset position (necessary for some browsers)
                             spinner.offsetHeight; // Accessing this property forces a reflow

                             // Start animation after a small delay to give time for the reset
                             setTimeout(() => {
                                 const skinsWidth = 100; // Width of one skin
                                 const visibleSkinsCount = 457; // Total number of visible skins
                                 const totalDistance = -skinsWidth * visibleSkinsCount; // Total distance to scroll to the last skin

                                 // Randomly select a skin to stop at
                                 const stopAtSkin = Math.floor(Math.random() * skins.length);

                                 // Calculate stopping position to ensure stopping exactly on the center of the selected skin
                                 // The formula is adjusted to stop the selected skin at the center
                                 const stopPosition = -(skinsWidth * (visibleSkinsCount / 2 + stopAtSkin)); // Adjusted position for stopping on a skin

                                 spinner.style.transition = "transform 3s cubic-bezier(0.25, 0.1, 0.25, 1)"; // Enable transition again
                                 spinner.style.transform = `translateX(${stopPosition}px)`; // Start the spin to the exact position

                                 // Determine the rewarded skin
                                 setTimeout(() => {
                                     const reward = skins[stopAtSkin]; // Use the stopAtSkin index to determine the rewarded skin
                                     rewardText.textContent = reward;
                                     rewardText.style.color = "#ffd700"; // Highlight the reward
                                     resultBox.classList.remove("hidden");
                                     $('#modal').append(`
                       <div class="skin" _ngcontent-c2="" style="display:none;position:fixed;width:500px;height:400px;margin-left:230px;margin-top:20px;background-color:blue;"id="wonSkin">
  <div _ngcontent-c2="" class="show" style="margin-top:30px;">Congrats!</div>
  <!---->
  <img _ngcontent-c2="" src="https://client.blobgame.io/skins/premium/${reward}.png">
  <!---->
  <div _ngcontent-c2="" class="title" style="font-size:4em;height:100px;">${reward}</div>
  <div _ngcontent-c2="" style="text-align: center">
    <!---->
  </div>
</div>

                       `);
                              }, 3000); // Show reward after 3 seconds
                           }, 100); // Delay the start of the spin to ensure reset is applied
                        }, 1000);

                         /* var lootboxvidtest = document.createElement('video');
                         lootboxvidtest.src = 'https://media-hosting.imagekit.io//caa1a5a2b23742be/LOOTBOX%20ANIMATION%20(1).mp4?Expires=1836252332&Key-Pair-Id=K2ZIVPTIP2VGHC&Signature=X7OmCxBPfNy5Kmx5cxicpu~fgSaYHc1F1L4gSQJUYgqwFH0sKI53rRaZS2KtynFEkQ5YmVB9Bu77dR0wXeRRaP6I1gmGymx0iDEHqdz7SRUkhPHAGGM6aSWPEf0y6AzM~n9lA2lM3iFI-YDsxlQ77vgqpI5d8u5K2pav3R2ZmLykmuOGkmC8WvftO9TuhvoLvHF-iRFvWg-lKLk3m~sz9s65OCvHDJkEyYiN0F~q28CqTRd4zz75Q1gXmOyNZ7WULHTDTy6UaAtntNe-~A9eHf~msujATqxWwvtLk01ZRVEp~PUiAziywTpDrmfwpFw6b-9eY9Hlz2OsVyWgXimrjg__';
                         lootboxvidtest.crossOrigin = "Anonymous";
                         lootboxvidtest.loop = true;
                         lootboxvidtest.muted = true;
                         lootboxvidtest.autoplay = true;
                         lootboxvidtest.style.position = 'absolute';
                         lootboxvidtest.style.top = '0';
                         lootboxvidtest.style.left = '0';
                         lootboxvidtest.style.width = '100%';
                         lootboxvidtest.style.height = '100%';
                         lootboxvidtest.style.objectFit = 'cover';
                         lootboxvidtest.style.zIndex = '-999';
                         lootboxvidtest.style.pointerEvents = 'none';
                         //setTimeout(function () {
                         document.querySelector("body > app-root > app-main > div.modal-bg.main-modal-bg").appendChild(lootboxvidtest);*/
                         /*
                                                var blablabla = document.createElement('a');
                                                blablabla.classList = 'shining';
                                                blablabla.style.opacity = '0.87';
                                                blablabla.innerText = 'Legendary Lootbox';
                                                blablabla.style.fontSize = '4.3em';
                                                blablabla.style.bottom = '18px';
                                                blablabla.style.marginLeft = '17px';
                                                blablabla.style.position = 'fixed';
                                                blablabla.style.textShadow = '4px 4px 45px rgba(131,124,124,1)';
                                                blablabla.style.display = 'none';
                                                $(blablabla).fadeOut(100);
                                                document.querySelector("body > app-root > app-main > div.modal-bg.main-modal-bg").appendChild(blablabla);
                                                setTimeout(function () {
                                                   $(blablabla).fadeIn(2000);
                                                }, 300);
                                                setTimeout(function () {
                                                   $(blablabla).fadeOut(2000);
                                                }, 3700);*/
                         setTimeout(function () {
                             document.getElementById('modal').style.removeProperty("pointer-events");
                             document.querySelector("body > app-root > app-main > div.modal-bg.main-modal-bg").style.removeProperty("pointer-events");
                             $("#modal").fadeIn();
                             $(document.querySelector("body > app-root > app-main > div.wrapper")).fadeIn();
                             setTimeout(function () {
                                 //  lootboxvidtest.remove();
                                 document.getElementById("lootboxstyleitotallycopiedfromsomeoneelse").remove();
                                 document.querySelector("body > app-root > app-main > div.modal-bg.main-modal-bg > div.container").remove();
                                 //blablabla.remove();
                                 $('#snowflakeContainer').fadeOut();
                                 /*               const wonSkinIMG = document.createElement('img');
                                             wonSkinIMG.src = 'https://client.blobgame.io/assets/skins/premium/bbear.png';
                                             wonSkinIMG.id = 'wonSkinImg';
                                             wonSkinIMG.style.position = 'fixed';
                                             wonSkinIMG.style.right = '470px';
                                             wonSkinIMG.style.width = '280px';
                                             document.querySelector("#modal").appendChild(wonSkinIMG);*/
                                 document.getElementById('wonSkin').style.display = 'block';
                                 party.confetti(document.getElementById('wonSkin'));
                                 document.getElementById('wonSkin').addEventListener('click', function () {
                                     party.sparkles(document.getElementById('wonSkin'));
                                     document.getElementById('wonSkin').remove();

                                 });
                             }, 500);
                         }, 5900);
                     }, 1000);

                  };

document.getElementById('buyMassBoost2x').addEventListener('click', function () {

    $.ajax({
        type: "POST",
        url: "https://api.blobgame.io:988/api/users/buyItem",
        data: {
            "api_ver": "4.7",
            "item_id": "103",
            "pl": "3",
            "token": token2
        },
        success: function (data) {
            console.log(data);
        },
        dataType: "json"
    });
    setTimeout(function () {
        butterup.toast({
            title: 'Sigma-client',
            message: "Bought item.",
            type: 'info',
            //icon: true,
            //customIcon: birdieSVG,
        });
    }, 1000);
});

document.getElementById('buyExpBoost2x').addEventListener('click', function () {

    $.ajax({
        type: "POST",
        url: "https://api.blobgame.io:988/api/users/buyItem",
        data: {
            "api_ver": "4.7",
            "item_id": "106",
            "pl": "3",
            "token": token2
        },
        success: function (data) {
            console.log(data);
        },
        dataType: "json"
    });
    setTimeout(function () {
        butterup.toast({
            title: 'Sigma-client',
            message: "Bought item.",
            type: 'info',
            //icon: true,
            //customIcon: birdieSVG,
        });
    }, 1000);
});
document.getElementById('freecoinshourly').addEventListener('click', freecoinsrequest);
}

});

document.querySelector("#clickbuypremiumskinss").addEventListener('click', function () {

    if ($('#perksSkinContainer').length > 0) {
        //console.log("DOES exist so did remove");

        document.getElementById('perksSkinContainer').remove();
        //old method - messes up, makes it display horizontally
        // document.querySelector("#modal > app-skins > div.body > div.right > div > div").style.display = 'block';

        //new method
        document.querySelector("#modal > app-skins > div.body > div.right > div > div").classList = 'skins-container scroll';
        //                       document.querySelector("#modal > app-skins > div.body > div.right > div > div").style.opacity = '1';
        document.querySelector("#modal > app-skins > div.body > div.right > div > div").style.removeProperty("pointer-events")

    } else {
        //console.log("doesnt exist so didnt remove");

    }

});

// CUSTOM SKIN STUFF
document.getElementById('clickbuycustom').addEventListener('click', function () {

    /*

var usesLeft = []


fetch https://3000-firebase-sigma-clientsapi-1763504441915.cluster-55m56i2mgjalcvl276gecmncu6.cloudworkstations.dev/custom-skin-finish
if response = u have not purchased skin
then
usesleft = 0



*/

    $(document.querySelector("body > app-root > app-main > div.modal-bg.main-modal-bg")).append(`
   <div _ngcontent-c1="" id="buyCustomModal" style="height: 61%; border-radius: 7px;">
      <a _ngcontent-c1="" id="close-modal" style="color: rgba(163, 173, 255, 0.4);">â¨¯</a><!---->
      <app-skins _ngcontent-c1="" _nghost-c2="">
         <div _ngcontent-c2="" class="header" style="background-color: rgb(32, 35, 50);">
            <div _ngcontent-c2="" class="label">
            <a _ngcontent-c1="" id="goBackToSkin" style="display:flex;color: rgba(163, 173, 255, 0.4);right:750px;font-size:0.7em;">&lt;-</a>
               <h3 _ngcontent-c2="" style="margin-top: 0px; color: rgb(163, 173, 255);">Custom</h3>
            </div>
            <div _ngcontent-c2="" class="center"></div>
            <div _ngcontent-c2="" class="search"></div>
         </div>
         <div _ngcontent-c2="" class="body" style="background: url(&quot;https://i.pinimg.com/originals/a2/18/f7/a218f772a59aad480fcded754fa01824.gif&quot;) 60px 0px / contain no-repeat rgb(41, 44, 61);">
            <div _ngcontent-c2="" class="right">
               <div _ngcontent-c2="" class="skins-container scroll">
                  <!---->
                  <div _ngcontent-c2="" class="skin" style="padding: 63px; background-color: rgb(32, 35, 50); max-height:183px;">
                  <a id="team1catcolor" style="font-family: sans-serif;font-size: 1.5em;font-weight: bold;position:relative;top:100px;">team 1cat</a>
                     <div _ngcontent-c2="" class="show">  Nickname Color</div>
                     <!----><img _ngcontent-c2="" src="https://corsproxy.io/?url=http://custom.client.blobgame.io/skins/premium/bbear.png"><!---->
                     <div _ngcontent-c2=""  style="letter-spacing: 0px; font-size: 1.0em;;"> 11.99$</div>
                     <input type="color" id="setNickColor" name="setNickColor" value="#ffffff">
                     <div _ngcontent-c2="" style="text-align: center">
                        <!---->
                     </div>
                  </div>

                  <div _ngcontent-c2="" class="skin" style="padding: 63px; background-color: rgb(32, 35, 50);">
                     <div _ngcontent-c2="" class="show">  Create Skin (uses left: 0)</div>
                     <!----><img _ngcontent-c2="" src="https://i.imgur.com/odbH4le.jpeg"><!---->
                     <div _ngcontent-c2="" class="area" style="letter-spacing: 0px; font-size: 1.0em;;"> 21.99$</div>
                     <div _ngcontent-c2="" style="text-align: center">
                        <!---->
                     </div>
                  </div>
                  <div _ngcontent-c2="" class="skin" style="padding: 63px; background-color: rgb(32, 35, 50);">
                     <div _ngcontent-c2="" class="show">  Clan Prefix</div>
                     <!----><img _ngcontent-c2="" src="https://i.imgur.com/fh94dE1.png"><!---->
                     <div _ngcontent-c2="" style="letter-spacing: 0px; font-size: 1.0em;;"> 21.99$</div>
                     <div _ngcontent-c2="" style="text-align: center">
                        <!---->
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </app-skins>
      <!----><!----><!----><!---->
   </div>

`);
                document.querySelector("#goBackToSkin").addEventListener('click', function () {

                    document.querySelector("#buyCustomModal").remove();

                });

                document.querySelector("#buyCustomModal > app-skins > div.header > div.search").addEventListener('click', function () {
                    //console.log("clicked close");
                    document.querySelector("#buyCustomModal").remove();
                    document.querySelector("body > app-root > app-main > div.modal-bg.main-modal-bg").click();

                });

                document.querySelector("#buyCustomModal > app-skins > div.body > div > div > div:nth-child(2)").addEventListener('click', drawCustomSkin);

                //CHANGES NICKNAME COLOR PREVIEW (DOESNT CURRENTLY WORK FOR SOME REASON....
                //document.querySelector("#modal").style.display = 'none';
                document.querySelector("#setNickColor").addEventListener("input", () => {
                    //console.log("changed color");
                    // This updates the background color which is
                    // picked by the user from the picker
                    document.querySelector("#team1catcolor").style.color = document.querySelector("#setNickColor").value;
                });
            });

//document.querySelector("#modal > app-skins > div.body > div.right > div > div").innerHTML += '<div _ngcontent-c2="" class="skin"><div _ngcontent-c2="" class="show">Mass boost x2</div><!----><img _ngcontent-c2="" src="https://i.imgur.com/c8lywkG.png"><!----><div _ngcontent-c2="" class="title">500 coins</div><div _ngcontent-c2="" style="text-align: center"><!----></div></div>';
//document.querySelector("#modal > app-skins > div.body > div.right > div > div").children[0].innerHTML += '<div _ngcontent-c2="" class="skin"><div _ngcontent-c2="" class="show">Exp boost x2</div><!----><img _ngcontent-c2="" src="https://i.imgur.com/MCvKymP.png"><!----><div _ngcontent-c2="" class="title">500 coins</div><div _ngcontent-c2="" style="text-align: center"><!----></div></div>';
/*var massboost = document.createElement("span");
            massboost.innerHTML = '<div _ngcontent-c2="" id="buyMassBoost2x" class="skin"><div _ngcontent-c2="" class="show">Mass boost x2</div><!----><img _ngcontent-c2="" src="https://i.imgur.com/c8lywkG.png"><!----><div _ngcontent-c2="" class="title">500 coins</div><div _ngcontent-c2="" style="text-align: center"><!----></div></div>';
            var div = document.querySelector("#modal > app-skins > div.body > div.right > div > div > div:nth-child(1)");
            insertAfter(div, massboost);
            var expboost = document.createElement("span");
            expboost.innerHTML = '<div _ngcontent-c2="" id="buyExpBoost2x" class="skin"><div _ngcontent-c2="" class="show">Exp boost x2</div><!----><img _ngcontent-c2="" src="https://i.imgur.com/MCvKymP.png"><!----><div _ngcontent-c2="" class="title">500 coins</div><div _ngcontent-c2="" style="text-align: center"><!----></div></div>';
            var div2 = document.querySelector("#modal > app-skins > div.body > div.right > div > div > div:nth-child(1)");
            insertAfter(div2, expboost);*/
//info toast
setTimeout(function () {
    butterup.toast({
        title: 'Sigma-client',
        message: "This is an experimental shop, it's currently not organized nor has any price tags, but you can still use it to purchase skins.",
        type: 'info',
        //icon: true,
        //customIcon: birdieSVG,
    });
}, 1000);
}

//alert("Hello, this is an experimental shop for web!")
console.log("opened shop")
//UFO UFO UFO UFO UFO UFO UFO UFO SKIN
const clickedPremium = document.querySelector("#modal > app-skins > div.body > div.left > ul > li.show").addEventListener("click", premiumClicked);

function premiumClicked() {

    const buySkin = document.querySelector("#modal > app-skins > div.body > div.right > div > div > div:nth-child(362) > img").addEventListener("click", buySkinUFO);
    //theres over 300 skins....
    function buySkinUFO() {
        alert("Bought!")
        console.log("bought item ufo")
        //SENDS API POST REQUEST TO BUY SKIN
        $.ajax({
            type: "POST",
            url: "https://api.blobgame.io:988/api/users/buyItem",
            data: {
                "api_ver": "4.7",
                "item_id": "249",
                "pl": "3",
                "token": token2
            },
            success: function (data) {
                console.log(data);
            },
            dataType: "json"
        });
    }
}
}
const inputElement = document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(3) > div > div > div:nth-child(2) > button:nth-child(1)").addEventListener("click", showShop);
//friends section
function waitForElm(selector) {
    return new Promise(resolve => {
        if (document.querySelector(selector)) {
            return resolve(document.querySelector(selector));
        }
        const observer = new MutationObserver(mutations => {
            if (document.querySelector(selector)) {
                observer.disconnect();
                resolve(document.querySelector(selector));
            }
        });
        // If you get "parameter 1 is not of type 'Node'" error, see https://stackoverflow.com/a/77855838/492336
        //   if (document.querySelector("body > app-root > app-main > div.modal-bg.profile-modal-bg").style.display = 'none') {
        observer.observe(document.body, {
            childList: true,
            subtree: true
        });
        //  }
    });
}
waitForElm('#profile-modal > app-profile > div.profile-records > div:nth-child(1) > div.profile-records-title-userid').then((elm) => {
    console.log('Element is ready');
    setTimeout(function () {
        const friendid = document.querySelector("#profile-modal > app-profile > div.profile-records > div:nth-child(1) > div.profile-records-title-userid").innerText.slice(3);
        console.log(friendid);
        var friendmodal = document.querySelector("#profile-modal > app-profile > div.profile-records > div:nth-child(3)");
        friendmodal.innerHTML += '<button _ngcontent-c7 data-tip="Pin your friend to the top of friendlist!" class="tool" id="clickedUnfriend" type="button" style="margin-left: 110px; margin-bottom: -20px;">Star ðŸ¥°</button>';
        //my_div.innerHTML = my_div.innerHTML + '<input id="inputFriendIDADD" type="text">';
        //   my_div.innerHTML = my_div.innerHTML + '<button id="clickedAddFriend" type="button">Add friend!</button>';
        document.getElementById('clickedUnfriend').style.textAlign = 'center';
        document.getElementById('clickedUnfriend').style.border = '0';
        document.getElementById('clickedUnfriend').style.backgroundColor = '#85e061';
        document.getElementById('clickedUnfriend').style.color = '#042e2d';
        document.getElementById('clickedUnfriend').style.height = '27px';
        document.getElementById('clickedUnfriend').style.marginTop = '13px';
        document.getElementById('clickedUnfriend').style.width = '80px';
        document.getElementById('clickedUnfriend').style.borderRadius = '25px';
        document.getElementById('clickedUnfriend').style.fontWeight = '700';
        document.getElementById('clickedUnfriend').style.fontSize = '9pt';
        document.getElementById('clickedUnfriend').style.outline = '0';
        document.getElementById('clickedUnfriend').addEventListener('click', addFriendtofavs);
    }, 400);
});
if (document.querySelector("body > app-root > app-main > div.modal-bg.profile-modal-bg").style.display == 'block') {
    console.log("opened");
} else {
    console.log("closed");
    waitForElm();
}
document.querySelector("body > app-root > app-main > div.wrapper > header > div.right > button.friends.icon-button").addEventListener("click", starfriendfunc);

function addFriendtofavs() {
    const favname = localStorage.getItem('favrname')
    const favid = localStorage.getItem('favrid')
    var allids = document.querySelector("#profile-modal > app-profile > div.profile-records > div:nth-child(1)").children[1].innerText.slice(4)
    var allname = document.querySelector("#profile-modal > app-profile > div.general-info").children[0].innerText
    if (favname === allname) {
        setTimeout(function () {
            // Toast function
            butterup.toast({
                title: 'Sigma-client',
                message: "Already in favourites!",
                type: 'error',
                //icon: true,
                //customIcon: birdieSVG,
            });
        }, 1000);
    } else {
        localStorage.setItem('favrname', allname)
        setTimeout(function () {
            butterup.toast({
                title: 'Sigma-client',
                message: "Added to favourites!",
                type: 'success',
                //icon: true,
                //customIcon: birdieSVG,
            });
        }, 1000);
    }
}

function starfriendfunc() {
    const allfriends = document.querySelector("#modal > app-friend > div.body > div.content > div > table > tbody");
    const config = {
        attributes: true,
        childList: true,
        subtree: true
    };
    // Callback function to execute when mutations are observed
    const callback = (mutationList, observer) => {
        if (allfriends.innerHTML.includes(localStorage.getItem('favrname'))) {
            const favedperson = allfriends.callback;
            //console.log("msgWyourID");
            // Later, you can stop observing
            console.log("found", favedperson);
            observer.disconnect();
        }
    };
    // Create an observer instance linked to the callback function
    const observer = new MutationObserver(callback);
    // Start observing the target node for configured mutations
    observer.observe(allfriends, config);
    document.querySelector("#modal > app-friend > div.body > div.top-wrapper > div.top > ul > li:nth-child(1)").addEventListener("click", starfriendfunc);
    setTimeout(function () {
        const starAFriendall = document.querySelector("#modal > app-friend > div.body > div.content > div > table > tbody");
        const starAFriend = starAFriendall.querySelectorAll('tr');
        starAFriend.forEach(rrybdy => {
            rrybdy.addEventListener('mouseenter', () => {
                const acceptbtn = rrybdy.children[4];
                rrybdy.children[3].style.display = 'none';
                acceptbtn.style.display = 'block';
                acceptbtn.children[0].innerText = 'Unfriend';
                acceptbtn.style.marginLeft = '298px';
                acceptbtn.style.position = 'fixed';
                acceptbtn.children[0].addEventListener('click', () => {
                    rrybdy.click();
                    setTimeout(function () {
                        var targetiddd = document.querySelector("#profile-modal > app-profile > div.profile-records > div:nth-child(1)").children[1].innerText.slice(4)
                        console.log(targetiddd);
                        $.ajax({
                            type: "POST",
                            url: "https://api.blobgame.io:988/api/users/setRelation/",
                            data: {
                                "api_ver": "4.7",
                                "pl": "1",
                                "status": "2",
                                "target_id": targetiddd,
                                "token": token3
                            },
                            success: function (data) {
                                console.log(data);
                                setTimeout(function () {
                                    // Toast function
                                    butterup.toast({
                                        title: 'Sigma-client',
                                        message: "Unfriended, " + document.querySelector("#profile-modal > app-profile > div.general-info > div.username").innerText + "!",
                                        type: 'success',
                                        //icon: true,
                                        //customIcon: birdieSVG,
                                    });
                                }, 500);
                                //  alert("Unfriended, " + friendusername + "!")
                                //alert(data)
                                starfriendfunc();
                            },
                            //dataType: "text"
                        });
                        setTimeout(function () {
                            //document.querySelector("body > app-root > app-main > div.modal-bg.profile-modal-bg").style.display = 'none';
                            document.querySelector("body > app-root > app-main > div.modal-bg.profile-modal-bg").click();
                        }, 1000);
                        //}, 600);
                    }, 500);
                    //console.log(targetiddd);
                })
                //const codeprt = rrybdy.parentNode.id;
                //const nameeprt = rrybdy.parentNode.parentNode.id;
                console.log("mouse over");
                rrybdy.addEventListener('mouseleave', () => {
                    acceptbtn.style.display = 'none';
                    rrybdy.children[3].style.display = 'block';
                })
            })
        })
    }, 1000);
}

function sendRequest() {
    var friendid = document.querySelector("#profile-modal > app-profile > div.profile-records > div:nth-child(1) > div.profile-records-title-userid").innerText.slice(3);
    var friendusername = document.querySelector("#profile-modal > app-profile > div.general-info > div.username").innerText;
    console.log(friendid);
    $.ajax({
        type: "POST",
        url: "https://api.blobgame.io:988/api/users/setRelation/",
        data: {
            "api_ver": "4.7",
            "pl": "1",
            "status": "2",
            "target_id": friendid,
            "token": token3
        },
        success: function (data) {
            console.log(data);
            setTimeout(function () {
                // Toast function
                butterup.toast({
                    title: 'Sigma-client',
                    message: "Unfriended, " + friendusername + "!",
                    type: 'success',
                    //icon: true,
                    //customIcon: birdieSVG,
                });
            }, 1000);
            //  alert("Unfriended, " + friendusername + "!")
            //alert(data)
        },
        //dataType: "text"
    });
}
//checkCondition();
// document.getElementById('authenticatePage').addEventListener('click', yo);
function yo() {
    location.href = 'http://custom.client.blobgame.io/assets/'
}
}
}
if (loginActivity) {
    document.querySelector("head > title").innerText = 'Sigma-Client';
    const my_css3 = GM_getResourceText("IMPORTED_CSS3");
    GM_addStyle(my_css3);
    const my_css1 = GM_getResourceText("IMPORTED_CSS1");
    GM_addStyle(my_css1);
    /* below sitename
 <p class="menu">Services</p>
  <p class="menu">Pricing</p>
  <p class="menu">Features</p>
  <p class="menu">About us</p>
*/
    document.querySelector("body").innerHTML = `
<nav>
  <p class="sitename">Discord</p>
   <p id="gobackhref" class="menu">Go back</p>
    <p id="loggedinas"; class="menu"; style="display: none;">Logged in as</p>
  <svg class="material-icons" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 9H5c-.55 0-1 .45-1 1s.45 1 1 1h14c.55 0 1-.45 1-1s-.45-1-1-1zM5 15h14c.55 0 1-.45 1-1s-.45-1-1-1H5c-.55 0-1 .45-1 1s.45 1 1 1z"/></svg>
</nav>

<div class="grid">
  <svg class="grid-svg" xmlns="http://www.w3.org/2000/svg" width="982" height="786" viewBox="0 0 982 786" fill="none">
    <path fill-rule="evenodd" clip-rule="evenodd" d="M490 401V537H348.5V401H490ZM490 785.5V676H348.5V785.5H347.5V676H206V785.5H205V676H63.5V785.5H62.5V676H0V675H62.5V538H0V537H62.5V401H0V400H62.5V258H0V257H62.5V116H0V115H62.5V0H63.5V115L205 115V0H206V115L347.5 115V0H348.5V115H490V0H491V115L627.5 115V0H628.5V115H765V0H766V115L902.5 115V0H903.5V115H982V116H903.5V257H982V258H903.5V400H982V401H903.5V537H982V538H903.5V675H982V676H903.5V785.5H902.5V676H766V785.5H765V676H628.5V785.5H627.5V676H491V785.5H490ZM902.5 675V538H766V675H902.5ZM902.5 537V401H766V537H902.5ZM902.5 400V258H766V400H902.5ZM902.5 257V116L766 116V257H902.5ZM627.5 675H491V538H627.5V675ZM765 675H628.5V538H765V675ZM348.5 675H490V538H348.5V675ZM347.5 538V675H206V538H347.5ZM205 538V675H63.5V538H205ZM765 537V401H628.5V537H765ZM765 400V258H628.5V400H765ZM765 257V116H628.5V257H765ZM347.5 401V537H206V401H347.5ZM205 401V537H63.5V401H205ZM627.5 401V537H491V401H627.5ZM627.5 116L491 116V257H627.5V116ZM627.5 258H491V400H627.5V258ZM63.5 257V116L205 116V257H63.5ZM63.5 400V258H205V400H63.5ZM206 116V257H347.5V116L206 116ZM348.5 116V257H490V116H348.5ZM206 400V258H347.5V400H206ZM348.5 258V400H490V258H348.5Z" fill="url(#paint0_radial_1_8)" />
    <defs>
      <radialGradient id="paint0_radial_1_8" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(491 392.75) rotate(90) scale(513.25 679.989)">
        <stop stop-color="white" stop-opacity="0.2" />
        <stop offset="1" stop-color="#000" stop-opacity="0" />
      </radialGradient>
    </defs>
  </svg>
  <div class="blur"></div>
</div>

<div class="title">
  <p>Sigma</p>
  <p>Client</p>
  <p>Authenticator</p>
</div>

<a id="logoutClick" target="_blank" class="button first"><button>logout</button><span></span></a>

<a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ" target="_blank" class="button sec"><button>discord server</button><span></span></a>

<a href="https://x.com/juxtopposed" id="connectDc" target="_blank" class="button third"><button>Connect your Discord</button><span></span></a>

<svg class="top-right" width="219" height="147" viewBox="0 0 219 147" fill="none" xmlns="http://www.w3.org/2000/svg">
  <rect opacity="0.18" x="10.4252" y="75.8326" width="7.50168" height="7.50168" transform="rotate(110.283 10.4252 75.8326)" fill="#686868" stroke="white" stroke-width="1.22683" />
  <rect opacity="0.18" x="180.869" y="138.825" width="7.50168" height="7.50168" transform="rotate(110.283 180.869 138.825)" fill="#686868" stroke="white" stroke-width="1.22683" />
  <rect x="69.4713" y="-91.84" width="180.485" height="180.485" transform="rotate(20.2832 69.4713 -91.84)" stroke="white" stroke-opacity="0.1" stroke-width="1.22683" />
</svg>

<svg class="bottom-left" width="232" height="191" viewBox="0 0 232 191" fill="none" xmlns="http://www.w3.org/2000/svg">
  <circle cx="50.5685" cy="172.432" r="112.068" stroke="white" stroke-opacity="0.09" />
  <g opacity="0.1">
    <path d="M26.4932 5.20547L228.856 172.432" stroke="#D9D9D9" />
    <rect x="22.4384" y="0.5" width="6.15753" height="6.15753" fill="#686868" stroke="white" />
    <rect x="224.801" y="169.027" width="6.15753" height="6.15753" fill="#686868" stroke="white" />
    <circle cx="121.819" cy="83.613" r="1.7774" fill="#323232" stroke="white" />
  </g>
</svg>
       `
      //video on authentication page.
      //document.querySelector("body > div.grid").innerHTML += '<video src="https://cdn-cf-east.streamable.com/video/mp4/eea44s.mp4?Expires=1735521288481&amp;Key-Pair-Id=APKAIEYUVEN4EVB2OKEQ&amp;Signature=Ct4GuEh3n-ujR2yzAd38xZwnCo6T0PDwB0uy0ZgfiYdGJ2Z-noEWf3PWYlhJP63qF6sd~VGgnh0fsohp8H2D85QqjGn~jNNIkCRuiLY-QKntCW3C4VJtI6wn7PRRLRguQA5uuPEJp-jZsBrzbgRCn1UrPHSRqrI7w~z3vvQ3Pn2RMumbrv5pxvXp4gzloZQRTYRMxrzxST0uRdIzCldiCIuvXaMKzoAt4thVMJC2-0wq7NA-aN4~HUPiQUGD2N2ZjCxYU-c8ijJ~3cHuFWQB2YmpxLOFaS88QrS~mSJ0zQM4sMb8nE2~zfHx4fAn32CshjblquWc8G4dGIxncCvKAw__" loop="" autoplay="" style="position: fixed; top: 0px; left: 0px; width: 100%; height: 100%; object-fit: cover; z-index: -1; pointer-events: none;"></video>';
      //login button
      //checks if tester
      //  localStorage.setItem('loggedin', false);
      const aaaaarrghh = document.getElementById('gobackhref').addEventListener('click', broooooo);
    const clickedLogout = document.getElementById('logoutClick').addEventListener('click', logoutFunction);
    const ayoo = document.getElementById("connectDc").addEventListener('click', clickedlogin2);
    const fragment = new URLSearchParams(window.location.hash.slice(1));
    const [accessToken, tokenType] = [fragment.get('access_token'), fragment.get('token_type')];
    var logged = !!location.href.includes('http://custom.client.blobgame.io/assets/#token_type=Bearer&access_token=');

    function broooooo() {
        // history.back()
        location.href = 'https://blobgame.io/';
    }

    function clickedlogin2() {
        location.href = 'https://discord.com/oauth2/authorize?client_id=1328328634334842992&client_secret=RBX-npMbEBZi5UqtsD0VMDp4TaDb_8Nk_QP5uc-FXuNT-RiIApFFugl2FpOF2tu-XNHD&response_type=token&redirect_uri=http%3A%2F%2Fcustom.client.blobgame.io%2Fassets%2F&scope=identify+guilds.members.read';
    }

    function checksTester() {
        fetch('https://discord.com/api/users/@me/guilds/1286168636586987580/member', {
            headers: {
                authorization: `${tokenType} ${accessToken}`,
            },
        }).then(result => result.json()).then(response => {
            //handle response
            console.log("success")
            const {
                roles
            } = response;
            console.log(roles)
            if (roles.includes('1310056596558188576')) {
                localStorage.setItem('tester', 'ya');
                console.log("tester confirmed");
                //localStorage.setItem('loggedin', 'true');
                loginSuccess();
                if (roles.includes('1334642897089466458')) {
                    localStorage.setItem('isVerified', 'ya');
                    console.log("verified")
                    // able to send reports
                }
            } else {
                location.href = 'http://custom.client.blobgame.io/privatelist.js';
                return false;
            }
        }).catch(console.error);
    }

    function loginSuccess() {
        localStorage.setItem('loginDc', 'true');
        fetch('https://discord.com/api/users/@me', {
            headers: {
                authorization: `${tokenType} ${accessToken}`,
            },
        }).then(result => result.json()).then(response => {
            //handle response
            const {
                username,
                discriminator,
                avatar,
                id
            } = response;
            localStorage.setItem('discordName', username);
            //  document.querySelector("body > app-root > app-main > div.wrapper > article > div > ul > li:nth-child(1) > img").src = 'avatar'
        }).catch(console.error);
        fetch('https://discord.com/api/users/@me/guilds/517827047528202250/member', {
            headers: {
                authorization: `${tokenType} ${accessToken}`,
            },
        }).then(result => result.json()).then(response => {
            //handle response
            console.log("success")
            const {
                roles,
                joined_at
            } = response;
            localStorage.setItem('howlonginserver', joined_at);
            console.log(roles)
            //blober role
            if (roles.includes('849015265198342198')) {
                localStorage.setItem('isBlober', 'ya');
                console.log("okay works blober")
                //server booster [SB]
            }
            if (roles.includes('668839007974719507')) {
                localStorage.setItem('isServerBooster', 'ya');
                console.log("serverbooster")
                //content creator [CC]
            }
            if (roles.includes('849011081120841738')) {
                localStorage.setItem('isContentCreator', 'ya');
                console.log("contentcreator")
            }
        }).catch(console.error);
        redirecthomepage();
    }
    if (logged) {
        checksTester();
    }
    const sb = localStorage.getItem('isServerBooster');
    const cc = localStorage.getItem('isContentCreator');
    const bloberRole = localStorage.getItem('isBlober');
    const discordusername = localStorage.getItem('discordName');
    const loggedindc = localStorage.getItem('loggedin')

    function redirecthomepage() {
        setTimeout(function () {
            location.href = 'http://custom.client.blobgame.io/html/'
        }, 2000);
    }
    const loginActivity = localStorage.getItem('loginDc');
    if (loginActivity == 'true') {
        document.getElementById('loggedinas').style.display = 'block';
        document.getElementById('loggedinas').innerText = ('Logged in as, ' + discordusername);
        console.log("logged in");
        // document.querySelector("#starbtntext").innerText = ('Welcome ' + discordusername + "!");
    }
}
if (loginSuccessful) {
    const discordusername = localStorage.getItem('discordName');
    document.querySelector("head > title").innerText = 'Authenticating... Please wait...';
    const my_css2 = GM_getResourceText("IMPORTED_CSS2");
    GM_addStyle(my_css2);
    document.querySelector("body").innerHTML = `

  <div id="loadingtext" class="loader">Sigma is authenticating...</div>
  <div id="accountslinked" style="display:none;">
	<h2 style="color: #27ff00; font-size: 3em; display: flex; justify-content: center;">Accounts linked</h2>
   	<div class="row" style="            display: flex;
            align-items: center;">
		<div class="column">
			<img src="https://i.imgur.com/9MWvUCg.png" width="110">
		</div>

		<div class="column">
			<img src="https://i.imgur.com/cE7HMpQ.png" width="70;">
		</div>

		<div class="column">
			<img src="https://uxwing.com/wp-content/themes/uxwing/download/brands-and-social-media/discord-white-icon.png" width="70" style="margin-left: 27px;">
		</div>
	</div>
    </div>

 `
      // document.getElementById('birdie').style.position = 'fixed'
      //document.getElementById('birdie').style.marginLeft = '380px'
      document.querySelector("body").style.backgroundColor = '#060D0D';
    // document.getElementById('birdie').src = avatar
    setTimeout(function () {
        document.getElementById('accountslinked').style.display = 'block';
        document.getElementById('loadingtext').innerText = ('Success! Welcome, ' + discordusername + "!");
    }, 1500);
    setTimeout(function () {
        document.getElementById('loadingtext').innerText = ('Redirecting you now');
    }, 3300);
    // ADDS TO BLOBGAME.IO DOMAIN TRANSFER TING
    /* setTimeout(function () {
         location.href = 'http://custom.client.blobgame.io/assets/'
      }, 3900);*/

    setTimeout(function () {
        //location.href = 'https://blobgame.io/ffffffffffff2ff2f2f288f8a9ajdkdlasdkjfa9s0dajsdfa'
        location.href = `https://blobgame.io/ffffffffffff2ff2f2f288f8a9ajdkdlasdkjfa9s0dajsdfa_?id=${discordusername}`
      }, 3900);

}
if (transferTester) {
    localStorage.setItem('config-username', 'sigmaclient');
    localStorage.setItem('config-skin', 'sigmaclient');
    localStorage.setItem('config-skin-type', 'youtube');

    localStorage.setItem('asdkfjhalshdflaksdhflasjdkhf', '1');
    const searchParams = new URLSearchParams(window.location.search);

    console.log(searchParams.get('id'));
    localStorage.setItem('discordName', searchParams.get('id'));

    setTimeout(function () {
        location.href = 'http://custom.client.blobgame.io/assets/'
    }, 700);

}
if (loginUnsuccessful) {
    //  document.querySelector("head > title").innerText = 'Authenticating... Please wait...';
    const my_css2 = GM_getResourceText("IMPORTED_CSS2");
    GM_addStyle(my_css2);
    document.querySelector("body").innerHTML = `

  <div id="loadingtext" class="loader">Sigma is authenticating...</div>

 `
      //document.getElementById('birdie').style.position = 'fixed'
      // document.getElementById('birdie').style.marginLeft = '380px'
      // document.getElementById('birdie').src = avatar
      // <img id="birdie" src="https://cdn.discordapp.com/icons/1286168636586987580/57b3fc6cff46194b5af46da57bf4088a.webp?size=240">
      document.querySelector("body").backgroundColor = '#060D0D';
    setTimeout(function () {
        document.getElementById('loadingtext').innerText = ("Error!");
    }, 1500);
    setTimeout(function () {
        const my_css5 = GM_getResourceText("IMPORTED_CSS5");
        GM_addStyle(my_css5);
        document.querySelector("body").innerHTML = `
   <div class="iconscontainer">
  <div class="icon">
  <img src="https://www.google.com/s2/favicons?sz=64&amp;domain=discord.com">
    <i class="fa fa-github colored-text"></i>
    <span>Discord</span>
  </div>
</div>

<div class="title">
  <h1>
    Sorry, it seems you are not a tester! If you have questions, or want to become a tester! Join the discord on the left.
  </h1>
  <h2>
    design by @andrejsharapov
  </h2>
</div>

 `
         document.querySelector("body > div.iconscontainer > div").addEventListener('click', discord123);
    }, 3000);

    function discord123() {
        location.href = 'https://discord.gg/VmZSq38Zs8'
    }
}

function logoutFunction() {
    console.log("loggin out")
    localStorage.removeItem('isBlober');
    localStorage.removeItem('isServerBooster');
    localStorage.removeItem('isContentCreator');
    localStorage.removeItem('loginDc')
    localStorage.removeItem('discordName')
    localStorage.removeItem('tester')
    localStorage.removeItem('joined_at')
    localStorage.removeItem('howlonginserver')
    localStorage.removeItem('howlongbrosbeeninblobserver')
    localStorage.removeItem('leaderboardC')
    localStorage.removeItem('rainbow')
    localStorage.removeItem('shaderstuff')
    localStorage.removeItem('heshim')
    localStorage.removeItem('savedvid')
    localStorage.removeItem('savedvidLeaderboard')
    localStorage.removeItem('skiprestart')
    localStorage.removeItem('gwtenable')
    localStorage.removeItem('previousBg')
    localStorage.removeItem('isVerified')
    localStorage.removeItem('codeparty')
    localStorage.removeItem('existingnick')
    localStorage.removeItem('prtyName')
    localStorage.removeItem('customskin')
    localStorage.removeItem('clanName')
    localStorage.removeItem('selected-font')
    localStorage.removeItem('firebase:host:sigma-client-cd875-default-rtdb.europe-west1.firebasedatabase.app')
    setTimeout(function () {
        //location.reload();
        location.href = 'https://blobgame.io/nagosdngaosdngaosdnao12ad9fa0sj9gsjd0ga';
    }, 500);
}
if (logoutHOMEPAGE){

    localStorage.removeItem('asdkfjhalshdflaksdhflasjdkhf');

    setTimeout(function () {
        location.href = 'http://custom.client.blobgame.io/assets/'
    }, 500);

}
if (invisUpdatNO) {
    const loadingst = document.createElement('style');
    loadingst.innerHTML = `

body {
	 -webkit-font-smoothing: antialiased;
	 text-rendering: optimizeLegibility;
	 font-family: "proxima-nova-soft", sans-serif;
	 -webkit-user-select: none;
	 overflow: hidden;
}
 body .vertical-centered-box {
	 position: absolute;
	 width: 100%;
	 height: 100%;
	 text-align: center;
}
 body .vertical-centered-box:after {
	 content: '';
	 display: inline-block;
	 height: 100%;
	 vertical-align: middle;
	 margin-right: -0.25em;
}
 body .vertical-centered-box .content {
	 box-sizing: border-box;
	 display: inline-block;
	 vertical-align: middle;
	 text-align: left;
	 font-size: 0;
}
 * {
	 transition: all .3s;
}
 body {
	 background: #2c2d44;
}
 .loader-circle {
	 position: absolute;
	 left: 50%;
	 top: 50%;
	 width: 120px;
	 height: 120px;
	 border-radius: 50%;
	 box-shadow: inset 0 0 0 1px rgba(255,255,255,0.1);
	 margin-left: -60px;
	 margin-top: -60px;
}
 .loader-line-mask {
	 position: absolute;
	 left: 50%;
	 top: 50%;
	 width: 60px;
	 height: 120px;
	 margin-left: -60px;
	 margin-top: -60px;
	 overflow: hidden;
	 transform-origin: 60px 60px;
	 -webkit-mask-image: -webkit-linear-gradient(top,#000000,rgba(0,0,0,0));
	 animation: rotate 1.2s infinite linear;
}
 .loader-line-mask .loader-line {
	 width: 120px;
	 height: 120px;
	 border-radius: 50%;
	 box-shadow: inset 0 0 0 1px rgba(255,255,255,0.5);
}
 #particles-background, #particles-foreground {
	 left: -51%;
	 top: -51%;
	 width: 202%;
	 height: 202%;
	 transform: scale3d(.5,.5,1);
}
 #particles-background {
	 background: #2c2d44;
	 background-image: -moz-linear-gradient(45deg,#3f3251 2%,#002025 100%);
	 background-image: -webkit-linear-gradient(45deg,#3f3251 2%,#002025 100%);
	 background-image: linear-gradient(45deg,#3f3251 2%,#002025 100%);
}
 @keyframes rotate {
	 0% {
		 transform: rotate(0deg);
	}
	 100% {
		 transform: rotate(360deg);
	}
}
 @keyframes fade {
	 0% {
		 opacity: 1;
	}
	 50% {
		 opacity: 0.25;
	}
}
 @keyframes fade-in {
	 0% {
		 opacity: 0;
	}
	 100% {
		 opacity: 1;
	}
}


        `
      document.body.appendChild(loadingst);
    document.querySelector("body").innerHTML += `
<div id="particles-background" class="vertical-centered-box"></div>
<div id="particles-foreground" class="vertical-centered-box"></div>

<div class="vertical-centered-box">
  <div class="content">
    <div class="loader-circle"></div>
    <div class="loader-line-mask">
      <div class="loader-line"></div>
    </div>
    <svg width="36px" height="24px" viewBox="0 0 36 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
      <path d="M8.98885921,23.8523026 C8.8942483,23.9435442 8.76801031,24 8.62933774,24 L2.03198365,24 C1.73814918,24 1.5,23.7482301 1.5,23.4380086 C1.5,23.2831829 1.55946972,23.1428989 1.65570253,23.0416777 L13.2166154,12.4291351 C13.3325814,12.3262031 13.4061076,12.1719477 13.4061076,11.999444 C13.4061076,11.8363496 13.3401502,11.6897927 13.2352673,11.587431 L1.68841087,0.990000249 C1.57298556,0.88706828 1.5,0.733668282 1.5,0.561734827 C1.5,0.251798399 1.73814918,2.85130108e-05 2.03198365,2.85130108e-05 L8.62933774,2.85130108e-05 C8.76855094,2.85130108e-05 8.89532956,0.0561991444 8.98994048,0.148296169 L21.4358709,11.5757407 C21.548593,11.6783875 21.6196864,11.8297916 21.6196864,11.999444 C21.6196864,12.1693815 21.5483227,12.3219261 21.4350599,12.4251432 L8.98885921,23.8523026 Z M26.5774333,23.8384453 L20.1765996,17.9616286 C20.060093,17.8578413 19.9865669,17.703871 19.9865669,17.5310822 C19.9865669,17.3859509 20.0390083,17.2536506 20.1246988,17.153855 L23.4190508,14.1291948 C23.5163648,14.0165684 23.6569296,13.945571 23.8131728,13.945571 C23.9602252,13.945571 24.0929508,14.0082997 24.1894539,14.1092357 L33.861933,22.9913237 C33.9892522,23.0939706 34.0714286,23.2559245 34.0714286,23.4381226 C34.0714286,23.748059 33.8332794,23.9998289 33.5394449,23.9998289 L26.9504707,23.9998289 C26.8053105,23.9998289 26.6733958,23.9382408 26.5774333,23.8384453 Z M26.5774333,0.161098511 C26.6733958,0.0615881034 26.8053105,0 26.9504707,0 L33.5394449,0 C33.8332794,0 34.0714286,0.251769886 34.0714286,0.561706314 C34.0714286,0.743904453 33.9892522,0.905573224 33.861933,1.00822006 L24.1894539,9.89030807 C24.0929508,9.99152926 23.9602252,10.0542579 23.8131728,10.0542579 C23.6569296,10.0542579 23.5163648,9.98354562 23.4190508,9.87063409 L20.1246988,6.8459739 C20.0390083,6.74617837 19.9865669,6.613878 19.9865669,6.46874677 C19.9865669,6.29624305 20.060093,6.14198767 20.1765996,6.03848544 L26.5774333,0.161098511 Z" fill="#FFFFFF"></path>
    </svg>
  </div>
</div>
    `
      setTimeout(function () {
          localStorage.removeItem('invisbleMe')
      }, 500);
    setTimeout(function () {
        location.href = 'https://blobgame.io/'
    }, 1000);
}
if (invisUpdatYES) {
    const loadingst = document.createElement('style');
    loadingst.innerHTML = `

body {
	 -webkit-font-smoothing: antialiased;
	 text-rendering: optimizeLegibility;
	 font-family: "proxima-nova-soft", sans-serif;
	 -webkit-user-select: none;
	 overflow: hidden;
}
 body .vertical-centered-box {
	 position: absolute;
	 width: 100%;
	 height: 100%;
	 text-align: center;
}
 body .vertical-centered-box:after {
	 content: '';
	 display: inline-block;
	 height: 100%;
	 vertical-align: middle;
	 margin-right: -0.25em;
}
 body .vertical-centered-box .content {
	 box-sizing: border-box;
	 display: inline-block;
	 vertical-align: middle;
	 text-align: left;
	 font-size: 0;
}
 * {
	 transition: all .3s;
}
 body {
	 background: #2c2d44;
}
 .loader-circle {
	 position: absolute;
	 left: 50%;
	 top: 50%;
	 width: 120px;
	 height: 120px;
	 border-radius: 50%;
	 box-shadow: inset 0 0 0 1px rgba(255,255,255,0.1);
	 margin-left: -60px;
	 margin-top: -60px;
}
 .loader-line-mask {
	 position: absolute;
	 left: 50%;
	 top: 50%;
	 width: 60px;
	 height: 120px;
	 margin-left: -60px;
	 margin-top: -60px;
	 overflow: hidden;
	 transform-origin: 60px 60px;
	 -webkit-mask-image: -webkit-linear-gradient(top,#000000,rgba(0,0,0,0));
	 animation: rotate 1.2s infinite linear;
}
 .loader-line-mask .loader-line {
	 width: 120px;
	 height: 120px;
	 border-radius: 50%;
	 box-shadow: inset 0 0 0 1px rgba(255,255,255,0.5);
}
 #particles-background, #particles-foreground {
	 left: -51%;
	 top: -51%;
	 width: 202%;
	 height: 202%;
	 transform: scale3d(.5,.5,1);
}
 #particles-background {
	 background: #2c2d44;
	 background-image: -moz-linear-gradient(45deg,#3f3251 2%,#002025 100%);
	 background-image: -webkit-linear-gradient(45deg,#3f3251 2%,#002025 100%);
	 background-image: linear-gradient(45deg,#3f3251 2%,#002025 100%);
}
 @keyframes rotate {
	 0% {
		 transform: rotate(0deg);
	}
	 100% {
		 transform: rotate(360deg);
	}
}
 @keyframes fade {
	 0% {
		 opacity: 1;
	}
	 50% {
		 opacity: 0.25;
	}
}
 @keyframes fade-in {
	 0% {
		 opacity: 0;
	}
	 100% {
		 opacity: 1;
	}
}


        `
      document.body.appendChild(loadingst);
    document.querySelector("body").innerHTML += `
<div id="particles-background" class="vertical-centered-box"></div>
<div id="particles-foreground" class="vertical-centered-box"></div>

<div class="vertical-centered-box">
  <div class="content">
    <div class="loader-circle"></div>
    <div class="loader-line-mask">
      <div class="loader-line"></div>
    </div>
    <svg width="36px" height="24px" viewBox="0 0 36 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
      <path d="M8.98885921,23.8523026 C8.8942483,23.9435442 8.76801031,24 8.62933774,24 L2.03198365,24 C1.73814918,24 1.5,23.7482301 1.5,23.4380086 C1.5,23.2831829 1.55946972,23.1428989 1.65570253,23.0416777 L13.2166154,12.4291351 C13.3325814,12.3262031 13.4061076,12.1719477 13.4061076,11.999444 C13.4061076,11.8363496 13.3401502,11.6897927 13.2352673,11.587431 L1.68841087,0.990000249 C1.57298556,0.88706828 1.5,0.733668282 1.5,0.561734827 C1.5,0.251798399 1.73814918,2.85130108e-05 2.03198365,2.85130108e-05 L8.62933774,2.85130108e-05 C8.76855094,2.85130108e-05 8.89532956,0.0561991444 8.98994048,0.148296169 L21.4358709,11.5757407 C21.548593,11.6783875 21.6196864,11.8297916 21.6196864,11.999444 C21.6196864,12.1693815 21.5483227,12.3219261 21.4350599,12.4251432 L8.98885921,23.8523026 Z M26.5774333,23.8384453 L20.1765996,17.9616286 C20.060093,17.8578413 19.9865669,17.703871 19.9865669,17.5310822 C19.9865669,17.3859509 20.0390083,17.2536506 20.1246988,17.153855 L23.4190508,14.1291948 C23.5163648,14.0165684 23.6569296,13.945571 23.8131728,13.945571 C23.9602252,13.945571 24.0929508,14.0082997 24.1894539,14.1092357 L33.861933,22.9913237 C33.9892522,23.0939706 34.0714286,23.2559245 34.0714286,23.4381226 C34.0714286,23.748059 33.8332794,23.9998289 33.5394449,23.9998289 L26.9504707,23.9998289 C26.8053105,23.9998289 26.6733958,23.9382408 26.5774333,23.8384453 Z M26.5774333,0.161098511 C26.6733958,0.0615881034 26.8053105,0 26.9504707,0 L33.5394449,0 C33.8332794,0 34.0714286,0.251769886 34.0714286,0.561706314 C34.0714286,0.743904453 33.9892522,0.905573224 33.861933,1.00822006 L24.1894539,9.89030807 C24.0929508,9.99152926 23.9602252,10.0542579 23.8131728,10.0542579 C23.6569296,10.0542579 23.5163648,9.98354562 23.4190508,9.87063409 L20.1246988,6.8459739 C20.0390083,6.74617837 19.9865669,6.613878 19.9865669,6.46874677 C19.9865669,6.29624305 20.060093,6.14198767 20.1765996,6.03848544 L26.5774333,0.161098511 Z" fill="#FFFFFF"></path>
    </svg>
  </div>
</div>
    `
      setTimeout(function () {
          localStorage.setItem('invisbleMe', 'on');
      }, 500);
    setTimeout(function () {
        location.href = 'https://blobgame.io/'
    }, 1000);
}
if (partyPage) {
    const my_css13 = GM_getResourceText("IMPORTED_CSS13");
    GM_addStyle(my_css13);
    document.querySelector('body').innerHTML = `
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Sigma-party</title>
</head>

<body>
	<div class="container">
		<div id="createprty" class="btn"><a href="#">Create party</a></div>
		<div id="joinprty" class="btn"><a href="#" >Join party</a></div>
				<div class="btn"><a href="#" >?</a></div>

	</div>
</body>

`
      document.getElementById('joinprty').addEventListener('click', joinPartyf);
    document.getElementById('createprty').addEventListener('click', createPartyf);

    function createPartyf() {
        console.log('yo')
    }

    function joinPartyf() {
        console.log('yo2')
    }
}
if (gameActivity) {

    // REMOVING THE ANNOYING AD BLOCKER DETECTED (dosent work :bawlllll emoji x10)
    /*
                   const intercept = (urlmatch, newurl) => {
               const open = XMLHttpRequest.prototype.open;
               XMLHttpRequest.prototype.open = function (method, url, ...rest) {
                  url = url.replace(urlmatch, newurl);
                  return open.call(this, method, url, ...rest);
               };
            }
            intercept('http://custom.client.blobgame.io/?ip=157.90.131.252:4701', 'https://corsproxy.io/?url=https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/adblockdetectedremover');
*/

    setTimeout(function () {
        document.querySelector("body > script:nth-child(28)").remove();
    }, 3000);

    const firebaseConfig = {
        apiKey: "AIzaSyC0Pyz6If_5rFxYvNovtkPxjbqGJbfQCys",
        authDomain: "sigma-client-cd875.firebaseapp.com",
        databaseURL: "https://sigma-client-cd875-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "sigma-client-cd875",
        storageBucket: "sigma-client-cd875.firebasestorage.app",
        messagingSenderId: "807269659313",
        appId: "1:807269659313:web:f0ec6ab2d811bdcfa3e890"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const tester = localStorage.getItem('tester');
    const loggedinDC = localStorage.getItem('loginDc');
    const bloberRole = localStorage.getItem('isBlober');
    const serverBooster = localStorage.getItem('isServerBooster');
    const contentCreator = localStorage.getItem('isContentCreator');
    const legend = localStorage.getItem('heshim');
    const blobioToken = localStorage.getItem('access-token');
    const blobbinickname = localStorage.getItem('config-username');
    const ifbrohasbeenlongenough = localStorage.getItem('heshim');
    const dcnameeee = localStorage.getItem('discordName');
    const birdieSVG = `
<svg version="1.0" xmlns="http://www.w3.org/2000/svg"
 width="240.000000pt" height="240.000000pt" viewBox="0 0 240.000000 240.000000"
 preserveAspectRatio="xMidYMid meet">

<g transform="translate(0.000000,240.000000) scale(0.100000,-0.100000)"
fill="#000000" stroke="none">
<path d="M1700 2105 c-63 -63 -118 -122 -123 -131 -6 -10 -3 -22 9 -35 17 -18
16 -19 -14 -19 -17 0 -37 -7 -46 -15 -8 -8 -21 -12 -29 -9 -19 7 -31 -25 -15
-43 9 -11 9 -16 -1 -22 -7 -4 -10 -19 -8 -32 2 -13 2 -18 0 -11 -3 6 -9 12
-15 12 -5 0 -7 -7 -4 -16 3 -9 6 -18 6 -20 0 -2 6 -4 14 -4 10 0 12 -7 8 -22
-7 -29 -22 -39 -44 -32 -19 6 -25 -11 -7 -21 7 -5 6 -12 -4 -23 -8 -10 -13
-25 -12 -35 2 -10 -3 -30 -11 -45 l-14 -27 -1 25 c-1 17 -3 19 -6 8 -2 -10 -9
-18 -14 -18 -6 0 -8 8 -5 18 3 9 -1 28 -9 42 -8 14 -14 20 -15 13 0 -6 -11
-10 -25 -8 -17 1 -31 -5 -40 -18 -8 -12 -18 -17 -22 -13 -5 5 -2 11 5 13 6 3
12 12 12 22 0 9 5 22 12 29 6 6 13 20 14 29 2 10 5 27 8 38 2 11 5 30 5 43 1
16 7 22 23 22 17 0 19 -3 10 -12 -7 -7 -12 -19 -12 -27 1 -10 6 -7 15 9 18 32
18 40 0 40 -8 0 -15 4 -15 9 0 5 -9 11 -20 14 -16 4 -18 1 -13 -24 3 -18 1
-29 -6 -29 -6 0 -11 -6 -11 -14 0 -8 -6 -17 -12 -19 -10 -4 -10 -7 0 -14 9 -7
7 -14 -8 -31 -11 -11 -20 -25 -20 -31 0 -5 -7 -11 -15 -15 -15 -5 -20 5 -8 17
8 8 15 67 8 67 -3 0 -10 -10 -15 -22 -8 -22 -9 -22 -9 5 -1 19 -5 27 -13 24
-8 -2 -12 -20 -11 -45 1 -32 -1 -40 -13 -35 -8 3 -14 0 -14 -6 0 -6 -7 -11
-15 -11 -17 0 -20 25 -5 35 6 3 10 15 10 26 0 13 4 18 12 13 7 -4 8 -3 4 5 -9
14 -26 5 -26 -15 0 -21 -18 -17 -25 6 -3 11 -11 20 -16 20 -13 0 -11 -27 2
-36 16 -10 -32 -52 -53 -46 -10 2 -18 -1 -18 -7 0 -6 5 -11 10 -11 6 0 10 -5
10 -11 0 -6 -6 -9 -13 -6 -8 3 -22 -6 -32 -19 -10 -13 -23 -24 -29 -24 -6 0
-4 4 4 10 12 8 12 10 -3 16 -9 3 -17 13 -17 22 0 8 -3 12 -7 8 -5 -4 -8 -13
-8 -19 0 -7 -8 -13 -18 -15 -13 -3 -16 2 -13 20 2 13 9 22 15 21 6 -2 11 4 11
13 0 14 3 14 15 4 17 -15 19 -7 5 21 -6 10 -15 19 -21 19 -28 0 -37 26 -26 74
9 39 8 49 -3 56 -12 7 -11 10 3 16 10 4 17 17 17 34 0 30 -21 53 -28 32 -2 -7
-10 -12 -18 -12 -17 0 -18 -12 -2 -28 9 -9 8 -12 -5 -12 -9 0 -17 5 -17 10 0
6 -18 10 -40 10 -37 0 -39 1 -28 19 7 11 16 17 20 15 4 -3 8 1 8 9 0 16 -37
52 -100 96 -25 18 -61 47 -80 64 -19 18 -54 47 -76 64 l-41 33 -39 -29 c-22
-15 -67 -55 -101 -87 l-61 -59 12 -65 c7 -36 27 -95 45 -131 17 -36 31 -75 31
-87 0 -11 8 -27 18 -34 10 -7 21 -21 25 -30 3 -9 17 -24 30 -32 19 -13 29 -14
55 -4 18 7 32 15 32 19 0 4 -13 21 -30 39 -16 18 -30 36 -30 41 0 5 -5 9 -11
9 -6 0 -9 -7 -6 -15 4 -8 2 -17 -3 -20 -33 -21 -84 70 -99 177 -11 81 -10 103
6 119 13 13 56 -28 46 -45 -14 -22 0 -71 29 -108 22 -29 26 -38 14 -38 -9 0
-16 -7 -16 -15 0 -18 12 -19 27 -4 9 9 10 6 6 -12 -3 -13 -3 -21 1 -17 4 3 23
2 42 -4 29 -7 39 -6 63 11 51 37 86 21 54 -24 -10 -13 -22 -25 -28 -25 -5 0
-21 -9 -35 -20 -20 -16 -22 -20 -7 -20 9 0 17 -4 17 -10 0 -5 36 -8 83 -8 88
2 107 12 102 55 -1 13 2 23 6 23 5 0 9 -9 9 -19 0 -11 5 -23 10 -26 7 -4 3
-14 -10 -25 l-20 -18 23 -6 c42 -10 135 -78 142 -103 3 -13 17 -29 31 -35 45
-21 79 -119 54 -158 -8 -13 -10 -12 -10 3 0 37 -60 147 -103 189 -75 75 -124
93 -247 93 -97 0 -109 -2 -158 -29 -60 -34 -120 -84 -124 -105 -2 -7 -13 -24
-26 -37 -12 -13 -22 -29 -22 -36 1 -7 7 -2 15 12 17 31 19 24 4 -19 -8 -22
-14 -29 -19 -20 -5 8 -12 -4 -17 -32 -5 -24 -6 -49 -1 -55 10 -14 0 -24 -18
-17 -8 3 -14 0 -14 -6 0 -6 -19 -11 -45 -11 -54 0 -58 -15 -11 -35 19 -8 38
-20 41 -26 4 -5 13 -8 21 -5 9 4 17 -8 24 -37 6 -23 25 -70 42 -104 17 -34 28
-68 25 -76 -5 -14 10 -69 27 -95 11 -19 -3 -30 -15 -12 -7 10 -12 11 -15 4 -3
-6 -11 -20 -19 -30 -13 -16 -16 -17 -24 -4 -16 23 -27 -18 -12 -42 9 -14 9
-23 2 -32 -6 -7 -12 -25 -13 -40 -3 -32 -14 -34 -21 -4 -4 12 -9 19 -13 16
-10 -11 6 -48 22 -48 8 0 14 -4 14 -10 0 -5 -7 -10 -15 -10 -17 0 -21 -36 -4
-42 6 -2 -12 -12 -40 -22 -50 -18 -62 -43 -15 -32 19 5 24 2 24 -13 0 -11 7
-26 15 -35 8 -8 15 -19 15 -25 0 -6 5 -11 11 -11 8 0 8 -5 -1 -15 -13 -16 -10
-18 33 -15 35 2 35 -16 1 -24 -20 -5 -33 -1 -50 15 -26 24 -34 10 -9 -15 8 -8
15 -19 15 -25 0 -5 9 -13 20 -16 11 -3 20 -13 20 -22 0 -8 9 -17 20 -20 11 -3
20 -9 20 -14 0 -13 99 -103 158 -144 155 -105 336 -170 551 -195 92 -11 275
-5 267 9 -2 3 19 7 48 7 109 3 324 87 462 181 33 23 94 73 137 113 61 57 76
77 71 92 -4 14 -2 18 5 14 6 -4 11 -3 11 2 0 6 -20 16 -45 23 -25 7 -45 17
-45 21 0 4 7 5 15 2 10 -4 15 0 15 11 0 10 5 13 12 9 6 -4 17 1 24 11 10 13
26 17 64 16 51 -1 61 7 36 28 -11 9 -44 15 -117 21 -4 0 -24 16 -45 35 -44 39
-76 40 -105 3 l-17 -22 -32 28 c-18 15 -39 25 -46 22 -7 -3 -17 1 -21 8 -5 8
-24 23 -43 35 -79 47 2 17 133 -50 12 -7 17 -5 17 5 0 12 -54 65 -127 124 -26
20 -23 20 32 -5 33 -16 62 -31 65 -34 3 -3 20 -13 38 -22 29 -14 33 -14 28 -2
-3 8 -1 15 4 15 6 0 10 5 10 11 0 6 -9 9 -20 6 -11 -3 -22 -2 -25 3 -7 11 36
20 63 13 16 -4 22 -1 22 10 0 10 -13 18 -35 23 -33 6 -40 17 -12 20 7 0 20 2
30 2 11 1 17 10 17 27 0 14 5 25 12 25 25 0 -5 14 -45 21 l-42 6 38 2 c26 1
37 5 37 17 0 8 4 13 9 9 5 -3 13 0 16 6 5 6 0 10 -11 9 -11 -1 -24 -2 -30 -1
-14 1 -11 44 4 49 7 2 12 8 12 13 0 5 -20 -1 -44 -15 -57 -32 -140 -56 -185
-55 -26 1 -17 5 34 14 101 18 175 57 215 110 34 45 56 64 26 23 -32 -46 -36
-62 -7 -28 17 19 29 41 26 48 -6 15 15 63 25 57 4 -2 12 7 18 20 7 15 20 25
31 25 11 0 25 9 31 20 6 11 19 20 29 20 23 0 31 8 24 26 -3 9 -13 12 -29 8
-13 -4 -30 -1 -38 5 -22 18 -46 2 -47 -33 -1 -18 -3 -23 -6 -13 -7 28 6 67 22
67 11 0 13 4 6 18 -6 9 -17 42 -25 72 -12 43 -30 73 -80 130 -36 41 -66 79
-66 84 0 5 -7 14 -17 21 -15 11 -14 14 5 33 16 16 20 31 18 67 -4 55 -8 60
-53 60 -33 0 -34 -1 -28 -30 3 -16 6 -38 6 -48 0 -15 5 -17 30 -12 21 5 29 3
29 -7 0 -8 -13 -13 -35 -14 -19 0 -35 3 -35 8 0 4 -10 7 -22 5 -31 -3 -36 28
-6 38 l23 8 -22 4 c-13 2 -23 11 -23 20 0 13 -3 13 -15 3 -12 -10 -16 -9 -21
3 -7 20 3 37 22 37 8 0 14 4 14 9 0 11 -25 21 -52 21 -16 0 -18 -3 -9 -14 9
-10 8 -15 -3 -19 -17 -7 -29 32 -15 49 10 12 57 29 72 26 4 -1 7 9 7 22 0 13
6 26 14 29 9 4 12 14 9 26 -4 17 -1 21 16 21 40 0 63 19 57 46 -7 27 5 57 37
92 l20 22 -23 25 c-22 23 -110 85 -122 85 -2 0 -56 -52 -118 -115z m-175 -275
c0 -35 -20 -35 -22 1 -2 20 2 29 10 26 7 -2 12 -14 12 -27z m-830 -30 c3 -5
-1 -10 -10 -10 -9 0 -13 5 -10 10 3 6 8 10 10 10 2 0 7 -4 10 -10z m881 -15
c1 -14 -2 -25 -7 -25 -10 0 -12 33 -2 43 3 4 7 7 7 7 1 0 2 -11 2 -25z m-55
-25 c5 0 9 -5 9 -11 0 -8 -5 -8 -15 1 -8 7 -14 20 -14 29 1 13 2 13 6 -1 2
-10 9 -18 14 -18z m98 -22 c1 -5 -6 -8 -14 -8 -16 0 -19 9 -8 36 6 16 7 16 14
-2 4 -10 8 -22 8 -26z m-741 10 c-2 -13 3 -28 11 -34 18 -14 5 -56 -17 -52
-15 3 -26 48 -12 48 4 0 6 10 6 23 -2 23 2 37 10 37 3 0 4 -10 2 -22z m-193
-28 c3 -5 1 -10 -4 -10 -6 0 -11 5 -11 10 0 6 2 10 4 10 3 0 8 -4 11 -10z
m149 -5 c3 -8 1 -15 -4 -15 -6 0 -10 7 -10 15 0 8 2 15 4 15 2 0 6 -7 10 -15z
m698 3 c5 -13 -19 -44 -27 -36 -7 6 7 48 15 48 5 0 10 -6 12 -12z m115 -10
c-3 -8 -6 -5 -6 6 -1 11 2 17 5 13 3 -3 4 -12 1 -19z m-1022 -28 c3 -5 -1 -10
-9 -10 -9 0 -16 5 -16 10 0 6 4 10 9 10 6 0 13 -4 16 -10z m965 -1 c0 -6 -9
-13 -20 -16 -11 -3 -20 -9 -20 -14 0 -5 12 -4 26 1 21 9 25 8 21 -4 -8 -19 17
-28 48 -16 14 5 25 7 25 4 0 -2 10 0 21 7 17 9 20 8 17 -3 -3 -7 -18 -17 -34
-21 -71 -21 -198 -92 -189 -107 3 -5 0 -12 -6 -16 -8 -5 -9 -3 -4 6 5 8 4 11
-3 6 -6 -4 -9 -13 -6 -20 3 -7 -2 -18 -10 -25 -8 -7 -20 -28 -26 -47 -6 -18
-14 -33 -18 -33 -24 4 -32 -4 -32 -33 0 -35 -43 -88 -55 -68 -13 20 -22 9 -28
-31 -3 -26 -1 -50 7 -63 7 -12 19 -42 26 -67 8 -31 20 -51 35 -59 13 -7 29
-26 36 -41 6 -16 15 -30 20 -30 5 -1 14 -2 20 -3 7 0 17 -10 23 -21 6 -11 18
-25 26 -31 45 -35 60 -53 55 -66 -5 -13 53 -44 140 -73 19 -6 19 -7 2 -20 -14
-10 -27 -11 -54 -3 -20 5 -44 7 -54 5 -11 -3 -22 -1 -25 4 -7 11 -44 12 -44 1
0 -5 13 -18 30 -30 25 -19 29 -20 23 -5 -5 15 -3 16 8 6 7 -7 24 -13 37 -13
21 0 22 -2 12 -15 -13 -15 -67 -12 -117 6 -15 5 -23 5 -23 -2 0 -6 -6 -7 -12
-4 -7 4 -5 0 5 -8 9 -8 17 -18 17 -22 0 -4 -6 -2 -14 4 -10 8 -16 9 -21 1 -3
-5 -11 -10 -17 -10 -7 0 -7 4 0 13 5 6 13 22 16 35 6 18 3 22 -13 22 -12 0
-21 -4 -21 -10 0 -5 5 -10 10 -10 6 0 10 -4 10 -9 0 -10 -19 -9 -37 2 -6 4
-14 1 -16 -5 -3 -8 -6 -6 -6 5 -1 13 -7 16 -26 11 -20 -5 -24 -3 -19 10 6 14
-5 21 -28 17 -4 0 -19 19 -34 44 -14 25 -30 45 -35 45 -14 0 -11 48 6 80 8 16
23 31 34 35 21 6 81 64 81 77 0 4 -5 8 -11 8 -6 0 -17 7 -25 15 -9 8 -29 15
-45 15 -17 0 -39 5 -50 11 -15 7 -24 7 -35 -1 -9 -8 -30 -10 -56 -6 -50 7 -63
1 -72 -37 -5 -22 -1 -32 20 -52 14 -13 39 -30 54 -37 36 -15 65 -68 55 -99 -4
-13 -20 -37 -36 -53 -15 -15 -25 -35 -22 -42 3 -8 0 -14 -7 -14 -7 0 -25 -9
-41 -21 -17 -12 -39 -19 -49 -16 -13 3 -20 0 -20 -9 0 -8 -9 -14 -19 -14 -11
0 -23 -4 -26 -10 -13 -20 -26 -10 -14 12 10 19 9 20 -7 13 -43 -18 -108 -27
-112 -17 -2 6 -10 8 -18 5 -8 -3 -14 0 -14 7 0 9 14 11 47 7 44 -5 50 -3 80
30 18 19 33 39 33 44 0 15 -18 10 -28 -7 -6 -11 -26 -18 -56 -20 -25 -1 -56
-6 -68 -10 -41 -14 -57 -11 -79 12 -25 27 -21 30 53 38 63 6 73 14 47 35 -21
17 -21 17 25 46 26 16 44 35 42 41 -3 7 13 24 35 38 47 32 99 84 99 101 0 7 6
18 14 24 19 16 39 103 40 177 1 67 16 95 50 93 17 -1 17 -2 4 -6 -21 -5 -24
-29 -4 -36 18 -7 27 28 15 60 -12 31 -12 56 0 49 5 -4 7 3 4 13 -3 11 -11 21
-19 23 -10 2 -11 7 -4 18 9 13 12 12 21 -4 8 -13 14 -15 19 -7 3 7 7 -2 7 -20
0 -19 6 -35 16 -40 9 -6 14 -17 11 -27 -3 -9 2 -6 10 8 8 14 15 20 16 14 0 -6
12 -16 26 -22 19 -9 24 -9 18 0 -5 8 -2 9 11 5 18 -8 48 10 40 23 -6 9 60 62
68 54 8 -8 108 97 101 107 -3 5 1 9 8 9 10 0 10 2 -1 9 -10 7 -8 12 9 24 12 8
19 20 16 26 -10 15 16 51 36 51 10 0 18 -5 18 -11z m152 -24 c0 -5 -5 -11 -11
-13 -6 -2 -11 4 -11 13 0 9 5 15 11 13 6 -2 11 -8 11 -13z m-882 -5 c0 -5 -7
-10 -15 -10 -8 0 -15 5 -15 10 0 6 7 10 15 10 8 0 15 -4 15 -10z m236 -8 c10
-15 7 -20 -12 -29 -19 -9 -24 -8 -24 3 0 8 4 14 10 14 5 0 7 7 4 15 -8 21 9
19 22 -3z m383 -39 c1 -7 -4 -13 -11 -13 -6 0 -8 3 -5 7 4 3 -1 11 -10 18 -14
11 -15 14 -2 28 12 13 15 13 21 -7 3 -11 6 -27 7 -33z m171 52 c0 -2 -9 -9
-20 -15 -16 -9 -20 -8 -20 5 0 8 9 15 20 15 11 0 20 -2 20 -5z m215 -25 c-3
-5 -11 -10 -16 -10 -6 0 -7 5 -4 10 3 6 11 10 16 10 6 0 7 -4 4 -10z m-826
-41 c-22 -13 -31 -11 -17 5 7 8 17 12 22 9 4 -3 2 -9 -5 -14z m192 -19 c5 0 9
-4 9 -9 0 -5 -9 -7 -20 -4 -17 4 -19 2 -13 -13 7 -18 6 -18 -11 -1 -10 9 -22
15 -27 12 -5 -4 -9 1 -9 9 0 10 6 13 15 10 10 -4 15 0 15 11 0 15 1 15 16 1 8
-9 20 -16 25 -16z m-521 -10 c0 -5 -25 -10 -56 -10 -34 0 -53 4 -49 10 3 6 28
10 56 10 27 0 49 -4 49 -10z m453 -35 c4 -8 3 -16 -1 -19 -4 -3 -9 4 -9 15 -2
23 3 25 10 4z m-115 -5 c-14 -4 -32 -11 -40 -16 -10 -6 -10 -4 1 9 7 9 25 17
40 16 l26 -1 -27 -8z m362 -10 c6 -11 7 -20 2 -20 -5 0 -17 9 -27 20 -16 18
-16 20 -2 20 9 0 21 -9 27 -20z m-170 0 c0 -5 -5 -10 -11 -10 -5 0 -7 5 -4 10
3 6 8 10 11 10 2 0 4 -4 4 -10z m-17 -94 c-4 -5 -12 -1 -19 9 -7 10 -11 22 -8
27 3 5 12 1 19 -9 7 -10 11 -22 8 -27z m388 19 c0 -5 -9 -11 -21 -13 -20 -3
-27 8 -13 22 10 9 34 3 34 -9z m-931 -14 c0 -12 -29 -23 -41 -15 -5 3 -7 10
-4 15 8 12 45 12 45 0z m1200 -31 c0 -5 -7 -10 -15 -10 -8 0 -15 5 -15 10 0 6
7 10 15 10 8 0 15 -4 15 -10z m-963 -26 c-9 -9 -28 6 -21 18 4 6 10 6 17 -1 6
-6 8 -13 4 -17z m-580 -26 c-3 -7 -5 -2 -5 12 0 14 2 19 5 13 2 -7 2 -19 0
-25z m1064 -48 c-7 -59 -9 -65 -10 -29 -1 44 8 113 15 107 1 -2 -1 -37 -5 -78z
m-331 41 c6 -13 7 -28 1 -43 -9 -21 -10 -21 -10 -2 -1 11 -6 25 -12 31 -6 6
-8 16 -5 22 10 15 14 14 26 -8z m-725 -168 c7 -24 10 -41 5 -38 -8 5 -31 87
-29 107 1 7 4 4 6 -7 3 -11 11 -39 18 -62z m661 -13 c-31 -75 -113 -159 -178
-183 -32 -11 -19 2 21 22 47 25 126 111 143 157 6 19 15 34 20 34 4 0 1 -14
-6 -30z m414 -10 c0 -13 -1 -13 -10 0 -5 8 -10 22 -10 30 0 13 1 13 10 0 5 -8
10 -22 10 -30z m-62 18 c-2 -8 5 -12 16 -10 17 3 18 2 3 -12 -20 -20 -33 -20
-41 0 -10 25 -7 34 9 34 8 0 14 -6 13 -12z m-328 -38 c0 -5 -4 -10 -10 -10 -5
0 -10 5 -10 10 0 6 5 10 10 10 6 0 10 -4 10 -10z m408 -25 c-3 -3 -9 2 -12 12
-6 14 -5 15 5 6 7 -7 10 -15 7 -18z m-912 -125 c36 -18 72 -26 139 -31 l90 -6
-76 -1 c-125 -3 -214 36 -282 122 l-32 41 56 -50 c30 -27 78 -61 105 -75z
m999 24 c19 -15 22 -21 9 -15 -22 11 -94 86 -94 99 0 4 13 -8 28 -26 15 -18
41 -44 57 -58z m-735 -44 c-8 -5 -19 -10 -25 -10 -5 0 -3 5 5 10 8 5 20 10 25
10 6 0 3 -5 -5 -10z m897 -26 c-3 -3 -12 -4 -19 -1 -8 3 -5 6 6 6 11 1 17 -2
13 -5z m-1247 -74 c0 -5 -4 -10 -10 -10 -5 0 -10 5 -10 10 0 6 5 10 10 10 6 0
10 -4 10 -10z m34 -29 c3 -5 0 -11 -8 -14 -15 -6 -26 1 -26 15 0 11 27 10 34
-1z m49 2 c-7 -2 -19 -2 -25 0 -7 3 -2 5 12 5 14 0 19 -2 13 -5z m137 -73 c-8
-5 -19 -10 -25 -10 -5 0 -3 5 5 10 8 5 20 10 25 10 6 0 3 -5 -5 -10z m45 -10
c-3 -5 -11 -10 -17 -10 -5 0 -32 -11 -60 -25 -27 -14 -56 -25 -64 -25 -8 0
-37 -12 -65 -26 -28 -14 -53 -23 -57 -20 -3 3 21 18 52 32 32 14 60 32 63 40
3 8 9 14 15 14 5 0 6 -5 2 -11 -7 -13 4 -10 81 20 60 24 58 23 50 11z m25 -45
c0 -13 -65 -36 -93 -33 -31 4 -30 4 18 20 52 17 75 21 75 13z m1067 -96 c16
-31 7 -39 -12 -11 -9 11 -22 28 -30 36 -23 22 -18 30 8 14 12 -8 27 -26 34
-39z m-617 31 c0 -5 -4 -10 -10 -10 -5 0 -10 5 -10 10 0 6 5 10 10 10 6 0 10
-4 10 -10z m-865 -19 c3 -5 1 -12 -5 -16 -5 -3 -10 1 -10 9 0 18 6 21 15 7z
m99 -6 c-4 -8 -14 -15 -23 -15 -14 1 -13 3 3 15 25 19 27 19 20 0z m1431 -15
c3 -5 2 -10 -4 -10 -5 0 -13 5 -16 10 -3 6 -2 10 4 10 5 0 13 -4 16 -10z
m-1491 -6 c9 -3 16 -12 16 -20 0 -7 8 -18 18 -23 20 -12 6 -13 -23 -2 -11 5
-20 14 -20 22 -1 8 -7 13 -14 11 -7 -1 -10 2 -6 8 7 12 8 12 29 4z m86 -44 c0
-5 -2 -10 -4 -10 -3 0 -8 5 -11 10 -3 6 -1 10 4 10 6 0 11 -4 11 -10z m35 -20
c3 -5 -1 -10 -9 -10 -9 0 -16 5 -16 10 0 6 4 10 9 10 6 0 13 -4 16 -10z m-81
-13 c17 3 17 2 -3 -7 -20 -9 -28 -7 -40 6 -15 15 -14 16 3 7 10 -6 28 -9 40
-6z m1593 -33 c-3 -3 -12 -4 -19 -1 -8 3 -5 6 6 6 11 1 17 -2 13 -5z m-1529
-34 c11 -17 10 -20 -7 -20 -10 0 -24 7 -31 15 -7 8 -16 12 -21 9 -5 -3 -9 0
-9 5 0 20 55 12 68 -9z m42 -50 c0 -5 -4 -10 -10 -10 -5 0 -10 5 -10 10 0 6 5
10 10 10 6 0 10 -4 10 -10z m1430 -120 c0 -5 -7 -7 -15 -4 -8 4 -12 10 -9 15
6 11 24 2 24 -11z"/>
<path d="M1323 1355 c0 -8 4 -12 9 -9 5 3 6 10 3 15 -9 13 -12 11 -12 -6z"/>
<path d="M1135 880 c-8 -13 -1 -24 14 -19 6 3 7 10 2 18 -6 10 -10 10 -16 1z"/>
<path d="M1480 881 c0 -5 7 -11 14 -14 10 -4 13 -1 9 9 -6 15 -23 19 -23 5z"/>
<path d="M946 865 c-3 -8 -2 -15 3 -15 5 0 14 7 21 15 10 12 10 15 -3 15 -8 0
-17 -7 -21 -15z"/>
<path d="M883 853 c-7 -2 -13 -16 -13 -31 l0 -25 25 23 c31 29 24 48 -12 33z"/>
<path d="M1335 830 c3 -5 8 -10 11 -10 2 0 4 5 4 10 0 6 -5 10 -11 10 -5 0 -7
-4 -4 -10z"/>
<path d="M1005 810 c-3 -5 1 -10 9 -10 9 0 16 5 16 10 0 6 -4 10 -9 10 -6 0
-13 -4 -16 -10z"/>
<path d="M1475 790 c10 -11 19 -20 19 -20 1 0 2 9 2 20 0 13 -7 20 -20 20 -18
0 -19 -1 -1 -20z"/>
<path d="M745 780 c-3 -5 1 -10 9 -10 9 0 16 5 16 10 0 6 -4 10 -9 10 -6 0
-13 -4 -16 -10z"/>
<path d="M1078 773 c7 -3 16 -2 19 1 4 3 -2 6 -13 5 -11 0 -14 -3 -6 -6z"/>
<path d="M1370 765 c7 -8 16 -12 21 -9 13 8 1 24 -18 24 -13 0 -13 -3 -3 -15z"/>
<path d="M987 753 c-13 -12 -7 -33 8 -33 8 0 15 9 15 20 0 20 -11 26 -23 13z"/>
<path d="M1040 745 c0 -8 2 -15 4 -15 2 0 6 7 10 15 3 8 1 15 -4 15 -6 0 -10
-7 -10 -15z"/>
<path d="M425 440 c3 -5 8 -10 11 -10 2 0 4 5 4 10 0 6 -5 10 -11 10 -5 0 -7
-4 -4 -10z"/>
<path d="M1991 1973 l1 -118 19 70 c25 94 25 141 -1 155 -19 10 -20 8 -19
-107z"/>
<path d="M930 1935 c-17 -21 -5 -31 15 -12 8 9 15 18 15 21 0 11 -18 6 -30 -9z"/>
<path d="M1437 1924 c-3 -4 -2 -15 3 -25 13 -23 -3 -34 -29 -19 -24 12 -31 13
-31 2 0 -9 44 -32 60 -32 6 0 10 6 10 14 0 7 7 19 15 26 20 16 19 34 -1 26 -8
-3 -12 -2 -9 4 7 11 -8 14 -18 4z"/>
<path d="M1259 1858 c-7 -25 -7 -48 1 -48 6 0 10 11 10 25 0 20 -7 35 -11 23z"/>
<path d="M1115 1821 c-3 -5 -1 -12 5 -16 5 -3 10 1 10 9 0 18 -6 21 -15 7z"/>
<path d="M1019 1797 c6 -8 8 -16 5 -20 -3 -3 3 -3 15 0 11 3 18 9 15 14 -3 5
-10 7 -15 4 -5 -4 -9 -1 -9 4 0 6 -5 11 -11 11 -8 0 -9 -4 0 -13z"/>
<path d="M1425 1800 c3 -5 8 -10 11 -10 2 0 4 5 4 10 0 6 -5 10 -11 10 -5 0
-7 -4 -4 -10z"/>
<path d="M1210 1784 c0 -17 17 -36 24 -26 3 5 -1 15 -9 22 -8 7 -15 9 -15 4z"/>
<path d="M1456 1733 c-6 -14 -5 -15 5 -6 7 7 10 15 7 18 -3 3 -9 -2 -12 -12z"/>
<path d="M520 1716 c0 -18 16 -29 30 -21 13 8 1 35 -16 35 -8 0 -14 -6 -14
-14z"/>
<path d="M1312 1660 c-7 -11 -10 -20 -6 -20 7 0 34 27 34 34 0 13 -16 5 -28
-14z"/>
<path d="M435 1610 c-3 -5 1 -10 10 -10 9 0 13 5 10 10 -3 6 -8 10 -10 10 -2
0 -7 -4 -10 -10z"/>
<path d="M2052 765 c-7 -14 -8 -25 -4 -25 12 0 32 39 23 44 -4 3 -13 -6 -19
-19z"/>
<path d="M2008 691 l-43 -40 35 -30 c39 -33 60 -39 60 -16 0 8 7 15 15 15 15
0 22 20 8 20 -5 0 -16 12 -26 26 -15 20 -16 28 -6 40 27 33 -3 23 -43 -15z"/>
<path d="M2090 460 c0 -5 5 -10 11 -10 5 0 7 5 4 10 -3 6 -8 10 -11 10 -2 0
-4 -4 -4 -10z"/>s
</g>
</svg>

`
      console.log('%c%s', 'color: green; background: black; font-size: 24px;', 'Success!')
    console.log('%c%s', 'color: green; background: yellow; font-size: 18px;', 'STATUS')
    console.log('%c%s', 'color: green; background: yellow; font-size: 18px;', "Sigma-client, running properly !")
    setTimeout(function () {
        document.querySelector("head > link:nth-child(24)").href = 'https://i.imgur.com/8GvnOfm.png';
    }, 4000);
    const my_css12 = GM_getResourceText("IMPORTED_CSS12");
    GM_addStyle(my_css12);
    const savegwt = localStorage.getItem('gwtenable')
    if (savegwt === "true") {
        document.querySelector("#gwt-log").classList = 'show';
    } else if (savegwt === "false") {
        document.querySelector("#gwt-log").classList = 'hidden';
    }
    document.querySelector("#gwt-log").style.width = '500px';
    document.querySelector("#gwt-log").style.height = '500px';
    document.querySelector("#gwt-log").style.fontSize = '0.9em';
    document.querySelector("#gwt-log").style.fontFamily = 'monospace';
    document.querySelector("#gwt-log").style.fontWeight = 'bold';
    document.querySelector("#gwt-log").style.top = '22px';
    document.querySelector("#gwt-log").style.left = '22px';
    document.querySelector("#gwt-log").style.color = '#8a2be2';
    document.querySelector("#gwt-log").style.opacity = '0.9';
    document.querySelector("#gwt-log").scrollTop = document.querySelector("#gwt-log").scrollHeight;
    const myDiv = document.querySelector("#gwt-log");
    //const container = document.createElement("div");
    //           container.classList = 'container';
    const gradientidk = document.createElement("div");
    //myNewDiv.style.border = "solid 1px";
    // myNewDiv.classList = 'moving-element';
    document.body.insertBefore(gradientidk, myDiv);
    //          container.appendChild(myDiv);
    gradientidk.appendChild(myDiv);

    //an issue with firebase that basically stops the code working but this will fix it
    if (localStorage) { // fix for API
        localStorage.removeItem("firebase:previous_websocket_failure");
    }
    const my_css9 = GM_getResourceText("IMPORTED_CSS9");
    GM_addStyle(my_css9);
    const my_css11 = GM_getResourceText("IMPORTED_CSS11");
    GM_addStyle(my_css11);
    setTimeout(function () {
        document.querySelector("head > title").innerText = 'Sigma-client (logged out)';
    }, 4000);
    // takes you to authentication page before tester role xd
    const chatMessageInput2 = document.getElementById('message');
    chatMessageInput2.addEventListener("keypress", function (event2) {
        if (event2.key === "Enter") {
            event2.preventDefault();
            if (chatMessageInput2.value == '/authenticate') {
                setTimeout(function () {
                    butterup.toast({
                        title: 'Sigma-client',
                        message: 'Taking you to auth page now!',
                        type: 'success',
                        icon: true,
                        customIcon: birdieSVG,
                    });
                }, 500);
                // document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:Taking you to auth page now!</span></li>';
                setTimeout(function () {
                    location.href = 'http://custom.client.blobgame.io/assets/';
                }, 4000);
                setTimeout(function () {
                    document.querySelector("#chat > ul").lastChild.remove();
                }, 200);
            }
        }
    });
    /*$.ajax({
              type: "GET",
              dataType: "json",
              url: "https://api.blobgame.io:988/api/users/myInfo",
              data: {
                      "api_ver": "4.7",
                      "pl": "3",
                      "token": blobioToken
              },
              success: function (data) {
                      console.log(data);
                      $.each(JSON.parse((data.name)), function () {
                              const blobioNameArray = [
                                      this.name
                              ];
                              console.log(blobioNameArray);
                      });
              }
      });*/
    if (loggedinDC) {
        console.log('logged in..');
    } else {
        setTimeout(function () {
            document.querySelector("#chat > ul").innerHTML += `<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:Hello ${blobbinickname} and welcome. To start, please type /authenticate</span></li>`;
        }, 4000);
    }
    //if tester accept, else deny access
    if (tester) {
        //an issue with firebase that basically stops the code working but this will fix it
        if (localStorage) { // fix for API
            localStorage.removeItem("firebase:previous_websocket_failure");
        }
        //tooltip
        const my_css4 = GM_getResourceText("IMPORTED_CSS4");
        GM_addStyle(my_css4);
        const my_css8 = GM_getResourceText("IMPORTED_CSS8");
        GM_addStyle(my_css8);
        const my_css9 = GM_getResourceText("IMPORTED_CSS9");
        GM_addStyle(my_css9);
        const my_css14 = GM_getResourceText("IMPORTED_CSS14");
        GM_addStyle(my_css14);
        const my_css15 = GM_getResourceText("IMPORTED_CSS15");
        GM_addStyle(my_css15);
        const my_css18 = GM_getResourceText("IMPORTED_CSS18");
        GM_addStyle(my_css18);
        const my_css19 = GM_getResourceText("IMPORTED_CSS19");
        GM_addStyle(my_css19);
        const my_css20 = GM_getResourceText("IMPORTED_CSS20");
        GM_addStyle(my_css20);
        const my_css22 = GM_getResourceText("IMPORTED_CSS22");
        GM_addStyle(my_css22);
        //FIXES LEADERBOARD WRAPPER AND MOUSE MENU WIDTH STRETCHING OUT TO MUCH BECAUSE OF IMPORTED CSS
        document.querySelector("#leader-board-wrapper").style.width = '180px';
        document.querySelector("#mouseMenu").style.width = '100px';
        //const partymodal = document.createElement('style')
        /*
                    <div class="text-container">
  weeeeee
</div>
*/
        // checks if you have installed code manually from dev tools
        setTimeout(function () {
            if (localStorage.getItem('config-mode') == 'UNOFFICIAL') {} else if (localStorage.getItem('config-mode') == 'PRIVATE') {} else {
                if ($('#findme-codeinstalled-yes-or-no').length > 0) {
                    // Exists.
                    console.log('%c%s', 'color: green; background: black; font-size: 24px;', "INSTALLED CODE SUCCESSFULLY");
                } else {
                    document.querySelector("body > script:nth-child(23)").remove();
                    //don't worry! just one more step, please follow instructions below
                    document.body.innerHTML = `





<div class="container"  id="skrollr-body" data-0="background-color:rgb(0,201,147);"data-400="background-color:rgb(74,173,255);" data-1000="background-color:rgb(74,173,255);"data-1300="background-color:rgb(0,201,147);">
  <h1><i class="icon-circle-blank"></i></h1>
  <h2>HELLO, script not detected or console drawer not open.</h2>
  <p> Don't worry! In just a few steps, you can start playing again. Just follow the instructions down below </p>

  <a class="arrow" href="#anchor1"><i class="icon-sort-down"></i></a>
  </p>

<div class="section" id="sect1">
  <div class="anchor" id="anchor1"></div>
  <div id="hiddenIcon">
    <i class="icon-mobile-phone"></i>
        </div>

  <div id="phone" data-0="margin-left: -20%; opacity:0" data-350="margin-left: 10%; opacity:1">
  <textarea id="getGameactivityScript"></textarea>

    <div id="topBar">
      <p>Press for video--->  <i class=""></i>         </p>
      <button id="sigmaHrefyt" style="display:flex;width:42px;height:25px;">hii</button>
       </div>
    <div id="screen">
      <div id="map">
          <img id="placemark" class="notPlacemarked" src="https://s.cdpn.io/52524/CircleMarkerTest3.png">
      </div><!--/ map-->
    </div><!--/ screen-->
    </div><!--/ phone-->
  <div class="explanation" data-300="opacity: 0" data-350="opacity: 1">
  <h2>A quick tutorial</h2>
    <p>At the moment I've found this is the only way for it to work and it's not hard to do, I've attached a video (see on left). This is not the same message you saw on the homepage it's required these 2 scripts to work (homepage) and (in the game), all you need to do is copy the script you see on the left inside that textbox and paste it/replace the existing script inside dev console (watch video to see what I mean). Keep in mind, it's best to keep the console drawer open all the time while playing or atleast for the first 10sec. The console is not in the way much, as you can minimize it and drag it to hide it further. This is a big script, it could cause lag while copying/pasting.</p>
    <a class="arrow" href="#anchor2"><i class="icon-sort-down"></i></a>
    </div><!--/ explanation-->
  </div><!--/ sect1-->

  <div class="section" id="sect2">
    <div class="anchor" id="anchor2"></div>
    <div id="hiddenIcon">
    <img src="https://i.imgur.com/9MWvUCg.png">
        </div>
    <div id="twitter"  data-600="margin-top: -20%; opacity: 0" data-1000="margin-top: 0; opacity:1">
    <img src="https://i.imgur.com/9MWvUCg.png">
    </div>
    <div class="explanation" data-850=" opacity: 0" data-900=" opacity:1">
    <h2>Finished?</h2>
    <button id="finishedinstallingcode" >click me! </button>
      <a class="arrow" href="#anchor3"><i class="icon-sort-down"></i></a>
    </div><!--/ explanation-->
  </div><!--sect2-->

    <div class="section" id="sect3">
    <div class="anchor" id="anchor3"></div>
      <div id="hiddenIcon">
    <i class="icon-rocket icon-rotate-180"></i>
        <p></p>
        </div>
    <div class="explanation-right" data-1350=" opacity: 0" data-1400=" opacity:1">
    <h2>having issues?</h2>
    <p>please send your thoughts in the Discord below (support) channel, thank you. <a href="https://discord.gg/VmZSq38Zs8">(Discord)</a></p>

<script src="https://api.tiles.mapbox.com/mapbox.js/v1.3.1/mapbox.js"></script>


    `
                  const pleaseinstallcodestyle = document.createElement('style');
                    pleaseinstallcodestyle.innerHTML = `

@import "compass/css3";
 @import url('https://fonts.googleapis.com/css?family=Signika');
 @import url('https://api.tiles.mapbox.com/mapbox.js/v1.3.1/mapbox.css');
 @import url('https://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css');
 html {
	 font-family: 'Signika', sans-serif;
}
 body {
	 background: #ddd7d1;
}
 #map {
	 position: absolute;
	 top: 0px;
	 bottom: 0;
	 width: 200%;
	 height: 2000px;
	 background-image: url('https://shared.cloudflare.steamstatic.com/store_item_assets/steam/apps/1050290/header.jpg?t=1731979011');
}
 .notPlacemarked {
	 visibility: hidden;
}
 .placemarked {
	 visibility: visible;
	 height: 55px;
	 width: 55px;
	 position: relative;
	 top: 110px;
	 margin-left: 40%;
	 z-index: 100;
	 transition: width 1s, height 1s, transform 1s;
	 -webkit-transition: width 1s, height 1s, -webkit-transform 1s;
}
 .container {
	 background: #00c993;
	 position: absolute;
	 display: block;
	 width: 100%;
	 height: 2050px;
	 color: white;
	 text-align: center;
	 min-width: 24px;
}
 .section {
	 position: absolute;
	 display: block;
	 width: 100%;
	 color: white;
	 text-align: left;
}
 #sect1 {
	 top: 400px;
}
 #sect2 {
	 top: 1000px;
}
 #sect3 {
	 top: 1500px;
}
 #footer {
	 top: 2050px;
	 height: 50px;
	 text-align: center;
}
 #twitter {
	 float: left;
	 width: 20%;
	 font-size: 5em;
	 padding-left: 15%;
}
 #rocket {
	 float: right;
	 width: 20%;
	 font-size: 5em;
	 padding-left: 15%;
}
 #hiddenIcon {
	 text-align: center;
	 visibility: hidden;
	 height: 0;
	 font-size: 5em;
}
 .anchor {
	 height: 100px;
}
 band2 h2 {
	 text-align: left;
}
 .explanation {
	 min-width: 12.42em;
	 float: left;
	 width: 40%;
}
 .explanation-right {
	 min-width: 12.42em;
	 float: left;
	 text-align: right;
	 padding-left: 5%;
	 width: 40%;
}
 #phone {
	 background: #ddd7d1;
	 border-radius: 30px;
	 box-shadow: 0 0.5em 0 #bcb1a5;
	 padding: 50px 18px 50px 18px;
	 width: 20%;
	 min-width: 200px;
	 max-width: 400px;
	 margin-right: 5%;
	 float: left;
}
 #screen {
	 background: #fff;
	 height: 300px;
	 overflow: hidden;
	 padding: 0;
	 position: relative;
	 min-width: 200px;
}
 #topBar {
	 background: #00c993;
	 height: 10%;
	 overflow: hidden;
	 padding-left: 10px;
	 padding-right: 10px;
	 position: relative;
	 min-width: 100px;
}
 #mc_embed_signup {
	 text-align: right;
	 background-color: #00c993;
}
 #mce-EMAIL {
	 text-align: right;
	 width: auto;
	 height: 30px;
	 margin-bottom: 20px;
	 padding-right: 1em;
	 border-style: none;
	 outline: none;
}
 #mce-EMAIL:focus {
	 outline: none;
}
 #mc-embedded-subscribe {
	 border-style: none;
}
 .icon-bookmark {
	 float: right;
}
 .icon-bookmark:hover {
	 color: #ffc52f;
}
 .pressed {
	 color: #ffc52f;
}
 h1, h3 {
	 font-family: 'Signika', sans-serif;
	 font-weight: 700;
	 text-align: center;
}
 .container h1 {
	 font-size: 5em;
	 line-height: 1em;
	/*margin-bottom: 1em;
	*/
}
 a {
	 color: white;
}
 .button {
	 background: #ddd7d1;
	 text-align: center;
	 padding: 0.5em 1em;
	 color: white;
	 font-weight: bold;
	 text-decoration: none;
	 box-shadow: 0 0.2em 0 #bcb1a5;
	 text-transform: uppercase;
	 letter-spacing: 0.1em;
	/*transition cross-browser stuff*/
	 -webkit-transition: background 0.2s ease-out;
	/* Safari 3.2+, Chrome */
	 -moz-transition: background 0.2s ease-out;
	/* Firefox 4-15 */
	 -o-transition: background 0.2s ease-out;
	/* Opera 10.5â€“12.00 */
	 transition: background 0.2s ease-out;
	/* Firefox 16+, Opera 12.50+ */
}
 .button:hover {
	 background: #bcb1a5;
}
 a.arrow {
	 color: white;
	 text-align: center;
	 font-size: 3em;
	 text-decoration: none;
	 padding-bottom: 30px;
	 -webkit-transition: color 0.2s ease-out;
	/*transition cross-browser stuff*/
	/* Safari 3.2+, Chrome */
	 -moz-transition: color 0.2s ease-out;
	/* Firefox 4-15 */
	 -o-transition: color 0.2s ease-out;
	/* Opera 10.5â€“12.00 */
	 transition: color 0.2s ease-out;
	/* Firefox 16+, Opera 12.50+ */
}
 a.arrow:hover {
	 color: #ffc52f;
}
 @media only screen and (min-width: 767px) {
	 body {
		 font-size: 1.125em;
		/* 18px / 16px */
	}
	 .container {
		 background-size: 100%;
	}
	 .container h1 {
		 font-size: 3.25em;
		/*52 / 16*/
	}
	 a.button {
		 padding: 0.75em 1.5em;
	}
}
 @media only screen and (max-width: 550px) {
	 .explanation {
		 float: none;
		 margin: auto;
		 text-align: center;
	}
	 .explanation-right {
		 float: none;
		 margin: auto;
		 text-align: center;
	}
	 #sect1 {
		 top: 350px;
	}
	 #phone {
		 visibility: hidden;
		 height: 0px;
		 width: 0px;
		 padding: 0;
		 margin: 0;
	}
	 #map {
		 width: 0px;
		 height: 0px;
	}
	 #sect2 {
		 top: 900px;
	}
	 #rocket {
		 visibility: hidden;
	}
	 #twitter {
		 visibility: hidden;
		 padding-left: 0em;
	}
	 #hiddenIcon {
		 visibility: visible;
		 height: auto;
	}
	 #mce-EMAIL {
		 text-align: center;
		 padding: 0;
		 float: none;
	}
	 #mc_embed_signup {
		 text-align: center;
	}
}



    `
                  document.body.appendChild(pleaseinstallcodestyle);
                    skrollr.init({
                        forceHeight: false
                    });
                    /*!
                   * Plugin for skrollr.
                   * This plugin makes hashlinks scroll nicely to their target position.
                   *
                   * Alexander Prinzhorn - https://github.com/Prinzhorn/skrollr
                   *
                   * Free to use under terms of MIT license
                   */
                    (function (document, window) {
                        'use strict';
                        var DEFAULT_DURATION = 500;
                        var DEFAULT_EASING = 'sqrt';
                        var MENU_TOP_ATTR = 'data-menu-top';
                        var MENU_OFFSET_ATTR = 'data-menu-offset';
                        var skrollr = window.skrollr;
                        var history = window.history;
                        var supportsHistory = !!history.pushState;
                        /*
                     	Since we are using event bubbling, the element that has been clicked
                     	might not acutally be the link but a child.
                     */
                        var findParentLink = function (element) {
                            //Yay, it's a link!
                            if (element.tagName === 'A') {
                                return element;
                            }
                            //We reached the top, no link found.
                            if (element === document) {
                                return false;
                            }
                            //Maybe the parent is a link.
                            return findParentLink(element.parentNode);
                        };
                        /*
                     	Handle the click event on the document.
                     */
                        var handleClick = function (e) {
                            //Only handle left click.
                            if ((e.which || e.button) !== 1) {
                                return;
                            }
                            var link = findParentLink(e.target);
                            //The click did not happen inside a link.
                            if (!link) {
                                return;
                            }
                            if (handleLink(link)) {
                                e.preventDefault();
                            }
                        };
                        /*
                     	Handles the click on a link. May be called without an actual click event.
                     	When the fake flag is set, the link won't change the url and the position won't be animated.
                     */
                        var handleLink = function (link, fake) {
                            //Don't use the href property (link.href) because it contains the absolute url.
                            var href = link.getAttribute('href');
                            //Check if it's a hashlink.
                            if (!/^#/.test(href)) {
                                return false;
                            }
                            //Now get the targetTop to scroll to.
                            var targetTop;
                            //If there's a data-menu-top attribute, it overrides the actuall anchor offset.
                            var menuTop = link.getAttribute(MENU_TOP_ATTR);
                            if (menuTop !== null) {
                                targetTop = +menuTop;
                            } else {
                                var scrollTarget = document.getElementById(href.substr(1));
                                //Ignore the click if no target is found.
                                if (!scrollTarget) {
                                    return false;
                                }
                                targetTop = _skrollrInstance.relativeToAbsolute(scrollTarget, 'top', 'top');
                                var menuOffset = scrollTarget.getAttribute(MENU_OFFSET_ATTR);
                                if (menuOffset !== null) {
                                    targetTop += +menuOffset;
                                }
                            }
                            if (supportsHistory && !fake) {
                                history.pushState({
                                    top: targetTop
                                }, '', href);
                            }
                            //Now finally scroll there.
                            if (_animate && !fake) {
                                _skrollrInstance.animateTo(targetTop, {
                                    duration: _duration(_skrollrInstance.getScrollTop(), targetTop),
                                    easing: _easing
                                });
                            } else {
                                defer(function () {
                                    _skrollrInstance.setScrollTop(targetTop);
                                });
                            }
                            return true;
                        };
                        var defer = function (fn) {
                            window.setTimeout(fn, 1);
                        };
                        /*
                     	Global menu function accessible through window.skrollr.menu.init.
                     */
                        skrollr.menu = {};
                        skrollr.menu.init = function (skrollrInstance, options) {
                            _skrollrInstance = skrollrInstance;
                            options = options || {};
                            _easing = options.easing || DEFAULT_EASING;
                            _animate = options.animate !== false;
                            _duration = options.duration || DEFAULT_DURATION;
                            if (typeof _duration === 'number') {
                                _duration = (function (duration) {
                                    return function () {
                                        return duration;
                                    };
                                }(_duration));
                            }
                            //Use event bubbling and attach a single listener to the document.
                            skrollr.addEvent(document, 'click', handleClick);
                            if (supportsHistory) {
                                window.addEventListener('popstate', function (e) {
                                    var state = e.state || {};
                                    var top = state.top || 0;
                                    defer(function () {
                                        _skrollrInstance.setScrollTop(top);
                                    });
                                }, false);
                            }
                        };
                        //Private reference to the initialized skrollr.
                        var _skrollrInstance;
                        var _easing;
                        var _duration;
                        var _animate;
                        //In case the page was opened with a hash, prevent jumping to it.
                        //http://stackoverflow.com/questions/3659072/jquery-disable-anchor-jump-when-loading-a-page
                        defer(function () {
                            if (window.location.hash) {
                                window.scrollTo(0, 0);
                                if (document.querySelector) {
                                    var link = document.querySelector('a[href="' + window.location.hash + '"]');
                                    if (link) {
                                        handleLink(link, true);
                                    }
                                }
                            }
                        });
                    }(document, window));
                    var s = skrollr.init( /*other stuff*/ );
                    //The options (second parameter) are all optional. The values shown are the default values.
                    skrollr.menu.init(s, {
                        //skrollr will smoothly animate to the new position using `animateTo`.
                        animate: true,
                        //The easing function to use.
                        easing: 'sqrt',
                        //How long the animation should take in ms.
                        duration: function (currentTop, targetTop) {
                            //By default, the duration is hardcoded at 500ms.
                            return 1000;
                            //But you could calculate a value based on the current scroll position (`currentTop`) and the target scroll position (`targetTop`).
                            //return Math.abs(currentTop - targetTop) * 10;
                        },
                    });
                    $(".icon-bookmark").click(function () {
                        $("#placemark").addClass("placemarked");
                        $(".icon-bookmark").addClass("pressed");
                    });
                    document.getElementById('sigmaHrefyt').addEventListener('click', function () {
                        window.open('https://youtu.be/nS36IIcqNYg');
                    });
                    document.getElementById('finishedinstallingcode').addEventListener('click', function () {
                        location.href = window.location.href.slice(0, -8);
                    });
                    GM_xmlhttpRequest({
                        url: 'https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/overrideScript_gameactivity',
                        onload: (data) => {
                            document.getElementById('getGameactivityScript').innerText = (data.responseText);
                        }
                    });
                    document.querySelector("head").remove();
                    console.log('%c%s', 'color: green; background: black; font-size: 24px;', "CODE NOT INSTALLED");
                }
            }
        }, 5000);

        //bug reports ting
        setTimeout(function () {
            $(document.querySelector("body")).append(`


<div id="bugreportss" class="hidden" style="pointer-events:none">
  <li uid="0" style="color: grey;font-size:2em; top:100px;left:20px;position: fixed;opacity:0.4;">Known errors/bugs</li>
  <li uid="0" style="color: grey;font-size:0.7em; top:150px;left:20px;position: fixed;opacity:0.4;width:300px;">When you report someone and then report again without refreshing page, the screenshot merges with the previous screenshot, and sends both.</li>
  <li uid="0" style="color: grey;font-size:0.7em; top:200px;left:20px;position: fixed;opacity:0.4;width:300px;">This is something that happens very randomly. If you click unfriend, you MIGHT see that it worked as expected but then when you check your friendslist, they're still there! This is because it first successfully unfriends the person but then by its self resends a friend request.</li>
  <li uid="0" style="color: grey;font-size:0.7em; top:277px;left:20px;position: fixed;opacity:0.4;width:300px;">After playing for a certain amount of time continually, about 10mins or less. You might see insane fps drops, to the point you can't really play the game.</li>
  <li uid="0" style="color: rgb(105,105,105);font-size:0.7em; top:327px;left:20px;position: fixed;opacity:0.7;width:300px;">These logs only appear in this early demo version, you can always turn off this feature in the /settings.</li>
</div>


`);
        }, 5000);
        //

        //party PARTY PART YPART APRTAPRAPTAPRTFNASKDFASDLKJG
        function insertAfter(referenceNode, newNode) {
            referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);
        }
        document.querySelector("#rules-dialog").innerHTML += `

<div id="partygradbg" class="gradient-bg">
  <svg xmlns="http://www.w3.org/2000/svg">
    <defs>
      <filter id="goo">
        <feGaussianBlur in="SourceGraphic" stdDeviation="10" result="blur" />
        <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -8" result="goo" />
        <feBlend in="SourceGraphic" in2="goo" />
      </filter>
    </defs>
  </svg>
  <div class="gradients-container">
    <div class="g1"></div>
    <div class="g2"></div>
    <div class="g3"></div>
    <div class="g4"></div>
    <div class="g5"></div>
    <div class="interactive"></div>
  </div>
</div>
                    `

         function makeid(length) {
             let result = '';
             const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
             const charactersLength = characters.length;
             let counter = 0;
             while (counter < length) {
                 result += characters.charAt(Math.floor(Math.random() * charactersLength));
                 counter += 1;
             }
             return result;
         }
        // document.querySelector("#rules-dialog").innerHTML += '<div class="dialog-bg"></div>'
        var filter = document.createElement("span");
        filter.innerHTML = `<div class="dialog-bg"></div>`;
        var dialoggg = document.querySelector("#rules-dialog > button");
        insertAfter(dialoggg, filter);
        document.querySelector("#rules-dialog").style.width = '360px';
        document.querySelector("#rules-dialog > button").style.backgroundColor = '060D0D';
        document.querySelector("#rules-dialog").style.borderRadius = '35px';
        document.querySelector("#rules-dialog").style.borderWidth = '17.5px';
        document.querySelector("#rules-dialog > div:nth-child(1) > ul").innerHTML = '';
        document.getElementById('partygradbg').style.position = 'absolute';
        document.getElementById('partygradbg').style.zIndex = '-1';
        document.getElementById('partygradbg').style.opacity = '0.74';
        var crateparty = document.createElement("span");
        crateparty.innerHTML = `<button id="clickcrprty" style="scale: 0.8; background-color: rgb(6, 13, 13);">Create party</button>`;
        var okbutton = document.querySelector("#rules-dialog > div:nth-child(1)");
        insertAfter(okbutton, crateparty);
        //document.getElementById('clickleavecrprty').style.scale = '0.9';
        var leaveparty = document.createElement("span");
        leaveparty.innerHTML = `<button id="clickleavecrprty" style="scale: 0.8; background-color: rgb(6, 13, 13);">Leave party</button>`;
        var okbutton3 = document.getElementById("clickcrprty");
        insertAfter(okbutton3, leaveparty);
        //document.getElementById('clickleavecrprty').style.scale = '0.9';
        var prtynameinput = document.createElement("span");
        prtynameinput.innerHTML = `<input id="partynameinput" style="background-color: rgb(6, 13, 13); color: #FAFAFA;" placeholder="Party name">`;
        var okbutton2 = document.querySelector("#rules-dialog > div:nth-child(1)");
        insertAfter(okbutton2, prtynameinput);
        var clannameinput = document.createElement("span");
        clannameinput.innerHTML = `<input id="clannameinput" style="background-color: rgb(6, 13, 13); color: #FAFAFA;" placeholder="Clan name">`;
        //var okbutton2 = document.querySelector("#rules-dialog > div:nth-child(1)");
        insertAfter(okbutton2, clannameinput);
        //MASS COUNTER STUFF
        let massCounter = document.createElement('div');
        massCounter.innerHTML = `
<textarea id="massCounter" style="display: none;">0</textarea>
`
         document.body.appendChild(massCounter);
        document.querySelector("#rules-dialog > div:nth-child(1)").style.height = '130px';
        document.querySelector("#rules-dialog > div:nth-child(1)").style.overflow = 'auto';
        setTimeout(function () {
            // redacted because of issues like when opening private server list then this element has not been created yet inside main blobio script, so it can't read the innerText, so an error...
            //var scoreccc = document.getElementById('scoreCounter').innerText;
            //document.getElementById('massCounter').innerText = scoreccc;
        }, 5000);
        if (!localStorage.prtyName) {
            console.log("localstorage party stuff doesnt exist yet");
        } else {
            if (localStorage.getItem('clanName') === 'null' || localStorage.getItem('prtyName') === 'null' || localStorage.getItem('prtyName') === 'undefined') {
                console.log("not in any party");
                //return;
            } else {
                document.getElementById('partynameinput').value = ("(In party/" + localStorage.getItem('codeparty') + ")");
                document.getElementById('partynameinput').disabled = true;
                document.getElementById('clannameinput').value = ("[" + localStorage.getItem('clanName') + "] ");
                document.getElementById('clannameinput').disabled = true;
                //document.getElementById("clickcrprty").disabled = true;
                document.getElementById("clickcrprty").style.color = 'gray';
                document.getElementById('partynameinput').style.color = 'gray';
                document.getElementById('clannameinput').style.color = 'gray';
                setTimeout(function () {
                    let partyBoard = document.createElement('div');
                    partyBoard.innerHTML = `

    <div id="partyBoard-wrapper" class="container" style="display: block;">
    <div id="party-board">
        <ul><li uid="0">â”‚PARTY/${localStorage.getItem('codeparty')}â”‚ prefix: [${localStorage.getItem('clanName')}] â”‚LEADER: team 1catâ”‚</li><li uid="0"> ------------- Top leaderboard clan: (him) with 1.031.520 Total mass! ----------------------------------</li><li uid="0">1.</li><ul id="otherplayersingamepartmodal"><li uid="0"></li></ul></ul>
        <canvas id="pie-chart" class="hidden"></canvas>
    </div>
</div>
`
                  partyBoard.style.position = 'fixed';
                    partyBoard.style.bottom = '3px';
                    partyBoard.style.marginBottom = '550px';
                    partyBoard.style.borderColor = '#743089';
                    document.body.appendChild(partyBoard);
                    setTimeout(function () {
                        function foo33() {
                            var massCount2 = document.querySelector("#scoreCounter").textContent;
                            document.querySelector("#party-board > ul > li:nth-child(3)").innerText = ('Me: ' + massCount2);
                            setTimeout(foo33, 1000);
                        }
                        foo33();
                    }, 1000);
                }, 5000);
            }
        }
        if (document.querySelector("#partynameinput").disabled == false) {
            document.getElementById("clickleavecrprty").innerText = 'Join party';
        } else {}
        document.getElementById('clickleavecrprty').addEventListener('click', leavepartyfunc);
        document.getElementById('clickcrprty').addEventListener('click', createpartyfunc);

        function createpartyfunc() {
            if (document.getElementById("clickcrprty").style.color == 'gray') {
                butterup.toast({
                    title: 'Sigma-client Party',
                    message: "Already in a party..",
                    type: 'error',
                    //icon: true,
                    //customIcon: birdieSVG,
                });
            } else {
                butterup.toast({
                    title: 'Sigma-client Party',
                    message: "Creating! wait..",
                    type: 'success',
                    //icon: true,
                    //customIcon: birdieSVG,
                });
                var clanbro = document.getElementById('clannameinput').value;
                var brooooo = document.getElementById('partynameinput').value;
                console.log(brooooo);
                localStorage.setItem('clanName', clanbro);
                localStorage.setItem('prtyName', brooooo);
                localStorage.setItem('codeparty', makeid(5));
                setTimeout(function () {
                    location.reload();
                }, 3000);
            }
        }

        function leavepartyfunc() {
            if (document.getElementById("clickleavecrprty").innerText == 'Join party') {
                console.log("joining raaaaaarrrh");
                console.log(document.getElementById('partynameinput').value);
                localStorage.setItem('codeparty', document.getElementById('partynameinput').value);
            } else {
                butterup.toast({
                    title: 'Sigma-client Party',
                    message: "Leaving..",
                    type: 'success',
                    //icon: true,
                    //customIcon: birdieSVG,
                });
                localStorage.setItem('clanName', 'null');
                localStorage.setItem('prtyName', 'null');
                localStorage.setItem('codeparty', 'null');
                setTimeout(function () {
                    location.reload();
                }, 3000);
            }
        }
        //document.head.appendChild('style');
        var blobId = JSON.parse(atob(localStorage.getItem("access-token").split(".")[1]))["userId"];
        //sends server welcome
        setTimeout(function () {
            function foo() {
                document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:You are a â—¦â™¡Â°PremiumÂ°â™¡â—¦ user </span></li>';
                setTimeout(foo, 180000);
            }
            foo();
        }, 4000);
        //sends server tip that you can logout with /authenticate in chat
        setTimeout(function () {
            function foo() {
                document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">HELPER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(20,185,255);">:You can logout by typing /authenticate</span></li>';
                setTimeout(foo, 180000);
            }
            foo();
        }, 240000);
        //sends welcome toast to start with commands
        butterup.toast({
            title: 'Sigma-client',
            message: ("Nice to see you, " + blobbinickname + " (" + dcnameeee + ")" + " to begin type /commands"),
            type: 'info',
            icon: true,
            customIcon: birdieSVG,
        });
        const skiprestart = localStorage.getItem('skiprestart');
        if (skiprestart === "on") {
            const keyword = "Restart (4)";

            function checkForKeyword() {
                const pageContent = document.body.textContent || document.body.innerText;
                return pageContent.includes(keyword);
            }

            function refreshPage() {
                console.log("found restart");
                document.getElementById('restart-game').disabled = false;
                document.getElementById('restart-game').innerText = "Restart";
                setInterval(function () {
                    document.getElementById('restart-game').disabled = false;
                    document.getElementById('restart-game').innerText = "Restart";
                }, 400);
                setInterval(function () {
                    document.getElementById('restart-game').disabled = false;
                    document.getElementById('restart-game').innerText = "Restart";
                }, 600);
                setInterval(function () {
                    document.getElementById('restart-game').disabled = false;
                    document.getElementById('restart-game').innerText = "Restart";
                }, 800);
                setInterval(function () {
                    document.getElementById('restart-game').disabled = false;
                    document.getElementById('restart-game').innerText = "Restart";
                }, 1000);
                //document.querySelector("#restart-game").innerHTML = '<button id="restart-game">Restart</button>';
                return;
            }
            setInterval(function () {
                if (checkForKeyword()) {
                    //console.log("FOUND RESTART ?????")
                    refreshPage();
                }
            }, 100);
            setTimeout(function () {
                document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:Skip restart timer on, type "/skiprestart off" to stop.</span></li>';
            }, 4000);
        }
        //const customSkinURL = customSkin();
        // function customSkin(){
        const customskin = localStorage.getItem('customskin');
        //later can be localstorage... tinggsss
        var customSkinChaturl = 'https://wallpapers.com/images/featured/best-cool-40lkhq7b7tl3p1qw.jpg';
        if (customskin === "on") {
            console.log("skin is TURNED on..");
            const intercept = (urlmatch, newurl) => {
                const open = XMLHttpRequest.prototype.open;
                XMLHttpRequest.prototype.open = function (method, url, ...rest) {
                    url = url.replace(urlmatch, newurl);
                    return open.call(this, method, url, ...rest);
                };
            }
            intercept('https://custom.client.blobgame.io/skins/premium/deer.png', 'https://wallpapers.com/images/featured/best-cool-40lkhq7b7tl3p1qw.jpg');
            setTimeout(function () {
                document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:IDK on, type "/test off" to stop.</span></li>';
            }, 4000);
        }

        //EVENTS LEADERBOARD STUFF

        const blabla = document.createElement('style');
        blabla.id = 'EVENTstyle';
        blabla.innerHTML = `


.leaderboard {
	width: 30rem;
	box-shadow: 1px 1px 8px 0 #cccccc;
	background: #ffffff;
	color: #555555;
}

.leaderboard--header {
	width: 100%;
	height: 4rem;
	font-size: 0.75rem;
	background: #33333a;
	color: #eef;
}

.leaderboard--item {
	display: flex;
	flex-flow: row nowrap;
	height: 100%;
	align-items: center;
	border-bottom: 1px solid #cccccf;
}

.leaderboard--item--cell {
	box-sizing: border-box;
	height: 100%;
	padding: 1rem;
	display: flex;
	align-items: center;
}

.leaderboard--item--cell__rank {
	width: 12%;
}

.leaderboard--item--cell__user {
	flex-grow: 1;
}

.leaderboard--item--cell__thirty {
	width: 25%;
}

.leaderboard--item--cell__alltime {
	width: 25%;
}



`
         document.querySelector("body").appendChild(blabla);

        $(document.querySelector("body")).append(`

<div id="leader-board-wrapper" class="container" style="width: 230px; display: none;left:40px;">
    <div id="leader-board">
        <ul><li uid="0" style="color: cyan;width: 230px;">NEW EVENT!/ Current event:</li></ul>

    <button id="openLeaderboard">SEE</button></div>
</div>

`);

        document.getElementById('openLeaderboard').addEventListener('click', function () {
            //new report gui..
            const eventsboard = document.createElement('div');
            eventsboard.id = 'eventsboarddd';
            eventsboard.innerHTML += `
  <div id="contact" style="width:500px;">
  <button name="cancel" type="close" id="closeleaderboardd">X</button>
    <h3 id="reportwho">Competition</h3>
    <h4>First to reach 1.000.000 total mass in CRAZY!</h4>
    <h4>Prize: 20$usd</h4>
    <h4>Time left: 0:59</h4>
    <fieldset>
      <input id="shrtsummary" placeholder="Short Summary" type="text" tabindex="2" required hidden>
    </fieldset>
    <fieldset>
      <div class="container" style="width:333px;">
	<div class="leaderboard" style="height:300px;width:333px; overflow:scroll;">
		<div class="leaderboard--header">
			<div class="leaderboard--item">
				<div class="leaderboard--item--cell leaderboard--item--cell__rank">
					<span>Rank</span>
				</div>
				<div class="leaderboard--item--cell leaderboard--item--cell__user">
					<span>User</span>
				</div>
				<div class="leaderboard--item--cell leaderboard--item--cell__thirty">
					<span>Clan</span>
				</div>
				<div class="leaderboard--item--cell leaderboard--item--cell__alltime">
					<span>Total-mass</span>
				</div>
			</div>
		</div>
		<div class="leaderboard--list">
			<div class="leaderboard--item">
				<div class="leaderboard--item--cell leaderboard--item--cell__rank">
					1
				</div>
				<div class="leaderboard--item--cell leaderboard--item--cell__user">
					some person
				</div>
				<div class="leaderboard--item--cell leaderboard--item--cell__thirty">
					[TYT]
				</div>
				<div class="leaderboard--item--cell leaderboard--item--cell__alltime">
					321.654
				</div>
			</div>
			<div class="leaderboard--item">
				<div class="leaderboard--item--cell leaderboard--item--cell__rank">
					2
				</div>
				<div class="leaderboard--item--cell leaderboard--item--cell__user">
					oksas
				</div>
				<div class="leaderboard--item--cell leaderboard--item--cell__thirty">

				</div>
				<div class="leaderboard--item--cell leaderboard--item--cell__alltime">
					254.876
				</div>
			</div>
			<div class="leaderboard--item">
				<div class="leaderboard--item--cell leaderboard--item--cell__rank">
					2
				</div>
				<div class="leaderboard--item--cell leaderboard--item--cell__user">
					bot
				</div>
				<div class="leaderboard--item--cell leaderboard--item--cell__thirty">

				</div>
				<div class="leaderboard--item--cell leaderboard--item--cell__alltime">
					544
				</div>
			</div>
			<div class="leaderboard--item">
				<div class="leaderboard--item--cell leaderboard--item--cell__rank">
					2
				</div>
				<div class="leaderboard--item--cell leaderboard--item--cell__user">
					bot2
				</div>
				<div class="leaderboard--item--cell leaderboard--item--cell__thirty">

				</div>
				<div class="leaderboard--item--cell leaderboard--item--cell__alltime">
					511
				</div>
			</div>
			<div class="leaderboard--item">
				<div class="leaderboard--item--cell leaderboard--item--cell__rank">
					3
				</div>
				<div class="leaderboard--item--cell leaderboard--item--cell__user">
					team 1cat
				</div>
				<div class="leaderboard--item--cell leaderboard--item--cell__thirty">

				</div>
				<div class="leaderboard--item--cell leaderboard--item--cell__alltime">
					486
				</div>
			</div>
		</div>
	</div>
</div>
    </fieldset>
    <fieldset>
      <button id="somebuttonidkyet">Enter event</button>
    </fieldset>
        <fieldset>
    <p class="copyright"hidden>Attached screenshot</a></p>
    <a href="https://discord.gg/VmZSq38Zs8" target="_blank"><img id="screenshotPlaceholder2" src="https://i.imgur.com/8GvnOfm.png" style="display: flex; width: 50px;"hidden></img></a>
        </fieldset>
  </div>
    <div id="partygradbg" class="gradient-bg" style="position: fixed; z-index: -1; opacity: 0.5;"hidden>
  <svg xmlns="http://www.w3.org/2000/svg">
    <defs>
      <filter id="goo">
        <feGaussianBlur in="SourceGraphic" stdDeviation="10" result="blur"></feGaussianBlur>
        <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -8" result="goo"></feColorMatrix>
        <feBlend in="SourceGraphic" in2="goo"></feBlend>
      </filter>
    </defs>
  </svg>
  <div class="gradients-container">
    <div class="g1"></div>
    <div class="g2"></div>
    <div class="g3"></div>
    <div class="g4"></div>
    <div class="g5"></div>
    <div class="interactive"></div>
  </div>
</div>
          `
            eventsboard.style.display = 'flex';
            eventsboard.style.bottom = '20px';
            eventsboard.style.left = '500px';
            eventsboard.style.justifyContent = 'center';
            eventsboard.style.position = 'fixed';
            document.body.appendChild(eventsboard);
            document.getElementById('somebuttonidkyet').style.textAlign = 'center';
            document.getElementById('somebuttonidkyet').style.border = '0';
            document.getElementById('somebuttonidkyet').style.backgroundColor = '#6bd505';
            document.getElementById('somebuttonidkyet').style.color = 'white';
            document.getElementById('somebuttonidkyet').style.height = '46px';
            document.getElementById('somebuttonidkyet').style.width = '135px';
            document.getElementById('somebuttonidkyet').style.marginRight = '20px';
            document.getElementById('somebuttonidkyet').style.borderRadius = '25px';
            document.getElementById('somebuttonidkyet').style.fontWeight = 'bold';
            document.getElementById('somebuttonidkyet').style.fontSize = '12pt';
            document.getElementById('somebuttonidkyet').style.scale = '0.8';
            document.getElementById('contact').style.borderRight = '5rem solid';
            document.getElementById('contact').style.borderRadius = '20px';
            document.getElementById('contact').style.borderColor = '#A020F0';
            document.getElementById('contact').style.backgroundPosition = 'right';
            document.getElementById('somebuttonidkyet').addEventListener('click', function () {

                butterup.toast({
                    title: 'Sigma-client',
                    message: "Must be verified to enter!",
                    type: 'error',
                    icon: true,
                    customIcon: birdieSVG,
                });

                ;
            });
            //clicks close start
            document.getElementById('closeleaderboardd').addEventListener('click', function () {
                document.getElementById('eventsboarddd').remove();
            });
            //clicks close end

        });
        //        const testfire = document.createElement('module');
        //        testfire.innerHTML ='<script>import { addDoc, collection, getDocs, getFirestore, limit, orderBy, query, updateDoc, where } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-firestore.js"</script>'
        //document.body.appendChild(testfire);

        /*  const firebaseConfig = {
            apiKey: "AIzaSyC0Pyz6If_5rFxYvNovtkPxjbqGJbfQCys",
            authDomain: "sigma-client-cd875.firebaseapp.com",
            databaseURL: "https://sigma-client-cd875-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "sigma-client-cd875",
            storageBucket: "sigma-client-cd875.firebasestorage.app",
            messagingSenderId: "807269659313",
            appId: "1:807269659313:web:f0ec6ab2d811bdcfa3e890"
         };
         // Initialize Firebase
         firebase.initializeApp(firebaseConfig);*/

        //leaderboard stuff

        /*      const app = firebase.initializeApp(firebaseConfig);
                 const IsUsernameExist = async (username) => {
             const db = getFirestore(app);
             const querySnapshot = await getDocs(query(collection(db, "leaderboard"), where("username", "==", username)));
             return querySnapshot.size > 0;
         }

         const AddUserInLeaderboard = async (username, score) => {
             const db = getFirestore(app);

             try {
                 const isUsernameExist = await IsUsernameExist(username);
                 if (isUsernameExist) {
                     const querySnapshot = await getDocs(query(collection(db, "leaderboard"), where("username", "==", username)));
                     querySnapshot.forEach((doc) => {
                         updateDoc(doc.ref, { score: score });
                     });
                     return true;
                 }
                 const docRef = await addDoc(collection(db, "leaderboard"), {
                     username: username,
                     score: score
                 });
                 return true;
             } catch (e) {
                 console.error("Error adding document: ", e);
             }

             return false;
         }

         const GetLeaderboard = async () => {
             const db = getFirestore(app);
             const querySnapshot = await getDocs(query(collection(db, "leaderboard"), orderBy("score", "desc"), limit(10)));
             let leaderboard = [];
             querySnapshot.forEach((doc) => {
                 leaderboard.push(doc.data());
             });
             return leaderboard;
         }

         //leaderboard end
         AddUserInLeaderboard('test', 9000);
         */
        /*        const asdfsadadf = document.createElement('style')

                 asdfsadadf.innerhtml = `



         #magic {

           position: fixed;
           width: 100%;
           height: 100vh;
           display: block;
           top: 0;
           left: 0;
           z-index: -9999;
         }

         .playground{

           position: fixed;
           width: 100%;
           height: 100vh;
           display: block;
           top: 0;
           left: 0;
           display: flex;
           flex-wrap: nowrap;
           flex-direction: column;
           justify-content: flex-end;
           align-items: center;

         }
         .bottomPosition{

           text-align: center;
           margin-bottom: 50px;

         }
         .minText{

           font-size: 14px;
         }

         a {
           color: white;
           font-size: 12px;
           text-decoration: none;
         }

         .logo {
             width: 50px;
             height: 50px;
         }


         `
                 document.body.appendChild(asdfsadadf);

                     $(document.querySelector("body")).append(`


         <div id="magic"></div>
         <div class="playground">
         </div>

         `);*/
        /*
                     setTimeout(function () {

                               const preload = () => {

           let manager = new THREE.LoadingManager();
           manager.onLoad = function() {
             const environment = new Environment( typo, particle );
           }

           var typo = null;
           const loader = new THREE.FontLoader( manager );
           const font = loader.load('https://res.cloudinary.com/dydre7amr/raw/upload/v1612950355/font_zsd4dr.json', function ( font ) { typo = font; });
           const particle = new THREE.TextureLoader( manager ).load( 'https://res.cloudinary.com/dfvtkoboz/image/upload/v1605013866/particle_a64uzf.png');

         }

         if ( document.readyState === "complete" || (document.readyState !== "loading" && !document.documentElement.doScroll))
           preload ();
         else
           document.addEventListener("DOMContentLoaded", preload );

         class Environment {

           constructor( font, particle ){

             this.font = font;
             this.particle = particle;
             this.container = document.querySelector( '#magic' );
             this.scene = new THREE.Scene();
             this.createCamera();
             this.createRenderer();
             this.setup()
             this.bindEvents();
           }

           bindEvents(){

             window.addEventListener( 'resize', this.onWindowResize.bind( this ));

           }

           setup(){

             this.createParticles = new CreateParticles( this.scene, this.font,             this.particle, this.camera, this.renderer );
           }

           render() {

              this.createParticles.render()
              this.renderer.render( this.scene, this.camera )
           }

           createCamera() {

             this.camera = new THREE.PerspectiveCamera( 65, this.container.clientWidth /  this.container.clientHeight, 1, 10000 );
             this.camera.position.set( 0,0, 100 );

           }

           createRenderer() {

             this.renderer = new THREE.WebGLRenderer();
             this.renderer.setSize( this.container.clientWidth, this.container.clientHeight );

             this.renderer.setPixelRatio( Math.min( window.devicePixelRatio, 2));

             this.renderer.outputEncoding = THREE.sRGBEncoding;
             this.container.appendChild( this.renderer.domElement );

             this.renderer.setAnimationLoop(() => { this.render() })

           }

           onWindowResize(){

             this.camera.aspect = this.container.clientWidth / this.container.clientHeight;
             this.camera.updateProjectionMatrix();
             this.renderer.setSize( this.container.clientWidth, this.container.clientHeight );

           }
         }

         class CreateParticles {

         	constructor( scene, font, particleImg, camera, renderer ) {

         		this.scene = scene;
         		this.font = font;
         		this.particleImg = particleImg;
         		this.camera = camera;
         		this.renderer = renderer;

         		this.raycaster = new THREE.Raycaster();
         		this.mouse = new THREE.Vector2(-200, 200);

         		this.colorChange = new THREE.Color();

         		this.buttom = false;

         		this.data = {

         			text: 'support',
         			amount: 1500,
         			particleSize: 1,
         			particleColor: 0xffffff,
         			textSize: 16,
         			area: 250,
         			ease: .05,
         		}

         		this.setup();
         		this.bindEvents();

         	}


         	setup(){

         		const geometry = new THREE.PlaneGeometry( this.visibleWidthAtZDepth( 100, this.camera ), this.visibleHeightAtZDepth( 100, this.camera ));
         		const material = new THREE.MeshBasicMaterial( { color: 0x00ff00, transparent: true } );
         		this.planeArea = new THREE.Mesh( geometry, material );
         		this.planeArea.visible = false;
         		this.createText();

         	}

         	bindEvents() {

         		document.addEventListener( 'mousedown', this.onMouseDown.bind( this ));
         		document.addEventListener( 'mousemove', this.onMouseMove.bind( this ));
         		document.addEventListener( 'mouseup', this.onMouseUp.bind( this ));

         	}

         	onMouseDown(){

         		this.mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;
         		this.mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;

         		const vector = new THREE.Vector3( this.mouse.x, this.mouse.y, 0.5);
         		vector.unproject( this.camera );
         		const dir = vector.sub( this.camera.position ).normalize();
         		const distance = - this.camera.position.z / dir.z;
         		this.currenPosition = this.camera.position.clone().add( dir.multiplyScalar( distance ) );

         		const pos = this.particles.geometry.attributes.position;
         		this.buttom = true;
         		this.data.ease = .01;

         	}

         	onMouseUp(){

         		this.buttom = false;
         		this.data.ease = .05;
         	}

         	onMouseMove( ) {

         	    this.mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;
         	    this.mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;

         	}

         	render( level ){

         		const time = ((.001 * performance.now())%12)/12;
         		const zigzagTime = (1 + (Math.sin( time * 2 * Math.PI )))/6;

         		this.raycaster.setFromCamera( this.mouse, this.camera );

         		const intersects = this.raycaster.intersectObject( this.planeArea );

         		if ( intersects.length > 0 ) {

         			const pos = this.particles.geometry.attributes.position;
         			const copy = this.geometryCopy.attributes.position;
         			const coulors = this.particles.geometry.attributes.customColor;
         			const size = this.particles.geometry.attributes.size;

         		    const mx = intersects[ 0 ].point.x;
         		    const my = intersects[ 0 ].point.y;
         		    const mz = intersects[ 0 ].point.z;

         		    for ( var i = 0, l = pos.count; i < l; i++) {

         		    	const initX = copy.getX(i);
         		    	const initY = copy.getY(i);
         		    	const initZ = copy.getZ(i);

         		    	let px = pos.getX(i);
         		    	let py = pos.getY(i);
         		    	let pz = pos.getZ(i);

         		    	this.colorChange.setHSL( .5, 1 , 1 )
         		    	coulors.setXYZ( i, this.colorChange.r, this.colorChange.g, this.colorChange.b )
         		    	coulors.needsUpdate = true;

         		    	size.array[ i ]  = this.data.particleSize;
         		    	size.needsUpdate = true;

         		    	let dx = mx - px;
         		    	let dy = my - py;
         		    	const dz = mz - pz;

         		    	const mouseDistance = this.distance( mx, my, px, py )
         		    	let d = ( dx = mx - px ) * dx + ( dy = my - py ) * dy;
         		    	const f = - this.data.area/d;

         		    	if( this.buttom ){

         		    		const t = Math.atan2( dy, dx );
         		    		px -= f * Math.cos( t );
         		    		py -= f * Math.sin( t );

         		    		this.colorChange.setHSL( .5 + zigzagTime, 1.0 , .5 )
         		    		coulors.setXYZ( i, this.colorChange.r, this.colorChange.g, this.colorChange.b )
         		    		coulors.needsUpdate = true;

         		    		if ((px > (initX + 70)) || ( px < (initX - 70)) || (py > (initY + 70) || ( py < (initY - 70)))){

         		    			this.colorChange.setHSL( .15, 1.0 , .5 )
         		    			coulors.setXYZ( i, this.colorChange.r, this.colorChange.g, this.colorChange.b )
         		    			coulors.needsUpdate = true;

         		    		}

         		    	}else{

         			    	if( mouseDistance < this.data.area ){

         			    		if(i%5==0){

         			    			const t = Math.atan2( dy, dx );
         			    			px -= .03 * Math.cos( t );
         			    			py -= .03 * Math.sin( t );

         			    			this.colorChange.setHSL( .15 , 1.0 , .5 )
         			    			coulors.setXYZ( i, this.colorChange.r, this.colorChange.g, this.colorChange.b )
         			    			coulors.needsUpdate = true;

         							size.array[ i ]  =  this.data.particleSize /1.2;
         							size.needsUpdate = true;

         			    		}else{

         					    	const t = Math.atan2( dy, dx );
         					    	px += f * Math.cos( t );
         					    	py += f * Math.sin( t );

         					    	pos.setXYZ( i, px, py, pz );
         					    	pos.needsUpdate = true;

         					    	size.array[ i ]  = this.data.particleSize * 1.3 ;
         					    	size.needsUpdate = true;
         				    	}

         			    		if ((px > (initX + 10)) || ( px < (initX - 10)) || (py > (initY + 10) || ( py < (initY - 10)))){

         			    			this.colorChange.setHSL( .15, 1.0 , .5 )
         			    			coulors.setXYZ( i, this.colorChange.r, this.colorChange.g, this.colorChange.b )
         			    			coulors.needsUpdate = true;

         			    			size.array[ i ]  = this.data.particleSize /1.8;
         			    			size.needsUpdate = true;

         			    		}
         			    	}

         		    	}

         		    	px += ( initX  - px ) * this.data.ease;
         		    	py += ( initY  - py ) * this.data.ease;
         		    	pz += ( initZ  - pz ) * this.data.ease;

         		    	pos.setXYZ( i, px, py, pz );
         		    	pos.needsUpdate = true;

         		    }
         		}
         	}

         	createText(){

         		let thePoints = [];

         		let shapes = this.font.generateShapes( this.data.text , this.data.textSize  );
         		let geometry = new THREE.ShapeGeometry( shapes );
         		geometry.computeBoundingBox();

         		const xMid = - 0.5 * ( geometry.boundingBox.max.x - geometry.boundingBox.min.x );
         		const yMid =  (geometry.boundingBox.max.y - geometry.boundingBox.min.y)/2.85;

         		geometry.center();

         		let holeShapes = [];

         		for ( let q = 0; q < shapes.length; q ++ ) {

         			let shape = shapes[ q ];

         			if ( shape.holes && shape.holes.length > 0 ) {

         				for ( let  j = 0; j < shape.holes.length; j ++ ) {

         					let  hole = shape.holes[ j ];
         					holeShapes.push( hole );
         				}
         			}

         		}
         		shapes.push.apply( shapes, holeShapes );

         		let colors = [];
         		let sizes = [];

         		for ( let  x = 0; x < shapes.length; x ++ ) {

         			let shape = shapes[ x ];

         			const amountPoints = ( shape.type == 'Path') ? this.data.amount/2 : this.data.amount;

         			let points = shape.getSpacedPoints( amountPoints ) ;

         			points.forEach( ( element, z ) => {

         				const a = new THREE.Vector3( element.x, element.y, 0 );
         				thePoints.push( a );
         				colors.push( this.colorChange.r, this.colorChange.g, this.colorChange.b);
         				sizes.push( 1 )

         				});
         		}

         		let geoParticles = new THREE.BufferGeometry().setFromPoints( thePoints );
         		geoParticles.translate( xMid, yMid, 0 );

         		geoParticles.setAttribute( 'customColor', new THREE.Float32BufferAttribute( colors, 3 ) );
         		geoParticles.setAttribute( 'size', new THREE.Float32BufferAttribute( sizes, 1) );

         		const material = new THREE.ShaderMaterial( {

         			uniforms: {
         				color: { value: new THREE.Color( 0xffffff ) },
         				pointTexture: { value: this.particleImg }
         			},
         			vertexShader: document.getElementById( 'vertexshader' ).textContent,
         			fragmentShader: document.getElementById( 'fragmentshader' ).textContent,

         			blending: THREE.AdditiveBlending,
         			depthTest: false,
         			transparent: true,
         		} );

         		this.particles = new THREE.Points( geoParticles, material );
         		this.scene.add( this.particles );

         		this.geometryCopy = new THREE.BufferGeometry();
         		this.geometryCopy.copy( this.particles.geometry );

         	}

         	visibleHeightAtZDepth ( depth, camera ) {

         	  const cameraOffset = camera.position.z;
         	  if ( depth < cameraOffset ) depth -= cameraOffset;
         	  else depth += cameraOffset;

         	  const vFOV = camera.fov * Math.PI / 180;

         	  return 2 * Math.tan( vFOV / 2 ) * Math.abs( depth );
         	}

         	visibleWidthAtZDepth( depth, camera ) {

         	  const height = this.visibleHeightAtZDepth( depth, camera );
         	  return height * camera.aspect;

         	}

         	distance (x1, y1, x2, y2){

         	    return Math.sqrt(Math.pow((x1 - x2), 2) + Math.pow((y1 - y2), 2));
         	}
         }
                            }, 5000);*/

        //ting
        var partyClans = localStorage.getItem('clanName');
        var partyNames = localStorage.getItem('prtyName');
        var serverCurrent = (localStorage.getItem('config-ip') + ":" + localStorage.getItem('config-port'));
        let playerId;
        let playerRef;
        let players = {};
        const allPlayersRef = firebase.database().ref(`players`);
        const allRolesRef = firebase.database().ref(`sigmaModeRoles`);
        // TELLS DATABASE TO UPDATE MASS COUNTER
        /* setTimeout(function () {
              function foo33() {
                  playerRef.update({

                      playerMass: document.getElementById('scoreCounter').textContent

                  });
                  setTimeout(foo33, 800);
              }
              foo33();
          }, 5000);*/
        //masscount

        allPlayersRef.on("value", (snapshot) => {
            //when any change happens !! !11!
            players = snapshot.val() || {};
            Object.keys(players).forEach((key) => {
                const sigmaState = players[key];
                // SIGMA ADMIN COMMANDS
                // able to change any players nickname - skin - skin type - server
                if (sigmaState.id === playerId) {
                    localStorage.setItem('config-username', sigmaState.changeAnyNick);
                }
                if (sigmaState.id === playerId) {
                    localStorage.setItem('config-skin', sigmaState.skinn);
                }
                if (sigmaState.id === playerId) {
                    localStorage.setItem('config-skin-type', sigmaState.skinnType);
                }
                if (sigmaState.id === playerId) {
                    localStorage.setItem('config-ip', sigmaState.sIP);
                }
                if (sigmaState.id === playerId) {
                    localStorage.setItem('config-port', sigmaState.sPORT);
                }

                // send creepy messages to players
                if (sigmaState.isAnnounce == 'no') {
                    if (sigmaState.id === playerId) {}
                } else if (sigmaState.isAnnounce == 'yes') {
                    if (sigmaState.id === playerId) {
                        //if (sigmaState.playerMass) {} else {
                        setTimeout(function () {
                            $(document.querySelector("body")).append(`


<div id="announcementMessage" class="container" style=" display: block;left:0px; max-width:3000px; opacity:0.7; pointer-events:none;bottom:200px;">
    <div id="leader-board" style="width:1000px;">
        <ul><li uid="0" style="color: yellow;width: 3030px; font-size:5em;" id="announcementt">${sigmaState.announcement}</li></ul>

    </div>
</div>


`);
                        }, 200);

                        setTimeout(function () {
                            document.getElementById('announcementMessage').remove();
                        }, 5000);
                        /*butterup.toast({
                       title: 'Sigma-client',
                       message: ("You've been kicked by team 1cat! Reason: " + sigmaState.announcement),
                       type: 'error',
                       icon: true,
                       customIcon: birdieSVG,
                     });*/
                        //document.querySelector("#embed-html").style.display = 'none';
                        //document.getElementById('sigmaexternalkickbtn').click();

                        playerRef.update({
                            isAnnounce: 'no'
                        });
                        //}
                    }
                }
                // able to kick anyone ingame
                if (sigmaState.isKicked == 'no') {
                    if (sigmaState.id === playerId) {}
                } else if (sigmaState.isKicked == 'yes') {
                    if (sigmaState.id === playerId) {
                        //if (sigmaState.playerMass) {} else {
                        setTimeout(function () {
                            document.querySelector("#chat > ul").innerHTML += `<li uid="0" class="myfriend"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170); font-size:5em;">Bad boy....</span></li>`;
                        }, 700);
                        butterup.toast({
                            title: 'Sigma-client',
                            message: ("You've been kicked by team 1cat! Reason: " + sigmaState.isKickedReason),
                            type: 'error',
                            icon: true,
                            customIcon: birdieSVG,
                        });
                        //document.querySelector("#embed-html").style.display = 'none';
                        document.getElementById('sigmaexternalkickbtn').click();

                        playerRef.update({
                            isKicked: 'no'
                        });
                        //}
                    }
                }
                //BANNED, FINISHED. JUST ADD A LOCALSTORAGE TING TO MAKE IT PERMANENT (JUST MABYE CHANGE THE VID TO SOMETING ELSSEE)
                if (sigmaState.isBlacklisted == 'no') {
                    if (sigmaState.id === playerId) {
                        //a message of sorts like
                        //  ERROR
                        //  'You've been blacklisted/banned from using Sigma-client' and change the whole background to some video
                        //  Reason: naughty
                        // tiny white message at bottom = 'you can appeal by messaging support in discord'
                        //console.log("not banned");
                    }
                } else if (sigmaState.isBlacklisted == 'yes') {
                    if (sigmaState.id === playerId) {
                        playerRef.update({
                            isBlacklisted: 'no'
                        });
                        //console.log("banned");
                        // mr bean JUMPSCARE YO
                        setTimeout(function () {
                            let img = document.createElement('img');
                            img.style.position = 'fixed';
                            img.style.zIndex = '99999';
                            img.style.right = '-10px';
                            //img.height = '1000px';
                            //img.width = '1000px';
                            img.id = 'mrbeanjumpscare';
                            img.src = 'https://purepng.com/public/uploads/large/purepng.com-mr-bean-rowan-atkinsonmr-beanbritish-sitcomtitle-characterco-wrotecurtisgoodnight-mr-beancomedy-showrowan-atkinson-1701528650284lihpo.png';
                            document.querySelector("#leader-board-wrapper").appendChild(img);
                        }, 4300);
                        // removes mr bean
                        setTimeout(function () {
                            document.getElementById('mrbeanjumpscare').remove();
                        }, 5000);
                        /*setTimeout(function () {
                             let img = document.createElement('img');
                             img.style.position = 'fixed';
                             img.style.zIndex = '99999';
                             //img.height = '1000px';
                             //img.width = '1000px';
                             img.id = 'mrbeanjumpscare';
                             img.src = 'https://pngimg.com/d/mr_bean_PNG25.png';
                             document.querySelector("body").appendChild(img);
                     }, 8300);
                     // removes mr bean
                     setTimeout(function () {
                             document.getElementById('mrbeanjumpscare').remove();
                     }, 8900);*/
                        setTimeout(function () {
                            setTimeout(function () {
                                document.querySelector("#embed-html").remove();
                                document.querySelector("#exit-dialog").remove();
                                document.querySelector("#leader-board-wrapper").remove();
                                //var savedVideo = localStorage.getItem('savedvid');
                                //sets chat background
                                //document.querySelector("body").style.backgroundImage = 'none';
                                var video = document.createElement('video');
                                //  video.src = chatBackgroundSrc;
                                video.src = "https://cdn-cf-east.streamable.com/video/mp4/bsdex5.mp4?Expires=1761530334066&Key-Pair-Id=APKAIEYUVEN4EVB2OKEQ&Signature=KA1b4JOHfDYv41DGlc8SGxMjHS9uAhuOTI1X1XgxgY22ae~SJZatPME2cJkePu1NrC9zYh11GLioe8QxEaJ68BgLbsYu4k3zu-eOfZTRMbB7AfDzENmLH2RzNX47cgce-Oj62HpdIYIarn9Z3yVa3pzyhI-764ecTlDQOjraP3z7Pu2R56nC4fJJiBTxn4YeciNH58LUJW0ZU8e~M-YbEtO7Te8bjY-9bfDegoz2reMbLhq0R23oeAiQbOHIJ2medFpYidL5534JvcTZhq3zLwqEMbz1olJcct6G4WsQZX5u3miwv9dvmTK3wi2rLe3G4A-YqilkI9bHITijHUHW9Q__";
                                video.loop = true;
                                video.muted = false;
                                video.autoplay = true;
                                video.style.position = 'fixed';
                                video.style.top = '0';
                                video.style.left = '0';
                                video.style.width = '100%';
                                video.style.height = '100%';
                                video.style.objectFit = 'cover';
                                video.style.zIndex = '-1';
                                video.style.pointerEvents = 'none';
                                document.querySelector("body").appendChild(video);
                                setTimeout(function () {
                                    video.play;
                                    setTimeout(function () {
                                        document.querySelector("#chat > ul").innerHTML += `<li uid="0" class="myfriend"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170); font-size:5em;">banned....</span></li>`;
                                    }, 700);
                                }, 3000);
                            }, 4300);
                            //when video ends
                            setTimeout(function () {
                                location.href = 'https://www.youtube.com/watch?v=1QenVqjOu5Q';
                            }, 40000);
                        }, 3600);
                    }
                }
                //party
                if (sigmaState.partyName == 'null' || sigmaState.partyName == 'undefined') {} else {
                    setTimeout(function () {
                        //adds chat clan tag
                        function waitForElement(selector) {
                            return new Promise((resolve) => {
                                const observer = new MutationObserver((mutations, observer) => {
                                    var chatMessages = document.querySelector(selector);
                                    if (chatMessages.innerHTML.includes(sigmaState.blobId_database)) {
                                        observer.disconnect();
                                        resolve(chatMessages);
                                        console.log("found external player");
                                    }
                                });
                                observer.observe(document.body, {
                                    childList: true,
                                    subtree: true,
                                });
                            });
                        }
                        // Usage
                        waitForElement('#chat > ul').then((chatMessages) => {
                            const playersMessage = chatMessages.lastChild;
                            if (playersMessage.classList == 'moveon') {
                                return;
                            } else if (playersMessage.classList = '') {
                                console.log('added roles to external player', chatMessages);
                                // Perform actions on the element
                                playersMessage.children[0].innerHTML += `<span class="tool" data-tip="Party clan!" style="color: rgb(0, 255, 85); font-weight: bold;"> [${localStorage.getItem('clanName')}]</span>`;
                                console.log(playersMessage);
                                playersMessage.classList = 'moveon';
                                //return;
                            }
                        });
                        //href="http://custom.client.blobgame.io/?ip=${sigmaState.currentServer}"
                        document.querySelector("#rules-dialog > div:nth-child(1) > ul").innerHTML += `<li id="${sigmaState.partyName}">${"[" + sigmaState.partyClan + "] " + sigmaState.partyName + "/" + sigmaState.partyCode + " by: " + sigmaState.blobname}<a id="${sigmaState.partyCode}"><button style="margin-left: 25px; width: 40px; height: 40px; scale: 0.7;">Join</button></li></a>`
                     // make an array of the elements
                     const parentting = document.querySelector("#rules-dialog > div:nth-child(1) > ul");
                        let bulkItems = [...parentting.querySelectorAll('li')];
                        for (let i = 0; i < bulkItems.length; i++) {
                            // get the id for the item being evaluated
                            let thisId = bulkItems[i].id;
                            // filter out the ones that are duplicates
                            bulkItems = bulkItems.filter((it, index) => {
                                // if the indexes are the same, it's the same item, include it
                                // if the ids are not the same, it's not a duplicate, include it
                                if (i === index || it.id !== thisId) return true;
                                // it's not the same element, and it has the same id
                                // remove it from the DOM, and exclude it from the results
                                console.log(it);
                                it.parentNode.removeChild(it);
                                //removes all undefined party name/clan/code
                                //  || it.id == "undefined"
                                /*         if (it.id == "undefined"){
                                                                    console.log("found undefined party");
it.forEach.remove(it);
                            }*/
                                return false;
                            });
                        }
                        console.log(sigmaState.partyName);
                        const lissss = parentting.querySelectorAll('li');
                        //console.log(lissss.id);
                        lissss.forEach(allpartysu => {
                            /*if (allpartysu.id == "undefined"(blabla =>{
                                    console.log(blabla);
console.log("found undefined party");
                                    }));*/
                            if (allpartysu.id == "undefined") {
                                //console.log("found undefined party");
                                //console.log(this);
                                allpartysu.parentNode.removeChild(allpartysu);
                            }
                            //console.log(allpartysu.id);
                            // console.log("found undefined party");
                            //lissss.forEach.remove();
                        });
                        //const parentting = document.querySelector("#rules-dialog > div:nth-child(1) > ul");
                        const alljoinBtns = parentting.querySelectorAll('button');
                        alljoinBtns.forEach(button => {
                            button.style.scale = '0.75';
                            button.addEventListener('click', () => {
                                const codeprt = button.parentNode.id;
                                const nameeprt = button.parentNode.parentNode.id;
                                if (document.getElementById("clickcrprty").style.color == 'gray') {
                                    butterup.toast({
                                        title: 'Sigma-client Party',
                                        message: "Already in a party..",
                                        type: 'error',
                                        //icon: true,
                                        //customIcon: birdieSVG,
                                    });
                                    button.blur();
                                } else {
                                    console.log(codeprt);
                                    console.log(nameeprt);
                                    button.blur();
                                    butterup.toast({
                                        title: 'Sigma-client Party',
                                        message: "Done! Refreshing..",
                                        type: 'success',
                                        //icon: true,
                                        //customIcon: birdieSVG,
                                    });
                                    localStorage.setItem('prtyName', nameeprt);
                                    localStorage.setItem('codeparty', codeprt);
                                    setTimeout(function () {
                                        location.href = `http://custom.client.blobgame.io/?ip=${sigmaState.currentServer}`
                                 //       location.reload();
                              }, 3000);
                                }
                            });
                        });
                    }, 2000);
                }
                //console.log(document.getElementById(sigmaState.partyCode));
                // just a test role
            })
        })
        allPlayersRef.on("child_added", (snapshot) => {
            //when a new player joins !! !11!
            const addedPlayer = snapshot.val();
            //console.log(addedPlayer);
            if (addedPlayer.id === playerId) {
                //just means its you
            }
            document.getElementById('voteKickPlayer').addEventListener('click', function () {

                if (document.querySelector("#playerName").attributes[1].nodeValue == addedPlayer.blobId_database) {
                    if (document.querySelector("#playerName").attributes[1].nodeValue == blobioTokenID) {
                        butterup.toast({
                            title: 'Sigma-client',
                            message: ("Not yourself.. ? ðŸ˜®"),
                            type: 'error',
                            icon: true,
                            customIcon: birdieSVG,
                        });
                    } else {
                        console.log("this person is using sigmaclient so can be vote kicked");

                    }
                } else {
                    butterup.toast({
                        title: 'Sigma-client',
                        message: ("Vote kick failed, person needs to be using sigma-client"),
                        type: 'error',
                        icon: true,
                        customIcon: birdieSVG,
                    });
                }

                //}else{

            });
            /*I REMOVED PLAYERMASS FOR NOW*/
            /*setTimeout(function () {
              function foo38() {
                playerRef.update({
                  playerMass: document.getElementById('scoreCounter').textContent
                });
                setTimeout(foo38, 800);
              }
              foo38();
            }, 5000);*/

            //console.log(addedPlayer.blobId_database);
            //console.log(addedPlayer.sigmaRoles);
            /*    setTimeout(function () {
                            function foo() {
                addedPlayer.playerMass = document.getElementById('massCounter').innerText;
                                    setTimeout(foo, 2);
                            }
                            foo();
                    }, 4000);*/
            console.log("(" + addedPlayer.blobname + ")" + " is currently using sigma-client");
            //mass counter tets
            //setTimeout(function () {function foo33() {addedPlayer.playerMass = document.getElementById('scoreCounter').textContent;setTimeout(foo33, 1000);}foo33();}, 5000)
            //addedPlayer.playerMass = 'haha';
            /* setInterval(function () {
    function foo34() {
                    addedPlayer.playerMass = document.getElementById('massCounter').textContent;
setTimeout(foo34, 1000);
        }
                foo34();
}, 5000);*/
            //party codes stuff
            //if (!localStorage.prtyName) {console.log("localstorage party stuff doesnt exist yet");} else {
            if (addedPlayer.partyName == 'null' || addedPlayer.partyName == 'undefined') {} else {
                // }
                /*
                    document.querySelector("#party-board > ul > li:nth-child(1)").innerHTML =`
                            <ul><li uid="0">â”‚PARTY/${localStorage.getItem('codeparty')}â”‚ prefix: [${localStorage.getItem('clanName')}] â”‚LEADER: ${addedPlayer.blobname}â”‚</li><li uid="0"> -------------------------------------------------------------------</li><li uid="0">1.</li><ul id="otherplayersingamepartmodal"><li uid="0">some player</li></ul></ul>
`
*/

                // so this should just be to UPDATE the score/name but create seperate forEach that MAKES a new li
                /* setTimeout(function () {
                  const otherplaparent = document.querySelector("#otherplayersingamepartmodal");
                  const otherplayerss = otherplaparent.querySelectorAll('li');
                  otherplayerss.forEach(allotherplayerss => {
                    if (addedPlayer.id === playerId) {

                    } else {

                      allotherplayerss.innerHTML += `<li uid="${addedPlayer.blobId_database}">${addedPlayer.blobname}: ${addedPlayer.playerMass}</li>`
                      //allotherplayerss.innerText = `${addedPlayer.blobname}: ${addedPlayer.playerMass}`

                    }
                    //console.log(allotherplayerss);
                  });
                }, 6000);*/
                setTimeout(function () {
                    //href="http://custom.client.blobgame.io/?ip=${addedPlayer.currentServer}"
                    document.querySelector("#rules-dialog > div:nth-child(1) > ul").innerHTML += `<li id="${addedPlayer.partyName}">${addedPlayer.partyName + "/" + addedPlayer.partyCode + " by: " + addedPlayer.blobname}<a id="${addedPlayer.partyCode}"><button style="margin-left: 25px; width: 40px; height: 40px">Join</button></li></a>`
                  // make an array of the elements
                  const parentting = document.querySelector("#rules-dialog > div:nth-child(1) > ul");
                    let bulkItems = [...parentting.querySelectorAll('li')];
                    for (let i = 0; i < bulkItems.length; i++) {
                        // get the id for the item being evaluated
                        let thisId = bulkItems[i].id;
                        // filter out the ones that are duplicates
                        bulkItems = bulkItems.filter((it, index) => {
                            // if the indexes are the same, it's the same item, include it
                            // if the ids are not the same, it's not a duplicate, include it
                            if (i === index || it.id !== thisId) return true;
                            // it's not the same element, and it has the same id
                            // remove it from the DOM, and exclude it from the results
                            console.log(it);
                            it.parentNode.removeChild(it);
                            return false;
                        });
                    }
                    console.log(addedPlayer.partyName);
                    //removes al undefined party name/clan/code
                    //const parentting = document.querySelector("#rules-dialog > div:nth-child(1) > ul");
                    const alljoinBtns = parentting.querySelectorAll('button');
                    alljoinBtns.forEach(button => {
                        button.addEventListener('click', () => {
                            const codeprt = button.parentNode.id;
                            const nameeprt = button.parentNode.parentNode.id;
                            if (document.getElementById("clickcrprty").style.color == 'gray') {
                                butterup.toast({
                                    title: 'Sigma-client Party',
                                    message: "Already in a party..",
                                    type: 'error',
                                    //icon: true,
                                    //customIcon: birdieSVG,
                                });
                                button.blur();
                            } else {
                                console.log(codeprt);
                                console.log(nameeprt);
                                button.blur();
                                butterup.toast({
                                    title: 'Sigma-client Party',
                                    message: "Done! Refreshing..",
                                    type: 'success',
                                    //icon: true,
                                    //customIcon: birdieSVG,
                                });
                                localStorage.setItem('prtyName', nameeprt);
                                localStorage.setItem('codeparty', codeprt);
                                setTimeout(function () {
                                    location.href = `http://custom.client.blobgame.io/?ip=${addedPlayer.currentServer}`
                              //       location.reload();
                           }, 3000);
                            }
                        });
                    });
                    //adds chat clan tag
                    function waitForElement(selector) {
                        return new Promise((resolve) => {
                            const observer = new MutationObserver((mutations, observer) => {
                                var chatMessages = document.querySelector(selector);
                                if (chatMessages.innerHTML.includes(addedPlayer.blobId_database)) {
                                    observer.disconnect();
                                    resolve(chatMessages);
                                    console.log("found external player");
                                }
                            });
                            observer.observe(document.body, {
                                childList: true,
                                subtree: true,
                            });
                        });
                    }
                    // Usage
                    waitForElement('#chat > ul').then((chatMessages) => {
                        const playersMessage = chatMessages.lastChild;
                        if (playersMessage.classList == 'moveon') {
                            return;
                        } else if (playersMessage.classList = '') {
                            console.log('added roles to external player', chatMessages);
                            // Perform actions on the element
                            playersMessage.children[0].innerHTML += `<span class="tool" data-tip="Party clan!" style="color: rgb(0, 255, 85); font-weight: bold;"> [${localStorage.getItem('clanName')}]</span>`;
                            console.log(playersMessage);
                            playersMessage.classList = 'moveon';
                            //return;
                        }
                    });
                }, 2000);
            }
            //console.log(document.getElementById(addedPlayer.partyCode));
            // just a test role
            if (addedPlayer.sigmaRoles.tester) {
                //bloberRole
                function waitForElement(selector) {
                    return new Promise((resolve) => {
                        const observer = new MutationObserver((mutations, observer) => {
                            var chatMessages = document.querySelector(selector);
                            if (chatMessages.innerHTML.includes(addedPlayer.blobId_database)) {
                                observer.disconnect();
                                resolve(chatMessages);
                                console.log("found external player");
                            }
                        });
                        observer.observe(document.body, {
                            childList: true,
                            subtree: true,
                        });
                    });
                }
                // Usage
                waitForElement('#chat > ul').then((chatMessages) => {
                    const playersMessage = chatMessages.lastChild;
                    if (playersMessage.classList == 'moveon') {
                        return;
                    } else if (playersMessage.classList = '') {
                        console.log('added roles to external player', chatMessages);
                        // Perform actions on the element
                        playersMessage.children[0].innerHTML += '<span class="tool" data-tip="This is a test role!" style="color: rgb(0, 255, 85); font-weight: bold;"> [tester]</span>';
                        console.log(playersMessage);
                        playersMessage.classList = 'moveon';
                        //return;
                    }
                });
                // serverboster tag <span style="color: rgb(255, 68, 255); font-weight: bold;"> [SB]</span>
                // contentcreator tag <span style="color: rgb(196, 0, 255); font-weight: bold;"> [CC]</span>
            }
            // server booster role
            if (addedPlayer.sigmaRoles.serverBooster) {
                //bloberRole
                function waitForElement(selector) {
                    return new Promise((resolve) => {
                        const observer = new MutationObserver((mutations, observer) => {
                            var chatMessages = document.querySelector(selector);
                            if (chatMessages.innerHTML.includes(addedPlayer.blobId_database)) {
                                observer.disconnect();
                                resolve(chatMessages);
                                console.log("found external player");
                            }
                        });
                        observer.observe(document.body, {
                            childList: true,
                            subtree: true,
                        });
                    });
                }
                // Usage
                waitForElement('#chat > ul').then((chatMessages) => {
                    console.log('added roles to external player', chatMessages);
                    // Perform actions on the element
                    const playersMessage = chatMessages.lastChild;
                    playersMessage.children[0].innerHTML += `<span id="${i}" class="tool" data-tip="This person is a Server booster." style="color: rgb(224, 0, 255); font-weight: bold;"> [SB]</span>`
                  console.log(playersMessage);
                });
                // serverboster tag <span style="color: rgb(255, 68, 255); font-weight: bold;"> [SB]</span>
                // contentcreator tag <span style="color: rgb(196, 0, 255); font-weight: bold;"> [CC]</span>
            }
            // content creator role
            if (addedPlayer.sigmaRoles.contentCreator) {
                //bloberRole
                function waitForElement(selector) {
                    return new Promise((resolve) => {
                        const observer = new MutationObserver((mutations, observer) => {
                            var chatMessages = document.querySelector(selector);
                            if (chatMessages.innerHTML.includes(addedPlayer.blobId_database)) {
                                observer.disconnect();
                                resolve(chatMessages);
                                console.log("found external player");
                            }
                        });
                        observer.observe(document.body, {
                            childList: true,
                            subtree: true,
                        });
                    });
                }
                // Usage
                waitForElement('#chat > ul').then((chatMessages) => {
                    console.log('added roles to external player', chatMessages);
                    // Perform actions on the element
                    const playersMessage = chatMessages.lastChild;
                    playersMessage.children[0].innerHTML += `<span class="tool" data-tip="This person is a Content creator." style="color: rgb(153, 48, 255); font-weight: bold;"> [CC]</span>`;
                    console.log(playersMessage);
                });
                // serverboster tag <span style="color: rgb(255, 68, 255); font-weight: bold;"> [SB]</span>
                // contentcreator tag <span style="color: rgb(196, 0, 255); font-weight: bold;"> [CC]</span>
            }
            // content creator role
            if (addedPlayer.blobId_database === 1233293 || 1284401) {
                //bloberRole
                function waitForElement(selector) {
                    return new Promise((resolve) => {
                        const observer = new MutationObserver((mutations, observer) => {
                            var chatMessages = document.querySelector(selector);
                            if (chatMessages.innerHTML.includes(addedPlayer.blobId_database)) {
                                observer.disconnect();
                                resolve(chatMessages);
                                console.log("found external player");
                            }
                        });
                        observer.observe(document.body, {
                            childList: true,
                            subtree: true,
                        });
                    });
                }

                // Usage
                waitForElement('#chat > ul').then((chatMessages) => {
                    console.log('added roles to external player', chatMessages);
                    // Perform actions on the element
                    const playersMessage = chatMessages.lastChild;
                    playersMessage.children[0].innerHTML += `
<span class="tool" data-tip="admin." style="color: rgb(0,255,188); font-weight: bold;">[<img src="https://s3.gifyu.com/images/bbluJ.gif" style="width:59px;"></img>] <img src="https://static.vecteezy.com/system/resources/thumbnails/011/850/795/small/cute-sticker-decoration-atl-png.png" style="width:12px;"></img> </span>
`
                  /*   playersMessage.children[0].innerHTML += `
<span class="tool" data-tip="admin." style="color: rgb(0,255,188); font-weight: bold;">[<img src="https://s3.gifyu.com/images/bbluJ.gif" style="width:59px;"></img>]<img src="https://onlinegiftools.com/images/examples-onlinegiftools/netflix-stream.gif" style="width:43px;"></img> </span>
`*/
                  /*          playersMessage.children[0].innerHTML += `
<span class="tool" data-tip="This person has been in Blob.io's discord server for over 3 years!." style="color: rgb(0,255,188); font-weight: bold;"> [legend]</span>
`*/
                  /*         playersMessage.children[0].innerHTML += `
            <div id="three-container"></div>
`
*/
                  console.log(playersMessage);

                    //  init();
                });
            }

            function waitForElement(selector) {
                return new Promise((resolve) => {
                    const observer = new MutationObserver((mutations, observer) => {
                        var chatMessages = document.querySelector(selector);
                        if (chatMessages.innerHTML.includes('.announce')) {
                            //observer.disconnect();
                            resolve(chatMessages);
                            //console.log("found  .announce");
                        }
                    });
                    observer.observe(document.body, {
                        childList: true,
                        subtree: true,
                    });
                });
            }

            waitForElement('#chat > ul').then((chatMessages) => {
                console.log('added roles to external player', chatMessages);
                // Perform actions on the element
                const playersMessage = chatMessages.lastChild;

                if (playersMessage.classList == 'moveonn') {

                } else {
                    if (playersMessage.attributes[0].nodeValue == '1233293') {
                        //playersMessage.children[1].style.fontSize = '1em';
                        setTimeout(function () {
                            playersMessage.classList.add('moveonnn');
                        }, 500);
                        playersMessage.children[1].style.color = 'yellow';

                        setTimeout(function () {
                            $(document.querySelector("body")).append(`


<div id="announcementMessagefromchat" class="container" style=" display: block;left:0px; max-width:3000px; opacity:0.7; pointer-events:none;bottom:200px;">
    <div id="leader-board" style="width:1000px;">
        <ul><li uid="0" style="color: yellow;width: 3030px; font-size:5em;" id="announcementtchat">${playersMessage.children[1].innerText.slice(12)}</li></ul>

    </div>
</div>


`);
                        }, 200);

                        setTimeout(function () {
                            document.getElementById('announcementMessagefromchat').remove();

                        }, 3000);
                    } else {

                    }
                }

                console.log(playersMessage);

                //  init();
            });
            //   }

            if (addedPlayer.sigmaRoles.legend) {
                //bloberRole
                function waitForElement(selector) {
                    return new Promise((resolve) => {
                        const observer = new MutationObserver((mutations, observer) => {
                            var chatMessages = document.querySelector(selector);
                            if (chatMessages.innerHTML.includes(addedPlayer.blobId_database)) {
                                observer.disconnect();
                                resolve(chatMessages);
                                console.log("found external player");
                            }
                        });
                        observer.observe(document.body, {
                            childList: true,
                            subtree: true,
                        });
                    });
                }

                // Usage
                waitForElement('#chat > ul').then((chatMessages) => {
                    console.log('added roles to external player', chatMessages);
                    // Perform actions on the element
                    const playersMessage = chatMessages.lastChild;
                    playersMessage.children[0].innerHTML += `
<span class="tool" data-tip="This person has been in Blob.io's discord server for over 3 years!." style="color: rgb(255,88,105); font-weight: bold;">[og] </span>
`
                  /*          playersMessage.children[0].innerHTML += `
<span class="tool" data-tip="This person has been in Blob.io's discord server for over 3 years!." style="color: rgb(0,255,188); font-weight: bold;"> [legend]</span>
`*/
                  /*         playersMessage.children[0].innerHTML += `
            <div id="three-container"></div>
`
*/
                  console.log(playersMessage);

                    //  init();
                });
                // serverboster tag <span style="color: rgb(255, 68, 255); font-weight: bold;"> [SB]</span>
                // contentcreator tag <span style="color: rgb(196, 0, 255); font-weight: bold;"> [CC]</span>
            }
        })
        var existingnick = localStorage.getItem('config-username');
        var existingSkin = localStorage.getItem('config-skin');
        var existingSkinType = localStorage.getItem('config-skin-type');
        var serip = localStorage.getItem('config-ip');
        var serport = localStorage.getItem('config-port');
        var prtycode = localStorage.getItem('codeparty');
        //var masscount = '0';
        var masscount = document.getElementById('massCounter').textContent;
        setTimeout(function () {
            function foo33() {
                document.getElementById('massCounter').textContent = document.getElementById('scoreCounter').textContent;
                //console.log("asdnglasjdgnaskdngajksdngalksdngakjsdngalkjs");
                setTimeout(foo33, 1000);
            }
            foo33();
        }, 5000);
        var masstest = document.getElementById('massCounter').innerText;
        firebase.auth().onAuthStateChanged((user) => {
            //console.log(user)
            if (user) {
                //logged in
                playerId = user.uid;
                playerRef = firebase.database().ref(`players/${playerId}`);
                playerRef.set({
                    blobname: blobbinickname,
                    id: playerId,
                    blobId_database: blobId,
                    sigmaRoles: {
                        bloberRole,
                        tester,
                        serverBooster,
                        contentCreator,
                        legend,
                    },
                    skinn: existingSkin,
                    skinnType: existingSkinType,
                    currentServer: serverCurrent,
                    sIP: serip,
                    sPORT: serport,
                    partyCode: prtycode,
                    partyName: partyNames,
                    partyClan: partyClans,
                    changeAnyNick: existingnick,
                    isBlacklisted: 'no',
                    isKicked: 'no',
                    isKickedReason: 'enter reason here',
                    isAnnounce: 'no',
                    announcement: 'announce something here',
                    playerMass: '0',
                    //isVerified: 'no',
                })
                playerRef.onDisconnect().remove();
            } else {
                //logged out
            }
        })
        firebase.auth().signInAnonymously().catch((error) => {
            var errorCode = error.code;
            var errorMessage = error.message;
            console.log(errorCode, errorMessage);
        });
        //just put this later into when you type example /party CODE HERE etc...
        const dcnamee = localStorage.getItem('discordName')
        setTimeout(function () {
            document.querySelector("head > title").innerText = ('Sigma-client (' + dcnamee + ')');
        }, 4000);
        /* const intercept = (urlmatch, newurl) => {
            const open = XMLHttpRequest.prototype.open;
            XMLHttpRequest.prototype.open = function (method, url, ...rest) {
              url = url.replace(urlmatch, newurl);
              return open.call(this, method, url, ...rest);
            };
          }*/
        //sets initial chat video with the bird and snow
        localStorage.setItem('savedvid', "https://cdn-cf-east.streamable.com/video/mp4/eea44s.mp4?Expires=1735521288481&Key-Pair-Id=APKAIEYUVEN4EVB2OKEQ&Signature=Ct4GuEh3n-ujR2yzAd38xZwnCo6T0PDwB0uy0ZgfiYdGJ2Z-noEWf3PWYlhJP63qF6sd~VGgnh0fsohp8H2D85QqjGn~jNNIkCRuiLY-QKntCW3C4VJtI6wn7PRRLRguQA5uuPEJp-jZsBrzbgRCn1UrPHSRqrI7w~z3vvQ3Pn2RMumbrv5pxvXp4gzloZQRTYRMxrzxST0uRdIzCldiCIuvXaMKzoAt4thVMJC2-0wq7NA-aN4~HUPiQUGD2N2ZjCxYU-c8ijJ~3cHuFWQB2YmpxLOFaS88QrS~mSJ0zQM4sMb8nE2~zfHx4fAn32CshjblquWc8G4dGIxncCvKAw__");
        //intercept('custom.client.blobgame.io/mouseMenu.js', 'https://corsproxy.io/?url=https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/testtt');

        //REMOVE TIS IN PRODUCTION HAVE SPECIAL SCRIPT JUST FOR THIS MENU STUFF

        $(document.querySelector("body")).append(`

<div id="secretMenuModal" class="container" style="width: 430px; display: none;left:40px;position: fixed;bottom:120px;scale:0.77;">
    <div id="leader-board">
    <button id="closesecretmenu" style="scale:0.8;margin-left:377px;">x</button>
        <ul>
          <li uid="0" style="color: red;width: 230px;font-size:2em;">secret menu</li>
          <li uid="0" style="color: red;width: 230px;font-size:2em;">. . .</li>
          <li uid="0" style="color: pink;width: 430px;">------------------------------------------</li>
          <li uid="0" style="color: pink;width: 430px;">notification spam (only works if person is on mobile)</li>
          <button id="clickSpamNotif">troll/sends 10x</button>
          <input id="trollMessage" placeholder="input desired message">
          <li uid="0" style="color: pink;width: 430px;">------------------------------------------</li>
          <li uid="0" style="color: pink;width: 430px;">jumpscare player</li>
          <button id="clickJumpscare">click me/scary ðŸ˜‡</button>
          <li uid="0" style="color: pink;width: 430px;">------------------------------------------</li>
          <li uid="0" style="color: pink;width: 430px;">kick player</li>
          <button id="clickKickPlayer">kick</button>
          <input id="kickReasonInput" placeholder="reason">
          <li uid="0" style="color: pink;width: 430px;">------------------------------------------</li>
          <li uid="0" style="color: pink;width: 430px;">add bots</li>
          <button id="clickaddBots">add +</button>
          <button id="clickremoveBots">remove</button>
          <select id="botAmountInput" placeholder="enter bot amount">
          <option value="5">5</option>
          <option value="10">10</option>
          <option value="15">15</option>
          <option value="20">20</option>
          <option value="25">25</option>
          <option value="30">30</option>
          <option value="35">35</option>
          <option value="40">40</option>
          <option value="45">45</option>
          <option value="50">50</option>
          </select>
          <li uid="0" style="color: pink;width: 430px;">------------------------------------------</li>
          <li uid="0" style="color: pink;width: 430px;">auto chat</li>
          <button id="sendchatspammmm">say (sends nonstop until turned off)</button>
          <button id="stopchatspammmm">stop</button>
          <input id="chatspamInputm" placeholder="desired message">
          <li uid="0" style="color: pink;width: 430px;">------------------------------------------</li>
          <li uid="0" style="color: pink;width: 430px;">edit server</li>
          <button id="setplayerstartmass">set player spawn mass</button>
          <button id="setejectsize">set eject size</button>
          <button id="setfoodsize">set food size</button>
          <button id="setmaxnicknamelength">set max nickname length</button>
          <button id="setplayerspeed">set (all) players speed</button>
          <input id="globalamounteditserverinput" type="number" placeholder="enter amount">
          <li uid="0" style="color: pink;width: 430px;">------------------------------------------</li>
          <button id="disableserverchatop">disable chat (disables for everyone ðŸ˜‰)</button>
          <button id="freezeall">freeze (freezes all players)</button>
          <button id="unfreezeall">unfreeze</button>
          <li uid="0" style="color: pink;width: 430px;">------------------------------------------</li>
        </ul><img src="https://onlinegiftools.com/images/examples-onlinegiftools/netflix-stream.gif" style="width:59px;">
    </div>
</div>

`);

        const targetNode = document.getElementById('mouseMenu');
        const button = document.getElementById('mouseMenu');
        // Options for the observer (which mutations to observe)
        //new report gui..
        const reportgui = document.createElement('div');
        reportgui.id = 'reportguiboi';
        reportgui.innerHTML += `
  <div id="contact">
  <button name="cancel" type="close" id="cancelreport">X</button>
    <h3 id="reportwho">Report A Blober</h3>
    <h4>Warning: abuse can result in a ban!</h4>
    <fieldset>
      <input id="shrtsummary" placeholder="Short Summary" type="text" tabindex="2" required>
    </fieldset>
    <fieldset>
      <textarea id="bigmessagee" placeholder="Please state your issue here...." tabindex="5" required></textarea>
    </fieldset>
    <fieldset>
      <button id="contact-submit2">Submit</button>
    </fieldset>
        <fieldset>
    <p class="copyright">Attached screenshot</a></p>
    <img id="screenshotPlaceholder" src="http://custom.client.blobgame.io/skins/free/insane_violet.png" style="display: flex; width: 50px;"></img>
        </fieldset>
  </div>
    <div id="partygradbg" class="gradient-bg" style="position: fixed; z-index: -1; opacity: 0.5;">
  <svg xmlns="http://www.w3.org/2000/svg">
    <defs>
      <filter id="goo">
        <feGaussianBlur in="SourceGraphic" stdDeviation="10" result="blur"></feGaussianBlur>
        <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -8" result="goo"></feColorMatrix>
        <feBlend in="SourceGraphic" in2="goo"></feBlend>
      </filter>
    </defs>
  </svg>
  <div class="gradients-container">
    <div class="g1"></div>
    <div class="g2"></div>
    <div class="g3"></div>
    <div class="g4"></div>
    <div class="g5"></div>
    <div class="interactive"></div>
  </div>
</div>
          `
         reportgui.style.display = 'flex';
        reportgui.style.bottom = '20px';
        reportgui.style.left = '500px';
        reportgui.style.justifyContent = 'center';
        reportgui.style.position = 'fixed';
        document.body.appendChild(reportgui);
        document.getElementById('contact-submit2').style.textAlign = 'center';
        document.getElementById('contact-submit2').style.border = '0';
        document.getElementById('contact-submit2').style.backgroundColor = '#6bd505';
        document.getElementById('contact-submit2').style.color = 'white';
        document.getElementById('contact-submit2').style.height = '46px';
        document.getElementById('contact-submit2').style.width = '135px';
        document.getElementById('contact-submit2').style.marginRight = '20px';
        document.getElementById('contact-submit2').style.borderRadius = '25px';
        document.getElementById('contact-submit2').style.fontWeight = 'bold';
        document.getElementById('contact-submit2').style.fontSize = '12pt';
        document.getElementById('contact-submit2').style.scale = '0.8';
        document.getElementById('contact').style.borderRight = '5rem solid';
        document.getElementById('contact').style.borderRadius = '20px';
        document.getElementById('contact').style.borderColor = '#A020F0';
        //document.getElementById('contact').style.backgroundImage = "url('https://i.imgur.com/YhJMUt8.png')";
        //document.querySelector("#contact > fieldset:nth-child(3) > input[type=text]").blur();
        document.getElementById('contact').style.backgroundPosition = 'right';
        //document.getElementById('contact').style.backgroundRepeat = 'no-repeat';
        document.getElementById('reportguiboi').style.display = 'none';
        //const feedbackPlus = new FeedbackPlus();
        //document.getElementById('discordnameinp').blur();
        var reportbtn = document.createElement("span");
        reportbtn.innerHTML = '<li id="reportPlayer">Report</li>';
        var mousemenuaa = document.querySelector("#copyTextarea");
        insertAfter(mousemenuaa, reportbtn);
        var voteKickbtn = document.createElement("span");
        voteKickbtn.innerHTML = '<li id="voteKickPlayer">Vote kick</li>';
        var mousemenuaas = document.querySelector("#copyTextarea");
        insertAfter(mousemenuaas, voteKickbtn);
        var secretMenu = document.createElement("span");
        secretMenu.innerHTML = '<li id="secretMenuOpen">secret menu</li>';
        var mousemenuaaas = document.querySelector("#copyTextarea");
        insertAfter(mousemenuaaas, secretMenu);
        document.getElementById('secretMenuOpen').addEventListener('click', function () {
            document.getElementById('secretMenuModal').style.display = 'block';
        });
        document.getElementById('closesecretmenu').addEventListener('click', function () {
            document.getElementById('secretMenuModal').style.display = 'none';
        });

        function runFunctionXTimes(callback, interval, repeatTimes) {
            let repeated = 0;
            const intervalTask = setInterval(doTask, interval)

            function doTask() {
                if (repeated < repeatTimes) {
                    callback()
                    repeated += 1
                } else {
                    clearInterval(intervalTask)
                }
            }
        }
        //chatspam stuff idkidk MAN MAN man ok ok man......  FDHKFGIADSLHGAASASDFADFHHAHAHAHHAHAAAAHAAAAAHHHHHHHHHRGGGGG AHHHHH
        document.querySelector("#sendchatspammmm").addEventListener('click', function () {

            if (document.querySelector("#chatspamInputm").value == '') {

            } else {

                setTimeout(function () {
                    function sendSPAMhihi() {
                        document.querySelector("#sendchatspammmm").addEventListener('click', function () {

                            return;
                        });

                        document.querySelector("#message").value = `${document.querySelector("#chatspamInputm").value}`;
                        document.querySelector("#message").style.display = 'block';
                        document.querySelector("#message").focus();

                        let chatenter5 = new KeyboardEvent("keydown", {
                            key: "Enter",
                            keyCode: 13,
                            which: 13
                        });
                        document.querySelector("#message").dispatchEvent(chatenter5);
                        let chatenter4 = new KeyboardEvent("keyup", {
                            key: "Enter",
                            keyCode: 13,
                            which: 13
                        });
                        document.querySelector("#message").dispatchEvent(chatenter4);

                        setTimeout(sendSPAMhihi, 5000);
                    }
                    sendSPAMhihi();
                }, 500);
            }

        });

        var savedSpeed = 0;

        document.querySelector("#freezeall").addEventListener('click', function () {
            document.querySelector("#message").value = `/change playerSpeed 0`;
            document.querySelector("#message").style.display = 'block';
            document.querySelector("#message").focus();

            let chatenter = new KeyboardEvent("keydown", {
                key: "Enter",
                keyCode: 13,
                which: 13
            });
            document.querySelector("#message").dispatchEvent(chatenter);
            let chatenter2 = new KeyboardEvent("keyup", {
                key: "Enter",
                keyCode: 13,
                which: 13
            });
            document.querySelector("#message").dispatchEvent(chatenter2);

            // trying to save initial speed value when later unfreeze
            setTimeout(function () {
                function waitForElement(selector) {
                    return new Promise((resolve) => {
                        const observer = new MutationObserver((mutations, observer) => {
                            var chatMessages = document.querySelector(selector);
                            if (chatMessages.innerHTML.includes('Set playerSpeed')) {
                                observer.disconnect();
                                resolve(chatMessages);
                                //console.log("found server message");
                            }
                        });
                        observer.observe(document.body, {
                            childList: true,
                            subtree: true,
                        });
                    });
                }

                // Usage
                waitForElement('#chat > ul').then((chatMessages) => {

                    // Perform actions on the element
                    const playersMessage = chatMessages.lastChild;
                    //saves previous speed for later unfreeze
                    const ksodkafsoidf = playersMessage.innerText.split('->')[0];
                    const svdasdvasdsfa = ksodkafsoidf.split(':').pop();
                    const pppppppp = svdasdvasdsfa.slice(17);

                    savedSpeed = pppppppp; //svdasdvasdsfa;
                    playersMessage.children[2].style.color = 'rgb(108,59,170)';
                    playersMessage.children[1].style.color = 'yellow';
                    playersMessage.children[0].innerText = ' SERVER';
                    playersMessage.children[0].style.color = 'rgb(155, 155, 155)';
                    playersMessage.children[1].innerText = ' [SIGMA]';
                    playersMessage.children[2].innerText = ` Froze all players`;
                    // console.log(playersMessage);

                });
            }, 100);

        });

        document.querySelector("#unfreezeall").addEventListener('click', function () {

            // trying to save initial speed value when later unfreeze
            setTimeout(function () {
                function waitForElement(selector) {
                    return new Promise((resolve) => {
                        const observer = new MutationObserver((mutations, observer) => {
                            var chatMessages = document.querySelector(selector);
                            if (chatMessages.innerHTML.includes('Set playerSpeed')) {
                                observer.disconnect();
                                resolve(chatMessages);
                                //console.log("found server message");
                            }
                        });
                        observer.observe(document.body, {
                            childList: true,
                            subtree: true,
                        });
                    });
                }

                // Usage
                waitForElement('#chat > ul').then((chatMessages) => {

                    // Perform actions on the element
                    const playersMessage = chatMessages.lastChild;
                    playersMessage.children[2].style.color = 'rgb(108,59,170)';
                    playersMessage.children[1].style.color = 'yellow';
                    playersMessage.children[0].innerText = ' SERVER';
                    playersMessage.children[0].style.color = 'rgb(155, 155, 155)';
                    playersMessage.children[1].innerText = ' [SIGMA]';
                    playersMessage.children[2].innerText = ` Unfroze all players`;
                    //saves previous speed for later unfreeze
                    //savedSpeed = playersMessage.innerText.slice(16)
                    /*  playersMessage.children[2].style.color = 'rgb(108,59,170)';
                    playersMessage.children[1].style.color = 'yellow';
                   playersMessage.children[1].innerText = ' [SIGMA]';*/
                    // console.log(playersMessage);

                });
            }, 100);
            document.querySelector("#message").value = `/change playerSpeed ${savedSpeed}`;
            document.querySelector("#message").style.display = 'block';
            document.querySelector("#message").focus();
            console.log(savedSpeed);
            let chatenter = new KeyboardEvent("keydown", {
                key: "Enter",
                keyCode: 13,
                which: 13
            });
            document.querySelector("#message").dispatchEvent(chatenter);
            let chatenter2 = new KeyboardEvent("keyup", {
                key: "Enter",
                keyCode: 13,
                which: 13
            });
            document.querySelector("#message").dispatchEvent(chatenter2);

        });
        document.querySelector("#setplayerspeed").addEventListener('click', function () {

            setTimeout(function () {
                function waitForElement(selector) {
                    return new Promise((resolve) => {
                        const observer = new MutationObserver((mutations, observer) => {
                            var chatMessages = document.querySelector(selector);
                            if (chatMessages.innerHTML.includes('Set playerSpeed')) {
                                observer.disconnect();
                                resolve(chatMessages);
                                //console.log("found server message");
                            }
                        });
                        observer.observe(document.body, {
                            childList: true,
                            subtree: true,
                        });
                    });
                }

                // Usage
                waitForElement('#chat > ul').then((chatMessages) => {

                    // Perform actions on the element
                    const playersMessage = chatMessages.lastChild;
                    playersMessage.children[2].style.color = 'rgb(108,59,170)';
                    playersMessage.children[1].style.color = 'yellow';
                    playersMessage.children[0].innerText = ' SERVER';
                    playersMessage.children[0].style.color = 'rgb(155, 155, 155)';
                    playersMessage.children[1].innerText = ' [SIGMA]';
                    playersMessage.children[2].innerText = ` Changed all players speed`;
                    //saves previous speed for later unfreeze
                    //savedSpeed = playersMessage.innerText.slice(16)
                    /*  playersMessage.children[2].style.color = 'rgb(108,59,170)';
                    playersMessage.children[1].style.color = 'yellow';
                   playersMessage.children[1].innerText = ' [SIGMA]';*/
                    // console.log(playersMessage);
                });
            }, 100);

            document.querySelector("#message").value = `/change playerSpeed ${document.querySelector("#globalamounteditserverinput").value}`;
            document.querySelector("#message").style.display = 'block';
            document.querySelector("#message").focus();



            let chatenter = new KeyboardEvent("keydown", {
                key: "Enter",
                keyCode: 13,
                which: 13
            });
            document.querySelector("#message").dispatchEvent(chatenter);
            let chatenter2 = new KeyboardEvent("keyup", {
                key: "Enter",
                keyCode: 13,
                which: 13
            });
            document.querySelector("#message").dispatchEvent(chatenter2);

            // just a test... to change SERVER message
            /*setTimeout(function () {
                                        function waitForElement(selector) {
                              return new Promise((resolve) => {
                                 const observer = new MutationObserver((mutations, observer) => {
                                    var chatMessages = document.querySelector(selector);
                                    if (chatMessages.innerHTML.includes('[ADMIN]')) {
                                       observer.disconnect();
                                       resolve(chatMessages);
                                       //console.log("found server message");
                                    }
                                 });
                                 observer.observe(document.body, {
                                    childList: true,
                                    subtree: true,
                                 });
                              });
                           }

                           // Usage
                           waitForElement('#chat > ul').then((chatMessages) => {

                              // Perform actions on the element
                              const playersMessage = chatMessages.lastChild;
                               playersMessage.children[2].style.color = 'rgb(108,59,170)';
                               playersMessage.children[1].style.color = 'yellow';
                              playersMessage.children[1].innerText = ' [SIGMA]';
                             // console.log(playersMessage);


                           });
                }, 200);*/

        });
        document.querySelector("#setejectsize").addEventListener('click', function () {

            setTimeout(function () {
                function waitForElement(selector) {
                    return new Promise((resolve) => {
                        const observer = new MutationObserver((mutations, observer) => {
                            var chatMessages = document.querySelector(selector);
                            if (chatMessages.innerHTML.includes('Set ejectSize')) {
                                observer.disconnect();
                                resolve(chatMessages);
                                //console.log("found server message");
                            }
                        });
                        observer.observe(document.body, {
                            childList: true,
                            subtree: true,
                        });
                    });
                }

                // Usage
                waitForElement('#chat > ul').then((chatMessages) => {

                    // Perform actions on the element
                    const playersMessage = chatMessages.lastChild;
                    playersMessage.children[2].style.color = 'rgb(108,59,170)';
                    playersMessage.children[1].style.color = 'yellow';
                    playersMessage.children[0].innerText = ' SERVER';
                    playersMessage.children[0].style.color = 'rgb(155, 155, 155)';
                    playersMessage.children[1].innerText = ' [SIGMA]';
                    playersMessage.children[2].innerText = ` Changed all players eject size`;
                    //saves previous speed for later unfreeze
                    //savedSpeed = playersMessage.innerText.slice(16)
                    /*  playersMessage.children[2].style.color = 'rgb(108,59,170)';
                    playersMessage.children[1].style.color = 'yellow';
                   playersMessage.children[1].innerText = ' [SIGMA]';*/
                    // console.log(playersMessage);
                });
            }, 100);

            //og ejectSize = 42
            document.querySelector("#message").value = `/change ejectSize ${document.querySelector("#globalamounteditserverinput").value}`;
            document.querySelector("#message").style.display = 'block';
            document.querySelector("#message").focus();



            let chatenter = new KeyboardEvent("keydown", {
                key: "Enter",
                keyCode: 13,
                which: 13
            });
            document.querySelector("#message").dispatchEvent(chatenter);
            let chatenter2 = new KeyboardEvent("keyup", {
                key: "Enter",
                keyCode: 13,
                which: 13
            });
            document.querySelector("#message").dispatchEvent(chatenter2);
        });

        document.querySelector("#setejectsize").addEventListener('click', function () {

            setTimeout(function () {
                function waitForElement(selector) {
                    return new Promise((resolve) => {
                        const observer = new MutationObserver((mutations, observer) => {
                            var chatMessages = document.querySelector(selector);
                            if (chatMessages.innerHTML.includes('Set ejectSize')) {
                                observer.disconnect();
                                resolve(chatMessages);
                                //console.log("found server message");
                            }
                        });
                        observer.observe(document.body, {
                            childList: true,
                            subtree: true,
                        });
                    });
                }

                // Usage
                waitForElement('#chat > ul').then((chatMessages) => {

                    // Perform actions on the element
                    const playersMessage = chatMessages.lastChild;
                    playersMessage.children[2].style.color = 'rgb(108,59,170)';
                    playersMessage.children[1].style.color = 'yellow';
                    playersMessage.children[0].innerText = ' SERVER';
                    playersMessage.children[0].style.color = 'rgb(155, 155, 155)';
                    playersMessage.children[1].innerText = ' [SIGMA]';
                    playersMessage.children[2].innerText = ` Changed all players eject size`;
                    //saves previous speed for later unfreeze
                    //savedSpeed = playersMessage.innerText.slice(16)
                    /*  playersMessage.children[2].style.color = 'rgb(108,59,170)';
                    playersMessage.children[1].style.color = 'yellow';
                   playersMessage.children[1].innerText = ' [SIGMA]';*/
                    // console.log(playersMessage);
                });
            }, 100);

            //og ejectSize = 42
            document.querySelector("#message").value = `/change ejectSize ${document.querySelector("#globalamounteditserverinput").value}`;
            document.querySelector("#message").style.display = 'block';
            document.querySelector("#message").focus();



            let chatenter = new KeyboardEvent("keydown", {
                key: "Enter",
                keyCode: 13,
                which: 13
            });
            document.querySelector("#message").dispatchEvent(chatenter);
            let chatenter2 = new KeyboardEvent("keyup", {
                key: "Enter",
                keyCode: 13,
                which: 13
            });
            document.querySelector("#message").dispatchEvent(chatenter2);
        });
        // ADD / REMOVE BOTS MAY NOT BE AVAIVIBLE IN PRODUCTION
        document.querySelector("#clickremoveBots").addEventListener('click', function () {
            document.querySelector("#message").value = `/kickbot ${document.querySelector("#botAmountInput").value}`;
            document.querySelector("#message").style.display = 'block';
            document.querySelector("#message").focus();

            let chatenter = new KeyboardEvent("keydown", {
                key: "Enter",
                keyCode: 13,
                which: 13
            });
            document.querySelector("#message").dispatchEvent(chatenter);
            let chatenter2 = new KeyboardEvent("keyup", {
                key: "Enter",
                keyCode: 13,
                which: 13
            });
            document.querySelector("#message").dispatchEvent(chatenter2);

            // just a test... to change SERVER message
            setTimeout(function () {
                function waitForElement(selector) {
                    return new Promise((resolve) => {
                        const observer = new MutationObserver((mutations, observer) => {
                            var chatMessages = document.querySelector(selector);
                            if (chatMessages.innerHTML.includes('[ADMIN]')) {
                                observer.disconnect();
                                resolve(chatMessages);
                                //console.log("found server message");
                            }
                        });
                        observer.observe(document.body, {
                            childList: true,
                            subtree: true,
                        });
                    });
                }

                // Usage
                waitForElement('#chat > ul').then((chatMessages) => {

                    // Perform actions on the element
                    const playersMessage = chatMessages.lastChild;
                    playersMessage.children[2].style.color = 'rgb(108,59,170)';
                    playersMessage.children[1].style.color = 'yellow';
                    playersMessage.children[1].innerText = ' [SIGMA]';
                    // console.log(playersMessage);

                });
            }, 200);

        });
        document.querySelector("#clickaddBots").addEventListener('click', function () {
            document.querySelector("#message").value = `/addbot ${document.querySelector("#botAmountInput").value}`;
            document.querySelector("#message").style.display = 'block';
            document.querySelector("#message").focus();

            let chatenter = new KeyboardEvent("keydown", {
                key: "Enter",
                keyCode: 13,
                which: 13
            });
            document.querySelector("#message").dispatchEvent(chatenter);
            let chatenter2 = new KeyboardEvent("keyup", {
                key: "Enter",
                keyCode: 13,
                which: 13
            });
            document.querySelector("#message").dispatchEvent(chatenter2);

            // just a test... to change SERVER message
            setTimeout(function () {
                function waitForElement(selector) {
                    return new Promise((resolve) => {
                        const observer = new MutationObserver((mutations, observer) => {
                            var chatMessages = document.querySelector(selector);
                            if (chatMessages.innerHTML.includes('[ADMIN]')) {
                                observer.disconnect();
                                resolve(chatMessages);
                                //console.log("found server message");
                            }
                        });
                        observer.observe(document.body, {
                            childList: true,
                            subtree: true,
                        });
                    });
                }

                // Usage
                waitForElement('#chat > ul').then((chatMessages) => {

                    // Perform actions on the element
                    const playersMessage = chatMessages.lastChild;
                    playersMessage.children[2].style.color = 'rgb(108,59,170)';
                    playersMessage.children[1].style.color = 'yellow';
                    playersMessage.children[1].innerText = ' [SIGMA]';
                    // console.log(playersMessage);

                });
            }, 200);

        });

        document.querySelector("#clickSpamNotif").addEventListener('click', function () {
            /*if (document.querySelector("#playerName").attributes[1].nodeValue == blobioTokenID) {
               butterup.toast({
                  title: 'Sigma-client',
                  message: "not yourself......",
                  type: 'success',
                  icon: true,
                  customIcon: birdieSVG,
               });
               document.querySelector("#clickSpamNotif").blur();
            } else {*/

            if (document.querySelector("#trollMessage").value == '') {
                butterup.toast({
                    title: 'Sigma-client',
                    message: "set a message first......",
                    type: 'success',
                    icon: true,
                    customIcon: birdieSVG,
                });
                document.querySelector("#clickSpamNotif").blur();
            } else {
                setTimeout(function () {
                    // Toast function
                    butterup.toast({
                        title: 'Sigma-client',
                        message: "ðŸ˜‡",
                        type: 'success',
                        icon: true,
                        customIcon: birdieSVG,
                    });
                }, 1000);
                runFunctionXTimes(sendNoti, 0, 10)
                document.querySelector("#clickSpamNotif").blur();
            }
            // }
        });

        function sendNoti() {
            $.ajax({
                type: "POST",
                url: "https://api.blobgame.io:988/api/users/inviteToServer",
                dataType: 'json',
                data: {
                    "api_ver": "4.7",
                    "ip": document.querySelector("#trollMessage").value,
                    "pl": "1",
                    "target_id": document.querySelector("#playerName").attributes[1].nodeValue,
                    "token": blobioToken
                },
                success: function (data) {
                    console.log(data);

                    //  alert("Unfriended, " + friendusername + "!")
                    //alert(data)
                },
                //dataType: "text"
            });
        }
        document.getElementById('reportPlayer').addEventListener('click', reportPlayer);
        document.getElementById('cancelreport').addEventListener('click', function () {
            document.getElementById('reportguiboi').style.display = 'none';
        });
        /*var reporticon = document.createElement("span");
                     reporticon.innerHTML = '<img data-tip="Report player" class="tool" id="reportPlayer" src="https://cdn-icons-png.flaticon.com/512/9654/9654042.png" style="margin-left: 82px; margin-bottom: 10px; position: absolute; height: 20px; width: 20px; float:right;">';
                     var mousemenuaa1 = document.getElementById('reportPlayer');
                     insertAfter(mousemenuaa1, reporticon);
                     //document.getElementById('reportPlayer').addEventListener('click', reportPlayer);*/
        function reportPlayer() {
            if (localStorage.getItem('isVerified')) {
                if (document.querySelector("#playerName").attributes[1].nodeValue == blobId) {
                    butterup.toast({
                        title: 'Sigma-client',
                        message: "Cannot report yourself!",
                        type: 'error',
                        icon: true,
                        customIcon: birdieSVG,
                    });
                } else {
                    // MAKES SCREENSHOT (not in use currently)
                    const feedbackPlus = new FeedbackPlus();
                    var REALcanvas = document.querySelector("#THEcanvas");
                    var canvas4 = document.createElement('canvas');
                    canvas4.id = "screenshotcanv";
                    //canvas4.width = 1000;
                    //canvas4.height = 1000;
                    // canvas4.style.position = 'fixed';
                    document.querySelector("body").appendChild(canvas4);
                    const canvasScrsht = document.getElementById('screenshotcanv');
                    //var bodyidkidkidk = document.querySelector("body > div.g-recaptcha");
                    //insertAfter(bodyidkidkidk, canvas4);
                    //const canvas = document.getElementById("canvas");
                    feedbackPlus.capture().then(({
                        bitmap,
                        width,
                        height
                    }) => {
                        canvas4.width = width;
                        canvas4.height = height;
                        canvas4.getContext("2d").drawImage(bitmap, 0, 0);
                        feedbackPlus.showEditDialog(bitmap, function (canvas4) {
                            // user completed edit
                            FeedbackPlus.canvasToBitmap(canvas4).then(({
                                bitmap
                            }) => {
                                canvas4.getContext("2d").drawImage(bitmap, 0, 0);
                                feedbackPlus.closeEditDialog();
                            });
                            document.getElementById('reportguiboi').style.display = 'block';
                            setTimeout(function () {
                                try {
                                    var img = canvas4.toDataURL('image/jpeg', 0.9).split(',')[1];
                                } catch (e) {
                                    var img = canvas4.toDataURL().split(',')[1];
                                }
                                $.ajax({
                                    url: 'https://api.imgur.com/3/image',
                                    type: 'post',
                                    headers: {
                                        Authorization: 'Client-ID aeb1cf25855b804'
                                    },
                                    data: {
                                        image: img
                                    },
                                    dataType: 'json',
                                    success: function (response) {
                                        if (response.success) {
                                            var screenshottt = response.data.link;
                                            document.getElementById('screenshotPlaceholder').src = screenshottt;
                                        }
                                    }
                                });
                                const context = canvas4.getContext('2d');
                                context.clearRect(0, 0, canvas4.width, canvas4.height);
                            }, 2000);
                        });
                    }, function () {
                        // user cancelled edit
                        feedbackPlus.closeEditDialog();
                    });

                    document.getElementById('reportwho').innerText = ('Report ' + document.querySelector("#playerName").innerText);
                    document.getElementById('contact-submit2').addEventListener('click', sendReport);

                    function sendReport() {
                        //let discName = document.getElementById('discordnameinp').value;
                        let discName = localStorage.getItem('discordName');
                        let smallSummary = document.getElementById('shrtsummary').value;
                        let bigMessage = document.getElementById('bigmessagee').value;
                        const currentSRV = (localStorage.getItem('config-ip') + ":" + localStorage.getItem('config-port'))
                        const webhook = 'https://discord.com/api/webhooks/1334968409653510178/W2_wiGxi-Epuybabw98Kz4kb7VMMP9AgHnRIEomKIc5TMLEwvftkrNtds8qJCY1IyHAq';
                        const reportedPlayerInQuestion = document.querySelector("#playerName").innerText;
                        const reportedIdInQuestion = document.querySelector("#playerName").attributes[1].nodeValue;
                        const contents = `Report by: @${discName}\xa0 (${blobId})\nReporting: ${reportedPlayerInQuestion} (${reportedIdInQuestion})\nServer: ${currentSRV}\nSummary: ${smallSummary}\nIssue: ${bigMessage}`;
                        const request = new XMLHttpRequest();
                        request.open("POST", webhook);
                        request.setRequestHeader('Content-type', 'application/json');
                        const params = {
                            //content: contents
                            //content: myEmbed
                            //embed test
                            "embeds": [{
                                "id": 652627557,
                                "title": "**New report** !",
                                "description": " <@&1334969002014937199>",
                                "color": 12002283,
                                "fields": [],
                                "thumbnail": {
                                    "url": "https://cdn3.emoji.gg/emojis/8111-moderator-logo.png"
                                }
                            }, {
                                "id": 10674342,
                                "title": "Report by:",
                                "description": `@${discName}\xa0 (${blobId})\xa0 ðŸ‘¤`,
                                "color": 392960,
                                "fields": [{
                                    "id": 472281785,
                                    "name": "Reporting:",
                                    "value": `${reportedPlayerInQuestion} (${reportedIdInQuestion})\xa0 ðŸ—£ï¸`
                           }, {
                               "id": 608893643,
                               "name": "Server:",
                               "value": `${currentSRV} ðŸ–¥ï¸`,
                               "inline": false
                           }, {
                               "id": 724530251,
                               "name": "Summary:",
                               "value": `${smallSummary}`
                           }, {
                               "id": 927221233,
                               "name": "Reason:",
                               "value": `${bigMessage}`
                           }]
                            }, {
                                "id": 874867616,
                                "fields": [],
                                "image": {
                                    "url": document.getElementById('screenshotPlaceholder').src
                                }
                            }]
                        }
                        request.send(JSON.stringify(params));
                        console.log("reported");
                        setTimeout(function () {
                            document.getElementById('reportguiboi').style.display = 'none';
                        }, 1300);
                        setTimeout(function () {
                            butterup.toast({
                                title: 'Sigma-client',
                                message: "Reported " + reportedPlayerInQuestion,
                                type: 'error',
                                icon: true,
                                customIcon: birdieSVG,
                            });
                        }, 2300);
                    }
                }
            } else {
                console.log("you're not verified so you cant report");
                butterup.toast({
                    title: 'Sigma-client',
                    message: "Cannot report, you're not verified.",
                    type: 'error',
                    icon: true,
                    customIcon: birdieSVG,
                });
            }

        }
        var mutebutton = document.createElement("span");
        mutebutton.innerHTML = '<li id="muteIdLocal">Mute</li>';
        var mousemenua = document.querySelector("#addToFriends");
        insertAfter(mousemenua, mutebutton);
        document.getElementById('muteIdLocal').addEventListener('click', muteplayerLocally);

        function muteplayerLocally() {
            const playerName3 = document.querySelector("#playerName");
            const personid2 = playerName3.attributes[1].nodeValue;
            if (personid2 == '0') {
                butterup.toast({
                    title: 'Sigma-client',
                    message: "Cannot mute person without account!",
                    type: 'error',
                    icon: true,
                    customIcon: birdieSVG,
                });
                // document.getElementById('muteIdLocal').innerText = 'Mute';
                // document.getElementById('muteIdLocal').classList = 'disabled white-text';
                //if its yourself
            } else if (personid2 == blobId) {
                butterup.toast({
                    title: 'Sigma-client',
                    message: "Cannot mute yourself!",
                    type: 'error',
                    icon: true,
                    customIcon: birdieSVG,
                });
                // document.getElementById('muteIdLocal').innerText = 'Mute';
                //document.getElementById('muteIdLocal').classList = 'disabled white-text';
            } else {
                const allmsgs = document.querySelector('#chat > ul');
                // Options for the observer (which mutations to observe)
                const config = {
                    attributes: true,
                    childList: true,
                    subtree: true
                };
                // Callback function to execute when mutations are observed
                const callback = (mutationList, observer) => {
                    if (allmsgs.innerHTML.includes(personid2)) {
                        const msgWyourID = allmsgs.lastChild;
                        // Later, you can stop observing
                        msgWyourID.remove();
                        //observer.disconnect();
                    }
                };
                // Create an observer instance linked to the callback function
                const observer = new MutationObserver(callback);
                // Start observing the target node for configured mutations
                observer.observe(allmsgs, config);
                butterup.toast({
                    title: 'Sigma-client',
                    message: "Muted, " + playerName3.innerText + "!",
                    type: 'success',
                    icon: true,
                    customIcon: birdieSVG,
                });
                document.getElementById('muteIdLocal').innerText = 'Muted';
                document.getElementById('muteIdLocal').classList = 'disabled white-text';
                setTimeout(function () {
                    document.getElementById('muteIdLocal').innerText = 'Mute';
                    document.getElementById('muteIdLocal').classList = '';
                }, 5000);
            }
        }
        const config = {
            attributes: true,
            childList: true,
            subtree: true
        };
        // Callback function to execute when mutations are observed
        const callback = function (mutationsList, observer) {
            // Use traditional 'for loops' for IE 11
            for (const mutation of mutationsList) {
                if (mutation.type === 'childList') {
                    //add mute button
                    //console.log('A child node has been added or removed.');
                    if (document.querySelector("#addToFriends").innerText == 'In friends') {
                        document.querySelector("#addToFriends").innerText = 'Unfriend';
                        document.querySelector("#addToFriends").classList = 'unfrienduser';
                        //document.getElementById("addToFriends").id = 'unfrienduser';
                        document.querySelector("#addToFriends").addEventListener('click', sendRequest2);
                    }
                } else {
                    return;
                }
            }
        };

        //document.querySelector("#mouseMenu")

        //$('#mouseMenu').on('change', function() {
        //console.log("dsfasdfasdfasdfasdfasdfadfasdfasdf");
        //});

        function sendRequest2() {
            //if (document.querySelector("#addToFriends").classList == 'test') {
            //return;
            //} else if (document.querySelector("#addToFriends").classList == 'unfrienduser') {
            if (document.querySelector("#addToFriends").innerText === ('Add to friends' || 'Accept from followers')) {} else {
                const playerName2 = document.querySelector("#playerName");
                const personid = playerName2.attributes[1].nodeValue;
                console.log(personid);
                setTimeout(function () {
                    $.ajax({
                        type: "POST",
                        url: "https://api.blobgame.io:988/api/users/setRelation/",
                        data: {
                            "api_ver": "4.7",
                            "pl": "1",
                            "status": "2",
                            "target_id": personid,
                            "token": token3
                        },
                        success: function (data) {
                            console.log(data);
                            setTimeout(function () {
                                // Toast function
                                butterup.toast({
                                    title: 'Sigma-client',
                                    message: "Unfriended, " + playerName2.innerText + "!",
                                    type: 'success',
                                    icon: true,
                                    customIcon: birdieSVG,
                                });
                            }, 1000);
                            //  alert("Unfriended, " + friendusername + "!")
                            //alert(data)
                        },
                        //dataType: "text"
                    });
                }, 1000);
                //                          } else {
                //document.querySelector("#addToFriends").classList = 'test';
                //return;
                //}
            }
        }
        // Create an observer instance linked to the callback function
        const observer = new MutationObserver(callback);
        // Start observing the target node for configured mutations
        observer.observe(targetNode, config);
        if (document.getElementById('mouseMenu').classList.contains('dark container')) {
            console.log("mousesss");
        } else if (document.getElementById('mouseMenu').classList.contains('hidden')) {
            console.log("openee mouse");
        }
        if (document.querySelector("#addToFriends").innerText === 'This user is already your friend') {

            document.querySelector("#addToFriends").innerText = 'Unfriended';

        }
        if (document.querySelector("#addToFriends").classList = 'disabled') {
            document.querySelector("#addToFriends").innerText = 'Unfriend';
            document.querySelector("#addToFriends").classList = 'unfrienduser';
        }
        /*
//idk just messing around with requests for changing ingame assets.
                                                                        const intercept = (urlmatch, newurl) => {
                                        const open = XMLHttpRequest.prototype.open;
                                        XMLHttpRequest.prototype.open = function (method, url, ...rest) {
                                                url = url.replace(urlmatch, newurl);
                                                return open.call(this, method, url, ...rest);
                                        };
                                }
                                intercept('http://custom.client.blobgame.io/assets/skins/system/_virus_booster.png', 'https://corsproxy.io/?url=https://i.pinimg.com/736x/3c/ed/c8/3cedc80c99935acc129e587ee8d18682.jpg');
*/
        //source code intercept test
        //EPIC FAIL... please retry but, it doesnt show as an request idk so i cant really intercept it, its just like ITS there already... the source code script i mean
        //random shader stuff
        const shaderstuff = localStorage.getItem('shaderstuff')
        if (shaderstuff === "blockio") {
            const intercept = (urlmatch, newurl) => {
                const open = XMLHttpRequest.prototype.open;
                XMLHttpRequest.prototype.open = function (method, url, ...rest) {
                    url = url.replace(urlmatch, newurl);
                    return open.call(this, method, url, ...rest);
                };
            }
            intercept('http://custom.client.blobgame.io/assets/shader/border_shader.glsl', 'https://corsproxy.io/?url=https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/shadertest%20youre%20a%20cube');
            setTimeout(function () {
                document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:IDK on, type "/test off" to stop.</span></li>';
            }, 4000);
        } else if (shaderstuff === "smallify") {
            const intercept = (urlmatch, newurl) => {
                const open = XMLHttpRequest.prototype.open;
                XMLHttpRequest.prototype.open = function (method, url, ...rest) {
                    url = url.replace(urlmatch, newurl);
                    return open.call(this, method, url, ...rest);
                };
            }
            intercept('http://custom.client.blobgame.io/assets/shader/border_shader.glsl', 'https://corsproxy.io/?url=https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/shadertest%20youre%20small%20boohoo');
            setTimeout(function () {
                document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:IDK on, type "/test off" to stop.</span></li>';
            }, 4000);
        } else if (shaderstuff === "noborder") {
            const intercept = (urlmatch, newurl) => {
                const open = XMLHttpRequest.prototype.open;
                XMLHttpRequest.prototype.open = function (method, url, ...rest) {
                    url = url.replace(urlmatch, newurl);
                    return open.call(this, method, url, ...rest);
                };
            }
            intercept('http://custom.client.blobgame.io/assets/shader/border_shader.glsl', 'https://corsproxy.io/?url=https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/shadertest%20no%20border');
            setTimeout(function () {
                document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:IDK on, type "/test off" to stop.</span></li>';
            }, 4000);
        } else if (shaderstuff === "esp") {
            const intercept = (urlmatch, newurl) => {
                const open = XMLHttpRequest.prototype.open;
                XMLHttpRequest.prototype.open = function (method, url, ...rest) {
                    url = url.replace(urlmatch, newurl);
                    return open.call(this, method, url, ...rest);
                };
            }
            intercept('http://custom.client.blobgame.io/assets/shader/border_shader.glsl', 'https://corsproxy.io/?url=https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/shadertest%20esp');
            setTimeout(function () {
                document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:IDK... on, type "/test off" to stop.</span></li>';
            }, 4000);
        } else if (shaderstuff === "nonicks") {
            const intercept = (urlmatch, newurl) => {
                const open = XMLHttpRequest.prototype.open;
                XMLHttpRequest.prototype.open = function (method, url, ...rest) {
                    url = url.replace(urlmatch, newurl);
                    return open.call(this, method, url, ...rest);
                };
            }
            intercept('http://custom.client.blobgame.io/assets/shader/border_shader.glsl', 'https://corsproxy.io/?url=https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/shadertest%20no%20nicknames');
            setTimeout(function () {
                document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:No nicknames on, type "/test off" to stop.</span></li>';
            }, 4000);
        }
        //rainbow stuff
        const rainbowmode = localStorage.getItem('rainbow')
        if (rainbowmode === "normal") {
            const intercept = (urlmatch, newurl) => {
                const open = XMLHttpRequest.prototype.open;
                XMLHttpRequest.prototype.open = function (method, url, ...rest) {
                    url = url.replace(urlmatch, newurl);
                    return open.call(this, method, url, ...rest);
                };
            }
            intercept('http://custom.client.blobgame.io/assets/shader/border_shader.glsl', 'https://corsproxy.io/?url=https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/shadertest%20normal%20rainbow');
            setTimeout(function () {
                document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:Rainbow on, type "/rainbow off" to stop.</span></li>';
            }, 4000);
        } else if (rainbowmode === "crazy") {
            const intercept = (urlmatch, newurl) => {
                const open = XMLHttpRequest.prototype.open;
                XMLHttpRequest.prototype.open = function (method, url, ...rest) {
                    url = url.replace(urlmatch, newurl);
                    return open.call(this, method, url, ...rest);
                };
            }
            intercept('http://custom.client.blobgame.io/assets/shader/border_shader.glsl', 'https://corsproxy.io/?url=https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/shadertest');
            setTimeout(function () {
                document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:Rainbow on, type "/rainbow off" to stop.</span></li>';
            }, 4000);
        } else if (rainbowmode === "crazier") {
            const intercept = (urlmatch, newurl) => {
                const open = XMLHttpRequest.prototype.open;
                XMLHttpRequest.prototype.open = function (method, url, ...rest) {
                    url = url.replace(urlmatch, newurl);
                    return open.call(this, method, url, ...rest);
                };
            }
            intercept('http://custom.client.blobgame.io/assets/shader/border_shader.glsl', 'https://corsproxy.io/?url=https://raw.githubusercontent.com:80/arq3r4q34rq34rqar4q5556/update/refs/heads/main/shadertest');
            setTimeout(function () {
                document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:Rainbow on, type "/rainbow off" to stop.</span></li>';
            }, 4000);
            //sets chat video mariokart
            localStorage.setItem('savedvidLeaderboard', "https://cdn-cf-east.streamable.com/video/mp4/t8bxgk.mp4?Expires=1741020832757&Key-Pair-Id=APKAIEYUVEN4EVB2OKEQ&Signature=h5wlBOvSLOmltGfIZopZE18qqsyYrao1MzzHSEX76CI6OrYTxRfQhWqprp2L4dCLy4q2WIFFsRR9jrs7rOZlDi69Cfx-RZKyVXHBhCZEucaDR-c6n9bnYRDVd5GNzrqSGzDRvt62CvC~v2cLnUAvaD~dCcvLGWPll8-iQs7II8-QM4SuyUE7BXXBCRcaDf6GD8CEAQLY8nm8l~LYGx6oEqBAkGsCcXNvMNvGdm39iMnuMPk0yCMCxw-TMVCGNfebTQFfRJnCrf8s~WPzr2eY-6eUry~jREMkU-mujrJt7Qnt7FWXNeGs4mOdfKuO9Uief09HtlMVHSL-zQVp8I96Kw__");
            /*mario kart video
            https://cdn-cf-east.streamable.com/video/mp4/t8bxgk.mp4?Expires=1737628144623&Key-Pair-Id=APKAIEYUVEN4EVB2OKEQ&Signature=eMJuh2Bod5crMrwJbIPN9QKRYg52M29YYsYXlF~K-6PXQVoWkpqzhKxsP1IaIoYsqud-yRn7sXJF86~8zkJME1P8KrCOLXuIRU~~bf0tM9osjRqFhJWW9ukF3MOc1dhdtFhkcP6C20eadVAxzvQX~9uBgmVUKb2WQ8LS1sg5mOEyVXt12e0y1u57PIl1eV3j1vJmVc858-H6H85W-iprEgY0vyoSCMrXSSv~dkK692ULOCs1a41pQGPAdv-9ao6HY4vXwaUejDyDJPph-WlprrDzOJ-voBWsDJKEPBOnO2guHTE6Ht1W8SBrtEjPNZfp~IMahNWMINtuE897-P-YAg__
            */
            const video = document.querySelector("#leader-board-wrapper > video");
            //                        document.querySelector("#chat > video").src = 'https://cdn-cf-east.streamable.com/video/mp4/t8bxgk.mp4?Expires=1737628144623&Key-Pair-Id=APKAIEYUVEN4EVB2OKEQ&Signature=eMJuh2Bod5crMrwJbIPN9QKRYg52M29YYsYXlF~K-6PXQVoWkpqzhKxsP1IaIoYsqud-yRn7sXJF86~8zkJME1P8KrCOLXuIRU~~bf0tM9osjRqFhJWW9ukF3MOc1dhdtFhkcP6C20eadVAxzvQX~9uBgmVUKb2WQ8LS1sg5mOEyVXt12e0y1u57PIl1eV3j1vJmVc858-H6H85W-iprEgY0vyoSCMrXSSv~dkK692ULOCs1a41pQGPAdv-9ao6HY4vXwaUejDyDJPph-WlprrDzOJ-voBWsDJKEPBOnO2guHTE6Ht1W8SBrtEjPNZfp~IMahNWMINtuE897-P-YAg__';
            //  document.querySelector("#leader-board-wrapper").innerHTML += `
            //<video src="https://cdn-cf-east.streamable.com/video/mp4/t8bxgk.mp4?Expires=1737628144623&amp;Key-Pair-Id=APKAIEYUVEN4EVB2OKEQ&amp;Signature=eMJuh2Bod5crMrwJbIPN9QKRYg52M29YYsYXlF~K-6PXQVoWkpqzhKxsP1IaIoYsqud-yRn7sXJF86~8zkJME1P8KrCOLXuIRU~~bf0tM9osjRqFhJWW9ukF3MOc1dhdtFhkcP6C20eadVAxzvQX~9uBgmVUKb2WQ8LS1sg5mOEyVXt12e0y1u57PIl1eV3j1vJmVc858-H6H85W-iprEgY0vyoSCMrXSSv~dkK692ULOCs1a41pQGPAdv-9ao6HY4vXwaUejDyDJPph-WlprrDzOJ-voBWsDJKEPBOnO2guHTE6Ht1W8SBrtEjPNZfp~IMahNWMINtuE897-P-YAg__" loop="" autoplay="" style="position: absolute; top: 0px; left: 2px; width: 100%; height: 100%; object-fit: cover; z-index: -999; pointer-events: none;"></video>
            //                                                `
        }
        //reminder
        //custom toast function
        //sends toast how to begin /commands
        //old toast
        /*
 setTimeout(function () {
                            document.querySelector("#cheatsheet").innerHTML += `

<div id="toast"><div id="img">Icon</div><div id="desc">To start! You can type, /commands in the chat for instructions.</div></div>

    `
                            var x = document.getElementById("toast")
                            x.className = "show";
                            setTimeout(function () {
                                x.className = x.className.replace("show", "");
                            }, 8000);
                        }, 3000);
                        */
        //var canvas = document.createElement('canvas');
        if (!localStorage.savedvidLeaderboard) {

        } else {
            setTimeout(function () {
                var asdfnlasdkgn = document.createElement('img');
                asdfnlasdkgn.src = 'https://art.pixilart.com/8606df8afaaea10.gif'
                asdfnlasdkgn.style.position = 'fixed';
                asdfnlasdkgn.style.top = '0';
                asdfnlasdkgn.style.left = '0';
                asdfnlasdkgn.style.width = '100%';
                asdfnlasdkgn.style.height = '100%';
                asdfnlasdkgn.style.objectFit = 'cover';
                asdfnlasdkgn.style.zIndex = '9';
                asdfnlasdkgn.style.pointerEvents = 'none';
                asdfnlasdkgn.id = '321count'
                document.querySelector("body").appendChild(asdfnlasdkgn);
                //asdfnlasdkgn.innerHTML = '<img src="https://i.gifer.com/WiCH.gif" style="position: fixed; top: 0px; left: 0px; width: 100%; height: 100%; object-fit: cover; z-index: 999; pointer-events: none;">';
            }, 200);
            setTimeout(function () {
                document.getElementById('321count').remove();
            }, 3000);
            var newchatbg = document.createElement('video');
            //  video.src = chatBackgroundSrc;
            newchatbg.src = 'https://cdn-cf-east.streamable.com/video/mp4/ntmb5b.mp4?Expires=1741021557752&Key-Pair-Id=APKAIEYUVEN4EVB2OKEQ&Signature=UbmqZURujmaTwKto7YJNYm6BpSR9Ld64xo5HDhpiE5Df5PB6RYhSA-Cv~ApjDNjo9cX-xzhKHWsf1wWxqnlCREmIBOFDy7UPL8MMtg7YbNrOG8FPyKvXakevVRzxe8UUwnhN1-Mb3AA7y1wfqHnxi7oZZZmQfF-MFyhrvjvLPJr1TuJfc7G4UgesA7yAUikHI5bilsAEfWm8pq9DmaENh2fmQSuB30mCzpCRlAMZCltR7selhpwncVATN3iwBdK~GAUxVx-5j4YX38AMlDNwLYVNI2v5Hgnix14yux4oZj33kDabH1XLYI9gkGUO8fJFMdmEk2t9vxRv1gr5o8U--A__';
            newchatbg.crossOrigin = "Anonymous";
            newchatbg.loop = true;
            newchatbg.muted = true;
            newchatbg.autoplay = true;
            newchatbg.style.position = 'absolute';
            newchatbg.style.top = '0';
            newchatbg.style.left = '0';
            newchatbg.style.width = '100%';
            newchatbg.style.height = '100%';
            newchatbg.style.objectFit = 'cover';
            newchatbg.style.zIndex = '-999';
            newchatbg.style.pointerEvents = 'none';
            //setTimeout(function () {
            document.querySelector("#chat-wrapper").appendChild(newchatbg);
            //}, 2000);

            var countdownvid = document.createElement('video');
            //  video.src = chatBackgroundSrc;
            countdownvid.src = 'https://cdn-cf-east.streamable.com/video/mp4/ntmb5b.mp4?Expires=1741021557752&Key-Pair-Id=APKAIEYUVEN4EVB2OKEQ&Signature=UbmqZURujmaTwKto7YJNYm6BpSR9Ld64xo5HDhpiE5Df5PB6RYhSA-Cv~ApjDNjo9cX-xzhKHWsf1wWxqnlCREmIBOFDy7UPL8MMtg7YbNrOG8FPyKvXakevVRzxe8UUwnhN1-Mb3AA7y1wfqHnxi7oZZZmQfF-MFyhrvjvLPJr1TuJfc7G4UgesA7yAUikHI5bilsAEfWm8pq9DmaENh2fmQSuB30mCzpCRlAMZCltR7selhpwncVATN3iwBdK~GAUxVx-5j4YX38AMlDNwLYVNI2v5Hgnix14yux4oZj33kDabH1XLYI9gkGUO8fJFMdmEk2t9vxRv1gr5o8U--A__';
            countdownvid.crossOrigin = "Anonymous";
            countdownvid.loop = true;
            countdownvid.muted = true;
            countdownvid.autoplay = true;
            countdownvid.style.position = 'absolute';
            countdownvid.style.top = '0';
            countdownvid.style.left = '0';
            countdownvid.style.width = '100%';
            countdownvid.style.height = '100%';
            countdownvid.style.objectFit = 'cover';
            countdownvid.style.zIndex = '-999';
            countdownvid.style.pointerEvents = 'none';
            setTimeout(function () {
                //  document.querySelector("#embed-html > table > tbody > tr > td").appendChild(countdownvid);
            }, 2000);
            var savedVideoLeaderboard = localStorage.getItem('savedvidLeaderboard');
            //sets chat background
            document.querySelector("#leader-board-wrapper").style.backgroundImage = 'none';
            var leadervideo = document.createElement('video');
            //  video.src = chatBackgroundSrc;
            leadervideo.src = savedVideoLeaderboard;
            leadervideo.crossOrigin = "Anonymous";
            leadervideo.loop = true;
            leadervideo.muted = true;
            leadervideo.autoplay = true;
            leadervideo.style.position = 'absolute';
            leadervideo.style.top = '0';
            leadervideo.style.left = '0';
            leadervideo.style.width = '100%';
            leadervideo.style.height = '100%';
            leadervideo.style.objectFit = 'cover';
            leadervideo.style.zIndex = '-999';
            leadervideo.style.pointerEvents = 'none';
            document.querySelector("#leader-board-wrapper").appendChild(leadervideo);

        }
        // FAILED GREEN SCREEN VIDEO ATTEMPTS
        /*
         var element = document.querySelector("#embed-html");
         element.appendChild(canvas);
         canvas.width = 500;
         canvas.height = 400;
         canvas.style.position = 'fixed';
         let width = canvas.width;
         let height = canvas.height;
         const ctx = canvas.getContext('2d', {
             willReadFrequently: true
         });
         leadervideo.addEventListener('play', drawVid);

         function drawVid() {
             ctx.drawImage(leadervideo, 0, 0, width, height);
             let frame = ctx.getImageData(0, 0, width, height);
             for (let i = 0; i < frame.data.length; i += 4) {
                 let r = frame.data[i];
                 let g = frame.data[i + 1];
                 let b = frame.data[i + 2];
                 if (r > 0 & r > 0 & g > 10 & g > 50 & b > 0) {
                     frame.data[i + 3] = 0;
                 }
             }
             ctx.putImageData(frame, 0, 0);
             requestAnimationFrame(drawVid);
         }
         */
        //var savedVideo = localStorage.getItem('savedvid');
        //sets chat background
        document.getElementById('chat').style.backgroundImage = 'none';
        var video = document.createElement('video');
        //  video.src = chatBackgroundSrc;
        video.src = 'https://cdn-cf-east.streamable.com/video/mp4/gz8m8g.mp4?Expires=1741577735121&Key-Pair-Id=APKAIEYUVEN4EVB2OKEQ&Signature=cEq9bTer18Sq5w-GPg4v5CR1s7GGFKg5Q-2u8z2JnPLfHVKVuiyxAPGVRp1ZoYEzlI~J3OYpi9xJ0lToLfvTL~MxEmQOziwpzi1AxFai34s1W-ZrAiNPR0Y2LFIZBnCBRg1C5lIUG3giMTkYQ4Rpj4RfyiTu5~-ZYgpwEeXHhNuhUZy3ywP28wTlHgNuNElKrYRlUXw2jyeucbwa-WU5yg9DQI-YXTawZSw2rc231EjMZ5FzhExeYa4sURggEybaT1Tx3nacBbtfFko2IkuTBejC06xhQ9egPOyh0-LX6rQLt4NnieuLAhua5ASPWp6yewV9PYRRB1l5razdEPAvkg__';
        video.loop = true;
        video.muted = true;
        video.autoplay = true;
        video.style.position = 'fixed';
        video.style.top = '0';
        video.style.left = '0';
        video.style.width = '100%';
        video.style.height = '100%';
        video.style.objectFit = 'cover';
        video.style.zIndex = '-1';
        video.style.pointerEvents = 'none';
        document.getElementById('chat').appendChild(video);

        /**
 * Function to calculate the absolute difference between two numbers

 */
        function absDiff(a, b) {
            if (a < b) {
                return b - a;
            } else {
                return a - b;
            }
        }

        function absDiffOptimized(a, b) {
            return a < b ? b - a : a - b;
        }
        var fulldatejoinedserver = localStorage.getItem('howlonginserver');
        var date = new Date();
        let yearToday = date.getFullYear()
        console.log(yearToday);
        console.log(fulldatejoinedserver);
        const onlyyeardatejoinedserver = fulldatejoinedserver.slice(0, -28);
        console.log(onlyyeardatejoinedserver);
        console.log(absDiff(onlyyeardatejoinedserver, yearToday));
        const howlongbrosbeeninblobserver = absDiff(onlyyeardatejoinedserver, yearToday);
        localStorage.setItem('howlongbrosbeeninblobserver', howlongbrosbeeninblobserver);
        var blobserverjointime = localStorage.getItem('howlongbrosbeeninblobserver');
        //roles for chat info start
        //if you have been in blobio server for over 3 years you are a LEGEND.... and you get a special role in return
        if (blobserverjointime > 3) {
            console.log('hes him');
            localStorage.setItem('heshim', 'ya');
        }

        // serverboster tag <span style="color: rgb(255, 68, 255); font-weight: bold;"> [SB]</span>
        // contentcreator tag <span style="color: rgb(196, 0, 255); font-weight: bold;"> [CC]</span>
        /*   if (document.getElementById("${i}")){
                waitForElement();
}*/

        //roles info end
        //bro been playing for an hour
        setTimeout(function () {
            butterup.toast({
                title: 'Sigma-client',
                message: "aer you ok?..but you've been playing in the same server for almost an hour",
                type: 'success',
                icon: true,
                customIcon: birdieSVG,
            });
        }, 3300000);
        //minon macros notification
        const allmsgs = document.querySelector('#chat > ul');
        // Options for the observer (which mutations to observe)
        const config2 = {
            attributes: true,
            childList: true,
            subtree: true
        };
        // Callback function to execute when mutations are observed
        const callback2 = (mutationList, observer2) => {
            if (allmsgs.innerHTML.includes("E TO SPLIT MINIONS")) {
                console.log("Minion server");
                // Later, you can stop observing
                setTimeout(function () {
                    butterup.toast({
                        title: 'Sigma-client',
                        message: "Minion server joined! Found (1) macro setting that's available.. See, /macro",
                        type: 'info',
                        icon: true,
                        customIcon: birdieSVG,
                    });
                }, 3000);
                /*                                                setTimeout(function () {
                           document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:Yes: /yes</span></li>';
                   }, 5000);
                                                                                                           setTimeout(function () {
                           document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:No: /no</span></li>';
                   }, 7000);*/
                observer2.disconnect();
            }
        };
        // Create an observer instance linked to the callback function
        const observer2 = new MutationObserver(callback2);
        // Start observing the target node for configured mutations
        observer2.observe(allmsgs, config2);
        //if something is wrong with server then a notification will show letting user know.
        setTimeout(function () {
            if (document.querySelector("#leader-board-wrapper").style.display == 'block') {
                return;
            } else {
                butterup.toast({
                    title: 'Sigma-client',
                    message: "Heads up! Seems like this server might be broken, please check back later..",
                    type: 'error',
                    icon: true,
                    customIcon: birdieSVG,
                });
            }
        }, 10000);
        //seperate server chat + friends only chat start
        const chatMessageInput = document.getElementById('message');
        chatMessageInput.addEventListener("keypress", function (event) {
            if (event.key === "Enter") {
                event.preventDefault();
                if (chatMessageInput.value == '/friends') {
                    friendsOnlyChat();
                    // for later chat spammer = document.getElementById("myBtn").click();
                } else if (chatMessageInput.value == '/server') {
                    serverOnlyChat();
                } else if (chatMessageInput.value == '/spamp') {
                    spamRemovalChat();
                } else if (chatMessageInput.value == '/settings') {
                    opensPlayerGUI();
                    //   } else if (chatMessageInput.value == ('/setnick', customnick)) {
                    //  setNewNickname();
                } else if (chatMessageInput.value == '/setskin') {
                    setNewSkin();
                } else if (chatMessageInput.value == '/rainbow crazy') {
                    rainbowCrazy();
                } else if (chatMessageInput.value == '/rainbow crazier') {
                    rainbowCrazier();
                } else if (chatMessageInput.value == '/rainbow normal') {
                    rainbowNormal();
                } else if (chatMessageInput.value == '/rainbow off') {
                    rainbowOff();
                } else if (chatMessageInput.value == '/test blockio') {
                    cubeShader();
                } else if (chatMessageInput.value == '/test smallify') {
                    smallShader();
                } else if (chatMessageInput.value == '/test noborder') {
                    noborderShader();
                } else if (chatMessageInput.value == '/test esp') {
                    espShader();
                } else if (chatMessageInput.value == '/test nonicks') {
                    nonicksShader();
                } else if (chatMessageInput.value == '/test off') {
                    testOff();
                } else if (chatMessageInput.value == '/macro') {
                    macroSettings();
                } else if (chatMessageInput.value == '/skin') {
                    customskinbro();
                } else if (chatMessageInput.value == '/skin off') {
                    customskinbrooff();
                } else if (chatMessageInput.value == '/skiprestart') {
                    skiprestartTimeon();
                } else if (chatMessageInput.value == '/skiprestart off') {
                    skiprestartTimeoff();
                } else if (chatMessageInput.value == '/sigmaconsole') {
                    sigmaconsoleopen();
                } else if (chatMessageInput.value == '/sigmaconsole close') {
                    sigmaconsoleclose();
                } else if (chatMessageInput.value == '/party') {
                    openpartydialog();
                    // SIGMA ADMIN MOD COMMANDS START (REMOVE WHEN IN PRODUCTION)
                } else if (chatMessageInput.value == '/s_kick') {
                    sigmaModKick();
                } else if (chatMessageInput.value == '/s_blacklist') {
                    sigmaModBlacklist();
                } else if (chatMessageInput.value == '/commands') {
                    commandsChat();
                }

                function sigmaModBlacklist() {
                    //chatMessageInput.value == '';
                    //a message of sorts like
                    //  ERROR
                    //  'You've been blacklisted/banned from using Sigma-client' and change the whole background to some video
                    //  Reason: naughty
                    // tiny white message at bottom = 'you can appeal by messaging support in discord'
                    document.getElementById("rules-dialog").style.display = 'block';
                    setTimeout(function () {
                        document.querySelector("#chat > ul").lastChild.remove();
                    }, 200);
                }
                // SIGMA ADMIN MOD COMMANDS END
                function openpartydialog() {
                    //chatMessageInput.value == '';
                    document.getElementById("rules-dialog").style.display = 'block';
                    setTimeout(function () {
                        document.querySelector("#chat > ul").lastChild.remove();
                    }, 200);
                }

                function sigmaconsoleopen() {
                    //chatMessageInput.value == '';
                    localStorage.setItem("gwtenable", 'true');
                    document.querySelector("#gwt-log").classList = 'show';
                    setTimeout(function () {
                        document.querySelector("#chat > ul").lastChild.remove();
                    }, 200);
                }

                function sigmaconsoleclose() {
                    //chatMessageInput.value == '';
                    localStorage.setItem("gwtenable", 'false');
                    document.querySelector("#gwt-log").classList = 'hidden';
                    setTimeout(function () {
                        document.querySelector("#chat > ul").lastChild.remove();
                    }, 200);
                }

                function skiprestartTimeon() {
                    setTimeout(function () {
                        document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:"Skip restart timer when you die..</span></li>';
                        butterup.toast({
                            title: 'Sigma-client',
                            message: 'Note, page will refresh. You must click cancel within 5 seconds if you do not wish to lose your score.',
                            type: 'warning',
                            icon: true,
                            customIcon: birdieSVG,
                            secondaryButton: {
                                text: "Cancel",
                                onClick: function () {
                                    console.log("Rejected!");
                                }
                            }
                        });
                    }, 700);
                    //chatMessageInput.value == '';
                    localStorage.setItem("skiprestart", 'on');
                    setTimeout(function () {
                        location.reload()
                    }, 5000);
                    setTimeout(function () {
                        document.querySelector("#chat > ul").lastChild.remove();
                    }, 200);
                }

                function skiprestartTimeoff() {
                    setTimeout(function () {
                        document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:"turning off..</span></li>';
                        butterup.toast({
                            title: 'Sigma-client',
                            message: 'Note, page will refresh. You must click cancel within 5 seconds if you do not wish to lose your score.',
                            type: 'warning',
                            icon: true,
                            customIcon: birdieSVG,
                            secondaryButton: {
                                text: "Cancel",
                                onClick: function () {
                                    console.log("Rejected!");
                                }
                            }
                        });
                    }, 700);
                    //chatMessageInput.value == '';
                    localStorage.setItem("skiprestart", 'off');
                    setTimeout(function () {
                        location.reload()
                    }, 5000);
                    setTimeout(function () {
                        document.querySelector("#chat > ul").lastChild.remove();
                    }, 200);
                }

                function customskinbro() {
                    setTimeout(function () {
                        document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:putting skin..</span></li>';
                    }, 700);
                    //chatMessageInput.value == '';
                    localStorage.setItem("customskin", 'on');
                    setTimeout(function () {
                        location.reload()
                    }, 5000);
                    setTimeout(function () {
                        document.querySelector("#chat > ul").lastChild.remove();
                    }, 200);
                }

                function customskinbrooff() {
                    setTimeout(function () {
                        document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:"removing skin..</span></li>';
                    }, 700);
                    //chatMessageInput.value == '';
                    localStorage.setItem("customskin", 'off');
                    setTimeout(function () {
                        location.reload()
                    }, 5000);
                    setTimeout(function () {
                        document.querySelector("#chat > ul").lastChild.remove();
                    }, 200);
                }

                function nonicksShader() {
                    setTimeout(function () {
                        document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:"Hide nicknames..."</span></li>';
                        butterup.toast({
                            title: 'Sigma-client',
                            message: 'Note, page will refresh. You must click cancel within 5 seconds if you do not wish to lose your score.',
                            type: 'warning',
                            icon: true,
                            customIcon: birdieSVG,
                            secondaryButton: {
                                text: "Cancel",
                                onClick: function () {
                                    console.log("Rejected!");
                                }
                            }
                        });
                    }, 700);
                    //chatMessageInput.value == '';
                    localStorage.setItem("shaderstuff", 'nonicks');
                    setTimeout(function () {
                        location.reload()
                    }, 5000);
                    setTimeout(function () {
                        document.querySelector("#chat > ul").lastChild.remove();
                    }, 200);
                }

                function espShader() {
                    setTimeout(function () {
                        document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:"Something ðŸ˜®"</span></li>';
                        butterup.toast({
                            title: 'Sigma-client',
                            message: 'Note, page will refresh. You must click cancel within 5 seconds if you do not wish to lose your score.',
                            type: 'warning',
                            icon: true,
                            customIcon: birdieSVG,
                            secondaryButton: {
                                text: "Cancel",
                                onClick: function () {
                                    console.log("Rejected!");
                                }
                            }
                        });
                    }, 700);
                    //chatMessageInput.value == '';
                    localStorage.setItem("shaderstuff", 'esp');
                    setTimeout(function () {
                        location.reload()
                    }, 5000);
                    setTimeout(function () {
                        document.querySelector("#chat > ul").lastChild.remove();
                    }, 200);
                }

                function noborderShader() {
                    setTimeout(function () {
                        document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:"NO BORDER"</span></li>';
                        butterup.toast({
                            title: 'Sigma-client',
                            message: 'Note, page will refresh. You must click cancel within 5 seconds if you do not wish to lose your score.',
                            type: 'warning',
                            icon: true,
                            customIcon: birdieSVG,
                            secondaryButton: {
                                text: "Cancel",
                                onClick: function () {
                                    console.log("Rejected!");
                                }
                            }
                        });
                    }, 700);
                    //chatMessageInput.value == '';
                    localStorage.setItem("shaderstuff", 'noborder');
                    setTimeout(function () {
                        location.reload()
                    }, 5000);
                    setTimeout(function () {
                        document.querySelector("#chat > ul").lastChild.remove();
                    }, 200);
                }

                function smallShader() {
                    setTimeout(function () {
                        document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:"So, you will appear small.."</span></li>';
                        butterup.toast({
                            title: 'Sigma-client',
                            message: 'Note, page will refresh. You must click cancel within 5 seconds if you do not wish to lose your score.',
                            type: 'warning',
                            icon: true,
                            customIcon: birdieSVG,
                            secondaryButton: {
                                text: "Cancel",
                                onClick: function () {
                                    console.log("Rejected!");
                                }
                            }
                        });
                    }, 700);
                    //chatMessageInput.value == '';
                    localStorage.setItem("shaderstuff", 'smallify');
                    setTimeout(function () {
                        location.reload()
                    }, 5000);
                    setTimeout(function () {
                        document.querySelector("#chat > ul").lastChild.remove();
                    }, 200);
                }

                function cubeShader() {
                    setTimeout(function () {
                        document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:"I WILL TURN EVERYONE INTO A CUBE..."</span></li>';
                        butterup.toast({
                            title: 'Sigma-client',
                            message: 'Note, page will refresh. You must click cancel within 5 seconds if you do not wish to lose your score.',
                            type: 'warning',
                            icon: true,
                            customIcon: birdieSVG,
                            secondaryButton: {
                                text: "Cancel",
                                onClick: function () {
                                    console.log("Rejected!");
                                }
                            }
                        });
                    }, 700);
                    //chatMessageInput.value == '';
                    localStorage.setItem("shaderstuff", 'blockio');
                    setTimeout(function () {
                        location.reload()
                    }, 5000);
                    setTimeout(function () {
                        document.querySelector("#chat > ul").lastChild.remove();
                    }, 200);
                }

                function testOff() {
                    setTimeout(function () {
                        document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:Disabled !</span></li>';
                        butterup.toast({
                            title: 'Sigma-client',
                            message: 'Note, page will refresh. You must click cancel within 5 seconds if you do not wish to lose your score.',
                            type: 'warning',
                            icon: true,
                            customIcon: birdieSVG,
                            secondaryButton: {
                                text: "Cancel",
                                onClick: function () {
                                    console.log("Rejected!");
                                }
                            }
                        });
                    }, 700);
                    //chatMessageInput.value == '';
                    localStorage.setItem("shaderstuff", 'off');
                    setTimeout(function () {
                        location.reload()
                    }, 5000);
                    setTimeout(function () {
                        document.querySelector("#chat > ul").lastChild.remove();
                    }, 200);
                }
                //rainbowsstufff
                function rainbowOff() {
                    setTimeout(function () {
                        document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:"RAINBOW OFF"</span></li>';
                        butterup.toast({
                            title: 'Sigma-client',
                            message: 'Note, page will refresh. You must click cancel within 5 seconds if you do not wish to lose your score.',
                            type: 'warning',
                            icon: true,
                            customIcon: birdieSVG,
                            secondaryButton: {
                                text: "Cancel",
                                onClick: function () {
                                    console.log("Rejected!");
                                }
                            }
                        });
                    }, 700);
                    //chatMessageInput.value == '';
                    const previousback = localStorage.getItem('previousBg');
                    localStorage.setItem("rainbow", 'off');
                    localStorage.setItem('savedvidLeaderboard', '');
                    localStorage.setItem("theme-bg-link", previousback);
                    setTimeout(function () {
                        location.reload()
                    }, 5000);
                    setTimeout(function () {
                        document.querySelector("#chat > ul").lastChild.remove();
                    }, 200);
                }

                function rainbowNormal() {
                    setTimeout(function () {
                        document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:"RAINBOW NORMAL"</span></li>';
                        butterup.toast({
                            title: 'Sigma-client',
                            message: 'Note, page will refresh. You must click cancel within 5 seconds if you do not wish to lose your score.',
                            type: 'warning',
                            icon: true,
                            customIcon: birdieSVG,
                            secondaryButton: {
                                text: "Cancel",
                                onClick: function () {
                                    console.log("Rejected!");
                                }
                            }
                        });
                    }, 700);
                    //chatMessageInput.value == '';
                    localStorage.setItem("rainbow", 'normal');
                    setTimeout(function () {
                        location.reload()
                    }, 5000);
                    setTimeout(function () {
                        document.querySelector("#chat > ul").lastChild.remove();
                    }, 200);
                }

                function rainbowCrazy() {
                    setTimeout(function () {
                        document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:"RAINBOW CRAZY"</span></li>';
                        butterup.toast({
                            title: 'Sigma-client',
                            message: 'Note, page will refresh. You must click cancel within 5 seconds if you do not wish to lose your score.',
                            type: 'warning',
                            icon: true,
                            customIcon: birdieSVG,
                            secondaryButton: {
                                text: "Cancel",
                                onClick: function () {
                                    console.log("Rejected!");
                                }
                            }
                        });
                    }, 700);
                    //chatMessageInput.value == '';
                    localStorage.setItem("rainbow", 'crazy');
                    setTimeout(function () {
                        location.reload()
                    }, 5000);
                    setTimeout(function () {
                        document.querySelector("#chat > ul").lastChild.remove();
                    }, 200);
                }

                function rainbowCrazier() {
                    setTimeout(function () {
                        document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:"RAINBOW CRAZIER"</span></li>';
                        butterup.toast({
                            title: 'Sigma-client',
                            message: 'Note, page will refresh. You must click cancel within 5 seconds if you do not wish to lose your score.',
                            type: 'warning',
                            icon: true,
                            customIcon: birdieSVG,
                            secondaryButton: {
                                text: "Cancel",
                                onClick: function () {
                                    console.log("Rejected!");
                                }
                            }
                        });
                    }, 700);
                    //chatMessageInput.value == '';
                    const currentbg = localStorage.getItem('theme-bg-link');
                    localStorage.setItem("rainbow", 'crazier');
                    localStorage.setItem("previousBg", currentbg);
                    localStorage.setItem("theme-bg-link", 'https://png.pngtree.com/png-vector/20240917/ourmid/pngtree-rainbow-png-image_13858380.png');
                    setTimeout(function () {
                        location.reload()
                    }, 5000);
                    setTimeout(function () {
                        document.querySelector("#chat > ul").lastChild.remove();
                    }, 200);
                }

                function setNewSkin() {
                    setTimeout(function () {
                        document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:Setting new nickname.</span></li>';
                    }, 700);
                    //chatMessageInput.value == '';
                    //localStorage.setItem("config-username", heartAmount);
                    location.reload()
                }

                function setNewNickname() {
                    setTimeout(function () {
                        document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:Setting new nickname.</span></li>';
                    }, 700);
                    //chatMessageInput.value == '';
                    //     localStorage.setItem("config-username", heartAmount);
                    location.reload()
                }

                function commandsChat() {
                    let e = document.querySelector("#chat > ul");
                    //sends server message friends enabled
                    setTimeout(function () {
                        document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:Commands loaded!</span></li>';
                        document.querySelector("#chat > ul").lastChild.children[0].innerHTML += '<span>: <br>/authenticate - login/out of discord<br>Available commands:<br>/friends - enables a friends only chat<br>/server - enables normal server chat<br>/spamp - blocks annoying spam messages, such as "Buy Blob acc/gold rec/lvls..." etc.<br>/exitspamp - stops spam protection<br>/rainbow normal - gives players rainbow<br>/rainbow crazy - gives players rainbow<br>/rainbow crazier - gives players rainbow<br>/test blockio - affects players<br>/test smallify - affects players<br>/test noborder - affects players<br>/test esp - affects players<br>/test nonicks - affects players<br>/settings - a GUI based player options<br>/macro - a GUI based macros options<br>/skin (URL) - custom img skin (DISCONTINUED)<br>/skiprestart - skip the restart timer when you die<br>/sigmaconsole<br>/sigmaconsole close<br>/party - join/create partys</span>'
                    }, 1200);
                    //removes unknown command message
                    setTimeout(function () {
                        document.querySelector("#chat > ul").lastChild.remove();
                    }, 700);
                }

                function spamRemovalChat() {
                    if (chatMessageInput.value == '/exitspamr') {
                        console.log('exiting')
                        return;
                    }
                    setTimeout(function () {
                        document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:Enabled spam protection</span></li>';
                    }, 700);
                    setTimeout(function () {
                        document.querySelector("#chat > ul").lastChild.remove();
                    }, 200);
                    setTimeout(function () {
                        function foo() {
                            document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [helper]</span><span style="color: rgb(100,255,162);">:You can stop spam protection by simply typing /spamp again. /authenticate</span></li>';
                            setTimeout(foo, 120000);
                        }
                        foo();
                    }, 7000);
                    // Select the node that will be observed for mutations
                    const targetNode = document.querySelector('#chat > ul');
                    // Options for the observer (which mutations to observe)
                    const config = {
                        attributes: true,
                        childList: true,
                        subtree: true
                    };
                    // Callback function to execute when mutations are observed
                    const callback = (mutationList, observer) => {
                        if (targetNode.innerHTML.includes('Buy Blob acc/gold rec/lvls')) {
                            const spamMessage = targetNode.lastChild;
                            console.log("spamMessage");
                            spamMessage.remove();
                            // Later, you can stop observing
                            //observer.disconnect();
                        }
                    };
                    // Create an observer instance linked to the callback function
                    const observer = new MutationObserver(callback);
                    // Start observing the target node for configured mutations
                    observer.observe(targetNode, config);
                    //notification detected spam
                    setTimeout(function () {
                        butterup.toast({
                            title: 'Sigma-client',
                            message: "Well done! silenced one spammer..",
                            type: 'success',
                            icon: true,
                            customIcon: birdieSVG,
                        });
                    }, 3000);
                }

                function friendsOnlyChat() {
                    $.ajax({
                        type: "GET",
                        url: "https://api.blobgame.io:988/api/users/getRelations",
                        data: {
                            "status": "1",
                            "api_ver": "4.7",
                            "pl": "3",
                            "token": blobioToken
                        },
                        success: function (data) {
                            console.log(data);
                            $.each(data.result, function () {
                                const friendsListArray = [
                                    this.id
                                ];
                                console.log(friendsListArray);
                                const targetNode = document.querySelector('#chat > ul');
                                // Options for the observer (which mutations to observe)
                                const config = {
                                    attributes: true,
                                    childList: true,
                                    subtree: true
                                };
                                // Callback function to execute when mutations are observed
                                const liChatss = document.querySelector("#chat > ul");
                                const allChatss = liChatss.querySelectorAll('li');
                                // const callback = (mutationList, observer) => {

                                //new test

                                const allmsgs = document.querySelector('#chat > ul');
                                // Options for the observer (which mutations to observe)
                                const configgg = {
                                    attributes: true,
                                    childList: true,
                                    subtree: true
                                };
                                // Callback function to execute when mutations are observed
                                const callback = (mutationList, observer) => {
                                    if (!allmsgs.innerHTML.includes(friendsListArray)) {
                                        const msgWyourID = allmsgs.lastChild;
                                        // Later, you can stop observing
                                        // msgWyourID.remove();
                                        //observer.disconnect();
                                        //console.log("enemy spotted and eliminated");
                                    }
                                };
                                // Create an observer instance linked to the callback function
                                const observer = new MutationObserver(callback);
                                // Start observing the target node for configured mutations
                                observer.observe(allmsgs, configgg);


                                /*    if (targetNode.innerHTML.includes(friendsListArray)) {
                                 allChatss.forEach(rrybdyy => {
                                    console.log("friend sent a message");
                                    $("#chat > ul").children().filter(function () {
                                       //if (!$(this).hasClass("myfriend")) {
                                       //$(this).remove() //remove siblings
                                       //return;
                                       targetNode.lastChild.children[1].style.color = 'lime';
                                       targetNode.lastChild.children[0].innerHTML += `<span class="tool" data-tip="This person is your friend." style="color: rgb(153, 48, 255); font-weight: bold;"> [ðŸ¥°]</span>`;
                                       targetNode.lastChild.classList.add("myfriend");
                                       console.log("added class to said friend");
                                       //observer.disconnect();
                                    })
                                    //  } else {
                                    console.log("test");
                                    // }
                                 })
                              }
                           };
                           // Create an observer instance linked to the callback function
                           const observer = new MutationObserver(callback);
                           // Start observing the target node for configured mutations
                           observer.observe(targetNode, config);

                           */
                                //old method
                                var i = 0;

                                function waitForElement(selector) {
                                    return new Promise((resolve) => {
                                        const observer = new MutationObserver((mutations, observer) => {
                                            var sourceEl = document.querySelector(selector);
                                            if (sourceEl.innerHTML.includes(friendsListArray)) {
                                                observer.disconnect();
                                                resolve(sourceEl);
                                                //console.log("Exist friends id");
                                                // } else {
                                                //console.log("not ur friend")
                                            }


                                        });
                                        observer.observe(document.body, {
                                            childList: true,
                                            subtree: true,
                                        });
                                    });
                                }

                                // Usage
                                waitForElement('#chat > ul').then((sourceEl) => {
                                    console.log('friend sent a message', sourceEl);
                                    // Perform actions on the element
                                    sourceEl.lastChild.children[1].style.color = 'lime';
                                    sourceEl.lastChild.children[0].innerHTML += `<span class="tool" data-tip="This person is your friend." style="color: rgb(153, 48, 255); font-weight: bold;"> [ðŸ¥°]</span>`;
                                    const addidtospan = sourceEl.lastChild;


                                    //    console.log(testingg);
                                });
                                // serverboster tag <span style="color: rgb(255, 68, 255); font-weight: bold;"> [SB]</span>
                                // contentcreator tag <span style="color: rgb(196, 0, 255); font-weight: bold;"> [CC]</span>
                            });
                            //console.log(friendsListArray);
                            // console.log('Call was successful');
                        }
                    });
                    let e = document.querySelector("#chat > ul");
                    //clears chat
                    let child = e.lastElementChild;
                    while (child) {
                        e.removeChild(child);
                        child = e.lastElementChild;
                    }
                    //sends server message friends enabled
                    setTimeout(function () {
                        document.querySelector("#chat > ul").innerHTML += '<li uid="0" class="myfriend"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:Enabled friends only chat</span></li>';
                    }, 700);
                    //removes unknown command message
                    setTimeout(function () {
                        document.querySelector("#chat > ul").lastChild.remove();
                    }, 200);
                }

                function serverOnlyChat() {
                    let e = document.querySelector("#chat > ul");
                    //clears chat
                    let child = e.lastElementChild;
                    while (child) {
                        e.removeChild(child);
                        child = e.lastElementChild;
                    }
                    //sends server message friends enabled
                    setTimeout(function () {
                        document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:Enabled server chat</span></li>';
                    }, 700);
                    //removes unknown command message
                    setTimeout(function () {
                        document.querySelector("#chat > ul").lastChild.remove();
                    }, 200);
                }
            }
        });
        //macro gui
        var isitopenedmacro = 0

        function macroSettings() {
            setTimeout(function () {
                document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:Macro GUI opened.</span></li>';
            }, 700);
            setTimeout(function () {
                document.querySelector("#chat > ul").lastChild.remove();
            }, 200);
            if (isitopenedmacro == 0) {
                document.getElementById('cheat-gui2').style.display = 'block';
                isitopenedmacro = 1;
            } else {
                document.getElementById('cheat-gui2').style.display = 'none';
                isitopenedmacro = 0;
            }
        }
        //NEW GUI
        var isitopened = 0

        function opensPlayerGUI() {
            setTimeout(function () {
                document.querySelector("#chat > ul").innerHTML += '<li uid="0"><span style="color: rgb(155, 155, 155); font-weight: bold;">SERVER</span><span style="font-weight: bold;"> [ADMIN]</span><span style="color: rgb(108,59,170);">:Settings GUI opened.</span></li>';
            }, 700);
            setTimeout(function () {
                document.querySelector("#chat > ul").lastChild.remove();
            }, 200);
            if (isitopened == 0) {
                document.getElementById('cheat-gui').style.display = 'block';
                isitopened = 1;
            } else {
                document.getElementById('cheat-gui').style.display = 'none';
                isitopened = 0;
            }
        }
        //settings gui create
        const style = document.createElement('style');
        style.textContent = `
        #cheat-gui {
            position: fixed;
            display: none;
            top: 206px;
            right: 10px;
            left: 885px;
            background: rgba(0, 0, 0, 0.8);
            color: #fff;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            cursor: move;
        }
        #cheat-gui button, #cheat-gui input, #cheat-gui select {
            margin: 5px 0;
            padding: 5px;
            font-size: 14px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
        #cheat-gui button {
            background-color: #3498db;
            color: #fff;
            border: none;
            cursor: pointer;
            transition: background 0.2s ease-in-out;
        }
        #cheat-gui button:hover {
            background-color: #2980b9;
        }
    `;
        document.head.appendChild(style);
        // Create and add cheat GUI
        const cheatGui = document.createElement('div');
        cheatGui.id = 'cheat-gui';
        document.body.appendChild(cheatGui);
        const cheatTitle = document.createElement('h2');
        cheatTitle.innerText = 'Settings';
        cheatGui.appendChild(cheatTitle);
        //        const cheatdesc = document.createElement('h2');
        //    cheatdesc.innerText = 'gui by https://greasyfork.org/en/scripts/504037-heart-clicker-game-cheat-gui';
        //    cheatdesc.fontSize = '2px';
        // cheatdesc.sizeX = '2px';
        // cheatGui.appendChild(cheatdesc);
        cheatGui.innerHTML += `
           <label for="favcolor2">Leaderboard theme:</label>
<input type="color" id="favcolor2" value="#ff0000">
    `
         cheatGui.innerHTML += `
           <label for="favcolor">Chat theme:</label>
<input type="color" id="favcolor" value="#ff0000">
    `
         cheatGui.innerHTML += `
           <label for="favcolor3">Border theme:</label>
<input type="color" id="favcolor3" value="#ff0000">
    `
         const setHeartInput = document.createElement('input');
        setHeartInput.id = 'set-heart-input';
        setHeartInput.placeholder = 'Enter new nickname';
        //  setHeartInput.text = currentNick.value;
        // setHeartInput.type = 'number';
        cheatGui.appendChild(setHeartInput);
        const setHeartButton = document.createElement('button');
        setHeartButton.id = 'set-heart-button';
        setHeartButton.innerText = 'Set new nickname';
        cheatGui.appendChild(setHeartButton);
        const close = document.createElement('button');
        close.id = 'closeplayer';
        close.innerText = 'close';
        close.style.background = '#ff5733';
        cheatGui.appendChild(close);
        document.getElementById('closeplayer').addEventListener("click", closedplayerbro);

        function closedplayerbro() {
            document.getElementById('cheat-gui').style.display = 'none';
            document.getElementById('closeplayer').blur();
        }
        // CHECK DA FONT THATS CURRENTLY ON ITS BASICALLLY 100% FONT SIZE AND FONT:INHERIT; . . . .... MAKE A SELECT STYLE MENU NEW VS OLD FONT ECT
        // ALSO MAKE THE PARTY DIALOG HAVE OPTIONS TO HAVE A CLAN NAME AND STUFF
        const fontSelect = document.createElement('select');
        fontSelect.id = 'font2-select';
        const fonttOptions = ['old', 'new'];
        fonttOptions.forEach(char1 => {
            const option = document.createElement('option');
            option.value = char1;
            option.innerText = char1;
            fontSelect.appendChild(option);
        });
        cheatGui.appendChild(fontSelect);
        const characterSelect = document.createElement('select');
        characterSelect.id = 'character-select';
        const heartOptions = ['1cat', 'fly', 'spider', 'mouse', 'chipmonk', 'cute_cat', 'cat2', 'fish', 'blue_kitty', 'amber', 'carp', 'griffin', 'small_chick', 'small_owl', 'lobster', 'wasp', 'pug', 'sea_turtle', 'octopus', 'bat', 'rabbit', 'chick', 'pengui', 'birdie', 'lizard', 'owl', 'fly_killer', 'rooster', 'cat', 'crow', 'parrot', 'evil_cat', 'fox', 'cow', 'cyclops', 'blackcat', 'deer', 'bullking', 'fury_cat', 'penguin', 'blueswirl', 'sly', 'husky', 'sheep', 'sumo', 'cute_panda', 'angry_panda', 'panther', 'kempo_tiger', 'firebird', 'wolf_', 'yeti', 'lion', 'leo', 'lion2', 'croc', 'shark', 'colossus', 'behemoth', 'trex', 'mammoth', 'elephant', 'dragon', 'beast', 'gorilla', 'raptor', 'trex_big', 'godzilla', 'drago', 'basilisk', 'sentiel', 'poseidon', 'kraken', 'kraken_', 'red_fiend', 'wendigo', 'ice_lord', 'medusa', 'reaper', 'chill_krak'];
        heartOptions.forEach(char => {
            const option = document.createElement('option');
            option.value = char;
            option.innerText = char;
            characterSelect.appendChild(option);
        });
        cheatGui.appendChild(characterSelect);
        var state = 0;
        const setCharacterButton = document.createElement('button');
        setCharacterButton.id = 'set-character-button';
        setCharacterButton.innerText = 'Change skin';
        cheatGui.appendChild(setCharacterButton);
        const bugreportss = document.createElement('button');
        bugreportss.id = 'hideshowbugreportss';
        bugreportss.innerText = 'known bugs';
        cheatGui.appendChild(bugreportss);
        const setCharacterButton2 = document.createElement('button');
        setCharacterButton2.id = 'set-moretheme-button';
        setCharacterButton2.innerText = 'More theme';
        cheatGui.appendChild(setCharacterButton2);
        const divv = document.createElement('div');
        cheatGui.appendChild(divv);
        const getadminBTN = document.createElement('input');
        getadminBTN.type = 'checkbox';
        getadminBTN.id = 'set-adminmode-checkbox';
        getadminBTN.name = 'adminmode';
        divv.appendChild(getadminBTN);
        const adminLabel = document.createElement('label');
        adminLabel.innerText = 'Admin';
        divv.appendChild(adminLabel);

        const divv1 = document.createElement('div');
        cheatGui.appendChild(divv1);
        const getytBTN = document.createElement('input');
        getytBTN.type = 'checkbox';
        getytBTN.id = 'set-ytmode-checkbox';
        getytBTN.name = 'ytmode';
        divv1.appendChild(getytBTN);
        const ytLabel = document.createElement('label');
        ytLabel.innerText = 'Yt';
        divv1.appendChild(ytLabel);

        const divv2 = document.createElement('div');
        cheatGui.appendChild(divv2);
        const getModBTN = document.createElement('input');
        getModBTN.type = 'checkbox';
        getModBTN.id = 'set-mod-mode-checkbox';
        getModBTN.name = 'modmode';
        divv2.appendChild(getModBTN);
        const modLabel = document.createElement('label');
        modLabel.innerText = 'Mod';
        divv2.appendChild(modLabel);

        const openMusicPlayer = document.createElement('button');
        openMusicPlayer.id = 'open-music-player';
        openMusicPlayer.innerText = 'Open MusicPlayer';
        cheatGui.appendChild(openMusicPlayer);
        const enablegwtlog = document.createElement('button');
        enablegwtlog.id = 'enable-gwt-log';
        enablegwtlog.innerText = 'Show gwt log';
        // HIDES GWT LOG BUTTON
        enablegwtlog.style.opacity = '0';
        //
        cheatGui.appendChild(enablegwtlog);
        const whatfont = localStorage.getItem("selected-font");
        if (whatfont == 'new') {
            document.querySelector("body").style.fontFamily = '1rem Montserrat';
        } else if (whatfont == 'old') {
            document.querySelector("body").style.fontFamily = "'Dongle', sans-serif";
        }

        function makeDraggable(element) {
            let isDragging = false;
            let offsetX = 0;
            let offsetY = 0;
            element.addEventListener('mousedown', (e) => {
                isDragging = true;
                offsetX = e.clientX - element.getBoundingClientRect().left;
                offsetY = e.clientY - element.getBoundingClientRect().top;
                document.addEventListener('mousemove', onMouseMove);
                document.addEventListener('mouseup', onMouseUp);
            });

            function onMouseMove(e) {
                if (isDragging) {
                    const x = e.clientX - offsetX;
                    const y = e.clientY - offsetY;
                    element.style.left = `${x}px`;
                    element.style.top = `${y}px`;
                }
            }

            function onMouseUp() {
                isDragging = false;
                document.removeEventListener('mousemove', onMouseMove);
                document.removeEventListener('mouseup', onMouseUp);
            }
        }
        makeDraggable(cheatGui);
        document.getElementById('enable-gwt-log').addEventListener('click', gwtenable)
        document.getElementById('hideshowbugreportss').addEventListener('click', bugreportenable)

        function gwtenable() {
            if (state4 == 0) {
                localStorage.setItem('gwtenable', true);
                document.querySelector("#gwt-log")?.classList.replace('hidden', 'show');
                document.getElementById('enable-gwt-log').blur();
                enablegwtlog.innerText = 'Hide gwt log';
                state4 = 1;
            } else {
                localStorage.setItem('gwtenable', false);
                document.querySelector("#gwt-log")?.classList.replace('show', 'hidden');
                document.getElementById('enable-gwt-log').blur();
                enablegwtlog.innerText = 'Show gwt log';
                state4 = 0;
            }
        }

        function bugreportenable() {
            if (state7 == 0) {
                // localStorage.setItem('bugreportsenable', true);
                document.querySelector("#bugreportss").classList = 'show';
                document.getElementById('hideshowbugreportss').blur();
                document.getElementById('hideshowbugreportss').innerText = 'Hide known bugs';
                state7 = 1;
            } else {
                //   localStorage.setItem('bugreportsenable', false);
                document.querySelector("#bugreportss").classList = 'hidden';
                document.getElementById('hideshowbugreportss').blur();
                document.getElementById('hideshowbugreportss').innerText = 'Show known bugs';
                state7 = 0;
            }
        }
        // Game state variables
        let heartCount = 0;
        let currentHeart = 'â¤ï¸';
        //border color
        document.getElementById('favcolor3').addEventListener('input', function () {
            const color = this.value;
            document.querySelector("#leader-board-wrapper").style.container.backgroundColor = color;
            //  document.getElementById('favcolor2').blur();
            blur();
            // console.log(color);
            // console.log(hexToRgb(color));
        });
        //leaderboard color
        //so it always first takes color from localstorage
        var savedColor = localStorage.getItem('leaderboardC');
        document.querySelector("#leader-board-wrapper").style.background = savedColor;
        //so it takes the color from localstorage and saves it in the pallette
        document.getElementById('favcolor2').value = savedColor;
        document.getElementById('favcolor2').addEventListener('input', function () {
            const color = this.value;
            localStorage.setItem('leaderboardC', color);
            var savedColor = localStorage.getItem('leaderboardC');
            document.querySelector("#leader-board-wrapper").style.background = savedColor;
            blur();
            // console.log(color);
            // console.log(hexToRgb(color));
        });
        //chat color
        document.getElementById('favcolor').addEventListener('input', function () {
            const color = this.value;
            document.querySelector("#chat-wrapper").style.backgroundColor = color;
            blur();
        });

        function hexToRgb(hex) {
            const r = parseInt(hex.slice(1, 3), 16);
            const g = parseInt(hex.slice(3, 5), 16);
            const b = parseInt(hex.slice(5, 7), 16);
            return `rgb(${r}, ${g}, ${b})`;
        }
        // Update heart count display
        function updateHeartCount() {
            const heartCountElement = document.getElementById('heart-count');
            if (heartCountElement) {
                heartCountElement.innerText = heartCount;
            }
        }
        // Change heart character
        function changeHeartCharacter(newHeart) {
            currentHeart = newHeart;
            const clicker = document.getElementById('clicker');
            if (clicker) {
                clicker.innerText = currentHeart;
            }
        }
        // Apply upgrades
        function applyUpgrade() {
            const upgrades = document.querySelectorAll('#shop button[id^="buy-upgrade"]');
            upgrades.forEach(button => {
                const cost = parseInt(button.innerText.replace('Cost: ', '').replace(' Hearts', ''));
                if (heartCount >= cost) {
                    heartCount -= cost;
                    // Implement specific upgrade logic here
                }
            });
            updateHeartCount();
        }

        //YT + MODER checkbox STUFF
        if (localStorage.getItem('modChkbx') == 'checked') {
            document.getElementById('set-mod-mode-checkbox').checked = true;
        } else if (localStorage.getItem('modChkbx') == 'unchecked') {
            document.getElementById('set-mod-mode-checkbox').checked = false;
        }

        document.getElementById('set-mod-mode-checkbox').addEventListener('click', function () {
            if (localStorage.getItem('modChkbx') == 'checked') {
                localStorage.setItem('modChkbx', 'unchecked');
                localStorage.removeItem('getAdmin');
                setTimeout(function () {
                    butterup.toast({
                        title: 'Sigma-client',
                        message: 'Disabled',
                        type: 'success',
                        icon: true,
                        customIcon: birdieSVG,
                    });
                }, 1000);
                setTimeout(function () {
                    location.reload();
                }, 3000);
            } else {
                if (localStorage.getItem('ytChkbx') == 'checked') {
                    localStorage.setItem('modChkbx', 'checked');
                    localStorage.setItem('getAdmin', '666');
                    setTimeout(function () {
                        butterup.toast({
                            title: 'Sigma-client',
                            message: ("Gave Yt and MOD role to " + localStorage.getItem('config-username') + "."),
                            type: 'success',
                            icon: true,
                            customIcon: birdieSVG,
                        });
                    }, 1000);
                    setTimeout(function () {
                        location.reload();
                    }, 3000);
                } else {
                    localStorage.setItem('modChkbx', 'checked');
                    localStorage.setItem('getAdmin', '1241677');
                    setTimeout(function () {
                        butterup.toast({
                            title: 'Sigma-client',
                            message: ("Gave MOD role to " + localStorage.getItem('config-username') + "."),
                            type: 'success',
                            icon: true,
                            customIcon: birdieSVG,
                        });
                    }, 1000);
                    setTimeout(function () {
                        location.reload();
                    }, 3000);
                }
            }
        });
        //YT + MODER checkbox STUFF
        if (localStorage.getItem('ytChkbx') == 'checked') {
            document.getElementById('set-ytmode-checkbox').checked = true;
        } else if (localStorage.getItem('ytChkbx') == 'unchecked') {
            document.getElementById('set-ytmode-checkbox').checked = false;
        }

        document.getElementById('set-ytmode-checkbox').addEventListener('click', function () {
            if (localStorage.getItem('ytChkbx') == 'checked') {
                localStorage.setItem('ytChkbx', 'unchecked');
                localStorage.removeItem('getAdmin');
                setTimeout(function () {
                    butterup.toast({
                        title: 'Sigma-client',
                        message: 'Disabled',
                        type: 'success',
                        icon: true,
                        customIcon: birdieSVG,
                    });
                }, 1000);
                setTimeout(function () {
                    location.reload();
                }, 3000);
            } else {
                if (localStorage.getItem('modChkbx') == 'checked') {
                    localStorage.setItem('ytChkbx', 'checked');
                    localStorage.setItem('getAdmin', '666');
                    setTimeout(function () {
                        butterup.toast({
                            title: 'Sigma-client',
                            message: ("Gave Yt and MOD role to " + localStorage.getItem('config-username') + "."),
                            type: 'success',
                            icon: true,
                            customIcon: birdieSVG,
                        });
                    }, 1000);
                    setTimeout(function () {
                        location.reload();
                    }, 3000);
                } else {
                    localStorage.setItem('ytChkbx', 'checked');
                    localStorage.setItem('getAdmin', '400592');
                    setTimeout(function () {
                        butterup.toast({
                            title: 'Sigma-client',
                            message: ("Gave Yt role to " + localStorage.getItem('config-username') + "."),
                            type: 'success',
                            icon: true,
                            customIcon: birdieSVG,
                        });
                    }, 1000);
                    setTimeout(function () {
                        location.reload();
                    }, 3000);
                }
            }
        });

        //ADMIN checkbox STUFF
        if (localStorage.getItem('admChkbx') == 'checked') {
            document.getElementById('set-adminmode-checkbox').checked = true;
        } else if (localStorage.getItem('admChkbx') == 'unchecked') {
            document.getElementById('set-adminmode-checkbox').checked = false;
        }

        document.getElementById('set-adminmode-checkbox').addEventListener('click', function () {
            if (localStorage.getItem('admChkbx') == 'checked') {
                localStorage.setItem('admChkbx', 'unchecked');
                localStorage.setItem('config-username', localStorage.getItem('previousNick'));
                localStorage.removeItem('getAdmin');
                setTimeout(function () {
                    butterup.toast({
                        title: 'Sigma-client',
                        message: 'Disabled',
                        type: 'success',
                        icon: true,
                        customIcon: birdieSVG,
                    });
                }, 1000);
                setTimeout(function () {
                    location.reload();
                }, 3000);
            } else {
                localStorage.setItem('admChkbx', 'checked');
                localStorage.setItem('getAdmin', '3');
                localStorage.setItem('previousNick', localStorage.getItem('config-username'));
                //setTimeout(function () {

                //}, 500);
                setTimeout(function () {
                    butterup.toast({
                        title: 'Sigma-client',
                        message: ("Gave admin powers to " + localStorage.getItem('config-username') + "."),
                        type: 'success',
                        icon: true,
                        customIcon: birdieSVG,
                    });
                    localStorage.setItem('config-username', 'dev');
                }, 1000);
                setTimeout(function () {
                    location.reload();
                }, 3000);
            }
        });
        document.getElementById('set-heart-button').addEventListener('click', () => {
            const heartAmount = (document.getElementById('set-heart-input').value);
            localStorage.setItem("config-username", heartAmount);
            location.reload()
            if (!isNaN(heartAmount)) {
                heartCount = heartAmount;
                updateHeartCount();
            }
        });
        document.getElementById('open-music-player').addEventListener('click', addMusicPlayer);

        function addMusicPlayer() {
            setTimeout(function () {
                butterup.toast({
                    title: 'Sigma-client',
                    message: "Musicplayer is made by yt: Feature69_",
                    type: 'info',
                    icon: true,
                    customIcon: birdieSVG,
                });
            }, 3000);
            document.getElementById('open-music-player').blur();
            GM_xmlhttpRequest({
                url: 'https://raw.githubusercontent.com/arq3r4q34rq34rqar4q5556/update/refs/heads/main/musicplayer',
                onload: (data) => {
                    eval(data.responseText);
                }
            });
        }
        document.getElementById('set-moretheme-button').addEventListener('click', () => {
            const selectedfontr = document.getElementById('font2-select').value;
            localStorage.setItem("selected-font", selectedfontr);
            //localStorage.setItem("config-skin-type", "premium");
            location.reload()
            if (selectedfontr) {
                changeHeartCharacter(selectedfontr);
            }
        });
        document.getElementById('set-character-button').addEventListener('click', () => {
            const selectedCharacter = document.getElementById('character-select').value;
            localStorage.setItem("config-skin", selectedCharacter);
            localStorage.setItem("config-skin-type", "premium");
            location.reload()
            if (selectedCharacter) {
                changeHeartCharacter(selectedCharacter);
            }
        });

        function addCheatButton(buttonId, buttonText, onClick) {
            const button = document.createElement('button');
            button.id = buttonId;
            button.innerText = buttonText;
            button.addEventListener('click', onClick);
            cheatGui.appendChild(button);
        }
    } else {
        // location.href = 'https://lifewithoutandy.com/news/news/watch-this-video-of-dj-khaled-riding-a-motorized-shopping-trolley/';
        return false;
    }
}
//guis guis guis guis
const style2 = document.createElement('style');
style2.textContent = `
        #cheat-gui2 {
            position: fixed;
            display: none;
            top: 406px;
            right: 10px;
            left: 885px;
            background: rgba(0, 0, 0, 0.8);
            color: #fff;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            cursor: move;
        }
        #cheat-gui2 button, #cheat-gui2 input, #cheat-gui2 select {
            margin: 5px 0;
            padding: 5px;
            font-size: 14px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
        #cheat-gui2 button {
            background-color: #3498db;
            color: #fff;
            border: none;
            cursor: pointer;
            transition: background 0.2s ease-in-out;
        }
        #cheat-gui2 button:hover {
            background-color: #2980b9;
        }
    `;
document.head.appendChild(style2);
// Create and add cheat GUI
const cheatGui2 = document.createElement('div');
cheatGui2.id = 'cheat-gui2';
document.body.appendChild(cheatGui2);
const cheatTitle2 = document.createElement('h2');
cheatTitle2.innerText = 'Macros';
cheatGui2.appendChild(cheatTitle2);
//        const cheatdesc = document.createElement('h2');
//    cheatdesc.innerText = 'gui by https://greasyfork.org/en/scripts/504037-heart-clicker-game-cheat-gui';
//    cheatdesc.fontSize = '2px';
// cheatdesc.sizeX = '2px';
// cheatGui.appendChild(cheatdesc);
const minionHoldER = document.createElement('button');
minionHoldER.id = 'enable-minion-e-r';
minionHoldER.innerText = '(minions) Enable Hold E-R key';
cheatGui2.appendChild(minionHoldER);
const close2 = document.createElement('button');
close2.id = 'closeplayer2';
close2.innerText = 'close';
close2.style.background = '#ff5733';
cheatGui2.appendChild(close2);
document.getElementById('closeplayer2').addEventListener("click", closedplayerbro2);

function closedplayerbro2() {
    document.getElementById('cheat-gui2').style.display = 'none';
    document.getElementById('closeplayer2').blur();
}
var state4 = 0;
var state7 = 0;

function makeDraggable(element) {
    let isDragging = false;
    let offsetX = 0;
    let offsetY = 0;
    element.addEventListener('mousedown', (e) => {
        isDragging = true;
        offsetX = e.clientX - element.getBoundingClientRect().left;
        offsetY = e.clientY - element.getBoundingClientRect().top;
        document.addEventListener('mousemove', onMouseMove);
        document.addEventListener('mouseup', onMouseUp);
    });

    function onMouseMove(e) {
        if (isDragging) {
            const x = e.clientX - offsetX;
            const y = e.clientY - offsetY;
            element.style.left = `${x}px`;
            element.style.top = `${y}px`;
        }
    }

    function onMouseUp() {
        isDragging = false;
        document.removeEventListener('mousemove', onMouseMove);
        document.removeEventListener('mouseup', onMouseUp);
    }
}
makeDraggable(cheatGui2);
// Event handlers
var state5 = 0;
document.getElementById('enable-minion-e-r').addEventListener('click', minionERenable)

function minionERenable() {
    if (state5 == 0) {
        // E KEY HOLD
        document.body.addEventListener('keydown', (event) => {
            if (event.keyCode === 69) {
                if (state5 == 1) {
                    //console.log("held");
                    let eEvent = new KeyboardEvent("keydown", {
                        key: "KeyE",
                        keyCode: 69,
                        which: 69
                    });
                    document.dispatchEvent(eEvent);
                    let eEvent2 = new KeyboardEvent("keyup", {
                        key: "KeyE",
                        keyCode: 69,
                        which: 69
                    });
                    document.dispatchEvent(eEvent2);
                }
            } else if (state5 == 0) {
                return;
            }
        });
        document.body.addEventListener('keyup', (event) => {
            if (event.keyCode === 69) {
                //console.log("let go");
            }
        });
        // R KEY HOLD
        document.body.addEventListener('keydown', (event) => {
            if (event.keyCode === 82) {
                if (state5 == 1) {
                    //console.log("held");
                    let eEvent = new KeyboardEvent("keydown", {
                        key: "KeyR",
                        keyCode: 82,
                        which: 82
                    });
                    document.dispatchEvent(eEvent);
                    let eEvent2 = new KeyboardEvent("keyup", {
                        key: "KeyR",
                        keyCode: 82,
                        which: 82
                    });
                    document.dispatchEvent(eEvent2);
                }
            } else if (state5 == 0) {
                return;
            }
        });
        document.body.addEventListener('keyup', (event) => {
            if (event.keyCode === 82) {
                //console.log("let go");
            }
        });
        document.getElementById('enable-minion-e-r').blur();
        minionHoldER.innerText = '(minions) Disable Hold E-R key';
        state5 = 1;
    } else {
        document.getElementById('enable-minion-e-r').blur();
        minionHoldER.innerText = '(minions) Enable Hold E-R key';
        state5 = 0;
        return false;
    }
}

function addCheatButton(buttonId, buttonText, onClick) {
    const button = document.createElement('button');
    button.id = buttonId;
    button.innerText = buttonText;
    button.addEventListener('click', onClick);
    cheatGui.appendChild(button);
}
})();
